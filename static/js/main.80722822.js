/*! For license information please see main.80722822.js.LICENSE.txt */
(()=>{var e={9:e=>{"use strict";function t(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"===typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return n(e,t)}(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var i=function(){function e(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1}var n=e.prototype;return n.getIsEnabled=function(){return this.enabled_},n.enable=function(){this.enabled_=!0},n.disable=function(){this.enabled_=!1},n.reset=function(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1},n.addInterceptor=function(e,t){this.typeToInterceptorsMap_.has(e)||this.typeToInterceptorsMap_.set(e,new Set);var n=this.typeToInterceptorsMap_.get(e);return!n.has(t)&&(n.add(t),!0)},n.removeInterceptor=function(e,t){var n=this.typeToInterceptorsMap_.get(e);return!(!n||!n.has(t))&&(n.delete(t),!0)},n.clearInterceptorsByType=function(e){return!!this.typeToInterceptorsMap_.get(e)&&(this.typeToInterceptorsMap_.delete(e),this.typeToInterceptorsMap_.set(e,new Set),!0)},n.clear=function(){return!!this.typeToInterceptorsMap_.size&&(this.typeToInterceptorsMap_=new Map,!0)},n.getForType=function(e){return this.typeToInterceptorsMap_.get(e)||new Set},n.execute=function(e,n){for(var i,r=t(this.getForType(e));!(i=r()).done;){var s=i.value;try{n=s(n)}catch(a){}}return n},e}();e.exports=i},26:(e,t,n)=>{var i,r="undefined"!==typeof n.g?n.g:"undefined"!==typeof window?window:{},s=n(542);"undefined"!==typeof document?i=document:(i=r["__GLOBAL_DOCUMENT_CACHE@4"])||(i=r["__GLOBAL_DOCUMENT_CACHE@4"]=s),e.exports=i},43:(e,t,n)=>{"use strict";e.exports=n(202)},95:(e,t,n)=>{var i=n(923).NAMESPACE,r=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,s=new RegExp("[\\-\\.0-9"+r.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),a=new RegExp("^"+r.source+s.source+"*(?::"+r.source+s.source+"*)?$");function o(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,o)}function l(){}function u(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function c(e,t,n,r,s,a){function o(e,t,i){n.attributeNames.hasOwnProperty(e)&&a.fatalError("Attribute "+e+" redefined"),n.addValue(e,t.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,s),i)}for(var l,u=++t,c=0;;){var d=e.charAt(u);switch(d){case"=":if(1===c)l=e.slice(t,u),c=3;else{if(2!==c)throw new Error("attribute equal must after attrName");c=3}break;case"'":case'"':if(3===c||1===c){if(1===c&&(a.warning('attribute value must after "="'),l=e.slice(t,u)),t=u+1,!((u=e.indexOf(d,t))>0))throw new Error("attribute value no end '"+d+"' match");o(l,h=e.slice(t,u),t-1),c=5}else{if(4!=c)throw new Error('attribute value must after "="');o(l,h=e.slice(t,u),t),a.warning('attribute "'+l+'" missed start quot('+d+")!!"),t=u+1,c=5}break;case"/":switch(c){case 0:n.setTagName(e.slice(t,u));case 5:case 6:case 7:c=7,n.closed=!0;case 4:case 1:break;case 2:n.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),0==c&&n.setTagName(e.slice(t,u)),u;case">":switch(c){case 0:n.setTagName(e.slice(t,u));case 5:case 6:case 7:break;case 4:case 1:"/"===(h=e.slice(t,u)).slice(-1)&&(n.closed=!0,h=h.slice(0,-1));case 2:2===c&&(h=l),4==c?(a.warning('attribute "'+h+'" missed quot(")!'),o(l,h,t)):(i.isHTML(r[""])&&h.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+h+'" missed value!! "'+h+'" instead!!'),o(h,h,t));break;case 3:throw new Error("attribute value missed!!")}return u;case"\x80":d=" ";default:if(d<=" ")switch(c){case 0:n.setTagName(e.slice(t,u)),c=6;break;case 1:l=e.slice(t,u),c=2;break;case 4:var h=e.slice(t,u);a.warning('attribute "'+h+'" missed quot(")!!'),o(l,h,t);case 5:c=6}else switch(c){case 2:n.tagName;i.isHTML(r[""])&&l.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+l+'" missed value!! "'+l+'" instead2!!'),o(l,l,t),t=u,c=1;break;case 5:a.warning('attribute space is required"'+l+'"!!');case 6:c=1,t=u;break;case 3:c=4,t=u;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function d(e,t,n){for(var r=e.tagName,s=null,a=e.length;a--;){var o=e[a],l=o.qName,u=o.value;if((f=l.indexOf(":"))>0)var c=o.prefix=l.slice(0,f),d=l.slice(f+1),h="xmlns"===c&&d;else d=l,c=null,h="xmlns"===l&&"";o.localName=d,!1!==h&&(null==s&&(s={},p(n,n={})),n[h]=s[h]=u,o.uri=i.XMLNS,t.startPrefixMapping(h,u))}for(a=e.length;a--;){(c=(o=e[a]).prefix)&&("xml"===c&&(o.uri=i.XML),"xmlns"!==c&&(o.uri=n[c||""]))}var f;(f=r.indexOf(":"))>0?(c=e.prefix=r.slice(0,f),d=e.localName=r.slice(f+1)):(c=null,d=e.localName=r);var g=e.uri=n[c||""];if(t.startElement(g,d,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=s,!0;if(t.endElement(g,d,r),s)for(c in s)Object.prototype.hasOwnProperty.call(s,c)&&t.endPrefixMapping(c)}function h(e,t,n,i,r){if(/^(?:script|textarea)$/i.test(n)){var s=e.indexOf("</"+n+">",t),a=e.substring(t+1,s);if(/[&<]/.test(a))return/^script$/i.test(n)?(r.characters(a,0,a.length),s):(a=a.replace(/&#?\w+;/g,i),r.characters(a,0,a.length),s)}return t+1}function f(e,t,n,i){var r=i[n];return null==r&&((r=e.lastIndexOf("</"+n+">"))<t&&(r=e.lastIndexOf("</"+n)),i[n]=r),r<t}function p(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function g(e,t,n,i){if("-"===e.charAt(t+2))return"-"===e.charAt(t+3)?(r=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,r-t-4),r+3):(i.error("Unclosed comment"),-1):-1;if("CDATA["==e.substr(t+3,6)){var r=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,r-t-9),n.endCDATA(),r+3}var s=function(e,t){var n,i=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;r.lastIndex=t,r.exec(e);for(;n=r.exec(e);)if(i.push(n),n[1])return i}(e,t),a=s.length;if(a>1&&/!doctype/i.test(s[0][0])){var o=s[1][0],l=!1,u=!1;a>3&&(/^public$/i.test(s[2][0])?(l=s[3][0],u=a>4&&s[4][0]):/^system$/i.test(s[2][0])&&(u=s[3][0]));var c=s[a-1];return n.startDTD(o,l,u),n.endDTD(),c.index+c[0].length}return-1}function m(e,t,n){var i=e.indexOf("?>",t);if(i){var r=e.substring(t,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(r){r[0].length;return n.processingInstruction(r[1],r[2]),i+2}return-1}return-1}function y(){this.attributeNames={}}o.prototype=new Error,o.prototype.name=o.name,l.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),p(t,t={}),function(e,t,n,r,s){function a(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}function l(e){var t=e.slice(1,-1);return Object.hasOwnProperty.call(n,t)?n[t]:"#"===t.charAt(0)?a(parseInt(t.substr(1).replace("x","0x"))):(s.error("entity not found:"+e),e)}function p(t){if(t>k){var n=e.substring(k,t).replace(/&#?\w+;/g,l);_&&v(k),r.characters(n,0,t-k),k=t}}function v(t,n){for(;t>=T&&(n=S.exec(e));)b=n.index,T=b+n[0].length,_.lineNumber++;_.columnNumber=t-b+1}var b=0,T=0,S=/.*(?:\r\n?|\n)|.*$/g,_=r.locator,w=[{currentNSMap:t}],E={},k=0;for(;;){try{var x=e.indexOf("<",k);if(x<0){if(!e.substr(k).match(/^\s*$/)){var A=r.doc,C=A.createTextNode(e.substr(k));A.appendChild(C),r.currentElement=C}return}switch(x>k&&p(x),e.charAt(x+1)){case"/":var I=e.indexOf(">",x+3),L=e.substring(x+2,I).replace(/[ \t\n\r]+$/g,""),D=w.pop();I<0?(L=e.substring(x+2).replace(/[\s<].*/,""),s.error("end tag name: "+L+" is not complete:"+D.tagName),I=x+1+L.length):L.match(/\s</)&&(L=L.replace(/[\s<].*/,""),s.error("end tag name: "+L+" maybe not complete"),I=x+1+L.length);var R=D.localNSMap,M=D.tagName==L;if(M||D.tagName&&D.tagName.toLowerCase()==L.toLowerCase()){if(r.endElement(D.uri,D.localName,L),R)for(var P in R)Object.prototype.hasOwnProperty.call(R,P)&&r.endPrefixMapping(P);M||s.fatalError("end tag name: "+L+" is not match the current start tagName:"+D.tagName)}else w.push(D);I++;break;case"?":_&&v(x),I=m(e,x,r);break;case"!":_&&v(x),I=g(e,x,r,s);break;default:_&&v(x);var O=new y,N=w[w.length-1].currentNSMap,U=(I=c(e,x,O,N,l,s),O.length);if(!O.closed&&f(e,I,O.tagName,E)&&(O.closed=!0,n.nbsp||s.warning("unclosed xml attribute")),_&&U){for(var F=u(_,{}),B=0;B<U;B++){var j=O[B];v(j.offset),j.locator=u(_,{})}r.locator=F,d(O,r,N)&&w.push(O),r.locator=_}else d(O,r,N)&&w.push(O);i.isHTML(O.uri)&&!O.closed?I=h(e,I,O.tagName,l,r):I++}}catch($){if($ instanceof o)throw $;s.error("element parse error: "+$),I=-1}I>k?k=I:p(Math.max(x,k)+1)}}(e,t,n,r,this.errorHandler),r.endDocument()}},y.prototype={setTagName:function(e){if(!a.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,n){if(!a.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=l,t.ParseError=o},120:(e,t,n)=>{var i=n(923),r=n(699),s=n(248),a=n(95),o=r.DOMImplementation,l=i.NAMESPACE,u=a.ParseError,c=a.XMLReader;function d(e){return e.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028]/g,"\n")}function h(e){this.options=e||{locator:{}}}function f(){this.cdata=!1}function p(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function g(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function m(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function y(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}h.prototype.parseFromString=function(e,t){var n=this.options,i=new c,r=n.domBuilder||new f,a=n.errorHandler,o=n.locator,u=n.xmlns||{},h=/\/x?html?$/.test(t),p=h?s.HTML_ENTITIES:s.XML_ENTITIES;o&&r.setDocumentLocator(o),i.errorHandler=function(e,t,n){if(!e){if(t instanceof f)return t;e=t}var i={},r=e instanceof Function;function s(t){var s=e[t];!s&&r&&(s=2==e.length?function(n){e(t,n)}:e),i[t]=s&&function(e){s("[xmldom "+t+"]\t"+e+g(n))}||function(){}}return n=n||{},s("warning"),s("error"),s("fatalError"),i}(a,r,o),i.domBuilder=n.domBuilder||r,h&&(u[""]=l.HTML),u.xml=u.xml||l.XML;var m=n.normalizeLineEndings||d;return e&&"string"===typeof e?i.parse(m(e),u,p):i.errorHandler.error("invalid doc source"),r.doc},f.prototype={startDocument:function(){this.doc=(new o).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,i){var r=this.doc,s=r.createElementNS(e,n||t),a=i.length;y(this,s),this.currentElement=s,this.locator&&p(this.locator,s);for(var o=0;o<a;o++){e=i.getURI(o);var l=i.getValue(o),u=(n=i.getQName(o),r.createAttributeNS(e,n));this.locator&&p(i.getLocator(o),u),u.value=u.nodeValue=l,s.setAttributeNode(u)}},endElement:function(e,t,n){var i=this.currentElement;i.tagName;this.currentElement=i.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&p(this.locator,n),y(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=m.apply(this,arguments)){if(this.cdata)var i=this.doc.createCDATASection(e);else i=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(e)&&this.doc.appendChild(i),this.locator&&p(this.locator,i)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=m.apply(this,arguments);var i=this.doc.createComment(e);this.locator&&p(this.locator,i),y(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var i=this.doc.implementation;if(i&&i.createDocumentType){var r=i.createDocumentType(e,t,n);this.locator&&p(this.locator,r),y(this,r),this.doc.doctype=r}},warning:function(e){console.warn("[xmldom warning]\t"+e,g(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,g(this.locator))},fatalError:function(e){throw new u(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){f.prototype[e]=function(){return null}})),t.DOMParser=h},146:(e,t,n)=>{var i=n(26),r=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function s(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function a(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+(0|i)/1e3}var n=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function o(){this.values=r(null)}function l(e,t,n,i){var r=i?e.split(i):[e];for(var s in r)if("string"===typeof r[s]){var a=r[s].split(n);if(2===a.length)t(a[0].trim(),a[1].trim())}}function u(e,t,n){var i=e;function r(){var t=a(e);if(null===t)throw new s(s.Errors.BadTimeStamp,"Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function u(){e=e.replace(/^\s+/,"")}if(u(),t.startTime=r(),u(),"--\x3e"!==e.substr(0,3))throw new s(s.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.substr(3),u(),t.endTime=r(),u(),function(e,t){var i=new o;l(e,(function(e,t){switch(e){case"region":for(var r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var s=t.split(","),a=s[0];i.integer(e,a),i.percent(e,a)&&i.set("snapToLines",!1),i.alt(e,a,["auto"]),2===s.length&&i.alt("lineAlign",s[1],["start","center","end"]);break;case"position":s=t.split(","),i.percent(e,s[0]),2===s.length&&i.alt("positionAlign",s[1],["start","center","end"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");try{t.line=i.get("line","auto")}catch(r){}t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100);try{t.align=i.get("align","center")}catch(r){t.align=i.get("align","middle")}try{t.position=i.get("position","auto")}catch(r){t.position=i.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=i.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}s.prototype=r(Error.prototype),s.prototype.constructor=s,s.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},o.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var c=i.createElement&&i.createElement("textarea"),d={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},h={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},f={v:"title",lang:"lang"},p={rt:"ruby"};function g(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]*>?)?/);return e=n[1]?n[1]:n[2],t=t.substr(e.length),e}function i(e,t){return!p[t.localName]||p[t.localName]===e.localName}function r(t,n){var i=d[t];if(!i)return null;var r=e.document.createElement(i),s=f[t];return s&&n&&(r[s]=n.trim()),r}for(var s,o,l=e.document.createElement("div"),u=l,g=[];null!==(s=n());)if("<"!==s[0])u.appendChild(e.document.createTextNode((o=s,c.innerHTML=o,o=c.textContent,c.textContent="",o)));else{if("/"===s[1]){g.length&&g[g.length-1]===s.substr(2).replace(">","")&&(g.pop(),u=u.parentNode);continue}var m,y=a(s.substr(1,s.length-2));if(y){m=e.document.createProcessingInstruction("timestamp",y),u.appendChild(m);continue}var v=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!v)continue;if(!(m=r(v[1],v[3])))continue;if(!i(u,m))continue;if(v[2]){var b=v[2].split(".");b.forEach((function(e){var t=/^bg_/.test(e),n=t?e.slice(3):e;if(h.hasOwnProperty(n)){var i=t?"background-color":"color",r=h[n];m.style[i]=r}})),m.className=b.join(" ")}g.push(v[1]),u.appendChild(m),u=m}return l}var m=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function y(e){for(var t=0;t<m.length;t++){var n=m[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function v(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function i(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function r(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var s=n.match(/^.*(\n|\r)/);return s?(e.length=0,s[0]):n}return"ruby"===t.tagName?r(e):t.childNodes?(i(e,t),r(e)):void 0}for(i(t,e);n=r(t);)for(var s=0;s<n.length;s++)if(y(n.charCodeAt(s)))return"rtl";return"ltr"}function b(){}function T(e,t,n){b.call(this),this.cue=t,this.cueDiv=g(e,t.text);var i={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(i,this.cueDiv),this.div=e.document.createElement("div"),i={direction:v(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(i),this.div.appendChild(this.cueDiv);var r=0;switch(t.positionAlign){case"start":case"line-left":r=t.position;break;case"center":r=t.position-t.size/2;break;case"end":case"line-right":r=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function S(e){var t,n,i,r;if(e.div){n=e.div.offsetHeight,i=e.div.offsetWidth,r=e.div.offsetTop;var s=(s=e.div.childNodes)&&(s=s[0])&&s.getClientRects&&s.getClientRects();e=e.div.getBoundingClientRect(),t=s?Math.max(s[0]&&s[0].height||0,e.height/s.length):0}this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||n,this.bottom=e.bottom||r+(e.height||n),this.width=e.width||i,this.lineHeight=void 0!==t?t:e.lineHeight}function _(e,t,n,i){var r=new S(t),s=t.cue,a=function(e){if("number"===typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,i=0,r=0;r<n.length&&n[r]!==t;r++)"showing"===n[r].mode&&i++;return-1*++i}(s),o=[];if(s.snapToLines){var l;switch(s.vertical){case"":o=["+y","-y"],l="height";break;case"rl":o=["+x","-x"],l="width";break;case"lr":o=["-x","+x"],l="width"}var u=r.lineHeight,c=u*Math.round(a),d=n[l]+u,h=o[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/u)*u),a<0&&(c+=""===s.vertical?n.height:n.width,o=o.reverse()),r.move(h,c)}else{var f=r.lineHeight/n.height*100;switch(s.lineAlign){case"center":a-=f/2;break;case"end":a-=f}switch(s.vertical){case"":t.applyStyles({top:t.formatStyle(a,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(a,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(a,"%")})}o=["+y","-x","+x","-y"],r=new S(t)}var p=function(e,t){for(var r,s=new S(e),a=1,o=0;o<t.length;o++){for(;e.overlapsOppositeAxis(n,t[o])||e.within(n)&&e.overlapsAny(i);)e.move(t[o]);if(e.within(n))return e;var l=e.intersectPercentage(n);a>l&&(r=new S(e),a=l),e=new S(s)}return r||s}(r,o);t.move(p.toCSSCompatValues(n))}function w(){}b.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},b.prototype.formatStyle=function(e,t){return 0===e?0:e+t},T.prototype=r(b.prototype),T.prototype.constructor=T,S.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},S.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},S.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},S.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},S.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},S.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},S.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},S.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,i=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||i,height:e.height||t,bottom:e.bottom||i+(e.height||t),width:e.width||n}},w.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},w.convertCueToDOMTree=function(e,t){return e&&t?g(e,t):null};w.processCues=function(e,t,n){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var i=e.document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.right="0",i.style.top="0",i.style.bottom="0",i.style.margin="1.5%",n.appendChild(i),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var r=[],s=S.getSimpleBoxPosition(i),a={font:Math.round(.05*s.height*100)/100+"px sans-serif"};!function(){for(var n,o,l=0;l<t.length;l++)o=t[l],n=new T(e,o,a),i.appendChild(n.div),_(0,n,s,r),o.displayState=n.div,r.push(S.getSimpleBoxPosition(n))}()}else for(var o=0;o<t.length;o++)i.appendChild(t[o].displayState)},w.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},w.Parser.prototype={reportOrThrowError:function(e){if(!(e instanceof s))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function n(){for(var e=t.buffer,n=0;n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var i=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),i}function i(e){e.match(/X-TIMESTAMP-MAP/)?l(e,(function(e,n){if("X-TIMESTAMP-MAP"===e)!function(e){var n=new o;l(e,(function(e,t){switch(e){case"MPEGT":n.integer(e+"S",t);break;case"LOCA":n.set(e+"L",a(t))}}),/[^\d]:/,/,/),t.ontimestampmap&&t.ontimestampmap({MPEGTS:n.get("MPEGTS"),LOCAL:n.get("LOCAL")})}(n)}),/=/):l(e,(function(e,n){if("Region"===e)!function(e){var n=new o;if(l(e,(function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(2!==i.length)break;var r=new o;if(r.percent("x",i[0]),r.percent("y",i[1]),!r.has("x")||!r.has("y"))break;n.set(e+"X",r.get("x")),n.set(e+"Y",r.get("y"));break;case"scroll":n.alt(e,t,["up"])}}),/=/,/\s/),n.has("id")){var i=new(t.vttjs.VTTRegion||t.window.VTTRegion);i.width=n.get("width",100),i.lines=n.get("lines",3),i.regionAnchorX=n.get("regionanchorX",0),i.regionAnchorY=n.get("regionanchorY",100),i.viewportAnchorX=n.get("viewportanchorX",0),i.viewportAnchorY=n.get("viewportanchorY",100),i.scroll=n.get("scroll",""),t.onregion&&t.onregion(i),t.regionList.push({id:n.get("id"),region:i})}}(n)}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var c=(r=n()).match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new s(s.Errors.BadSignature);t.state="HEADER"}for(var d=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(d?d=!1:r=n(),t.state){case"HEADER":/:/.test(r)?i(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");try{t.cue.align="center"}catch(f){t.cue.align="middle"}if(t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{u(r,t.cue,t.regionList)}catch(f){t.reportOrThrowError(f),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var h=-1!==r.indexOf("--\x3e");if(!r||h&&(d=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":r||(t.state="ID");continue}}}catch(f){t.reportOrThrowError(f),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new s(s.Errors.BadSignature)}catch(t){e.reportOrThrowError(t)}return e.onflush&&e.onflush(),this}},e.exports=w},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var i,s={},u=null,c=null;for(i in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:u,ref:c,props:s,_owner:o.current}}t.Fragment=s,t.jsx=u,t.jsxs=u},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var T=b.prototype=new v;T.constructor=b,g(T,y.prototype),T.isPureReactComponent=!0;var S=Array.isArray,_=Object.prototype.hasOwnProperty,w={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,i){var r,s={},a=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)_.call(t,r)&&!E.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:w.current}}function x(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,r,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return a=a(l=e),e=""===s?"."+C(l,0):s,S(a)?(r="",null!=e&&(r=e.replace(A,"$&/")+"/"),I(a,t,r,"",(function(e){return e}))):null!=a&&(x(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(A,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",S(e))for(var u=0;u<e.length;u++){var c=s+C(o=e[u],u);l+=I(o,t,r,c,a)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(o=e.next()).done;)l+=I(o=o.value,t,r,c=s+C(o,u++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function L(e,t,n){if(null==e)return e;var i=[],r=0;return I(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},M={transition:null},P={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:M,ReactCurrentOwner:w};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:L,forEach:function(e,t,n){L(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return L(e,(function(){t++})),t},toArray:function(e){return L(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=r,t.Profiler=a,t.PureComponent=b,t.StrictMode=s,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=O,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=w.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)_.call(t,u)&&!E.hasOwnProperty(u)&&(r[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)r.children=i;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var o=2*(i+1)-1,l=e[o],u=o+1,c=e[u];if(0>s(l,n))u<r&&0>s(c,l)?(e[i]=c,e[u]=n,i=u):(e[i]=l,e[o]=n,i=o);else{if(!(u<r&&0>s(c,n)))break e;e[i]=c,e[u]=n,i=u}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function T(e){for(var t=i(c);null!==t;){if(null===t.callback)r(c);else{if(!(t.startTime<=e))break;r(c),t.sortIndex=t.expirationTime,n(u,t)}t=i(c)}}function S(e){if(m=!1,T(e),!g)if(null!==i(u))g=!0,M(_);else{var t=i(c);null!==t&&P(S,t.startTime-e)}}function _(e,n){g=!1,m&&(m=!1,v(x),x=-1),p=!0;var s=f;try{for(T(n),h=i(u);null!==h&&(!(h.expirationTime>n)||e&&!I());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===i(u)&&r(u),T(n)}else r(u);h=i(u)}if(null!==h)var l=!0;else{var d=i(c);null!==d&&P(S,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,E=!1,k=null,x=-1,A=5,C=-1;function I(){return!(t.unstable_now()-C<A)}function L(){if(null!==k){var e=t.unstable_now();C=e;var n=!0;try{n=k(!0,e)}finally{n?w():(E=!1,k=null)}}else E=!1}if("function"===typeof b)w=function(){b(L)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,R=D.port2;D.port1.onmessage=L,w=function(){R.postMessage(null)}}else w=function(){y(L,0)};function M(e){k=e,E||(E=!0,w())}function P(e,n){x=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,M(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return i(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,r,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(c,e),null===i(u)&&e===i(c)&&(m?(v(x),x=-1):m=!0,P(S,s-a))):(e.sortIndex=o,n(u,e),g||p||(g=!0,M(_))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},248:(e,t,n)=>{"use strict";var i=n(923).freeze;t.XML_ENTITIES=i({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=i({Aacute:"\xc1",aacute:"\xe1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223e",acd:"\u223f",acE:"\u223e\u0333",Acirc:"\xc2",acirc:"\xe2",acute:"\xb4",Acy:"\u0410",acy:"\u0430",AElig:"\xc6",aelig:"\xe6",af:"\u2061",Afr:"\ud835\udd04",afr:"\ud835\udd1e",Agrave:"\xc0",agrave:"\xe0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03b1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2a3f",AMP:"&",amp:"&",And:"\u2a53",and:"\u2227",andand:"\u2a55",andd:"\u2a5c",andslope:"\u2a58",andv:"\u2a5a",ang:"\u2220",ange:"\u29a4",angle:"\u2220",angmsd:"\u2221",angmsdaa:"\u29a8",angmsdab:"\u29a9",angmsdac:"\u29aa",angmsdad:"\u29ab",angmsdae:"\u29ac",angmsdaf:"\u29ad",angmsdag:"\u29ae",angmsdah:"\u29af",angrt:"\u221f",angrtvb:"\u22be",angrtvbd:"\u299d",angsph:"\u2222",angst:"\xc5",angzarr:"\u237c",Aogon:"\u0104",aogon:"\u0105",Aopf:"\ud835\udd38",aopf:"\ud835\udd52",ap:"\u2248",apacir:"\u2a6f",apE:"\u2a70",ape:"\u224a",apid:"\u224b",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224a",Aring:"\xc5",aring:"\xe5",Ascr:"\ud835\udc9c",ascr:"\ud835\udcb6",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224d",Atilde:"\xc3",atilde:"\xe3",Auml:"\xc4",auml:"\xe4",awconint:"\u2233",awint:"\u2a11",backcong:"\u224c",backepsilon:"\u03f6",backprime:"\u2035",backsim:"\u223d",backsimeq:"\u22cd",Backslash:"\u2216",Barv:"\u2ae7",barvee:"\u22bd",Barwed:"\u2306",barwed:"\u2305",barwedge:"\u2305",bbrk:"\u23b5",bbrktbrk:"\u23b6",bcong:"\u224c",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201e",becaus:"\u2235",Because:"\u2235",because:"\u2235",bemptyv:"\u29b0",bepsi:"\u03f6",bernou:"\u212c",Bernoullis:"\u212c",Beta:"\u0392",beta:"\u03b2",beth:"\u2136",between:"\u226c",Bfr:"\ud835\udd05",bfr:"\ud835\udd1f",bigcap:"\u22c2",bigcirc:"\u25ef",bigcup:"\u22c3",bigodot:"\u2a00",bigoplus:"\u2a01",bigotimes:"\u2a02",bigsqcup:"\u2a06",bigstar:"\u2605",bigtriangledown:"\u25bd",bigtriangleup:"\u25b3",biguplus:"\u2a04",bigvee:"\u22c1",bigwedge:"\u22c0",bkarow:"\u290d",blacklozenge:"\u29eb",blacksquare:"\u25aa",blacktriangle:"\u25b4",blacktriangledown:"\u25be",blacktriangleleft:"\u25c2",blacktriangleright:"\u25b8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20e5",bnequiv:"\u2261\u20e5",bNot:"\u2aed",bnot:"\u2310",Bopf:"\ud835\udd39",bopf:"\ud835\udd53",bot:"\u22a5",bottom:"\u22a5",bowtie:"\u22c8",boxbox:"\u29c9",boxDL:"\u2557",boxDl:"\u2556",boxdL:"\u2555",boxdl:"\u2510",boxDR:"\u2554",boxDr:"\u2553",boxdR:"\u2552",boxdr:"\u250c",boxH:"\u2550",boxh:"\u2500",boxHD:"\u2566",boxHd:"\u2564",boxhD:"\u2565",boxhd:"\u252c",boxHU:"\u2569",boxHu:"\u2567",boxhU:"\u2568",boxhu:"\u2534",boxminus:"\u229f",boxplus:"\u229e",boxtimes:"\u22a0",boxUL:"\u255d",boxUl:"\u255c",boxuL:"\u255b",boxul:"\u2518",boxUR:"\u255a",boxUr:"\u2559",boxuR:"\u2558",boxur:"\u2514",boxV:"\u2551",boxv:"\u2502",boxVH:"\u256c",boxVh:"\u256b",boxvH:"\u256a",boxvh:"\u253c",boxVL:"\u2563",boxVl:"\u2562",boxvL:"\u2561",boxvl:"\u2524",boxVR:"\u2560",boxVr:"\u255f",boxvR:"\u255e",boxvr:"\u251c",bprime:"\u2035",Breve:"\u02d8",breve:"\u02d8",brvbar:"\xa6",Bscr:"\u212c",bscr:"\ud835\udcb7",bsemi:"\u204f",bsim:"\u223d",bsime:"\u22cd",bsol:"\\",bsolb:"\u29c5",bsolhsub:"\u27c8",bull:"\u2022",bullet:"\u2022",bump:"\u224e",bumpE:"\u2aae",bumpe:"\u224f",Bumpeq:"\u224e",bumpeq:"\u224f",Cacute:"\u0106",cacute:"\u0107",Cap:"\u22d2",cap:"\u2229",capand:"\u2a44",capbrcup:"\u2a49",capcap:"\u2a4b",capcup:"\u2a47",capdot:"\u2a40",CapitalDifferentialD:"\u2145",caps:"\u2229\ufe00",caret:"\u2041",caron:"\u02c7",Cayleys:"\u212d",ccaps:"\u2a4d",Ccaron:"\u010c",ccaron:"\u010d",Ccedil:"\xc7",ccedil:"\xe7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2a4c",ccupssm:"\u2a50",Cdot:"\u010a",cdot:"\u010b",cedil:"\xb8",Cedilla:"\xb8",cemptyv:"\u29b2",cent:"\xa2",CenterDot:"\xb7",centerdot:"\xb7",Cfr:"\u212d",cfr:"\ud835\udd20",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03a7",chi:"\u03c7",cir:"\u25cb",circ:"\u02c6",circeq:"\u2257",circlearrowleft:"\u21ba",circlearrowright:"\u21bb",circledast:"\u229b",circledcirc:"\u229a",circleddash:"\u229d",CircleDot:"\u2299",circledR:"\xae",circledS:"\u24c8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cirE:"\u29c3",cire:"\u2257",cirfnint:"\u2a10",cirmid:"\u2aef",cirscir:"\u29c2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201d",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",Colon:"\u2237",colon:":",Colone:"\u2a74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2a6d",Congruent:"\u2261",Conint:"\u222f",conint:"\u222e",ContourIntegral:"\u222e",Copf:"\u2102",copf:"\ud835\udd54",coprod:"\u2210",Coproduct:"\u2210",COPY:"\xa9",copy:"\xa9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21b5",Cross:"\u2a2f",cross:"\u2717",Cscr:"\ud835\udc9e",cscr:"\ud835\udcb8",csub:"\u2acf",csube:"\u2ad1",csup:"\u2ad0",csupe:"\u2ad2",ctdot:"\u22ef",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22de",cuesc:"\u22df",cularr:"\u21b6",cularrp:"\u293d",Cup:"\u22d3",cup:"\u222a",cupbrcap:"\u2a48",CupCap:"\u224d",cupcap:"\u2a46",cupcup:"\u2a4a",cupdot:"\u228d",cupor:"\u2a45",cups:"\u222a\ufe00",curarr:"\u21b7",curarrm:"\u293c",curlyeqprec:"\u22de",curlyeqsucc:"\u22df",curlyvee:"\u22ce",curlywedge:"\u22cf",curren:"\xa4",curvearrowleft:"\u21b6",curvearrowright:"\u21b7",cuvee:"\u22ce",cuwed:"\u22cf",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232d",Dagger:"\u2021",dagger:"\u2020",daleth:"\u2138",Darr:"\u21a1",dArr:"\u21d3",darr:"\u2193",dash:"\u2010",Dashv:"\u2ae4",dashv:"\u22a3",dbkarow:"\u290f",dblac:"\u02dd",Dcaron:"\u010e",dcaron:"\u010f",Dcy:"\u0414",dcy:"\u0434",DD:"\u2145",dd:"\u2146",ddagger:"\u2021",ddarr:"\u21ca",DDotrahd:"\u2911",ddotseq:"\u2a77",deg:"\xb0",Del:"\u2207",Delta:"\u0394",delta:"\u03b4",demptyv:"\u29b1",dfisht:"\u297f",Dfr:"\ud835\udd07",dfr:"\ud835\udd21",dHar:"\u2965",dharl:"\u21c3",dharr:"\u21c2",DiacriticalAcute:"\xb4",DiacriticalDot:"\u02d9",DiacriticalDoubleAcute:"\u02dd",DiacriticalGrave:"`",DiacriticalTilde:"\u02dc",diam:"\u22c4",Diamond:"\u22c4",diamond:"\u22c4",diamondsuit:"\u2666",diams:"\u2666",die:"\xa8",DifferentialD:"\u2146",digamma:"\u03dd",disin:"\u22f2",div:"\xf7",divide:"\xf7",divideontimes:"\u22c7",divonx:"\u22c7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231e",dlcrop:"\u230d",dollar:"$",Dopf:"\ud835\udd3b",dopf:"\ud835\udd55",Dot:"\xa8",dot:"\u02d9",DotDot:"\u20dc",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22a1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222f",DoubleDot:"\xa8",DoubleDownArrow:"\u21d3",DoubleLeftArrow:"\u21d0",DoubleLeftRightArrow:"\u21d4",DoubleLeftTee:"\u2ae4",DoubleLongLeftArrow:"\u27f8",DoubleLongLeftRightArrow:"\u27fa",DoubleLongRightArrow:"\u27f9",DoubleRightArrow:"\u21d2",DoubleRightTee:"\u22a8",DoubleUpArrow:"\u21d1",DoubleUpDownArrow:"\u21d5",DoubleVerticalBar:"\u2225",DownArrow:"\u2193",Downarrow:"\u21d3",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21f5",DownBreve:"\u0311",downdownarrows:"\u21ca",downharpoonleft:"\u21c3",downharpoonright:"\u21c2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295e",DownLeftVector:"\u21bd",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295f",DownRightVector:"\u21c1",DownRightVectorBar:"\u2957",DownTee:"\u22a4",DownTeeArrow:"\u21a7",drbkarow:"\u2910",drcorn:"\u231f",drcrop:"\u230c",Dscr:"\ud835\udc9f",dscr:"\ud835\udcb9",DScy:"\u0405",dscy:"\u0455",dsol:"\u29f6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22f1",dtri:"\u25bf",dtrif:"\u25be",duarr:"\u21f5",duhar:"\u296f",dwangle:"\u29a6",DZcy:"\u040f",dzcy:"\u045f",dzigrarr:"\u27ff",Eacute:"\xc9",eacute:"\xe9",easter:"\u2a6e",Ecaron:"\u011a",ecaron:"\u011b",ecir:"\u2256",Ecirc:"\xca",ecirc:"\xea",ecolon:"\u2255",Ecy:"\u042d",ecy:"\u044d",eDDot:"\u2a77",Edot:"\u0116",eDot:"\u2251",edot:"\u0117",ee:"\u2147",efDot:"\u2252",Efr:"\ud835\udd08",efr:"\ud835\udd22",eg:"\u2a9a",Egrave:"\xc8",egrave:"\xe8",egs:"\u2a96",egsdot:"\u2a98",el:"\u2a99",Element:"\u2208",elinters:"\u23e7",ell:"\u2113",els:"\u2a95",elsdot:"\u2a97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25fb",emptyv:"\u2205",EmptyVerySmallSquare:"\u25ab",emsp:"\u2003",emsp13:"\u2004",emsp14:"\u2005",ENG:"\u014a",eng:"\u014b",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\ud835\udd3c",eopf:"\ud835\udd56",epar:"\u22d5",eparsl:"\u29e3",eplus:"\u2a71",epsi:"\u03b5",Epsilon:"\u0395",epsilon:"\u03b5",epsiv:"\u03f5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2a96",eqslantless:"\u2a95",Equal:"\u2a75",equals:"=",EqualTilde:"\u2242",equest:"\u225f",Equilibrium:"\u21cc",equiv:"\u2261",equivDD:"\u2a78",eqvparsl:"\u29e5",erarr:"\u2971",erDot:"\u2253",Escr:"\u2130",escr:"\u212f",esdot:"\u2250",Esim:"\u2a73",esim:"\u2242",Eta:"\u0397",eta:"\u03b7",ETH:"\xd0",eth:"\xf0",Euml:"\xcb",euml:"\xeb",euro:"\u20ac",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",ExponentialE:"\u2147",exponentiale:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\ufb03",fflig:"\ufb00",ffllig:"\ufb04",Ffr:"\ud835\udd09",ffr:"\ud835\udd23",filig:"\ufb01",FilledSmallSquare:"\u25fc",FilledVerySmallSquare:"\u25aa",fjlig:"fj",flat:"\u266d",fllig:"\ufb02",fltns:"\u25b1",fnof:"\u0192",Fopf:"\ud835\udd3d",fopf:"\ud835\udd57",ForAll:"\u2200",forall:"\u2200",fork:"\u22d4",forkv:"\u2ad9",Fouriertrf:"\u2131",fpartint:"\u2a0d",frac12:"\xbd",frac13:"\u2153",frac14:"\xbc",frac15:"\u2155",frac16:"\u2159",frac18:"\u215b",frac23:"\u2154",frac25:"\u2156",frac34:"\xbe",frac35:"\u2157",frac38:"\u215c",frac45:"\u2158",frac56:"\u215a",frac58:"\u215d",frac78:"\u215e",frasl:"\u2044",frown:"\u2322",Fscr:"\u2131",fscr:"\ud835\udcbb",gacute:"\u01f5",Gamma:"\u0393",gamma:"\u03b3",Gammad:"\u03dc",gammad:"\u03dd",gap:"\u2a86",Gbreve:"\u011e",gbreve:"\u011f",Gcedil:"\u0122",Gcirc:"\u011c",gcirc:"\u011d",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",gE:"\u2267",ge:"\u2265",gEl:"\u2a8c",gel:"\u22db",geq:"\u2265",geqq:"\u2267",geqslant:"\u2a7e",ges:"\u2a7e",gescc:"\u2aa9",gesdot:"\u2a80",gesdoto:"\u2a82",gesdotol:"\u2a84",gesl:"\u22db\ufe00",gesles:"\u2a94",Gfr:"\ud835\udd0a",gfr:"\ud835\udd24",Gg:"\u22d9",gg:"\u226b",ggg:"\u22d9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gl:"\u2277",gla:"\u2aa5",glE:"\u2a92",glj:"\u2aa4",gnap:"\u2a8a",gnapprox:"\u2a8a",gnE:"\u2269",gne:"\u2a88",gneq:"\u2a88",gneqq:"\u2269",gnsim:"\u22e7",Gopf:"\ud835\udd3e",gopf:"\ud835\udd58",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22db",GreaterFullEqual:"\u2267",GreaterGreater:"\u2aa2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2a7e",GreaterTilde:"\u2273",Gscr:"\ud835\udca2",gscr:"\u210a",gsim:"\u2273",gsime:"\u2a8e",gsiml:"\u2a90",Gt:"\u226b",GT:">",gt:">",gtcc:"\u2aa7",gtcir:"\u2a7a",gtdot:"\u22d7",gtlPar:"\u2995",gtquest:"\u2a7c",gtrapprox:"\u2a86",gtrarr:"\u2978",gtrdot:"\u22d7",gtreqless:"\u22db",gtreqqless:"\u2a8c",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\ufe00",gvnE:"\u2269\ufe00",Hacek:"\u02c7",hairsp:"\u200a",half:"\xbd",hamilt:"\u210b",HARDcy:"\u042a",hardcy:"\u044a",hArr:"\u21d4",harr:"\u2194",harrcir:"\u2948",harrw:"\u21ad",Hat:"^",hbar:"\u210f",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22b9",Hfr:"\u210c",hfr:"\ud835\udd25",HilbertSpace:"\u210b",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21ff",homtht:"\u223b",hookleftarrow:"\u21a9",hookrightarrow:"\u21aa",Hopf:"\u210d",hopf:"\ud835\udd59",horbar:"\u2015",HorizontalLine:"\u2500",Hscr:"\u210b",hscr:"\ud835\udcbd",hslash:"\u210f",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224e",HumpEqual:"\u224f",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xcd",iacute:"\xed",ic:"\u2063",Icirc:"\xce",icirc:"\xee",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xa1",iff:"\u21d4",Ifr:"\u2111",ifr:"\ud835\udd26",Igrave:"\xcc",igrave:"\xec",ii:"\u2148",iiiint:"\u2a0c",iiint:"\u222d",iinfin:"\u29dc",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Im:"\u2111",Imacr:"\u012a",imacr:"\u012b",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",imof:"\u22b7",imped:"\u01b5",Implies:"\u21d2",in:"\u2208",incare:"\u2105",infin:"\u221e",infintie:"\u29dd",inodot:"\u0131",Int:"\u222c",int:"\u222b",intcal:"\u22ba",integers:"\u2124",Integral:"\u222b",intercal:"\u22ba",Intersection:"\u22c2",intlarhk:"\u2a17",intprod:"\u2a3c",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012e",iogon:"\u012f",Iopf:"\ud835\udd40",iopf:"\ud835\udd5a",Iota:"\u0399",iota:"\u03b9",iprod:"\u2a3c",iquest:"\xbf",Iscr:"\u2110",iscr:"\ud835\udcbe",isin:"\u2208",isindot:"\u22f5",isinE:"\u22f9",isins:"\u22f4",isinsv:"\u22f3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xcf",iuml:"\xef",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\ud835\udd0d",jfr:"\ud835\udd27",jmath:"\u0237",Jopf:"\ud835\udd41",jopf:"\ud835\udd5b",Jscr:"\ud835\udca5",jscr:"\ud835\udcbf",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039a",kappa:"\u03ba",kappav:"\u03f0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041a",kcy:"\u043a",Kfr:"\ud835\udd0e",kfr:"\ud835\udd28",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040c",kjcy:"\u045c",Kopf:"\ud835\udd42",kopf:"\ud835\udd5c",Kscr:"\ud835\udca6",kscr:"\ud835\udcc0",lAarr:"\u21da",Lacute:"\u0139",lacute:"\u013a",laemptyv:"\u29b4",lagran:"\u2112",Lambda:"\u039b",lambda:"\u03bb",Lang:"\u27ea",lang:"\u27e8",langd:"\u2991",langle:"\u27e8",lap:"\u2a85",Laplacetrf:"\u2112",laquo:"\xab",Larr:"\u219e",lArr:"\u21d0",larr:"\u2190",larrb:"\u21e4",larrbfs:"\u291f",larrfs:"\u291d",larrhk:"\u21a9",larrlp:"\u21ab",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21a2",lat:"\u2aab",lAtail:"\u291b",latail:"\u2919",late:"\u2aad",lates:"\u2aad\ufe00",lBarr:"\u290e",lbarr:"\u290c",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298b",lbrksld:"\u298f",lbrkslu:"\u298d",Lcaron:"\u013d",lcaron:"\u013e",Lcedil:"\u013b",lcedil:"\u013c",lceil:"\u2308",lcub:"{",Lcy:"\u041b",lcy:"\u043b",ldca:"\u2936",ldquo:"\u201c",ldquor:"\u201e",ldrdhar:"\u2967",ldrushar:"\u294b",ldsh:"\u21b2",lE:"\u2266",le:"\u2264",LeftAngleBracket:"\u27e8",LeftArrow:"\u2190",Leftarrow:"\u21d0",leftarrow:"\u2190",LeftArrowBar:"\u21e4",LeftArrowRightArrow:"\u21c6",leftarrowtail:"\u21a2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27e6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21c3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230a",leftharpoondown:"\u21bd",leftharpoonup:"\u21bc",leftleftarrows:"\u21c7",LeftRightArrow:"\u2194",Leftrightarrow:"\u21d4",leftrightarrow:"\u2194",leftrightarrows:"\u21c6",leftrightharpoons:"\u21cb",leftrightsquigarrow:"\u21ad",LeftRightVector:"\u294e",LeftTee:"\u22a3",LeftTeeArrow:"\u21a4",LeftTeeVector:"\u295a",leftthreetimes:"\u22cb",LeftTriangle:"\u22b2",LeftTriangleBar:"\u29cf",LeftTriangleEqual:"\u22b4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21bf",LeftUpVectorBar:"\u2958",LeftVector:"\u21bc",LeftVectorBar:"\u2952",lEg:"\u2a8b",leg:"\u22da",leq:"\u2264",leqq:"\u2266",leqslant:"\u2a7d",les:"\u2a7d",lescc:"\u2aa8",lesdot:"\u2a7f",lesdoto:"\u2a81",lesdotor:"\u2a83",lesg:"\u22da\ufe00",lesges:"\u2a93",lessapprox:"\u2a85",lessdot:"\u22d6",lesseqgtr:"\u22da",lesseqqgtr:"\u2a8b",LessEqualGreater:"\u22da",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2aa1",lesssim:"\u2272",LessSlantEqual:"\u2a7d",LessTilde:"\u2272",lfisht:"\u297c",lfloor:"\u230a",Lfr:"\ud835\udd0f",lfr:"\ud835\udd29",lg:"\u2276",lgE:"\u2a91",lHar:"\u2962",lhard:"\u21bd",lharu:"\u21bc",lharul:"\u296a",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",Ll:"\u22d8",ll:"\u226a",llarr:"\u21c7",llcorner:"\u231e",Lleftarrow:"\u21da",llhard:"\u296b",lltri:"\u25fa",Lmidot:"\u013f",lmidot:"\u0140",lmoust:"\u23b0",lmoustache:"\u23b0",lnap:"\u2a89",lnapprox:"\u2a89",lnE:"\u2268",lne:"\u2a87",lneq:"\u2a87",lneqq:"\u2268",lnsim:"\u22e6",loang:"\u27ec",loarr:"\u21fd",lobrk:"\u27e6",LongLeftArrow:"\u27f5",Longleftarrow:"\u27f8",longleftarrow:"\u27f5",LongLeftRightArrow:"\u27f7",Longleftrightarrow:"\u27fa",longleftrightarrow:"\u27f7",longmapsto:"\u27fc",LongRightArrow:"\u27f6",Longrightarrow:"\u27f9",longrightarrow:"\u27f6",looparrowleft:"\u21ab",looparrowright:"\u21ac",lopar:"\u2985",Lopf:"\ud835\udd43",lopf:"\ud835\udd5d",loplus:"\u2a2d",lotimes:"\u2a34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25ca",lozenge:"\u25ca",lozf:"\u29eb",lpar:"(",lparlt:"\u2993",lrarr:"\u21c6",lrcorner:"\u231f",lrhar:"\u21cb",lrhard:"\u296d",lrm:"\u200e",lrtri:"\u22bf",lsaquo:"\u2039",Lscr:"\u2112",lscr:"\ud835\udcc1",Lsh:"\u21b0",lsh:"\u21b0",lsim:"\u2272",lsime:"\u2a8d",lsimg:"\u2a8f",lsqb:"[",lsquo:"\u2018",lsquor:"\u201a",Lstrok:"\u0141",lstrok:"\u0142",Lt:"\u226a",LT:"<",lt:"<",ltcc:"\u2aa6",ltcir:"\u2a79",ltdot:"\u22d6",lthree:"\u22cb",ltimes:"\u22c9",ltlarr:"\u2976",ltquest:"\u2a7b",ltri:"\u25c3",ltrie:"\u22b4",ltrif:"\u25c2",ltrPar:"\u2996",lurdshar:"\u294a",luruhar:"\u2966",lvertneqq:"\u2268\ufe00",lvnE:"\u2268\ufe00",macr:"\xaf",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21a6",mapsto:"\u21a6",mapstodown:"\u21a7",mapstoleft:"\u21a4",mapstoup:"\u21a5",marker:"\u25ae",mcomma:"\u2a29",Mcy:"\u041c",mcy:"\u043c",mdash:"\u2014",mDDot:"\u223a",measuredangle:"\u2221",MediumSpace:"\u205f",Mellintrf:"\u2133",Mfr:"\ud835\udd10",mfr:"\ud835\udd2a",mho:"\u2127",micro:"\xb5",mid:"\u2223",midast:"*",midcir:"\u2af0",middot:"\xb7",minus:"\u2212",minusb:"\u229f",minusd:"\u2238",minusdu:"\u2a2a",MinusPlus:"\u2213",mlcp:"\u2adb",mldr:"\u2026",mnplus:"\u2213",models:"\u22a7",Mopf:"\ud835\udd44",mopf:"\ud835\udd5e",mp:"\u2213",Mscr:"\u2133",mscr:"\ud835\udcc2",mstpos:"\u223e",Mu:"\u039c",mu:"\u03bc",multimap:"\u22b8",mumap:"\u22b8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20d2",nap:"\u2249",napE:"\u2a70\u0338",napid:"\u224b\u0338",napos:"\u0149",napprox:"\u2249",natur:"\u266e",natural:"\u266e",naturals:"\u2115",nbsp:"\xa0",nbump:"\u224e\u0338",nbumpe:"\u224f\u0338",ncap:"\u2a43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2a6d\u0338",ncup:"\u2a42",Ncy:"\u041d",ncy:"\u043d",ndash:"\u2013",ne:"\u2260",nearhk:"\u2924",neArr:"\u21d7",nearr:"\u2197",nearrow:"\u2197",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200b",NegativeThickSpace:"\u200b",NegativeThinSpace:"\u200b",NegativeVeryThinSpace:"\u200b",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226b",NestedLessLess:"\u226a",NewLine:"\n",nexist:"\u2204",nexists:"\u2204",Nfr:"\ud835\udd11",nfr:"\ud835\udd2b",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2a7e\u0338",nges:"\u2a7e\u0338",nGg:"\u22d9\u0338",ngsim:"\u2275",nGt:"\u226b\u20d2",ngt:"\u226f",ngtr:"\u226f",nGtv:"\u226b\u0338",nhArr:"\u21ce",nharr:"\u21ae",nhpar:"\u2af2",ni:"\u220b",nis:"\u22fc",nisd:"\u22fa",niv:"\u220b",NJcy:"\u040a",njcy:"\u045a",nlArr:"\u21cd",nlarr:"\u219a",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nLeftarrow:"\u21cd",nleftarrow:"\u219a",nLeftrightarrow:"\u21ce",nleftrightarrow:"\u21ae",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2a7d\u0338",nles:"\u2a7d\u0338",nless:"\u226e",nLl:"\u22d8\u0338",nlsim:"\u2274",nLt:"\u226a\u20d2",nlt:"\u226e",nltri:"\u22ea",nltrie:"\u22ec",nLtv:"\u226a\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xa0",Nopf:"\u2115",nopf:"\ud835\udd5f",Not:"\u2aec",not:"\xac",NotCongruent:"\u2262",NotCupCap:"\u226d",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226f",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226b\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2a7e\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224e\u0338",NotHumpEqual:"\u224f\u0338",notin:"\u2209",notindot:"\u22f5\u0338",notinE:"\u22f9\u0338",notinva:"\u2209",notinvb:"\u22f7",notinvc:"\u22f6",NotLeftTriangle:"\u22ea",NotLeftTriangleBar:"\u29cf\u0338",NotLeftTriangleEqual:"\u22ec",NotLess:"\u226e",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226a\u0338",NotLessSlantEqual:"\u2a7d\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2aa2\u0338",NotNestedLessLess:"\u2aa1\u0338",notni:"\u220c",notniva:"\u220c",notnivb:"\u22fe",notnivc:"\u22fd",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2aaf\u0338",NotPrecedesSlantEqual:"\u22e0",NotReverseElement:"\u220c",NotRightTriangle:"\u22eb",NotRightTriangleBar:"\u29d0\u0338",NotRightTriangleEqual:"\u22ed",NotSquareSubset:"\u228f\u0338",NotSquareSubsetEqual:"\u22e2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22e3",NotSubset:"\u2282\u20d2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2ab0\u0338",NotSucceedsSlantEqual:"\u22e1",NotSucceedsTilde:"\u227f\u0338",NotSuperset:"\u2283\u20d2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",npar:"\u2226",nparallel:"\u2226",nparsl:"\u2afd\u20e5",npart:"\u2202\u0338",npolint:"\u2a14",npr:"\u2280",nprcue:"\u22e0",npre:"\u2aaf\u0338",nprec:"\u2280",npreceq:"\u2aaf\u0338",nrArr:"\u21cf",nrarr:"\u219b",nrarrc:"\u2933\u0338",nrarrw:"\u219d\u0338",nRightarrow:"\u21cf",nrightarrow:"\u219b",nrtri:"\u22eb",nrtrie:"\u22ed",nsc:"\u2281",nsccue:"\u22e1",nsce:"\u2ab0\u0338",Nscr:"\ud835\udca9",nscr:"\ud835\udcc3",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22e2",nsqsupe:"\u22e3",nsub:"\u2284",nsubE:"\u2ac5\u0338",nsube:"\u2288",nsubset:"\u2282\u20d2",nsubseteq:"\u2288",nsubseteqq:"\u2ac5\u0338",nsucc:"\u2281",nsucceq:"\u2ab0\u0338",nsup:"\u2285",nsupE:"\u2ac6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20d2",nsupseteq:"\u2289",nsupseteqq:"\u2ac6\u0338",ntgl:"\u2279",Ntilde:"\xd1",ntilde:"\xf1",ntlg:"\u2278",ntriangleleft:"\u22ea",ntrianglelefteq:"\u22ec",ntriangleright:"\u22eb",ntrianglerighteq:"\u22ed",Nu:"\u039d",nu:"\u03bd",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224d\u20d2",nVDash:"\u22af",nVdash:"\u22ae",nvDash:"\u22ad",nvdash:"\u22ac",nvge:"\u2265\u20d2",nvgt:">\u20d2",nvHarr:"\u2904",nvinfin:"\u29de",nvlArr:"\u2902",nvle:"\u2264\u20d2",nvlt:"<\u20d2",nvltrie:"\u22b4\u20d2",nvrArr:"\u2903",nvrtrie:"\u22b5\u20d2",nvsim:"\u223c\u20d2",nwarhk:"\u2923",nwArr:"\u21d6",nwarr:"\u2196",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xd3",oacute:"\xf3",oast:"\u229b",ocir:"\u229a",Ocirc:"\xd4",ocirc:"\xf4",Ocy:"\u041e",ocy:"\u043e",odash:"\u229d",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2a38",odot:"\u2299",odsold:"\u29bc",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29bf",Ofr:"\ud835\udd12",ofr:"\ud835\udd2c",ogon:"\u02db",Ograve:"\xd2",ograve:"\xf2",ogt:"\u29c1",ohbar:"\u29b5",ohm:"\u03a9",oint:"\u222e",olarr:"\u21ba",olcir:"\u29be",olcross:"\u29bb",oline:"\u203e",olt:"\u29c0",Omacr:"\u014c",omacr:"\u014d",Omega:"\u03a9",omega:"\u03c9",Omicron:"\u039f",omicron:"\u03bf",omid:"\u29b6",ominus:"\u2296",Oopf:"\ud835\udd46",oopf:"\ud835\udd60",opar:"\u29b7",OpenCurlyDoubleQuote:"\u201c",OpenCurlyQuote:"\u2018",operp:"\u29b9",oplus:"\u2295",Or:"\u2a54",or:"\u2228",orarr:"\u21bb",ord:"\u2a5d",order:"\u2134",orderof:"\u2134",ordf:"\xaa",ordm:"\xba",origof:"\u22b6",oror:"\u2a56",orslope:"\u2a57",orv:"\u2a5b",oS:"\u24c8",Oscr:"\ud835\udcaa",oscr:"\u2134",Oslash:"\xd8",oslash:"\xf8",osol:"\u2298",Otilde:"\xd5",otilde:"\xf5",Otimes:"\u2a37",otimes:"\u2297",otimesas:"\u2a36",Ouml:"\xd6",ouml:"\xf6",ovbar:"\u233d",OverBar:"\u203e",OverBrace:"\u23de",OverBracket:"\u23b4",OverParenthesis:"\u23dc",par:"\u2225",para:"\xb6",parallel:"\u2225",parsim:"\u2af3",parsl:"\u2afd",part:"\u2202",PartialD:"\u2202",Pcy:"\u041f",pcy:"\u043f",percnt:"%",period:".",permil:"\u2030",perp:"\u22a5",pertenk:"\u2031",Pfr:"\ud835\udd13",pfr:"\ud835\udd2d",Phi:"\u03a6",phi:"\u03c6",phiv:"\u03d5",phmmat:"\u2133",phone:"\u260e",Pi:"\u03a0",pi:"\u03c0",pitchfork:"\u22d4",piv:"\u03d6",planck:"\u210f",planckh:"\u210e",plankv:"\u210f",plus:"+",plusacir:"\u2a23",plusb:"\u229e",pluscir:"\u2a22",plusdo:"\u2214",plusdu:"\u2a25",pluse:"\u2a72",PlusMinus:"\xb1",plusmn:"\xb1",plussim:"\u2a26",plustwo:"\u2a27",pm:"\xb1",Poincareplane:"\u210c",pointint:"\u2a15",Popf:"\u2119",popf:"\ud835\udd61",pound:"\xa3",Pr:"\u2abb",pr:"\u227a",prap:"\u2ab7",prcue:"\u227c",prE:"\u2ab3",pre:"\u2aaf",prec:"\u227a",precapprox:"\u2ab7",preccurlyeq:"\u227c",Precedes:"\u227a",PrecedesEqual:"\u2aaf",PrecedesSlantEqual:"\u227c",PrecedesTilde:"\u227e",preceq:"\u2aaf",precnapprox:"\u2ab9",precneqq:"\u2ab5",precnsim:"\u22e8",precsim:"\u227e",Prime:"\u2033",prime:"\u2032",primes:"\u2119",prnap:"\u2ab9",prnE:"\u2ab5",prnsim:"\u22e8",prod:"\u220f",Product:"\u220f",profalar:"\u232e",profline:"\u2312",profsurf:"\u2313",prop:"\u221d",Proportion:"\u2237",Proportional:"\u221d",propto:"\u221d",prsim:"\u227e",prurel:"\u22b0",Pscr:"\ud835\udcab",pscr:"\ud835\udcc5",Psi:"\u03a8",psi:"\u03c8",puncsp:"\u2008",Qfr:"\ud835\udd14",qfr:"\ud835\udd2e",qint:"\u2a0c",Qopf:"\u211a",qopf:"\ud835\udd62",qprime:"\u2057",Qscr:"\ud835\udcac",qscr:"\ud835\udcc6",quaternions:"\u210d",quatint:"\u2a16",quest:"?",questeq:"\u225f",QUOT:'"',quot:'"',rAarr:"\u21db",race:"\u223d\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221a",raemptyv:"\u29b3",Rang:"\u27eb",rang:"\u27e9",rangd:"\u2992",range:"\u29a5",rangle:"\u27e9",raquo:"\xbb",Rarr:"\u21a0",rArr:"\u21d2",rarr:"\u2192",rarrap:"\u2975",rarrb:"\u21e5",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291e",rarrhk:"\u21aa",rarrlp:"\u21ac",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21a3",rarrw:"\u219d",rAtail:"\u291c",ratail:"\u291a",ratio:"\u2236",rationals:"\u211a",RBarr:"\u2910",rBarr:"\u290f",rbarr:"\u290d",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298c",rbrksld:"\u298e",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201d",rdquor:"\u201d",rdsh:"\u21b3",Re:"\u211c",real:"\u211c",realine:"\u211b",realpart:"\u211c",reals:"\u211d",rect:"\u25ad",REG:"\xae",reg:"\xae",ReverseElement:"\u220b",ReverseEquilibrium:"\u21cb",ReverseUpEquilibrium:"\u296f",rfisht:"\u297d",rfloor:"\u230b",Rfr:"\u211c",rfr:"\ud835\udd2f",rHar:"\u2964",rhard:"\u21c1",rharu:"\u21c0",rharul:"\u296c",Rho:"\u03a1",rho:"\u03c1",rhov:"\u03f1",RightAngleBracket:"\u27e9",RightArrow:"\u2192",Rightarrow:"\u21d2",rightarrow:"\u2192",RightArrowBar:"\u21e5",RightArrowLeftArrow:"\u21c4",rightarrowtail:"\u21a3",RightCeiling:"\u2309",RightDoubleBracket:"\u27e7",RightDownTeeVector:"\u295d",RightDownVector:"\u21c2",RightDownVectorBar:"\u2955",RightFloor:"\u230b",rightharpoondown:"\u21c1",rightharpoonup:"\u21c0",rightleftarrows:"\u21c4",rightleftharpoons:"\u21cc",rightrightarrows:"\u21c9",rightsquigarrow:"\u219d",RightTee:"\u22a2",RightTeeArrow:"\u21a6",RightTeeVector:"\u295b",rightthreetimes:"\u22cc",RightTriangle:"\u22b3",RightTriangleBar:"\u29d0",RightTriangleEqual:"\u22b5",RightUpDownVector:"\u294f",RightUpTeeVector:"\u295c",RightUpVector:"\u21be",RightUpVectorBar:"\u2954",RightVector:"\u21c0",RightVectorBar:"\u2953",ring:"\u02da",risingdotseq:"\u2253",rlarr:"\u21c4",rlhar:"\u21cc",rlm:"\u200f",rmoust:"\u23b1",rmoustache:"\u23b1",rnmid:"\u2aee",roang:"\u27ed",roarr:"\u21fe",robrk:"\u27e7",ropar:"\u2986",Ropf:"\u211d",ropf:"\ud835\udd63",roplus:"\u2a2e",rotimes:"\u2a35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2a12",rrarr:"\u21c9",Rrightarrow:"\u21db",rsaquo:"\u203a",Rscr:"\u211b",rscr:"\ud835\udcc7",Rsh:"\u21b1",rsh:"\u21b1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22cc",rtimes:"\u22ca",rtri:"\u25b9",rtrie:"\u22b5",rtrif:"\u25b8",rtriltri:"\u29ce",RuleDelayed:"\u29f4",ruluhar:"\u2968",rx:"\u211e",Sacute:"\u015a",sacute:"\u015b",sbquo:"\u201a",Sc:"\u2abc",sc:"\u227b",scap:"\u2ab8",Scaron:"\u0160",scaron:"\u0161",sccue:"\u227d",scE:"\u2ab4",sce:"\u2ab0",Scedil:"\u015e",scedil:"\u015f",Scirc:"\u015c",scirc:"\u015d",scnap:"\u2aba",scnE:"\u2ab6",scnsim:"\u22e9",scpolint:"\u2a13",scsim:"\u227f",Scy:"\u0421",scy:"\u0441",sdot:"\u22c5",sdotb:"\u22a1",sdote:"\u2a66",searhk:"\u2925",seArr:"\u21d8",searr:"\u2198",searrow:"\u2198",sect:"\xa7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\ud835\udd16",sfr:"\ud835\udd30",sfrown:"\u2322",sharp:"\u266f",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xad",Sigma:"\u03a3",sigma:"\u03c3",sigmaf:"\u03c2",sigmav:"\u03c2",sim:"\u223c",simdot:"\u2a6a",sime:"\u2243",simeq:"\u2243",simg:"\u2a9e",simgE:"\u2aa0",siml:"\u2a9d",simlE:"\u2a9f",simne:"\u2246",simplus:"\u2a24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2a33",smeparsl:"\u29e4",smid:"\u2223",smile:"\u2323",smt:"\u2aaa",smte:"\u2aac",smtes:"\u2aac\ufe00",SOFTcy:"\u042c",softcy:"\u044c",sol:"/",solb:"\u29c4",solbar:"\u233f",Sopf:"\ud835\udd4a",sopf:"\ud835\udd64",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\ufe00",sqcup:"\u2294",sqcups:"\u2294\ufe00",Sqrt:"\u221a",sqsub:"\u228f",sqsube:"\u2291",sqsubset:"\u228f",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",squ:"\u25a1",Square:"\u25a1",square:"\u25a1",SquareIntersection:"\u2293",SquareSubset:"\u228f",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25aa",squf:"\u25aa",srarr:"\u2192",Sscr:"\ud835\udcae",sscr:"\ud835\udcc8",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22c6",Star:"\u22c6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03f5",straightphi:"\u03d5",strns:"\xaf",Sub:"\u22d0",sub:"\u2282",subdot:"\u2abd",subE:"\u2ac5",sube:"\u2286",subedot:"\u2ac3",submult:"\u2ac1",subnE:"\u2acb",subne:"\u228a",subplus:"\u2abf",subrarr:"\u2979",Subset:"\u22d0",subset:"\u2282",subseteq:"\u2286",subseteqq:"\u2ac5",SubsetEqual:"\u2286",subsetneq:"\u228a",subsetneqq:"\u2acb",subsim:"\u2ac7",subsub:"\u2ad5",subsup:"\u2ad3",succ:"\u227b",succapprox:"\u2ab8",succcurlyeq:"\u227d",Succeeds:"\u227b",SucceedsEqual:"\u2ab0",SucceedsSlantEqual:"\u227d",SucceedsTilde:"\u227f",succeq:"\u2ab0",succnapprox:"\u2aba",succneqq:"\u2ab6",succnsim:"\u22e9",succsim:"\u227f",SuchThat:"\u220b",Sum:"\u2211",sum:"\u2211",sung:"\u266a",Sup:"\u22d1",sup:"\u2283",sup1:"\xb9",sup2:"\xb2",sup3:"\xb3",supdot:"\u2abe",supdsub:"\u2ad8",supE:"\u2ac6",supe:"\u2287",supedot:"\u2ac4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27c9",suphsub:"\u2ad7",suplarr:"\u297b",supmult:"\u2ac2",supnE:"\u2acc",supne:"\u228b",supplus:"\u2ac0",Supset:"\u22d1",supset:"\u2283",supseteq:"\u2287",supseteqq:"\u2ac6",supsetneq:"\u228b",supsetneqq:"\u2acc",supsim:"\u2ac8",supsub:"\u2ad4",supsup:"\u2ad6",swarhk:"\u2926",swArr:"\u21d9",swarr:"\u2199",swarrow:"\u2199",swnwar:"\u292a",szlig:"\xdf",Tab:"\t",target:"\u2316",Tau:"\u03a4",tau:"\u03c4",tbrk:"\u23b4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20db",telrec:"\u2315",Tfr:"\ud835\udd17",tfr:"\ud835\udd31",there4:"\u2234",Therefore:"\u2234",therefore:"\u2234",Theta:"\u0398",theta:"\u03b8",thetasym:"\u03d1",thetav:"\u03d1",thickapprox:"\u2248",thicksim:"\u223c",ThickSpace:"\u205f\u200a",thinsp:"\u2009",ThinSpace:"\u2009",thkap:"\u2248",thksim:"\u223c",THORN:"\xde",thorn:"\xfe",Tilde:"\u223c",tilde:"\u02dc",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",times:"\xd7",timesb:"\u22a0",timesbar:"\u2a31",timesd:"\u2a30",tint:"\u222d",toea:"\u2928",top:"\u22a4",topbot:"\u2336",topcir:"\u2af1",Topf:"\ud835\udd4b",topf:"\ud835\udd65",topfork:"\u2ada",tosa:"\u2929",tprime:"\u2034",TRADE:"\u2122",trade:"\u2122",triangle:"\u25b5",triangledown:"\u25bf",triangleleft:"\u25c3",trianglelefteq:"\u22b4",triangleq:"\u225c",triangleright:"\u25b9",trianglerighteq:"\u22b5",tridot:"\u25ec",trie:"\u225c",triminus:"\u2a3a",TripleDot:"\u20db",triplus:"\u2a39",trisb:"\u29cd",tritime:"\u2a3b",trpezium:"\u23e2",Tscr:"\ud835\udcaf",tscr:"\ud835\udcc9",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040b",tshcy:"\u045b",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226c",twoheadleftarrow:"\u219e",twoheadrightarrow:"\u21a0",Uacute:"\xda",uacute:"\xfa",Uarr:"\u219f",uArr:"\u21d1",uarr:"\u2191",Uarrocir:"\u2949",Ubrcy:"\u040e",ubrcy:"\u045e",Ubreve:"\u016c",ubreve:"\u016d",Ucirc:"\xdb",ucirc:"\xfb",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21c5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296e",ufisht:"\u297e",Ufr:"\ud835\udd18",ufr:"\ud835\udd32",Ugrave:"\xd9",ugrave:"\xf9",uHar:"\u2963",uharl:"\u21bf",uharr:"\u21be",uhblk:"\u2580",ulcorn:"\u231c",ulcorner:"\u231c",ulcrop:"\u230f",ultri:"\u25f8",Umacr:"\u016a",umacr:"\u016b",uml:"\xa8",UnderBar:"_",UnderBrace:"\u23df",UnderBracket:"\u23b5",UnderParenthesis:"\u23dd",Union:"\u22c3",UnionPlus:"\u228e",Uogon:"\u0172",uogon:"\u0173",Uopf:"\ud835\udd4c",uopf:"\ud835\udd66",UpArrow:"\u2191",Uparrow:"\u21d1",uparrow:"\u2191",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21c5",UpDownArrow:"\u2195",Updownarrow:"\u21d5",updownarrow:"\u2195",UpEquilibrium:"\u296e",upharpoonleft:"\u21bf",upharpoonright:"\u21be",uplus:"\u228e",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",Upsi:"\u03d2",upsi:"\u03c5",upsih:"\u03d2",Upsilon:"\u03a5",upsilon:"\u03c5",UpTee:"\u22a5",UpTeeArrow:"\u21a5",upuparrows:"\u21c8",urcorn:"\u231d",urcorner:"\u231d",urcrop:"\u230e",Uring:"\u016e",uring:"\u016f",urtri:"\u25f9",Uscr:"\ud835\udcb0",uscr:"\ud835\udcca",utdot:"\u22f0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25b5",utrif:"\u25b4",uuarr:"\u21c8",Uuml:"\xdc",uuml:"\xfc",uwangle:"\u29a7",vangrt:"\u299c",varepsilon:"\u03f5",varkappa:"\u03f0",varnothing:"\u2205",varphi:"\u03d5",varpi:"\u03d6",varpropto:"\u221d",vArr:"\u21d5",varr:"\u2195",varrho:"\u03f1",varsigma:"\u03c2",varsubsetneq:"\u228a\ufe00",varsubsetneqq:"\u2acb\ufe00",varsupsetneq:"\u228b\ufe00",varsupsetneqq:"\u2acc\ufe00",vartheta:"\u03d1",vartriangleleft:"\u22b2",vartriangleright:"\u22b3",Vbar:"\u2aeb",vBar:"\u2ae8",vBarv:"\u2ae9",Vcy:"\u0412",vcy:"\u0432",VDash:"\u22ab",Vdash:"\u22a9",vDash:"\u22a8",vdash:"\u22a2",Vdashl:"\u2ae6",Vee:"\u22c1",vee:"\u2228",veebar:"\u22bb",veeeq:"\u225a",vellip:"\u22ee",Verbar:"\u2016",verbar:"|",Vert:"\u2016",vert:"|",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200a",Vfr:"\ud835\udd19",vfr:"\ud835\udd33",vltri:"\u22b2",vnsub:"\u2282\u20d2",vnsup:"\u2283\u20d2",Vopf:"\ud835\udd4d",vopf:"\ud835\udd67",vprop:"\u221d",vrtri:"\u22b3",Vscr:"\ud835\udcb1",vscr:"\ud835\udccb",vsubnE:"\u2acb\ufe00",vsubne:"\u228a\ufe00",vsupnE:"\u2acc\ufe00",vsupne:"\u228b\ufe00",Vvdash:"\u22aa",vzigzag:"\u299a",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2a5f",Wedge:"\u22c0",wedge:"\u2227",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\ud835\udd1a",wfr:"\ud835\udd34",Wopf:"\ud835\udd4e",wopf:"\ud835\udd68",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\ud835\udcb2",wscr:"\ud835\udccc",xcap:"\u22c2",xcirc:"\u25ef",xcup:"\u22c3",xdtri:"\u25bd",Xfr:"\ud835\udd1b",xfr:"\ud835\udd35",xhArr:"\u27fa",xharr:"\u27f7",Xi:"\u039e",xi:"\u03be",xlArr:"\u27f8",xlarr:"\u27f5",xmap:"\u27fc",xnis:"\u22fb",xodot:"\u2a00",Xopf:"\ud835\udd4f",xopf:"\ud835\udd69",xoplus:"\u2a01",xotime:"\u2a02",xrArr:"\u27f9",xrarr:"\u27f6",Xscr:"\ud835\udcb3",xscr:"\ud835\udccd",xsqcup:"\u2a06",xuplus:"\u2a04",xutri:"\u25b3",xvee:"\u22c1",xwedge:"\u22c0",Yacute:"\xdd",yacute:"\xfd",YAcy:"\u042f",yacy:"\u044f",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042b",ycy:"\u044b",yen:"\xa5",Yfr:"\ud835\udd1c",yfr:"\ud835\udd36",YIcy:"\u0407",yicy:"\u0457",Yopf:"\ud835\udd50",yopf:"\ud835\udd6a",Yscr:"\ud835\udcb4",yscr:"\ud835\udcce",YUcy:"\u042e",yucy:"\u044e",Yuml:"\u0178",yuml:"\xff",Zacute:"\u0179",zacute:"\u017a",Zcaron:"\u017d",zcaron:"\u017e",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017b",zdot:"\u017c",zeetrf:"\u2128",ZeroWidthSpace:"\u200b",Zeta:"\u0396",zeta:"\u03b6",Zfr:"\u2128",zfr:"\ud835\udd37",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21dd",Zopf:"\u2124",zopf:"\ud835\udd6b",Zscr:"\ud835\udcb5",zscr:"\ud835\udccf",zwj:"\u200d",zwnj:"\u200c"}),t.entityMap=t.HTML_ENTITIES},252:(e,t,n)=>{"use strict";var i=n(739);e.exports=function(e,t){return void 0===t&&(t=!1),function(n,r,s){if(n)e(n);else if(r.statusCode>=400&&r.statusCode<=599){var a=s;if(t)if(i.TextDecoder){var o=function(e){void 0===e&&(e="");return e.toLowerCase().split(";").reduce((function(e,t){var n=t.split("="),i=n[0],r=n[1];return"charset"===i.trim()?r.trim():e}),"utf-8")}(r.headers&&r.headers["content-type"]);try{a=new TextDecoder(o).decode(s)}catch(l){}}else a=String.fromCharCode.apply(null,new Uint8Array(s));e({cause:a})}else e(null,s)}}},307:e=>{e.exports=function(e){if(!e)return!1;var n=t.call(e);return"[object Function]"===n||"function"===typeof e&&"[object RegExp]"!==n||"undefined"!==typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var t=Object.prototype.toString},323:e=>{var t={"":1,lr:1,rl:1},n={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function i(e){return"string"===typeof e&&(!!n[e.toLowerCase()]&&e.toLowerCase())}function r(e,n,r){this.hasBeenReset=!1;var s="",a=!1,o=e,l=n,u=r,c=null,d="",h=!0,f="auto",p="start",g="auto",m="auto",y=100,v="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return s},set:function(e){s=""+e}},pauseOnExit:{enumerable:!0,get:function(){return a},set:function(e){a=!!e}},startTime:{enumerable:!0,get:function(){return o},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");o=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return l},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");l=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return u},set:function(e){u=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return c},set:function(e){c=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return d},set:function(e){var n=function(e){return"string"===typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===n)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");d=n,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return h},set:function(e){h=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return f},set:function(e){if("number"!==typeof e&&"auto"!==e)throw new SyntaxError("Line: an invalid number or illegal string was specified.");f=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return p},set:function(e){var t=i(e);t?(p=t,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return g},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");g=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return m},set:function(e){var t=i(e);t?(m=t,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return v},set:function(e){var t=i(e);if(!t)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");v=t,this.hasBeenReset=!0}}}),this.displayState=void 0}r.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.exports=r},329:(e,t,n)=>{var i=n(963).getUint64;e.exports=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8)},r=12;0===n.version?(n.earliestPresentationTime=t.getUint32(r),n.firstOffset=t.getUint32(r+4),r+=8):(n.earliestPresentationTime=i(e.subarray(r)),n.firstOffset=i(e.subarray(r+8)),r+=16),r+=2;var s=t.getUint16(r);for(r+=2;s>0;r+=12,s--)n.references.push({referenceType:(128&e[r])>>>7,referencedSize:2147483647&t.getUint32(r),subsegmentDuration:t.getUint32(r+4),startsWithSap:!!(128&e[r+8]),sapType:(112&e[r+8])>>>4,sapDeltaTime:268435455&t.getUint32(r+8)});return n}},391:(e,t,n)=>{"use strict";var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},403:e=>{var t,n,i,r,s,a,o,l=9e4;t=function(e){return e*l},n=function(e,t){return e*t},i=function(e){return e/l},r=function(e,t){return e/t},s=function(e,n){return t(r(e,n))},a=function(e,t){return n(i(e),t)},o=function(e,t,n){return i(n?e:e-t)},e.exports={ONE_SECOND_IN_TS:l,secondsToVideoTs:t,secondsToAudioTs:n,videoTsToSeconds:i,audioTsToSeconds:r,audioTsToVideoTs:s,videoTsToAudioTs:a,metadataTsToSeconds:o}},459:e=>{"use strict";var t=function(){function e(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1}var t=e.prototype;return t.getIsEnabled=function(){return this.enabled_},t.enable=function(){this.enabled_=!0},t.disable=function(){this.enabled_=!1},t.reset=function(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1},t.getMaxAttempts=function(){return this.maxAttempts_},t.setMaxAttempts=function(e){this.maxAttempts_=e},t.getDelayFactor=function(){return this.delayFactor_},t.setDelayFactor=function(e){this.delayFactor_=e},t.getFuzzFactor=function(){return this.fuzzFactor_},t.setFuzzFactor=function(e){this.fuzzFactor_=e},t.getInitialDelay=function(){return this.initialDelay_},t.setInitialDelay=function(e){this.initialDelay_=e},t.createRetry=function(e){var t=void 0===e?{}:e,i=t.maxAttempts,r=t.delayFactor,s=t.fuzzFactor,a=t.initialDelay;return new n({maxAttempts:i||this.maxAttempts_,delayFactor:r||this.delayFactor_,fuzzFactor:s||this.fuzzFactor_,initialDelay:a||this.initialDelay_})},e}(),n=function(){function e(e){this.maxAttempts_=e.maxAttempts,this.delayFactor_=e.delayFactor,this.fuzzFactor_=e.fuzzFactor,this.currentDelay_=e.initialDelay,this.currentAttempt_=1}var t=e.prototype;return t.moveToNextAttempt=function(){this.currentAttempt_++;var e=this.currentDelay_*this.delayFactor_;this.currentDelay_=this.currentDelay_+e},t.shouldRetry=function(){return this.currentAttempt_<this.maxAttempts_},t.getCurrentDelay=function(){return this.currentDelay_},t.getCurrentMinPossibleDelay=function(){return(1-this.fuzzFactor_)*this.currentDelay_},t.getCurrentMaxPossibleDelay=function(){return(1+this.fuzzFactor_)*this.currentDelay_},t.getCurrentFuzzedDelay=function(){var e=this.getCurrentMinPossibleDelay(),t=this.getCurrentMaxPossibleDelay();return e+Math.random()*(t-e)},e}();e.exports=t},501:(e,t,n)=>{var i=n(739),r=e.exports={WebVTT:n(146),VTTCue:n(323),VTTRegion:n(506)};i.vttjs=r,i.WebVTT=r.WebVTT;var s=r.VTTCue,a=r.VTTRegion,o=i.VTTCue,l=i.VTTRegion;r.shim=function(){i.VTTCue=s,i.VTTRegion=a},r.restore=function(){i.VTTCue=o,i.VTTRegion=l},i.VTTCue||r.shim()},506:e=>{var t={"":!0,up:!0};function n(e){return"number"===typeof e&&e>=0&&e<=100}e.exports=function(){var e=100,i=3,r=0,s=100,a=0,o=100,l="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!n(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return i},set:function(e){if("number"!==typeof e)throw new TypeError("Lines must be set to a number.");i=e}},regionAnchorY:{enumerable:!0,get:function(){return s},set:function(e){if(!n(e))throw new Error("RegionAnchorX must be between 0 and 100.");s=e}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(e){if(!n(e))throw new Error("RegionAnchorY must be between 0 and 100.");r=e}},viewportAnchorY:{enumerable:!0,get:function(){return o},set:function(e){if(!n(e))throw new Error("ViewportAnchorY must be between 0 and 100.");o=e}},viewportAnchorX:{enumerable:!0,get:function(){return a},set:function(e){if(!n(e))throw new Error("ViewportAnchorX must be between 0 and 100.");a=e}},scroll:{enumerable:!0,get:function(){return l},set:function(e){var n=function(e){return"string"===typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}(e);!1===n?console.warn("Scroll: an invalid or illegal string was specified."):l=n}}})}},542:()=>{},552:(e,t,n)=>{!function(){var e="undefined"!=typeof window?window:n.g,i={};for(var r in function(e,t,n){var i;function s(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var o=function(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof e&&e,"object"==typeof self&&self,"object"==typeof t&&t];for(var i=0;i<n.length;++i){var r=n[i];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function l(e,t){if(t)e:{var n=o;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}function u(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function c(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:s(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function d(e){if(!(e instanceof Array)){e=c(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}l("Symbol",(function(e){function t(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),l("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=o[t[n]];"function"===typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return u(s(this))}})}return e}));var h,f="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)h=Object.setPrototypeOf;else{var p;e:{var g={};try{g.__proto__={a:!0},p=g.a;break e}catch(rw){}p=!1}h=p?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var m=h;function y(e,t){if(e.prototype=f(t.prototype),e.prototype.constructor=e,m)m(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.Gk=t.prototype}function v(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.A=this.i=null}function b(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}function T(e,t){e.i={Hg:t,Sg:!0},e.g=e.m||e.j}function S(e,t,n){return e.g=n,{value:t}}function _(e){e.g=0}function w(e,t,n){e.m=t,void 0!=n&&(e.j=n)}function E(e,t){e.m=0,e.j=t||0}function k(e,t,n){e.g=t,e.m=n||0}function x(e,t){return e.m=t||0,t=e.i.Hg,e.i=null,t}function A(e){e.A=[e.i],e.m=0,e.j=0}function C(e,t){var n=e.A.splice(0)[0];(n=e.i=e.i||n)?n.Sg?e.g=e.m||e.j:void 0!=n.u&&e.j<n.u?(e.g=n.u,e.i=null):e.g=e.j:e.g=t}function I(e){this.g=new v,this.h=e}function L(e,t,n,i){try{var r=t.call(e.g.l,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.g.o=!1,r;var s=r.value}catch(a){return e.g.l=null,T(e.g,a),D(e)}return e.g.l=null,i.call(e.g,s),D(e)}function D(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(n){e.g.h=void 0,T(e.g,n)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.Sg)throw t.Hg;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function R(e){this.next=function(t){return b(e.g),e.g.l?t=L(e,e.g.l.next,t,e.g.s):(e.g.s(t),t=D(e)),t},this.throw=function(t){return b(e.g),e.g.l?t=L(e,e.g.l.throw,t,e.g.s):(T(e.g,t),t=D(e)),t},this.return=function(t){return function(e,t){b(e.g);var n=e.g.l;return n?L(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),D(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function M(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(i,r){!function e(s){s.done?i(s.value):Promise.resolve(s.value).then(t,n).then(e,r)}(e.next())}))}(new R(new I(e)))}function P(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function N(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}function U(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var s=e[r];if(t.call(n,s,r,e))return{Qg:r,v:s}}return{Qg:-1,v:void 0}}function F(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}v.prototype.s=function(e){this.h=e},v.prototype.return=function(e){this.i={return:e},this.g=this.j},v.prototype.u=function(e){this.g=e},l("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(r){t.reject(r)}}function n(){this.g=null}function i(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var s=o.setTimeout;n.prototype.i=function(e){s(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(i){this.j(i)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.F),reject:e(this.l)}},t.prototype.F=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.H(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.C(e):this.m(e)}},t.prototype.C=function(e){var t=void 0;try{t=e.then}catch(r){return void this.l(r)}"function"==typeof t?this.I(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.G(),this.A()},t.prototype.G=function(){var e=this;s((function(){if(e.B()){var t=o.console;"undefined"!==typeof t&&t.error(e.i)}}),1)},t.prototype.B=function(){if(this.o)return!1;var e=o.CustomEvent,t=o.Event,n=o.dispatchEvent;return"undefined"===typeof n||("function"===typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"===typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=o.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.H=function(e){var t=this.j();e.Pd(t.resolve,t.reject)},t.prototype.I=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(i){n.reject(i)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(n){s(n)}}:t}var r,s,a=new t((function(e,t){r=e,s=t}));return this.Pd(i(e,r),i(n,s)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Pd=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=i,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var r=c(e),s=r.next();!s.done;s=r.next())i(s.value).Pd(t,n)}))},t.all=function(e){var n=c(e),r=n.next();return r.done?i([]):new t((function(e,t){function s(t){return function(n){a[t]=n,0==--o&&e(a)}}var a=[],o=0;do{a.push(void 0),o++,i(r.value).Pd(s(a.length-1),t),r=n.next()}while(!r.done)}))},t})),l("WeakMap",(function(e){function t(e){if(this.g=(l+=Math.random()+1).toString(),e){e=c(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function i(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function r(e){if(!O(e,o)){var t=new n;a(e,o,{value:t})}}function s(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&r(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([[t,2],[n,3]]);return 2==i.get(t)&&3==i.get(n)&&(i.delete(t),i.set(n,4),!i.has(t)&&4==i.get(n))}catch(r){return!1}}())return e;var o="$jscomp_hidden_"+Math.random();s("freeze"),s("preventExtensions"),s("seal");var l=0;return t.prototype.set=function(e,t){if(!i(e))throw Error("Invalid WeakMap key");if(r(e),!O(e,o))throw Error("WeakMap key fail: "+e);return e[o][this.g]=t,this},t.prototype.get=function(e){return i(e)&&O(e,o)?e[o][this.g]:void 0},t.prototype.has=function(e){return i(e)&&O(e,o)&&O(e[o],this.g)},t.prototype.delete=function(e){return!!(i(e)&&O(e,o)&&O(e[o],this.g))&&delete e[o][this.g]},t})),l("Map",(function(e){function t(){var e={};return e.Vb=e.next=e.head=e}function n(e,t){var n=e[1];return u((function(){if(n){for(;n.head!=e[1];)n=n.Vb;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function i(e,t){var n=t&&typeof t;"object"==n||"function"==n?s.has(t)?n=s.get(t):(n=""+ ++a,s.set(t,n)):n="p_"+t;var i=e[0][n];if(i&&O(e[0],n))for(e=0;e<i.length;e++){var r=i[e];if(t!==t&&r.key!==r.key||t===r.key)return{id:n,list:i,index:e,entry:r}}return{id:n,list:i,index:-1,entry:void 0}}function r(e){if(this[0]={},this[1]=t(),this.size=0,e){e=c(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(c([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&!((r=i.next()).done||4!=r.value[0].x||"t"!=r.value[1]||!i.next().done)}catch(s){return!1}}())return e;var s=new WeakMap;r.prototype.set=function(e,t){var n=i(this,e=0===e?0:e);return n.list||(n.list=this[0][n.id]=[]),n.entry?n.entry.value=t:(n.entry={next:this[1],Vb:this[1].Vb,head:this[1],key:e,value:t},n.list.push(n.entry),this[1].Vb.next=n.entry,this[1].Vb=n.entry,this.size++),this},r.prototype.delete=function(e){return!(!(e=i(this,e)).entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this[0][e.id],e.entry.Vb.next=e.entry.next,e.entry.next.Vb=e.entry.Vb,e.entry.head=null,this.size--,!0)},r.prototype.clear=function(){this[0]={},this[1]=this[1].Vb=t(),this.size=0},r.prototype.has=function(e){return!!i(this,e).entry},r.prototype.get=function(e){return(e=i(this,e).entry)&&e.value},r.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},r.prototype.keys=function(){return n(this,(function(e){return e.key}))},r.prototype.values=function(){return n(this,(function(e){return e.value}))},r.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var a=0;return r})),l("Set",(function(e){function t(e){if(this.g=new Map,e){e=c(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(c([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&r.value[1]==t&&(!(r=i.next()).done&&r.value[0]!=t&&4==r.value[0].x&&r.value[1]==r.value[0]&&i.next().done)}catch(s){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(i){return e.call(t,i,i,n)}))},t)})),l("Array.prototype.values",(function(e){return e||function(){return N(this,(function(e,t){return t}))}})),l("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var i=[],r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof r){e=r.call(e);for(var s=0;!(r=e.next()).done;)i.push(t.call(n,r.value,s++))}else for(r=e.length,s=0;s<r;s++)i.push(t.call(n,e[s],s));return i}})),l("Array.prototype.keys",(function(e){return e||function(){return N(this,(function(e){return e}))}})),l("Array.prototype.findIndex",(function(e){return e||function(e,t){return U(this,e,t).Qg}})),l("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}})),l("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length;for(0>(t=t||0)&&(t=Math.max(t+i,0));t<i;t++){var r=n[t];if(r===e||Object.is(r,e))return!0}return!1}})),l("String.prototype.includes",(function(e){return e||function(e,t){return-1!==F(this,e,"includes").indexOf(e,t||0)}})),l("String.fromCodePoint",(function(e){return e||function(e){for(var t="",n=0;n<arguments.length;n++){var i=Number(arguments[n]);if(0>i||1114111<i||i!==Math.floor(i))throw new RangeError("invalid_code_point "+i);65535>=i?t+=String.fromCharCode(i):(i-=65536,t+=String.fromCharCode(i>>>10&1023|55296),t+=String.fromCharCode(1023&i|56320))}return t}})),l("WeakSet",(function(e){function t(e){if(this.g=new WeakMap,e){e=c(e);for(var t;!(t=e.next()).done;)this.add(t.value)}}return function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([t]);return!(!i.has(t)||i.has(n))&&(i.delete(t),i.add(n),!i.has(t)&&i.has(n))}catch(r){return!1}}()?e:(t.prototype.add=function(e){return this.g.set(e,!0),this},t.prototype.has=function(e){return this.g.has(e)},t.prototype.delete=function(e){return this.g.delete(e)},t)})),l("Array.prototype.find",(function(e){return e||function(e,t){return U(this,e,t).v}})),l("String.prototype.startsWith",(function(e){return e||function(e,t){var n=F(this,e,"startsWith"),i=n.length,r=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var s=0;s<r&&t<i;)if(n[t++]!=e[s++])return!1;return s>=r}})),l("Object.entries",(function(e){return e||function(e){var t,n=[];for(t in e)O(e,t)&&n.push([t,e[t]]);return n}}));var B="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)O(i,r)&&(e[r]=i[r])}return e};l("Object.assign",(function(e){return e||B})),l("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}})),l("Array.prototype.entries",(function(e){return e||function(){return N(this,(function(e,t){return[e,t]}))}})),l("Number.isNaN",(function(e){return e||function(e){return"number"===typeof e&&isNaN(e)}})),l("String.prototype.repeat",(function(e){return e||function(e){var t=F(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}})),l("Number.EPSILON",(function(){return Math.pow(2,-52)})),l("Number.MAX_SAFE_INTEGER",(function(){return 9007199254740991})),l("Number.isFinite",(function(e){return e||function(e){return"number"===typeof e&&(!isNaN(e)&&1/0!==e&&-1/0!==e)}})),l("Object.values",(function(e){return e||function(e){var t,n=[];for(t in e)O(e,t)&&n.push(e[t]);return n}})),l("Math.log2",(function(e){return e||function(e){return Math.log(e)/Math.LN2}})),l("String.prototype.endsWith",(function(e){return e||function(e,t){var n=F(this,e,"endsWith");void 0===t&&(t=n.length),t=Math.max(0,Math.min(0|t,n.length));for(var i=e.length;0<i&&0<t;)if(n[--t]!=e[--i])return!1;return 0>=i}})),l("Math.trunc",(function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}}));var j=this||self;function $(e,t){e=e.split(".");var n,i=j;e[0]in i||"undefined"==typeof i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}function V(){}function H(){}function q(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}function G(e){return e.h/(1-Math.pow(e.g,e.i))}function z(){this.h=new q(2),this.j=new q(5),this.g=0,this.i=128e3,this.l=16e3}function K(){}function W(){}function X(){}function Y(e){var t=P.apply(1,arguments);J.has(e)||(J.add(e),X.apply(K,d(t)))}function Q(){}q.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)},z.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},z.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},z.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(G(this.h),G(this.j))};var J=new Set;function Z(){this.g=new Map}function ee(){this.g=new Z}function te(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.g=function(e,t){if(void 0==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter((function(e){return!n.has(e)})),function(e){var t=ne;if(void 0==t){t=!1;try{var n={},i={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(r){t=!1}ne=t}return t||!1}(e)?t:t.capture||!1}(e,i),this.target.addEventListener(t,n,this.g)}e.console&&((new Map).set(1,(function(){return console.error.apply(console,d(P.apply(0,arguments)))})).set(2,(function(){return console.warn.apply(console,d(P.apply(0,arguments)))})).set(3,(function(){return console.info.apply(console,d(P.apply(0,arguments)))})).set(4,(function(){return console.log.apply(console,d(P.apply(0,arguments)))})).set(5,(function(){return console.debug.apply(console,d(P.apply(0,arguments)))})).set(6,(function(){return console.debug.apply(console,d(P.apply(0,arguments)))})),X=function(){return console.warn.apply(console,d(P.apply(0,arguments)))},W=function(){console.error.apply(console,d(P.apply(0,arguments)))}),(i=Z.prototype).push=function(e,t){this.g.has(e)?this.g.get(e).push(t):this.g.set(e,[t])},i.get=function(e){return this.g.has(e)?this.g.get(e).slice():null},i.remove=function(e,t){if(this.g.has(e)){var n=this.g.get(e).filter((function(e){return e!=t}));this.g.set(e,n),n.length||this.g.delete(e)}},i.forEach=function(e){this.g.forEach((function(t,n){e(n,t)}))},i.size=function(){return this.g.size},i.keys=function(){return Array.from(this.g.keys())},(i=ee.prototype).release=function(){this.Ma(),this.g=null},i.D=function(e,t,n,i){this.g&&(e=new te(e,t,n,i),this.g.push(t,e))},i.ma=function(e,t,n,i){var r=this;this.D(e,t,(function i(s){r.bb(e,t,i),n(s)}),i)},i.bb=function(e,t,n){if(this.g)for(var i=this.g.get(t)||[],r=(i=c(i)).next();!r.done;r=i.next())(r=r.value).target!=e||n!=r.listener&&n||(r.bb(),this.g.remove(t,r))},i.Ma=function(){if(this.g){for(var e=[],t=c(this.g.g.values()),n=t.next();!n.done;n=t.next())e.push.apply(e,d(n.value));for(t=(e=c(e)).next();!t.done;t=e.next())t.value.bb();this.g.g.clear()}},$("shaka.util.EventManager",ee),ee.prototype.removeAll=ee.prototype.Ma,ee.prototype.unlisten=ee.prototype.bb,ee.prototype.listenOnce=ee.prototype.ma,ee.prototype.listen=ee.prototype.D,ee.prototype.release=ee.prototype.release,te.prototype.bb=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};var ne=void 0;function ie(t){if(se.has(t))return se.get(t);var n=e.ManagedMediaSource||e.MediaSource;return!!n&&(n=n.isTypeSupported(t),se.set(t,n),n)}function re(){var t=e.ManagedSourceBuffer||e.SourceBuffer;return!!t&&!!t.prototype&&!!t.prototype.changeType}var se=new Map;function ae(e,t){this.g=e,this.h=t}function oe(e,t){var n=new ae(5,0),i=ce,r=i.g,s=n.h-r.h;(0<(n.g-r.g||s)?i.i:i.h)(i.g,n,e,t)}function le(e,t,n,i){X([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function ue(e,t,n,i){W([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(" "))}ae.prototype.toString=function(){return"v"+this.g+"."+this.h};var ce=null;function de(){}function he(){}function fe(){}function pe(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if((ArrayBuffer.isView(e)?e.buffer:e)==(ArrayBuffer.isView(t)?t.buffer:t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=me(e);t=me(t);for(var i=0;i<e.byteLength;i++)if(n[i]!=t[i])return!1;return!0}function ge(e){return ArrayBuffer.isView(e)?0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer:e}function me(e,t,n){return be(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint8Array)}function ye(e,t,n){return be(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint16Array)}function ve(e,t,n){return be(e,void 0===t?0:t,n=void 0===n?1/0:n,DataView)}function be(e,t,n,i){var r=ArrayBuffer.isView(e)?e.buffer:e,s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);var a=((e.byteOffset||0)+e.byteLength)/s;return new i(r,e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/s,a))),Math.floor(Math.min(e+Math.max(n,0),a))-e)}function Te(){}function Se(e){this.l=new he,(e=we(e.toLowerCase()))&&(this.l=e()),this.h=new de,(e=ke)&&(this.h=e())}function _e(e,t){Ee.set(e,t)}function we(e){return Ee.get(e)}de.prototype.extract=function(){},de.prototype.decode=function(){return[]},de.prototype.clear=function(){},de.prototype.getStreams=function(){return[]},he.prototype.init=function(){},he.prototype.parse=function(){return[]},$("shaka.util.BufferUtils",fe),fe.toDataView=ve,fe.toUint16=ye,fe.toUint8=me,fe.toArrayBuffer=ge,fe.equal=pe,Te.prototype.init=function(){},Te.prototype.i=function(){},Te.prototype.g=function(){},Te.prototype.j=function(){},$("shaka.media.IClosedCaptionParser",Te),Se.prototype.init=function(e,t){void 0!==t&&t||this.g(),this.l.init(e)},Se.prototype.i=function(e){for(var t=(e=c(e=this.l.parse(e))).next();!t.done;t=e.next()){var n=me((t=t.value).packet);0<n.length&&this.h.extract(n,t.pts)}return this.h.decode()},Se.prototype.g=function(){this.h.clear()},Se.prototype.j=function(){return this.h.getStreams()},$("shaka.media.ClosedCaptionParser",Se),Se.findDecoder=function(){return ke},Se.unregisterDecoder=function(){ke=null},Se.registerDecoder=function(e){ke=e},Se.findParser=we,Se.unregisterParser=function(e){Ee.delete(e)},Se.registerParser=_e;var Ee=new Map,ke=null;function xe(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Ae,this.scroll=Ce}$("shaka.text.CueRegion",xe);var Ae=1;xe.units={PX:0,PERCENTAGE:Ae,LINES:2};var Ce="";function Ie(e,t){return!("number"!==typeof e||"number"!==typeof t||!isNaN(e)||!isNaN(t))||e===t}function Le(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)}function De(e,t,n){if(n||(n=Ie),e.length!=t.length)return!1;t=t.slice();for(var i=(e=c(e)).next(),r={};!i.done;r={Ug:void 0},i=e.next()){if(r.Ug=i.value,-1==(i=t.findIndex(function(e){return function(t){return n(e.Ug,t)}}(r))))return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function Re(e,t,n){if(n||(n=Ie),e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function Me(e,t,n){var i=P.apply(3,arguments);if(this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1,this.message="Shaka Error "+this.code,Pe)try{throw Error(this.message||"Shaka Error")}catch(r){this.stack=r.stack}}xe.scrollMode={NONE:Ce,UP:"up"},Me.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},$("shaka.util.Error",Me);var Pe=!0;function Oe(e){this.h=e,this.g=void 0}function Ne(e,t){return!e.length||!t.length||e===t||0<Ue(e,t).length}function Ue(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],i=(e=c(e)).next();!i.done;i=e.next()){i=i.value;for(var r=c(t),s=r.next();!s.done;s=r.next())if(s=s.value,i.keySystem==s.keySystem){r=new Map;for(var a=c((i.initData||[]).concat(s.initData||[])),o=a.next();!o.done;o=a.next())o=o.value,r.set(o.keyId,o);r=Array.from(r.values()),a=i.keyIds&&s.keyIds?new Set([].concat(d(i.keyIds),d(s.keyIds))):i.keyIds||s.keyIds,n.push({keySystem:i.keySystem,licenseServerUri:i.licenseServerUri||s.licenseServerUri,distinctiveIdentifierRequired:i.distinctiveIdentifierRequired||s.distinctiveIdentifierRequired,persistentStateRequired:i.persistentStateRequired||s.persistentStateRequired,videoRobustness:i.videoRobustness||s.videoRobustness,audioRobustness:i.audioRobustness||s.audioRobustness,serverCertificate:i.serverCertificate||s.serverCertificate,serverCertificateUri:i.serverCertificateUri||s.serverCertificateUri,initData:r,keyIds:a});break}}return n}function Fe(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)}Me.Severity={RECOVERABLE:1,CRITICAL:2},Me.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},Me.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,DASH_INVALID_PATCH:4052,HLS_EMPTY_MEDIA_PLAYLIST:4053,DASH_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4054,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,MISSING_EME_SUPPORT:6020,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,PRELOAD_DESTROYED:7006,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005,INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED:10006,VAST_INVALID_XML:10007},Oe.prototype.value=function(){return void 0==this.g&&(this.g=this.h()),this.g};var Be=new Oe((function(){return ge(new Uint8Array([0]))})),je=new Map;function $e(e){this.h=e,this.g=null}function Ve(e){this.h=e,this.g=null}function He(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.isTypeSupported)}function qe(e){return""!=ut().canPlayType(e)}function Ge(){return!!navigator.userAgent.match(/Edge?\//)}function ze(){return ot("Xbox One")}function Ke(){return ot("Tizen")}function We(){return ot("Tizen 3")}function Xe(){return ot("Web0S")}function Ye(){return ot("CrKey")}function Qe(){if(!ot("Chrome")||navigator.userAgent.match(/Edge\//))return null;var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null}function Je(){return lt()&&(nt()||!!/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||lt()&&1<navigator.maxTouchPoints)}function Ze(){return ot("PlayStation 5")}function et(){return ot("PlayStation 4")}function tt(){return ot("Hisense")||ot("VIDAA")}function nt(){return navigator.userAgentData&&navigator.userAgentData.platform?"macos"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("mac")}function it(){return navigator.userAgentData&&navigator.userAgentData.platform?"windows"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("win32")}function rt(){return navigator.userAgentData&&navigator.userAgentData.platform?"android"==navigator.userAgentData.platform.toLowerCase():ot("Android")}function st(){return navigator.userAgentData&&navigator.userAgentData.platform?"fuchsia"==navigator.userAgentData.platform.toLowerCase():ot("Fuchsia")}function at(){return!!(Ke()||Xe()||ze()||et()||Ze()||Ye()||tt()||lt()&&!Je())}function ot(e){return(navigator.userAgent||"").includes(e)}function lt(){return(navigator.vendor||"").includes("Apple")}function ut(){return ht||(dt||(dt=new Ve((function(){ht=null}))),(ht=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(ht=document.createElement("video")),dt.aa(1),ht)}function ct(){var t,n,i,r,s,a,o,l,u,c,d,h,f,p;return M((function(g){switch(g.g){case 1:if(t={width:1/0,height:1/0},Ye()){if(h=e.cast&&cast.__platform__&&cast.__platform__.canDisplayType,t.width=1280,t.height=720,w(g,14),!(f=h)){g.u(16);break}return S(g,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),17)}if(Ke()){t.width=1920,t.height=1080;try{webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution?(n=webapis.systeminfo.getMaxVideoResolution(),t.width=n.width,t.height=n.height):webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(t.width=7680,t.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(t.width=3840,t.height=2160)}catch(m){X("Tizen: Error detecting screen size, default screen size 1920x1080.")}g.u(3);break}if(Xe()){try{i=JSON.parse(e.PalmSystem.deviceInfo),t.width=Math.max(1920,i.screenWidth),t.height=Math.max(1080,i.screenHeight)}catch(m){X("WebOS: Error detecting screen size, default screen size 1920x1080."),t.width=1920,t.height=1080}g.u(3);break}if(tt()){if(r=null,e.Hisense_Get4KSupportState)try{r=e.Hisense_Get4KSupportState()}catch(m){}null==r&&(r=ot("UHD")),r?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),g.u(3);break}if(!et()&&!Ze()){s=void 0;try{s="undefined"!==typeof Windows?Windows:chrome.webview.hostObjects.sync.Windows}catch(m){}if(s){t.width=1920,t.height=1080;try{a=new s.Media.Protection.ProtectionCapabilities,o=s.Media.Protection.ProtectionCapabilityResult,l=null;do{l=a.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation")}while(l===o.maybe);l===o.probably&&(t.width=3840,t.height=2160)}catch(m){X("Xbox: Error detecting screen size, default screen size 1920x1080.")}}else ze()&&(t.width=1920,t.height=1080,X("Xbox: Error detecting screen size, default screen size 1920x1080."));g.u(3);break}return u=!1,w(g,8),S(g,e.msdk.device.getDisplayInfo(),10);case 10:c=g.h,u="4K"===c.resolution,k(g,9);break;case 8:return x(g),w(g,11),S(g,e.msdk.device.getDisplayInfoImmediate(),13);case 13:d=g.h,u="4K"===d.resolution,k(g,9);break;case 11:X("PlayStation: Failed to get the display info:",x(g));case 9:u?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),g.u(3);break;case 17:f=g.h;case 16:if(f){t.width=3840,t.height=2160,g.u(18);break}if(!(p=h)){g.u(19);break}return S(g,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),20);case 20:p=g.h;case 19:p&&(t.width=1920,t.height=1080);case 18:k(g,3);break;case 14:W("Failed to check canDisplayType:",x(g));case 3:return g.return(t)}}))}$e.prototype.aa=function(t){var n=this;this.stop();var i=!0,r=null;return this.g=function(){e.clearTimeout(r),i=!1},r=e.setTimeout((function(){i&&n.h()}),1e3*t),this},$e.prototype.stop=function(){this.g&&(this.g(),this.g=null)},Ve.prototype.rb=function(){return this.stop(),this.h(),this},Ve.prototype.aa=function(e){var t=this;return this.stop(),this.g=new $e((function(){t.h()})).aa(e),this},Ve.prototype.ua=function(e){var t=this;return this.stop(),this.g=new $e((function(){t.g.aa(e),t.h()})).aa(e),this},Ve.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},$("shaka.util.Timer",Ve),Ve.prototype.stop=Ve.prototype.stop,Ve.prototype.tickEvery=Ve.prototype.ua,Ve.prototype.tickAfter=Ve.prototype.aa,Ve.prototype.tickNow=Ve.prototype.rb;var dt=null,ht=null;function ft(){}function pt(t){if(!t)return"";if(239==(t=me(t))[0]&&187==t[1]&&191==t[2]&&(t=t.subarray(3)),e.TextDecoder&&!et())return(t=(new TextDecoder).decode(t)).includes("\ufffd")&&W('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),t;for(var n="",i=0;i<t.length;++i){var r=65533;if(0==(128&t[i])?r=t[i]:t.length>=i+2&&192==(224&t[i])&&128==(192&t[i+1])?(r=(31&t[i])<<6|63&t[i+1],i+=1):t.length>=i+3&&224==(240&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])?(r=(15&t[i])<<12|(63&t[i+1])<<6|63&t[i+2],i+=2):t.length>=i+4&&240==(241&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])&&128==(192&t[i+3])&&(r=(7&t[i])<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3],i+=3),65535>=r)n+=String.fromCharCode(r);else{var s=1023&(r-=65536);n+=String.fromCharCode(55296+(r>>10)),n+=String.fromCharCode(56320+s)}}return n}function gt(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw new Me(2,2,2004);n=Math.floor(e.byteLength/2);var i=new Uint16Array(n);e=ve(e);for(var r=0;r<n;r++)i[r]=e.getUint16(2*r,t);return bt(i)}function mt(e){function t(e){return n.byteLength<=e||32<=n[e]&&126>=n[e]}if(!e)return"";var n=me(e);if(239==n[0]&&187==n[1]&&191==n[2])return pt(n);if(254==n[0]&&255==n[1])return gt(n.subarray(2),!1);if(255==n[0]&&254==n[1])return gt(n.subarray(2),!0);if(0==n[0]&&0==n[2])return gt(e,!1);if(0==n[1]&&0==n[3])return gt(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return pt(e);throw new Me(2,2,2003)}function yt(t){if(e.TextEncoder&&!et()){var n=new TextEncoder;return ge(n.encode(t))}t=encodeURIComponent(t),t=unescape(t),n=new Uint8Array(t.length);for(var i=0;i<t.length;i++)n[i]=t[i].charCodeAt(0);return ge(n)}function vt(e,t){for(var n=new ArrayBuffer(2*e.length),i=new DataView(n),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n}function bt(e){return St.value()(e)}function Tt(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&nbsp;":"\xa0","&lrm;":"\u200e","&rlm;":"\u200f"},n=/&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,(function(e){return"#"==e[1]?0<=(e="x"==e[2]||"X"==e[2]?parseInt(e.substring(3),16):parseInt(e.substring(2),10))&&1114111>=e?String.fromCodePoint(e):"":t[e]||"'"})):e||""}$("shaka.util.StringUtils",ft),ft.resetFromCharCode=function(){St.g=void 0},ft.toUTF16=vt,ft.toUTF8=yt,ft.fromBytesAutoDetect=mt,ft.fromUTF16=gt,ft.fromUTF8=pt;var St=new Oe((function(){function e(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(n){return!1}}for(var t={jc:65536};0<t.jc;(t={jc:t.jc}).jc/=2)if(e(t.jc))return function(e){return function(t){for(var n="",i=0;i<t.length;i+=e.jc)n+=String.fromCharCode.apply(null,t.subarray(i,i+e.jc));return n}}(t);return null}));function _t(e){this.h=e||"",this.g=0}function wt(e){Et(e,/[ \t]+/gm)}function Et(e,t){return t.lastIndex=e.g,t=null==(t=t.exec(e.h))?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||null==t||t.position!=e.g?null:(e.g+=t.length,t.results)}function kt(e){return e.g==e.h.length?null:(e=Et(e,/[^ \t\n]*/gm))?e[0]:null}function xt(e){if(null==(e=Et(e,Ct)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:(Number(e[6])||0)/1e3+n+60*t+3600*(Number(e[1])||0)}function At(e){return e?xt(new _t(e)):null}var Ct=/(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g;function It(e){var t=new WeakSet;return function e(n){switch(typeof n){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;default:if(!n||ArrayBuffer.isView(n))return n;if(t.has(n))return null;var i=n.constructor==Array;if(n.constructor!=Object&&!i)return null;t.add(n);var r,s=i?[]:{};for(r in n)s[r]=e(n[r]);return i&&(s.length=n.length),s}}(e)}function Lt(e){var t,n={};for(t in e)n[t]=e[t];return n}function Dt(e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++){var i=n.toString(),r=e[n];void 0!==r&&(r=Dt(r))&&t.push(i+":"+r)}e="["+t.join(",")+"]"}else if("function"==typeof e)e="";else if(e instanceof Object){for((n=Object.keys(e)).sort(),t=[],i=(n=c(n)).next();!i.done;i=n.next())r=i.value,i=JSON.stringify(r),void 0!==(r=e[r])&&(r=Dt(r))&&t.push(i+":"+r);e="{"+t.join(",")+"}"}else e=JSON.stringify(e);return e}function Rt(e,t){var n=void 0!==n&&n;return Mt(e=mt(e),t,n)}function Mt(e,t,n){return e=function(e,t){function n(s,a){a=void 0!==a&&a;for(var o=[];e[r];)if(60==e.charCodeAt(r)){if(47===e.charCodeAt(r+1)){a=r+2,r=e.indexOf(">",r);var l=(a=e.substring(a,r)).indexOf(s);if(-1==l){var u=s.indexOf(".");0<u&&(l=a.indexOf(s.substring(0,u)))}if(-1==l)throw s=e.substring(0,r).split("\n"),Error("Unexpected close tag\nLine: "+(s.length-1)+"\nColumn: "+(s[s.length-1].length+1)+"\nChar: "+e[r]);r+1&&(r+=1);break}if(33===e.charCodeAt(r+1)){if(45==e.charCodeAt(r+2)){for(;-1!==r&&(62!==e.charCodeAt(r)||45!=e.charCodeAt(r-1)||45!=e.charCodeAt(r-2)||-1==r);)r=e.indexOf(">",r+1);-1===r&&(r=e.length)}else if(91===e.charCodeAt(r+2)&&91===e.charCodeAt(r+8)&&"cdata"===e.substr(r+3,5).toLowerCase()){-1==(l=e.indexOf("]]>",r))?(o.push(e.substr(r+9)),r=e.length):(o.push(e.substring(r+9,l)),r=l+3);continue}r++;continue}e:{u=a,r++;var c=i(),h={};for(l=[];62!==e.charCodeAt(r)&&e[r];){var f=e.charCodeAt(r);if(64<f&&91>f||96<f&&123>f){f=i();for(var p=e.charCodeAt(r);p&&39!==p&&34!==p&&!(64<p&&91>p||96<p&&123>p)&&62!==p;)r++,p=e.charCodeAt(r);var g=r+1;if(r=e.indexOf(e[r],g),g=e.slice(g,r),39===p||34===p){if(-1===r){if(u={tagName:c,attributes:h,children:l,parent:null},t)for(c=0;c<l.length;c++)"string"!==typeof l[c]&&(l[c].parent=u);l=u;break e}}else g=null,r--;if(f.startsWith("xmlns:")){p=g;var m=f.split(":")[1];un.set(p,m),cn.set(m,p)}"tt"===c&&"xml:space"===f&&"preserve"===g&&(u=!0),h[f]=g}r++}for(47!==e.charCodeAt(r-1)?(r++,l=n(c,u)):r++,u={tagName:c,attributes:h,children:l,parent:null},c=l.length,h=0;h<c;h++)"string"!==typeof(f=l[h])?t&&(f.parent=u):h==c-1&&"\n"==f&&l.pop();l=u}if(o.push(l),"string"===typeof l)break;"?"===l.tagName[0]&&l.children&&(o.push.apply(o,d(l.children)),l.children=[])}else l=r,-2===(r=e.indexOf("<",r)-1)&&(r=e.length),l=e.slice(l,r+1),a?0<l.length&&o.push(l):(o.length&&1==l.length&&"\n"==l[0]||0<l.trim().length)&&o.push(l),r++;return o}function i(){for(var t=r;-1==="\r\n\t>/= ".indexOf(e[r])&&e[r];)r++;return e.slice(t,r)}var r=0;return n("")}(e,void 0!==n&&n),!t&&e.length?e[0]:(e=e.find((function(e){return t.split(",").includes(e.tagName)})))?e:null}function Pt(e){return un.has(e)?un.get(e):""}function Ot(e){return"string"===typeof e}function Nt(e){var t=[];if(!e.children)return[];for(var n=(e=c(e.children)).next();!n.done;n=e.next())"string"!==typeof(n=n.value)&&t.push(n);return t}function Ut(e,t){var n=[];if(!e.children)return[];for(var i=(e=c(e.children)).next();!i.done;i=e.next())(i=i.value).tagName===t&&n.push(i);return n}function Ft(e){return"string"===typeof e?Tt(e):""===(e=e.children.reduce((function(e,t){return"string"===typeof t?e+t:e}),""))?null:Tt(e)}function Bt(e){return Array.from(e.children).every((function(e){return"string"===typeof e}))?((e=Ft(e))&&(e=e.trim()),e):null}function jt(e,t,n){if(n=void 0===n?[]:n,e.tagName===t&&n.push(e),e.children)for(var i=(e=c(e.children)).next();!i.done;i=e.next())jt(i.value,t,n);return n}function $t(e,t){return 1!=(e=Ut(e,t)).length?null:e[0]}function Vt(e,t,n){return 1!=(e=Gt(e,t,n)).length?null:e[0]}function Ht(e,t,n,i){i=void 0===i?null:i;var r=null;return null!=(e=e.attributes[t])&&(r=n(e)),null==r?i:r}function qt(e,t,n){return t=Pt(t),e.attributes[t+":"+n]||null}function Gt(e,t,n){var i=Pt(t);if(t=[],e.children)for(n=i?i+":"+n:n,i=(e=c(e.children)).next();!i.done;i=e.next())(i=i.value)&&i.tagName===n&&t.push(i);return t}function zt(e,t,n){for(var i=(t=c(t)).next();!i.done;i=t.next())if(i=qt(e,i.value,n))return i;return null}function Kt(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function Wt(e){return e&&(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$","i").exec(e))?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null}function Xt(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function Yt(e){return 0===(e=Number(e))%1?e:null}function Qt(e){return 0===(e=Number(e))%1&&0<e?e:null}function Jt(e){return 0===(e=Number(e))%1&&0<=e?e:null}function Zt(e){return e=Number(e),isNaN(e)?null:e}function en(e){return!!e&&"true"===e.toLowerCase()}function tn(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function nn(e){for(var t=[],n=(e=c(e=Tt(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/))).next();!n.done;n=e.next()){var i=(n=n.value).match(/^([\w]+)/);if(i){var r=n.match(/(@id='(.*?)')/),s=n.match(/(@t='(\d+)')/),a=n.match(/(@n='(\d+)')/),o=n.match(/\[(\d+)\]/);t.push({name:i[0],id:r?r[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null,t:s?Number(s[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,n:a?Number(a[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,position:o?Number(o[1])-1:null,Yb:n.split("/@")[1]||null})}else n.startsWith("@")&&t.length&&(t[t.length-1].Yb=n.slice(1))}return t}function rn(e,t){var n=nn(t.attributes.sel||"");if(n.length){var i=n[n.length-1],r=t.attributes.pos||null;null==(n=i.position)&&(null!==i.t&&(n=sn(e,"t",i.t)),null!==i.n&&(n=sn(e,"n",i.n))),null===n?n="prepend"===r?0:e.length:"prepend"===r?--n:"after"===r&&++n,r=t.tagName,(i=i.Yb)&&e[n]?an(e[n],r,i,Bt(t)||""):("remove"!==r&&"replace"!==r||e.splice(n,1),"add"!==r&&"replace"!==r||e.splice.apply(e,[n,0].concat(d(t.children))))}}function sn(e,t,n){for(var i=0,r=(e=c(e)).next();!r.done;r=e.next()){if(Number(r.value.attributes[t])===n)return i;i++}return null}function an(e,t,n,i){"remove"===t?delete e.attributes[n]:"add"!==t&&"replace"!==t||(e.attributes[n]=i)}function on(e){var t="",n=e.tagName.split(":");for(var i in 0<n.length&&(t=n[0],t=cn.has(t)?cn.get(t):""),t=document.createElementNS(t,e.tagName),e.attributes)t.setAttribute(i,e.attributes[i]);for(i=(e=c(e.children)).next();!i.done;i=e.next())n=void 0,n="string"==typeof(i=i.value)?new Text(i):on(i),t.appendChild(n);return t}function ln(e){if(!e)return null;for(var t={tagName:e.tagName,attributes:Lt(e.attributes),children:[],parent:null},n=(e=c(e.children)).next();!n.done;n=e.next())"string"===typeof(n=n.value)||((n=ln(n)).parent=t),t.children.push(n);return t}var un=new Map,cn=new Map;function dn(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new xe,this.position=null,this.positionAlign=vn,this.size=0,this.textAlign=bn,this.direction=wn,this.writingMode=En,this.lineInterpretation=kn,this.line=null,this.lineHeight="",this.lineAlign=xn,this.displayAlign=Sn,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=Ln,this.fontStyle=Rn,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={nc:32,rows:15}}function hn(e,t){return(e=new dn(e,t,"")).lineBreak=!0,e}function fn(e,t){if(e.payload!=t.payload||!(.001>Math.abs(e.startTime-t.startTime)&&.001>Math.abs(e.endTime-t.endTime)))return!1;for(var n in e)if("startTime"!=n&&"endTime"!=n&&"payload"!=n)if("nestedCues"==n){if(!Re(e.nestedCues,t.nestedCues,fn))return!1}else if("region"==n||"cellResolution"==n){for(var i in e[n])if(e[n][i]!=t[n][i])return!1}else if(Array.isArray(e[n])){if(!Re(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}function pn(e,t){t=void 0===t?new Map:t;var n=e.payload;if(n.includes("<")){0===t.size&&gn(t);var i=n;n=[];for(var r=-1,s=0;s<i.length;s++)"<"===i[s]?r=s+1:">"===i[s]&&0<r&&((r=i.substr(r,s-r)).match(Nn)&&n.push(r),r=-1);for(s=(n=c(n)).next();!s.done;s=n.next())s=s.value,i=i.replace("<"+s+">",'<div time="'+s+'">'),i+="</div>";e:{s=i,r=[];var a=-1;n="",i=!1;for(var o=0;o<s.length;o++)if("/"===s[o]){var l=s.indexOf(">",o);if(-1===l){n=s;break e}if((l=s.substring(o+1,l))&&"v"==l){i=!0;var u=null;if(r.length&&(u=r[r.length-1]),u){if(u===l)n+="/"+l+">";else{if(!u.startsWith("v")){n+=s[o];continue}n+="/"+u+">"}o+=l.length+1}else n+=s[o]}else n+=s[o]}else"<"===s[o]?"v"!=s[a=o+1]&&(a=-1):">"===s[o]&&0<a&&(r.push(s.substr(a,o-a)),a=-1),n+=s[o];for(r=(s=c(r)).next();!r.done;r=s.next())a=(r=r.value).replace(" ",".voice-"),n=(n=n.replace("<"+r+">","<"+a+">")).replace("</"+r+">","</"+a+">"),i||(n+="</"+a+">")}n=function(e){var t={"< ":""," >":" &gt;"},n=/(< +>|<\s|\s>)/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,(function(e){return t[e]||""})):e||""}(n),e.payload="";try{var d=Mt("<span>"+n+"</span>","span")}catch(h){}if(d)if(1!=(d=d.children).length||d[0].tagName)for(n=(d=c(d)).next();!n.done;n=d.next())mn(n.value,e,t);else e.payload=Tt(n);else e.payload=Tt(n)}else e.payload=Tt(n)}function gn(e){for(var t=c(Object.entries(Cn)),n=t.next();!n.done;n=t.next()){var i=c(n.value);n=i.next().value,i=i.next().value;var r=new dn(0,0,"");r.color=i,e.set("."+n,r)}for(n=(t=c(Object.entries(In))).next();!n.done;n=t.next())n=(i=c(n.value)).next().value,i=i.next().value,(r=new dn(0,0,"")).backgroundColor=i,e.set("."+n,r)}function mn(e,t,n){var i=t.clone();if(i.nestedCues=[],i.payload="",i.rubyTag="",i.line=null,i.region=new xe,i.position=null,i.size=0,i.textAlign=bn,e.tagName)for(var r=c(e.tagName.split(/(?=[ .])+/g)),s=r.next();!s.done;s=r.next()){var a=s=s.value;if(a.startsWith(".voice-")){var o=a.split("-").pop();a='v[voice="'+o+'"]',n.has(a)||(a="v[voice="+o+"]")}switch(n.has(a)&&(o=i,a=n.get(a))&&(o.backgroundColor=yn(a.backgroundColor,o.backgroundColor),o.color=yn(a.color,o.color),o.fontFamily=yn(a.fontFamily,o.fontFamily),o.fontSize=yn(a.fontSize,o.fontSize),o.textShadow=yn(a.textShadow,o.textShadow),o.fontWeight=a.fontWeight,o.fontStyle=a.fontStyle,o.opacity=a.opacity,o.rubyTag=a.rubyTag,o.textCombineUpright=a.textCombineUpright,o.wrapLine=a.wrapLine),s){case"br":return i=hn(i.startTime,i.endTime),void t.nestedCues.push(i);case"b":i.fontWeight=Dn;break;case"i":i.fontStyle=Mn;break;case"u":i.textDecoration.push(On);break;case"font":(s=e.attributes.color)&&(i.color=s);break;case"div":if(!(s=e.attributes.time))break;(s=At(s))&&(i.startTime=s);break;case"ruby":case"rp":case"rt":i.rubyTag=s}}if(r=e.children,Ot(e)||1==r.length&&Ot(r[0]))for(n=Ft(e).split("\n"),e=!0,r=(n=c(n)).next();!r.done;r=n.next())r=r.value,e||(e=hn(i.startTime,i.endTime),t.nestedCues.push(e)),0<r.length&&((e=i.clone()).payload=Tt(r),t.nestedCues.push(e)),e=!1;else for(t.nestedCues.push(i),e=(t=c(r)).next();!e.done;e=t.next())mn(e.value,i,n)}function yn(e,t){return e&&0<e.length?e:t}dn.prototype.clone=function(){var e,t=new dn(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t},$("shaka.text.Cue",dn),dn.parseCuePayload=pn,dn.equal=fn,dn.prototype.clone=dn.prototype.clone;var vn="auto";dn.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:vn};var bn="center",Tn={LEFT:"left",RIGHT:"right",CENTER:bn,START:"start",END:"end"};dn.textAlign=Tn;var Sn="after",_n={BEFORE:"before",CENTER:"center",AFTER:Sn};dn.displayAlign=_n;var wn="ltr";dn.direction={HORIZONTAL_LEFT_TO_RIGHT:wn,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var En="horizontal-tb";dn.writingMode={HORIZONTAL_TOP_TO_BOTTOM:En,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var kn=0;dn.lineInterpretation={LINE_NUMBER:kn,PERCENTAGE:1};var xn="start",An={CENTER:"center",START:xn,END:"end"};dn.lineAlign=An;var Cn={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};dn.defaultTextColor=Cn;var In={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};dn.defaultTextBackgroundColor=In;var Ln=400,Dn=700;dn.fontWeight={NORMAL:Ln,BOLD:Dn};var Rn="normal",Mn="italic",Pn={NORMAL:Rn,ITALIC:Mn,OBLIQUE:"oblique"};dn.fontStyle=Pn;var On="underline";dn.textDecoration={UNDERLINE:On,LINE_THROUGH:"lineThrough",OVERLINE:"overline"};var Nn=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function Un(){}function Fn(e,t,n){jn.set(e.toLowerCase().split(";")[0]+"-"+n,{priority:n,oe:t})}function Bn(e,t){for(var n=e.toLowerCase().split(";")[0],i=c([qn,Hn,Vn,$n]),r=i.next();!r.done;r=i.next())if(r=jn.get(n+"-"+r.value)){var s=r.oe(),a=s.isSupported(e,t);if(s.destroy(),a)return r.oe}return null}Un.prototype.destroy=function(){},$("shaka.transmuxer.TransmuxerEngine",Un),Un.findTransmuxer=Bn,Un.unregisterTransmuxer=function(e,t){jn.delete(e.toLowerCase().split(";")[0]+"-"+t)},Un.registerTransmuxer=Fn,Un.prototype.destroy=Un.prototype.destroy;var jn=new Map,$n=1,Vn=2,Hn=3,qn=4;Un.PluginPriority={FALLBACK:$n,PREFERRED_SECONDARY:Vn,PREFERRED:Hn,APPLICATION:qn};var Gn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function zn(e){var t;e instanceof zn?(Kn(this,e.Ib),this.Ec=e.Ec,Wn(this,e.wb),Xn(this,e.Xc),this.Za=e.Za,Yn(this,e.g.clone()),this.pc=e.pc):e&&(t=String(e).match(Gn))?(Kn(this,t[1]||"",!0),this.Ec=Qn(t[2]||""),Wn(this,t[3]||"",!0),Xn(this,t[4]),this.Za=Qn(t[5]||"",!0),Yn(this,t[6]||"",!0),this.pc=Qn(t[7]||"")):this.g=new si(null)}function Kn(e,t,n){e.Ib=n?Qn(t,!0):t,e.Ib&&(e.Ib=e.Ib.replace(/:$/,""))}function Wn(e,t,n){e.wb=n?Qn(t,!0):t}function Xn(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Xc=t}else e.Xc=null}function Yn(e,t,n){t instanceof si?e.g=t:(n||(t=Jn(t,ii)),e.g=new si(t))}function Qn(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function Jn(e,t,n){return null!=e?(e=encodeURI(e).replace(t,Zn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Zn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(i=zn.prototype).Ib="",i.Ec="",i.wb="",i.Xc=null,i.Za="",i.pc="",i.toString=function(){var e=[],t=this.Ib;if(t&&e.push(Jn(t,ei,!0),":"),t=this.wb){e.push("//");var n=this.Ec;n&&e.push(Jn(n,ei,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Xc)&&e.push(":",String(t))}return(t=this.Za)&&(this.wb&&"/"!=t.charAt(0)&&e.push("/"),e.push(Jn(t,"/"==t.charAt(0)?ni:ti,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.pc)&&e.push("#",Jn(t,ri)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.Ib&&(t=new zn);var n=!!e.Ib;n?Kn(t,e.Ib):n=!!e.Ec,n?t.Ec=e.Ec:n=!!e.wb,n?Wn(t,e.wb):n=null!=e.Xc;var i=e.Za;if(n)Xn(t,e.Xc);else if(n=!!e.Za){if("/"!=i.charAt(0))if(this.wb&&!this.Za)i="/"+i;else{var r=t.Za.lastIndexOf("/");-1!=r&&(i=t.Za.substr(0,r+1)+i)}if(".."==i||"."==i)i="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var s=[],a=0;a<i.length;){var o=i[a++];"."==o?r&&a==i.length&&s.push(""):".."==o?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),r&&a==i.length&&s.push("")):(s.push(o),r=!0)}i=s.join("/")}}return n?t.Za=i:n=""!==e.g.toString(),n?Yn(t,e.g.clone()):n=!!e.pc,n&&(t.pc=e.pc),t},i.clone=function(){return new zn(this)};var ei=/[#\/\?@]/g,ti=/[#\?:]/g,ni=/[#\?]/g,ii=/[#\?@]/g,ri=/#/g;function si(e){this.g=e||null}function ai(e){if(!e.Sa&&(e.Sa=new Map,e.hd=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];s=decodeURIComponent(s.replace(/\+/g," ")),r=r||"",e.add(s,decodeURIComponent(r.replace(/\+/g," ")))}}function oi(e){return ai(e),e.hd}function li(){}function ui(e){return e=bt(me(e)),btoa(e)}function ci(e,t){return t=void 0==t||t,e=ui(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function di(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}function hi(t){for(var n=t.length/2,i=new Uint8Array(n),r=0;r<n;r++)i[r]=e.parseInt(t.substr(2*r,2),16);return i}function fi(e){var t=me(e);e="";for(var n=(t=c(t)).next();!n.done;n=t.next())1==(n=(n=n.value).toString(16)).length&&(n="0"+n),e+=n;return e}function pi(){for(var e=P.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var i=n=0;i<e.length;++i){var r=e[i];ArrayBuffer.isView(r)&&1===r.BYTES_PER_ELEMENT?t.set(r,n):t.set(me(r),n),n+=r.byteLength}return t}function gi(e,t,n){if(n=void 0===n?"":n,0==t.length)return e;if(1==e.length&&1==t.length){var i=new zn(e[0]);return t=new zn(t[0]),t=i.resolve(t),n&&Yn(t,n),[t.toString()]}t=t.map((function(e){return new zn(e)})),i=[];for(var r=(e=c(e)).next();!r.done;r=e.next()){r=new zn(r.value);for(var s=c(t),a=s.next();!a.done;a=s.next())a=r.resolve(a.value),n&&Yn(a,n),i.push(a.toString())}return i}function mi(e,t,n,i){return e={keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:n||[],keyIds:new Set},i&&(e.keySystemUris=new Set([i])),e}function yi(t,n){n=void 0===n?"cenc":n;var i=[],r=[],s=[];t.forEach((function(e,t){var n=t;22!=n.length&&(n=ci(hi(t),!1));var a=e;22!=a.length&&(a=ci(hi(e),!1)),e={kty:"oct",kid:n,k:a},i.push(e),r.push(e.kid),s.push(t)})),t=JSON.stringify({keys:i});var a=JSON.stringify({kids:r});return a=[{initData:me(yt(a)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:n,licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:a,keyIds:new Set(s)}}function vi(e,t){if(1==t.length)return t[0];if(null!=(e=bi(e,t)))return e;throw new Me(2,4,4025,t)}function bi(e,t){for(var n=Ei.get(e),i=(n=c(n)).next();!i.done;i=n.next()){i=i.value;for(var r=c(t),s=r.next();!s.done;s=r.next())if(s=s.value,i.test(s.trim()))return s.trim()}return e==Si?"":null}function Ti(e,t){for(var n=[],i=(e=c(e=Ei.get(e))).next();!i.done;i=e.next()){i=i.value;for(var r=c(t),s=r.next();!s.done;s=r.next())s=s.value,i.test(s.trim())&&n.push(s.trim())}return n}(i=si.prototype).Sa=null,i.hd=null,i.add=function(e,t){ai(this),this.g=null;var n=this.Sa.has(e)?this.Sa.get(e):null;return n||this.Sa.set(e,n=[]),n.push(t),this.hd++,this},i.set=function(e,t){return ai(this),this.g=null,this.Sa.has(e)?this.Sa.set(e,[t]):this.add(e,t),this},i.get=function(e){return ai(this),this.Sa.get(e)||[]},i.toString=function(){if(this.g)return this.g;if(!this.Sa||!this.Sa.size)return"";for(var e=[],t=c(this.Sa.keys()),n=t.next();!n.done;n=t.next()){var i=n.value;n=encodeURIComponent(i),i=this.Sa.get(i);for(var r=0;r<i.length;r++){var s=n;""!==i[r]&&(s+="="+encodeURIComponent(i[r])),e.push(s)}}return this.g=e.join("&")},i.clone=function(){var e=new si;if(e.g=this.g,this.Sa){for(var t=new Map,n=c(this.Sa),i=n.next();!i.done;i=n.next()){var r=c(i.value);i=r.next().value,r=r.next().value,t.set(i,r.concat())}e.Sa=t,e.hd=this.hd}return e},$("shaka.util.Uint8ArrayUtils",li),li.concat=pi,li.toHex=fi,li.fromHex=hi,li.fromBase64=di,li.toBase64=ci,li.toStandardBase64=ui;var Si="text",_i={la:"video",U:"audio",xa:Si,Re:"image",Aj:"application"},wi=1/15,Ei=(new Map).set("audio",[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4/,/^dts[cex]$/,/^iamf/,/^mhm[12]/]).set("video",[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/]).set("text",[/^vtt$/,/^wvtt/,/^stpp/]);function ki(){}function xi(e,t){var n=e;return t&&!Fi.includes(e)&&(n+='; codecs="'+t+'"'),n}function Ai(e,t){return t&&(e+='; codecs="'+t+'"'),e}function Ci(e,t,n){var i=xi(e,t);return Bn(t=Ai(e,t))?(e=Bn(t))?(n=(e=e()).convertCodecs(n,t),e.destroy()):n=t:n="video/mp2t"!=e&&"audio"==n?i.replace("video","audio"):i,n}function Ii(e,t,n){var i=[t];return Ui.forEach((function(t,r){var s=e[r];"codecs"==r?Fi.includes(e.mimeType)||i.push('codecs="'+n+'"'):s&&i.push(t+'="'+s+'"')})),"PQ"==e.hdr&&i.push('eotf="smpte2084"'),i.join(";")}function Li(e){return e.split(";")[0].split("/")[1]}function Di(e){var t=Ni(e);switch(e=t[0],t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:case"mp4a"===e&&"40.34"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:return"ac-3";case"mp4a"===e&&"a6"===t:return"ec-3";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"vp09"===e:return"vp9";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"vvc1"===e:case"vvi1"===e:return"vvc";case"dvh1"===e:case"dvhe"===e:return t&&t.startsWith("05")?"dovi-p5":"dovi-hevc";case"dvav"===e:case"dva1"===e:return"dovi-avc";case"dav1"===e:return"dovi-av1";case"dvc1"===e:case"dvi1"===e:return"dovi-vvc"}return e}function Ri(e){for(var t=[],n=(e=c(e.split(","))).next();!n.done;n=e.next())n=Ni(n.value),t.push(n[0]);return t.sort().join(",")}function Mi(e){return e.split(";")[0]}function Pi(e){return(e=e.split(/ *; */)).shift(),(e=e.find((function(e){return e.startsWith("codecs=")})))?e.split("=")[1].replace(/^"|"$/g,""):""}function Oi(e){return"application/x-mpegurl"===e||"application/vnd.apple.mpegurl"===e}function Ni(e){var t=(e=e.split("."))[0];return e.shift(),[t,e.join(".")]}$("shaka.util.MimeUtils",ki),ki.getFullTypeWithAllCodecs=Ai,ki.getFullType=xi;var Ui=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),Fi=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function Bi(e){this.i=null,this.j=e,this.B=!1,this.l=this.s=0,this.m=1/0,this.h=this.g=null,this.C="",this.A=function(){},this.o=new Map}function ji(e,t){Gi.set(e,t)}function $i(e){return Gi.get(e)}function Vi(e){return!!Gi.has(e)||("application/cea-608"==e||"application/cea-708"==e)&&!!ke}function Hi(e,t,n){if(e.C=t,t=e.o.get(t))for(var i=c(t.keys()),r=i.next();!r.done;r=i.next())(r=t.get(r.value).filter((function(e){return e.endTime<=n})))&&e.j.append(r)}function qi(e,t,n){t.startTime+=n,t.endTime+=n;for(var i=(t=c(t.nestedCues)).next();!i.done;i=t.next())qi(e,i.value,n)}Bi.prototype.destroy=function(){return this.j=this.i=null,this.o.clear(),Promise.resolve()},Bi.prototype.remove=function(e,t){var n=this;return M((function(i){if(1==i.g)return S(i,Promise.resolve(),2);!n.j||!n.j.remove(e,t)||null==n.g||t<=n.g||e>=n.h||(e<=n.g&&t>=n.h?n.g=n.h=null:e<=n.g&&t<n.h?n.g=t:e>n.g&&t>=n.h&&(n.h=e)),_(i)}))},$("shaka.text.TextEngine",Bi),Bi.prototype.destroy=Bi.prototype.destroy,Bi.findParser=$i,Bi.unregisterParser=function(e){Gi.delete(e)},Bi.registerParser=ji;var Gi=new Map;function zi(e,t){return e.concat(t)}function Ki(){}function Wi(e){return null!=e}function Xi(e,t){return Promise.race([t,new Promise((function(t,n){new Ve(n).aa(e)}))])}function Yi(){}function Qi(e,t){return e=er(e),t=er(t),e.split("-")[0]==t.split("-")[0]}function Ji(e,t){return e=er(e),t=er(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&1==e.length&&2==t.length}function Zi(e,t){return e=er(e),t=er(t),e=e.split("-"),t=t.split("-"),2==e.length&&2==t.length&&e[0]==t[0]}function er(e){var t=(e=c(e.split("-x-"))).next().value;t=void 0===t?"":t,e=void 0===(e=e.next().value)?"":e;var n=c(t.split("-"));return t=void 0===(t=n.next().value)?"":t,n=void 0===(n=n.next().value)?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=sr.get(t)||t,((n=n.toUpperCase())?t+"-"+n:t)+(e?"-"+e:"")}function tr(e,t){return e=er(e),(t=er(t))==e?4:Ji(t,e)?3:Zi(t,e)?2:Ji(e,t)?1:0}function nr(e){var t=e.indexOf("-");return e=(e=0<=t?e.substring(0,t):e).toLowerCase(),sr.get(e)||e}function ir(e){return e.language?er(e.language):e.audio&&e.audio.language?er(e.audio.language):e.video&&e.video.language?er(e.video.language):"und"}function rr(e,t){e=er(e);for(var n=new Set,i=(t=c(t)).next();!i.done;i=t.next())n.add(er(i.value));for(i=(t=c(n)).next();!i.done;i=t.next())if((i=i.value)==e)return i;for(i=(t=c(n)).next();!i.done;i=t.next())if(Ji(i=i.value,e))return i;for(i=(t=c(n)).next();!i.done;i=t.next())if(Zi(i=i.value,e))return i;for(t=(n=c(n)).next();!t.done;t=n.next())if(Ji(e,t=t.value))return t;return null}$("shaka.util.LanguageUtils",Yi),Yi.findClosestLocale=rr,Yi.getLocaleForVariant=ir,Yi.getLocaleForText=function(e){return er(e.language||"und")},Yi.getBase=nr,Yi.relatedness=tr,Yi.areSiblings=function(e,t){var n=nr(e),i=nr(t);return e!=n&&t!=i&&n==i},Yi.normalize=er,Yi.isSiblingOf=Zi,Yi.isParentOf=Ji,Yi.areLanguageCompatible=Qi,Yi.areLocaleCompatible=function(e,t){return(e=er(e))==(t=er(t))};var sr=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function ar(){}function or(e,t,n,i,r){if(r.length){for(var s=e.textStreams,a=(r=c(r)).next(),o={};!a.done;o={jg:void 0},a=r.next())if(o.jg=a.value,(a=s.filter(function(e){return function(t){return!(!t.codecs.startsWith(e.jg)&&!t.mimeType.startsWith(e.jg))}}(o))).length){s=a;break}e.textStreams=s}if(s=e.variants,(t.length||n.length)&&(s=function(e,t,n){for(var i=(t=c(t)).next(),r={};!i.done;r={Dh:void 0},i=t.next())if(r.Dh=i.value,i=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.Dh)}}(r)),i.length){e=i;break}for(n=c(n),t=n.next(),i={};!t.done;i={wg:void 0},t=n.next())if(i.wg=t.value,t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.wg)}}(i)),t.length){e=t;break}return e}(s,t,n)),i.length){for(t=new Z,s=(n=c(s)).next();!s.done;s=n.next())s=s.value,t.push(String(s.video.width||0),s);var l=[];t.forEach((function(e,t){e=0;for(var n=[],r=(t=c(t)).next(),s={};!r.done;s={Ke:void 0},r=t.next())s.Ke=r.value,(r=i.filter(function(e){return function(t){return e.Ke.decodingInfos[0][t]}}(s)).length)>e?(e=r,n=[s.Ke]):r==e&&n.push(s.Ke);l.push.apply(l,d(n))})),s=l}for(n=new Set,t=new Set,r=(s=c(s)).next();!r.done;r=s.next())(r=r.value).audio&&n.add(r.audio),r.video&&t.add(r.video);s=Array.from(n).sort((function(e,t){return e.bandwidth-t.bandwidth}));var u=[];for(n=new Map,r=(s=c(s)).next();!r.done;r=s.next()){if(a=(r=r.value).language+(r.channelsCount||0)+(r.audioSamplingRate||0)+r.roles.join(",")+r.label+r.groupId+r.fastSwitching,(o=n.get(a)||[]).length){var h=o[o.length-1],f=Di(h.codecs),p=Di(r.codecs);f!=p||r.bandwidth&&h.bandwidth&&!(r.bandwidth>h.bandwidth)||(o.push(r),u.push(r.id))}else o.push(r),u.push(r.id);n.set(a,o)}var g={vp8:1,avc:1,"dovi-avc":.95,vp9:.9,vp09:.9,hevc:.85,"dovi-hevc":.8,"dovi-p5":.75,av01:.7,"dovi-av1":.65,vvc:.6};s=Array.from(t).sort((function(e,t){if(!e.bandwidth||!t.bandwidth||e.bandwidth==t.bandwidth){if(e.codecs&&t.codecs&&e.codecs!=t.codecs&&e.width==t.width){var n=Di(e.codecs),i=Di(t.codecs);if(n!=i)return(g[n]||1)-(g[i]||1)}return e.width-t.width}return e.bandwidth-t.bandwidth})),t=re();var m=[];for(n=new Map,r=(s=c(s)).next();!r.done;r=s.next()){if(r=r.value,a=Math.round(r.frameRate||0)+(r.hdr||"")+r.fastSwitching,(o=n.get(a)||[]).length){if(h=o[o.length-1],!t&&(f=Di(h.codecs))!==(p=Di(r.codecs)))continue;r.width==h.width&&r.height==h.height?(f=Di(h.codecs))!=(p=Di(r.codecs))||r.bandwidth&&h.bandwidth&&!(r.bandwidth>h.bandwidth)||(o.push(r),m.push(r.id)):(r.width>h.width||r.height>h.height||r.bandwidth>h.bandwidth)&&(o.push(r),m.push(r.id))}else o.push(r),m.push(r.id);n.set(a,o)}e.variants=e.variants.filter((function(e){var t=e.audio;return e=e.video,!(t&&!u.includes(t.id)||e&&!m.includes(e.id))}))}function lr(e,t,n){function i(e,t,n){return e>=t&&e<=n}var r=e.video;if(r&&r.width&&r.height){var s=r.width,a=r.height;if(a>s&&(s=(a=c([a,s])).next().value,a=a.next().value),!i(s,t.minWidth,Math.min(t.maxWidth,n.width))||!i(a,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||e&&e.audio&&e.audio.channelsCount&&!i(e.audio.channelsCount,t.minChannelsCount,t.maxChannelsCount)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function ur(e,t,n,i){return n=void 0===n?[]:n,i=void 0===i?{}:i,M((function(r){return 1==r.g?S(r,cr(e,t,0<t.offlineSessionIds.length,n,i),2):(function(e){e.textStreams=e.textStreams.filter((function(e){return Vi(e=xi(e.mimeType,e.codecs))}))}(t),S(r,function(e){var t,n,i,r,s,a,o;return M((function(l){switch(l.g){case 1:t=[],n=c(e.imageStreams),i=n.next();case 2:if(i.done){l.u(4);break}if(r=i.value,"application/mp4"==(s=r.mimeType)&&"mjpg"==r.codecs&&(s="image/jpg"),Rr.has(s)){l.u(5);break}if(!(a=Mr.get(s))){Rr.set(s,!1),l.u(5);break}return S(l,function(e){return new Promise((function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then((function(){t(!0)})).catch((function(){t(!1)})):n.onload=n.onerror=function(){t(2===n.height)}}))}(a),7);case 7:o=l.h,Rr.set(s,o);case 5:Rr.get(s)&&t.push(r),i=n.next(),l.u(2);break;case 4:e.imageStreams=t,_(l)}}))}(t),0))}))}function cr(e,t,n,i,r){var s,a;return M((function(o){if(1==o.g)return ze()&&function(e){for(var t=(new Map).set("dvav","avc3").set("dva1","avc1").set("dvhe","hev1").set("dvh1","hvc1").set("dvc1","vvc1").set("dvi1","vvi1"),n=new Set,i=(e=c(e)).next();!i.done;i=e.next())(i=i.value).video&&n.add(i.video);for(n=c(n),e=n.next();!e.done;e=n.next()){e=e.value;for(var r=(i=c(t)).next();!r.done;r=i.next()){var s=c(r.value);if(r=s.next().value,s=s.next().value,e.codecs.includes(r)){e.codecs=e.codecs.replace(r,s);break}}}}(t.variants),S(o,fr(t.variants,n,!1,i),2);s=null,e&&(a=e.h)&&(s=a.keySystem),t.variants=t.variants.filter((function(e){var t=function(e,t,n){if(!e.decodingInfos.some((function(e){return!(!e.supported||t&&(e=e.keySystemAccess)&&(n[e.keySystem]||e.keySystem)!=t)})))return!1;var i=ze(),r=ot("Firefox")&&rt(),s=e.video,a=s&&s.width||0,o=s&&s.height||0;return!(i&&s&&(1920<a||1080<o)&&(s.codecs.includes("avc1.")||s.codecs.includes("avc3.")))&&(e=e.audio,!(r&&e&&e.encrypted&&e.codecs.toLowerCase().includes("opus")))}(e,s,r);if(!t){var n=[];e.audio&&n.push(Ir(e.audio)),e.video&&n.push(Ir(e.video))}return t})),_(o)}))}function dr(e,t){var n,i,r,s,a,o,l;return M((function(u){if(1==u.g){for(n=function(e,t){if(e){var n=Lt(e);return n.supported=e.supported&&t.supported,n.powerEfficient=e.powerEfficient&&t.powerEfficient,n.smooth=e.smooth&&t.smooth,t.keySystemAccess&&!n.keySystemAccess&&(n.keySystemAccess=t.keySystemAccess),n}return t},i=null,r=[],s=c(t),a=s.next(),o={};!a.done;o={cache:void 0,Od:void 0},a=s.next())l=a.value,o.Od=Dt(l),o.cache=Lr,o.cache.has(o.Od)?i=n(i,o.cache.get(o.Od)):r.push(hr(l).then(function(e){return function(t){for(var r=null,s=(t=c(t||[])).next();!s.done;s=t.next())r=n(r,s.value);r&&(e.cache.set(e.Od,r),i=n(i,r))}}(o)));return S(u,Promise.all(r),2)}i&&e.decodingInfos.push(i),_(u)}))}function hr(e){var t=[""];e.video&&(t=Pi(e.video.contentType).split(","));var n=[""];e.audio&&(n=Pi(e.audio.contentType).split(","));for(var i=[],r=(t=c(t)).next();!r.done;r=t.next()){r=r.value;for(var s=c(n),a=s.next(),o={};!a.done;o={oc:void 0},a=s.next())a=a.value,o.oc=It(e),e.video&&(o.oc.video.contentType=xi(Mi(o.oc.video.contentType),r)),e.audio&&(o.oc.audio.contentType=xi(Mi(o.oc.audio.contentType),a)),i.push(new Promise(function(e){return function(t,n){(rt()?Xi(5,navigator.mediaCapabilities.decodingInfo(e.oc)):navigator.mediaCapabilities.decodingInfo(e.oc)).then((function(e){t(e)})).catch(n)}}(o)))}return Promise.all(i).catch((function(){return JSON.stringify(e),null}))}function fr(e,t,n,i){var r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,_,w;return M((function(E){switch(E.g){case 1:if(e.some((function(e){return e.decodingInfos.length})))return E.return();r=c(i),s=r.next(),a={};case 2:if(s.done){E.u(4);break}a.eh=s.value,o=!1,l=c(e),u=l.next();case 5:if(u.done){E.u(7);break}d=u.value,h=pr(d,t,n).filter((k=a,function(e){return((e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)===k.eh})),f=c(h),p=f.next();case 8:if(p.done){E.u(10);break}return g=p.value,S(E,dr(d,g),9);case 9:p=f.next(),E.u(8);break;case 10:d.decodingInfos.length&&(o=!0),u=l.next(),E.u(5);break;case 7:if(o)return E.return();a={eh:void 0},s=r.next(),E.u(2);break;case 4:m=c(e),y=m.next();case 12:if(y.done){E.u(0);break}v=y.value,b=pr(v,t,n).filter((function(e){return!(e=(e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)||!i.includes(e)})),T=c(b),_=T.next();case 15:if(_.done){y=m.next(),E.u(12);break}return w=_.value,S(E,dr(v,w),16);case 16:_=T.next(),E.u(15)}var k}))}function pr(e,t,n){var i=e.audio,r=e.video,s=[],a=[];if(r)for(var o=c(r.fullMimeTypes),l=o.next();!l.done;l=o.next()){var u=Pi(l=l.value);if(u.includes(",")&&!i){var d=u.split(","),h=Mi(l);u=vi("video",d),h=Ci(h,d=gr(d=vi("audio",d),h),"audio"),a.push({contentType:h,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(u=mr(u),l={contentType:Ci(Mi(l),u,"video"),width:r.width||64,height:r.height||64,bitrate:r.bandwidth||e.bandwidth||1,framerate:r.frameRate||1},r.hdr)switch(r.hdr){case"SDR":l.transferFunction="srgb";break;case"PQ":l.transferFunction="pq";break;case"HLG":l.transferFunction="hlg"}r.colorGamut&&(l.colorGamut=r.colorGamut),s.push(l)}if(i)for(l=(o=c(i.fullMimeTypes)).next();!l.done;l=o.next())l=Ci(l=Mi(u=l.value),u=gr(Pi(u),l),"audio"),a.push({contentType:l,channels:i.channelsCount||2,bitrate:i.bandwidth||e.bandwidth||1,samplerate:i.audioSamplingRate||1,spatialRendering:i.spatialAudio});for(o=[],0==s.length&&s.push(null),0==a.length&&a.push(null),l=(s=c(s)).next();!l.done;l=s.next())for(l=l.value,h=(u=c(a)).next();!h.done;h=u.next())h=h.value,d={type:n?"file":"media-source"},l&&(d.video=l),h&&(d.audio=h),o.push(d);if(!(a=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])).length)return[o];for(e=[],n=new Map,s=(a=c(a)).next();!s.done;s=a.next())s=s.value,n.get(s.keySystem)||n.set(s.keySystem,[]),n.get(s.keySystem).push(s);for(a=t?"required":"optional",t=t?["persistent-license"]:["temporary"],l=(s=c(n.keys())).next();!l.done;l=s.next()){for(l=l.value,h=n.get(l),u=new Map,d=(h=c(h)).next();!d.done;d=h.next()){var f=(d=d.value).videoRobustness+","+d.audioRobustness;u.get(f)||u.set(f,[]),u.get(f).push(d)}for(h=(u=c(u.values())).next();!h.done;h=u.next()){h=h.value,d=[];for(var p=(f=c(o)).next();!p.done;p=f.next()){p=Object.assign({},p.value);for(var g={keySystem:l,initDataType:"cenc",persistentState:a,distinctiveIdentifier:"optional",sessionTypes:t},m=c(h),y=m.next();!y.done;y=m.next()){if((y=y.value).initData&&y.initData.length){for(var v=new Set,b=c(y.initData),T=b.next();!T.done;T=b.next())v.add(T.value.initDataType);g.initDataType=y.initData[0].initDataType}y.distinctiveIdentifierRequired&&(g.distinctiveIdentifier="required"),y.persistentStateRequired&&(g.persistentState="required"),y.sessionType&&(g.sessionTypes=[y.sessionType]),i&&(g.audio?(y.encryptionScheme&&(g.audio.encryptionScheme=g.audio.encryptionScheme||y.encryptionScheme),g.audio.robustness=g.audio.robustness||y.audioRobustness):(g.audio={robustness:y.audioRobustness},y.encryptionScheme&&(g.audio.encryptionScheme=y.encryptionScheme)),""==g.audio.robustness&&delete g.audio.robustness),r&&(g.video?(y.encryptionScheme&&(g.video.encryptionScheme=g.video.encryptionScheme||y.encryptionScheme),g.video.robustness=g.video.robustness||y.videoRobustness):(g.video={robustness:y.videoRobustness},y.encryptionScheme&&(g.video.encryptionScheme=y.encryptionScheme)),""==g.video.robustness&&delete g.video.robustness)}p.keySystemConfiguration=g,d.push(p)}e.push(d)}}return e}function gr(e,t){return"flac"==e.toLowerCase()?Je()?"fLaC":"flac":"opus"===e.toLowerCase()?Je()&&"mp4"==Li(t)?"Opus":"opus":"ac-3"==e.toLowerCase()&&We()?"ec-3":e}function mr(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",(e+=parseInt(t.shift(),10).toString(16))+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e}function yr(e){var t=e.audio,n=e.video,i=t?t.mimeType:null,r=n?n.mimeType:null,s=t?t.codecs:null,a=n?n.codecs:null,o=[];a&&o.push(a),s&&o.push(s);var l=[];n&&l.push(n.mimeType),t&&l.push(t.mimeType),l=l[0]||null;var u=[];t&&u.push(t.kind),n&&u.push(n.kind),u=u[0]||null;var d=new Set;if(t)for(var h=c(t.roles),f=h.next();!f.done;f=h.next())d.add(f.value);if(n)for(f=(h=c(n.roles)).next();!f.done;f=h.next())d.add(f.value);if(e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:u,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:l,audioMimeType:i,videoMimeType:r,codecs:o.join(", "),audioCodec:s,videoCodec:a,primary:e.primary,roles:Array.from(d),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.colorGamut=n.colorGamut||null,e.videoLayout=n.videoLayout||null,a.includes(","))){e.channelsCount=n.channelsCount,e.audioSamplingRate=n.audioSamplingRate,e.spatialAudio=n.spatialAudio,e.originalLanguage=n.originalLanguage,e.audioMimeType=r,n=a.split(",");try{e.videoCodec=vi("video",n),e.audioCodec=vi("audio",n)}catch(p){}}return t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage),e}function vr(e){return{id:e.id,active:!1,type:Si,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null,accessibilityPurpose:e.accessibilityPurpose,originalLanguage:e.originalLanguage}}function br(e){var t=e.width||null,n=e.height||null,i=null;e.segmentIndex&&(i=fl(e.segmentIndex));var r=e.tilesLayout;return i&&(r=i.tilesLayout||r),r&&null!=t&&(t/=Number(r.split("x")[0])),r&&null!=n&&(n/=Number(r.split("x")[1])),{id:e.id,active:!1,type:"image",bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:t,height:n,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:r||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId,accessibilityPurpose:null,originalLanguage:null}}function Tr(e){return e.__shaka_id||(e.__shaka_id=Dr++),e.__shaka_id}function Sr(e){var t=wr(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="unknown"),"subtitles"==e.kind&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),"forced"==e.kind&&(t.forced=!0),t}function _r(e){var t=wr(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t}function wr(e){var t=e.language;return{id:Tr(e),active:!1,type:"",bandwidth:0,language:er(t||"und"),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:t}}function Er(e){return e.allowedByApplication&&e.allowedByKeySystem&&0==e.disabledUntilTime}function kr(e){return e.filter((function(e){return Er(e)}))}function xr(e,t,n,i){var r=e,s=e.filter((function(e){return e.primary}));s.length&&(r=s);var a=r.length?r[0].language:"";if(r=r.filter((function(e){return e.language==a})),t){var o=rr(er(t),e.map((function(e){return e.language})));o&&(r=e.filter((function(e){return er(e.language)==o})))}if(r=r.filter((function(e){return e.forced==i})),n){if((e=Ar(r,n)).length)return e}else if(e=r.filter((function(e){return 0==e.roles.length})),e.length)return e;return e=r.map((function(e){return e.roles})).reduce(zi,[]),e.length?Ar(r,e[0]):r}function Ar(e,t){return e.filter((function(e){return e.roles.includes(t)}))}function Cr(e,t){t.length&&(t=t.filter((function(t){return Di(e.codecs)==Di(t.codecs)})).sort((function(e,t){return e.bandwidth&&t.bandwidth&&e.bandwidth!=t.bandwidth?e.bandwidth-t.bandwidth:(e.width||0)-(t.width||0)})),e.trickModeVideo=t[0],1<t.length&&(t=t.find((function(t){return e.width==t.width&&e.height==t.height}))))&&(e.trickModeVideo=t)}function Ir(e){return"audio"==e.type?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:"video"==e.type?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}$("shaka.util.StreamUtils",ar),ar.meetsRestrictions=lr;var Lr=new Map,Dr=0,Rr=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),Mr=(new Map).set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function Pr(){var t=this;this.G=null,this.o=!1,this.m=new z,this.j=new ee,navigator.connection&&navigator.connection.addEventListener&&this.j.D(navigator.connection,"change",(function(){if(t.o&&t.g.useNetworkInformation){t.m=new z,t.g&&t.m.configure(t.g.advanced);var e=t.chooseVariant();e&&navigator.onLine&&t.G(e,t.g.clearBufferSwitch,t.g.safeMarginSwitch)}})),this.F=[],this.H=1,this.I=!1,this.h=this.l=this.g=this.s=null,this.A=new Ve((function(){if(t.o&&(t.g.restrictToElementSize||t.g.restrictToScreenSize)){var e=t.chooseVariant();e&&t.G(e,t.g.clearBufferSwitch,t.g.safeMarginSwitch)}})),this.B=e,"documentPictureInPicture"in e&&this.j.D(e.documentPictureInPicture,"enter",(function(){t.B=e.documentPictureInPicture.window,t.A&&t.A.rb(),t.j.ma(t.B,"pagehide",(function(){t.B=e,t.A&&t.A.rb()}))})),this.C=this.i=null}function Or(e){if(!e.I){var t=e.m;if(!(t.g>=t.i))return;e.I=!0,e.s-=1e3*(e.g.switchInterval-e.g.minTimeToSwitch)}Date.now()-e.s<1e3*e.g.switchInterval||(t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.G(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch))}function Nr(e,t,n,i,r){if(e.C){var s=e.C.Ng();s&&(n=n.filter((function(e){return!e.bandwidth||!s||e.bandwidth<=s})))}return t&&(n=n.filter((function(e){return lr(e,t,{width:r,height:i})}))),n.sort((function(e,t){return e.bandwidth-t.bandwidth}))}(i=Pr.prototype).stop=function(){this.G=null,this.o=!1,this.F=[],this.H=1,this.l=this.s=null,this.h&&(this.h.disconnect(),this.h=null),this.A.stop(),this.C=this.i=null},i.release=function(){this.j.release(),this.A=null},i.init=function(e){this.G=e},i.chooseVariant=function(){var e=1/0,t=1/0;if(this.g.restrictToScreenSize){var n=this.g.ignoreDevicePixelRatio?1:this.B.devicePixelRatio;e=this.B.screen.height*n,t=this.B.screen.width*n}if(this.h&&this.g.restrictToElementSize){n=this.g.ignoreDevicePixelRatio?1:this.B.devicePixelRatio;var i=this.l.clientHeight,r=this.l.clientWidth;this.i&&document.pictureInPictureElement&&document.pictureInPictureElement==this.l&&(i=this.i.height,r=this.i.width),e=Math.min(e,i*n),t=Math.min(t,r*n)}if((n=this.F.filter((function(e){return e&&!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)}))).length||(n=this.F),i=n,n.length!=this.F.length&&(i=this.F.filter((function(e){return e&&!!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)}))),n=Nr(this,this.g.restrictions,i,1/0,1/0),1/0!=e||1/0!=t){for(n=function(e){for(var t=[],n=(e=c(e)).next();!n.done;n=e.next())(n=n.value.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort((function(e,t){return e.width-t.width}))}(n),r=(n=c(n)).next();!r.done;r=n.next())if((r=r.value).height>=e&&r.width>=t){e=r.height,t=r.width;break}n=Nr(this,this.g.restrictions,i,e,t)}for(e=this.getBandwidthEstimate(),i.length&&!n.length&&(n=[(n=Nr(this,null,i,1/0,1/0))[0]]),t=n[0]||null,i=0;i<n.length;i++){r=n[i];for(var s=isNaN(this.H)?1:Math.abs(this.H),a=s*r.bandwidth/this.g.bandwidthDowngradeTarget,o={bandwidth:1/0},l=i+1;l<n.length;l++)if(r.bandwidth!=n[l].bandwidth){o=n[l];break}s=s*o.bandwidth/this.g.bandwidthUpgradeTarget,e>=a&&e<=s&&(t.bandwidth!=r.bandwidth||t.bandwidth==r.bandwidth&&t.video&&r.video&&(t.video.width<r.video.width||t.video.height<r.video.height))&&(t=r)}return this.s=Date.now(),t},i.enable=function(){this.o=!0},i.disable=function(){this.o=!1},i.segmentDownloaded=function(e,t,n){e<this.g.cacheLoadThreshold||(this.m.sample(e,t),n&&null!=this.s&&this.o&&Or(this))},i.trySuggestStreams=function(){null!=this.s&&this.o&&Or(this)},i.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=1e6*navigator.connection.downlink),navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&this.g.preferNetworkInformationBandwidth?e:(e=this.m.getBandwidthEstimate(e),this.C?this.C.getBandwidthEstimate(e):e)},i.setVariants=function(e){this.F=e},i.playbackRateChanged=function(e){this.H=e},i.setMediaElement=function(t){function n(){i.A.aa(Ur)}var i=this;this.l=t,this.h&&(this.h.disconnect(),this.h=null),this.l&&"ResizeObserver"in e&&(this.h=new ResizeObserver(n),this.h.observe(this.l)),this.j.D(t,"enterpictureinpicture",(function(e){e.pictureInPictureWindow&&(i.i=e.pictureInPictureWindow,i.j.D(i.i,"resize",n))})),this.j.D(t,"leavepictureinpicture",(function(){i.i&&i.j.bb(i.i,"resize",n),i.i=null}))},i.setCmsdManager=function(e){this.C=e},i.configure=function(e){this.g=e,this.m&&this.g&&this.m.configure(this.g.advanced)},$("shaka.abr.SimpleAbrManager",Pr),Pr.prototype.configure=Pr.prototype.configure,Pr.prototype.setCmsdManager=Pr.prototype.setCmsdManager,Pr.prototype.setMediaElement=Pr.prototype.setMediaElement,Pr.prototype.playbackRateChanged=Pr.prototype.playbackRateChanged,Pr.prototype.setVariants=Pr.prototype.setVariants,Pr.prototype.getBandwidthEstimate=Pr.prototype.getBandwidthEstimate,Pr.prototype.trySuggestStreams=Pr.prototype.trySuggestStreams,Pr.prototype.segmentDownloaded=Pr.prototype.segmentDownloaded,Pr.prototype.disable=Pr.prototype.disable,Pr.prototype.enable=Pr.prototype.enable,Pr.prototype.chooseVariant=Pr.prototype.chooseVariant,Pr.prototype.init=Pr.prototype.init,Pr.prototype.release=Pr.prototype.release,Pr.prototype.stop=Pr.prototype.stop;var Ur=1;function Fr(e,t){var n={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4};this.l=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.j=null==e.baseDelay?n.baseDelay:e.baseDelay,this.o=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.m=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function Br(e){var t,n;return M((function(i){if(1==i.g){if(e.g>=e.l){if(!e.i)throw new Me(2,7,1010);e.g=1,e.h=e.j}return t=e.g,e.g++,0==t?i.return():(n=e.h*(1+(2*Math.random()-1)*e.o),S(i,new Promise((function(e){new Ve(e).aa(n/1e3)})),2))}e.h*=e.m,_(i)}))}function jr(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n}function $r(e,t){this.promise=e,this.i=t,this.g=null}function Vr(e){return new $r(Promise.reject(e),(function(){return Promise.resolve()}))}function Hr(){var e=Promise.reject(new Me(2,7,7001));return e.catch((function(){})),new $r(e,(function(){return Promise.resolve()}))}function qr(e){return new $r(Promise.resolve(e),(function(){return Promise.resolve()}))}function Gr(e){return new $r(e,(function(){return e.catch((function(){}))}))}function zr(e){return new $r(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))}function Kr(t,n){if(n)if(n instanceof Map)for(var i=c(n.keys()),r=i.next();!r.done;r=i.next())r=r.value,Object.defineProperty(this,r,{value:n.get(r),writable:!0,enumerable:!0});else for(i in n)Object.defineProperty(this,i,{value:n[i],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function Wr(e){var t,n=new Kr(e.type);for(t in e)Object.defineProperty(n,t,{value:e[t],writable:!0,enumerable:!0});return n}$("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),jr.prototype.resolve=function(){},jr.prototype.reject=function(){},$r.prototype.abort=function(){return this.g||(this.g=this.i()),this.g},$r.prototype.finally=function(e){return this.promise.then((function(){return e(!0)}),(function(){return e(!1)})),this},$r.prototype.Ea=function(e,t){function n(n){return function(o){if(r.g&&n)s.reject(a);else{var l=n?e:t;l?i=function(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then((function(){}),(function(){}))})}catch(r){return n.reject(r),function(){return Promise.resolve()}}}(l,o,s):(n?s.resolve:s.reject)(o)}}}function i(){return s.reject(a),r.abort()}var r=this,s=new jr;s.catch((function(){}));var a=new Me(2,7,7001);return this.promise.then(n(!0),n(!1)),new $r(s,(function(){return i()}))},o.Object.defineProperties($r.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return null!==this.g}}}),$("shaka.util.AbortableOperation",$r),$r.prototype.chain=$r.prototype.Ea,$r.prototype.finally=$r.prototype.finally,$r.all=zr,$r.prototype.abort=$r.prototype.abort,$r.notAbortable=Gr,$r.completed=qr,$r.aborted=Hr,$r.failed=Vr,Kr.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Kr.prototype.stopImmediatePropagation=function(){this.g=!0},Kr.prototype.stopPropagation=function(){},$("shaka.util.FakeEvent",Kr);var Xr={Cj:"abrstatuschanged",Dj:"adaptation",Ej:"audiotrackchanged",Fj:"buffering",Gj:"complete",Hj:"downloadcompleted",Ij:"downloadfailed",Jj:"downloadheadersreceived",Kj:"drmsessionupdate",Mj:"emsg",fk:"prft",Error:"error",Nj:"expirationupdated",Oj:"firstquartile",Pj:"gapjumped",Sj:"keystatuschanged",Wj:"loaded",Xj:"loading",Zj:"manifestparsed",$j:"manifestupdated",ak:"mediaqualitychanged",bk:"mediasourcerecovered",Metadata:"metadata",ck:"midpoint",dk:"nospatialvideoinfo",ek:"onstatechange",gk:"ratechange",ik:"segmentappended",jk:"sessiondata",kk:"spatialvideoinfo",lk:"stalldetected",mk:"started",nk:"statechanged",pk:"streaming",qk:"textchanged",rk:"texttrackvisibility",sk:"thirdquartile",tk:"timelineregionadded",uk:"timelineregionenter",vk:"timelineregionexit",wk:"trackschanged",yk:"unloading",Ak:"variantchanged"};function Yr(){this.Ca=new Z,this.ze=this}function Qr(){this.g=[]}function Jr(e,t){e.g.push(t.finally((function(){Le(e.g,t)})))}function Zr(e,t,n,i,r,s,a){Yr.call(this),this.i=!1,this.s=new Qr,this.g=new Set,this.h=new Set,this.m=e||null,this.l=t||null,this.C=n||null,this.F=i||null,this.G=r||null,this.I=s||null,this.H=a||null,this.A=this.B=!1,this.o=16e3,this.j=new Map}function es(e,t,n,i){i=void 0!==i&&i,n=n||ls;var r=us.get(e);(!r||n>=r.priority)&&us.set(e,{priority:n,oe:t,Xi:i})}function ts(e,t){for(var n=c(e.g),i=n.next();!i.done;i=n.next())t.g.add(i.value);for(n=(e=c(e.h)).next();!n.done;n=e.next())t.h.add(n.value)}function ns(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===n?null:n}}function is(e,t,n,i,r,s,a,o){e.B&&(n.uris[s]=n.uris[s].replace("https://","http://")),e.A&&(n.uris[s]=n.uris[s].replace("http://","https://")),0<s&&e.I&&e.I(t,i,n.uris[s],n.uris[s-1]);var l=new zn(n.uris[s]),u=l.Ib,c=!1;u||(Kn(l,u=(u=location.protocol).slice(0,-1)),n.uris[s]=l.toString()),u=u.toLowerCase();var d=(u=us.get(u))?u.oe:null;if(!d)return Vr(new Me(2,1,1e3,l));var h=u.Xi;(l=e.j.get(l.wb))&&(n.headers["common-access-token"]=l);var f,p=null,g=null,m=!1,y=!1;return Gr(Br(r)).Ea((function(){if(e.i)return Hr();f=Date.now();var r=0;n.requestStartTime=Date.now();var a=d(n.uris[s],n,t,(function(s,a,l){p&&p.stop(),g&&g.aa(u/1e3),e.m&&t==os&&(r++,n.packetNumber=r,e.m(s,a,rs(i),n),c=!0,o.g=l)}),(function(i){y=!0,n.timeToFirstByte=Date.now()-n.requestStartTime,e.l&&e.l(i,n,t)}),{minBytesForProgressEvents:e.o});if(!h)return a;var l=n.retryParameters.connectionTimeout;l&&(p=new Ve((function(){m=!0,a.abort()}))).aa(l/1e3);var u=n.retryParameters.stallTimeout;return u&&(g=new Ve((function(){m=!0,a.abort()}))),a})).Ea((function(i){p&&p.stop(),g&&g.stop(),void 0==i.timeMs&&(i.timeMs=Date.now()-f);var r=i.headers["common-access-token"];if(r){var s=new zn(i.uri);e.j.set(s.wb,r)}return r={response:i,Di:c},!y&&e.l&&e.l(i.headers,n,t),e.C&&e.C(n,i),r}),(function(l){if(p&&p.stop(),g&&g.stop(),e.F){var u=null,c=0;l instanceof Me&&(u=l,1001==l.code&&(c=l.data[1])),e.F(n,u,c,m)}if(e.i)return Hr();if(m&&(l=new Me(1,1,1003,n.uris[s],t)),l instanceof Me){if(7001==l.code)throw l;if(1010==l.code)throw a;if(1==l.severity){if((u=new Kr("retry",u=(new Map).set("error",l))).cancelable=!0,e.dispatchEvent(u),u.defaultPrevented)throw l;return s=(s+1)%n.uris.length,is(e,t,n,i,r,s,l,o)}}throw l}))}function rs(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.o)return!1}return!0}function ss(){this.g=0}function as(e,t,n){$r.call(this,e,t),this.h=n}Yr.prototype.addEventListener=function(e,t){this.Ca&&this.Ca.push(e,t)},Yr.prototype.removeEventListener=function(e,t){this.Ca&&this.Ca.remove(e,t)},Yr.prototype.dispatchEvent=function(e){if(!this.Ca)return!0;var t=this.Ca.get(e.type)||[],n=this.Ca.get("All");for(n&&(t=t.concat(n)),n=(t=c(t)).next();!n.done;n=t.next()){n=n.value,e.target=this.ze,e.currentTarget=this.ze;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(i){}if(e.g)break}return e.defaultPrevented},Yr.prototype.release=function(){this.Ca=null},Qr.prototype.destroy=function(){for(var e=[],t=c(this.g),n=t.next();!n.done;n=t.next())(n=n.value).promise.catch((function(){})),e.push(n.abort());return this.g=[],Promise.all(e)},y(Zr,Yr),(i=Zr.prototype).cg=function(e){this.B=e},i.dg=function(e){this.A=e},i.$i=function(e){this.g.add(e)},i.vj=function(e){this.g.delete(e)},i.Rh=function(){this.g.clear()},i.aj=function(e){this.h.add(e)},i.wj=function(e){this.h.delete(e)},i.Sh=function(){this.h.clear()},i.Bg=function(){this.j.clear()},i.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),this.j.clear(),Yr.prototype.release.call(this),this.s.destroy()},i.request=function(e,t,n){var i=this,r=new ss;if(this.i){var s=Promise.reject(new Me(2,7,7001));return s.catch((function(){})),new as(s,(function(){return Promise.resolve()}),r)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?It(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},t.uris=It(t.uris),s=function(e,t,n,i){function r(e){s=s.Ea((function(){return n.body&&(n.body=ge(n.body)),e(t,n,i)}))}var s=qr(void 0);e.G&&r(e.G);for(var a=(e=c(e.g)).next();!a.done;a=e.next())r(a.value);return s.Ea(void 0,(function(e){if(e instanceof Me&&7001==e.code)throw e;throw new Me(2,1,1006,e)}))}(this,e,t,n);var a=s.Ea((function(){return is(i,e,t,n,new Fr(t.retryParameters,!1),0,null,r)})),o=a.Ea((function(t){return function(e,t,n,i){for(var r=qr(void 0),s=(e=c(e.h)).next(),a={};!s.done;a={ih:void 0},s=e.next())a.ih=s.value,r=r.Ea(function(e){return function(){var r=n.response;return r.data&&(r.data=ge(r.data)),(0,e.ih)(t,r,i)}}(a));return r.Ea((function(){return n}),(function(e){var t=2;if(e instanceof Me){if(7001==e.code)throw e;t=e.severity}throw new Me(t,1,1007,e)}))}(i,e,t,n)})),l=Date.now(),u=0;s.promise.then((function(){u=Date.now()-l}),(function(){}));var d=0;a.promise.then((function(){d=Date.now()}),(function(){}));var h=o.Ea((function(r){var s=Date.now()-d,a=r.response;return a.timeMs+=u,a.timeMs+=s,r.Di||!i.m||a.fromCache||"HEAD"==t.method||e!=os||i.m(a.timeMs,a.data.byteLength,rs(n)),i.H&&i.H(e,a,n),a}),(function(e){throw e&&(e.severity=2),e}));return s=new as(h.promise,(function(){return h.abort()}),r),Jr(this.s,s),s},$("shaka.net.NetworkingEngine",Zr),Zr.prototype.request=Zr.prototype.request,Zr.prototype.destroy=Zr.prototype.destroy,Zr.makeRequest=ns,Zr.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},Zr.prototype.clearCommonAccessTokenMap=Zr.prototype.Bg,Zr.prototype.clearAllResponseFilters=Zr.prototype.Sh,Zr.prototype.unregisterResponseFilter=Zr.prototype.wj,Zr.prototype.registerResponseFilter=Zr.prototype.aj,Zr.prototype.clearAllRequestFilters=Zr.prototype.Rh,Zr.prototype.unregisterRequestFilter=Zr.prototype.vj,Zr.prototype.registerRequestFilter=Zr.prototype.$i,Zr.unregisterScheme=function(e){us.delete(e)},Zr.registerScheme=es,Zr.prototype.setForceHTTPS=Zr.prototype.dg,Zr.prototype.setForceHTTP=Zr.prototype.cg,Zr.NumBytesRemainingClass=ss,y(as,$r),Zr.PendingRequest=as;var os=1;Zr.RequestType={MANIFEST:0,SEGMENT:os,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8},Zr.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5,MPD_PATCH:6,MEDIATAILOR_SESSION_INFO:7,MEDIATAILOR_TRACKING_INFO:8,MEDIATAILOR_STATIC_RESOURCE:9,MEDIATAILOR_TRACKING_EVENT:10,INTERSTITIAL_ASSET_LIST:11,INTERSTITIAL_AD_URL:12};var ls=3;Zr.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:ls};var us=new Map;function cs(e){this.g=!1,this.h=new jr,this.i=e}function ds(e,t){if(e.g){if(t instanceof Me&&7003==t.code)throw t;throw new Me(2,7,7003,t)}}function hs(e,t){for(var n=[],i=(e=c(e)).next();!i.done;i=e.next())n.push(t(i.value));return n}function fs(e){for(var t=new Map,n=c(Object.keys(e)),i=n.next();!i.done;i=n.next())i=i.value,t.set(i,e[i]);return t}function ps(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}function gs(e,t){this.h=ve(e),this.i=t==ys,this.g=0}function ms(){return new Me(2,3,3e3)}cs.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then((function(){e.h.resolve()}),(function(){e.h.resolve()})))},(i=gs.prototype).ta=function(){return this.g<this.h.byteLength},i.ya=function(){return this.g},i.getLength=function(){return this.h.byteLength},i.V=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch(t){throw ms()}},i.na=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch(t){throw ms()}},i.R=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch(t){throw ms()}},i.gh=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch(t){throw ms()}},i.Yc=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch(n){throw ms()}if(2097151<t)throw new Me(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},i.Bb=function(e){if(this.g+e>this.h.byteLength)throw ms();var t=me(this.h,this.g,e);return this.g+=e,t},i.skip=function(e){if(this.g+e>this.h.byteLength)throw ms();this.g+=e},i.jh=function(e){if(this.g<e)throw ms();this.g-=e},i.seek=function(e){if(0>e||e>this.h.byteLength)throw ms();this.g=e},i.Ac=function(){for(var e=this.g;this.ta()&&0!=this.h.getUint8(this.g);)this.g+=1;return e=me(this.h,e,this.g-e),this.g+=1,pt(e)},$("shaka.util.DataViewReader",gs),gs.prototype.readTerminatedString=gs.prototype.Ac,gs.prototype.seek=gs.prototype.seek,gs.prototype.rewind=gs.prototype.jh,gs.prototype.skip=gs.prototype.skip,gs.prototype.readBytes=gs.prototype.Bb,gs.prototype.readUint64=gs.prototype.Yc,gs.prototype.readInt32=gs.prototype.gh,gs.prototype.readUint32=gs.prototype.R,gs.prototype.readUint16=gs.prototype.na,gs.prototype.readUint8=gs.prototype.V,gs.prototype.getLength=gs.prototype.getLength,gs.prototype.getPosition=gs.prototype.ya,gs.prototype.hasMoreData=gs.prototype.ta;var ys=1;function vs(){this.i=new Map,this.h=new Map,this.g=!1}function bs(e){for(var t=xs(e);e.reader.ta()&&!e.parser.g;)e.parser.Vc(e.start+t,e.reader,e.partialOkay)}function Ts(e){for(var t=xs(e),n=e.reader.R(),i=0;i<n&&(e.parser.Vc(e.start+t,e.reader,e.partialOkay),!e.parser.g);i++);}function Ss(e){var t=xs(e);for(e.reader.skip(78);e.reader.ta()&&!e.parser.g;)e.parser.Vc(e.start+t,e.reader,e.partialOkay)}function _s(e){var t=xs(e);e.reader.skip(8);var n=e.reader.na();for(e.reader.skip(6),2==n?e.reader.skip(48):e.reader.skip(12),1==n&&e.reader.skip(16);e.reader.ta()&&!e.parser.g;)e.parser.Vc(e.start+t,e.reader,e.partialOkay)}function ws(e){return function(t){e(t.reader.Bb(t.reader.getLength()-t.reader.ya()))}}function Es(e){for(var t=0,n=(e=c(e)).next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function ks(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function xs(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}gs.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:ys},(i=vs.prototype).box=function(e,t){return e=Es(e),this.i.set(e,As),this.h.set(e,t),this},i.S=function(e,t){return e=Es(e),this.i.set(e,Cs),this.h.set(e,t),this},i.stop=function(){this.g=!0},i.parse=function(e,t,n){for(e=new gs(e,0),this.g=!1;e.ta()&&!this.g;)this.Vc(0,e,t,n)},i.Vc=function(e,t,n,i){var r=t.ya();if(i&&r+8>t.getLength())this.g=!0;else{var s=t.R(),a=t.R(),o=ks(a),l=!1;switch(s){case 0:s=t.getLength()-r;break;case 1:if(i&&t.ya()+8>t.getLength())return void(this.g=!0);s=t.Yc(),l=!0}var u=this.h.get(a);if(u){var c=null,d=null;if(this.i.get(a)==Cs){if(i&&t.ya()+4>t.getLength())return void(this.g=!0);c=(d=t.R())>>>24,d&=16777215}a=r+s,n&&a>t.getLength()&&(a=t.getLength()),i&&a>t.getLength()?this.g=!0:(i=a-t.ya(),u({name:o,parser:this,partialOkay:n||!1,version:c,flags:d,reader:t=new gs(t=0<i?t.Bb(i):new Uint8Array(0),0),size:s,start:r+e,has64BitSize:l}))}else t.skip(Math.min(r+s-t.ya(),t.getLength()-t.ya()))}},$("shaka.util.Mp4Parser",vs),vs.headerSize=xs,vs.typeToString=ks,vs.allData=ws,vs.audioSampleEntry=_s,vs.visualSampleEntry=Ss,vs.sampleDescription=Ts,vs.children=bs,vs.prototype.parseNext=vs.prototype.Vc,vs.prototype.parse=vs.prototype.parse,vs.prototype.stop=vs.prototype.stop,vs.prototype.fullBox=vs.prototype.S,vs.prototype.box=vs.prototype.box;var As=0,Cs=1;function Is(e){var t=this;this.g=[],this.h=[],this.data=[],(new vs).box("moov",bs).box("moof",bs).S("pssh",(function(e){if(!(1<e.version)){var n=me(e.reader.h,-12,e.size);if(t.data.push(n),t.g.push(fi(e.reader.Bb(16))),0<e.version){n=e.reader.R();for(var i=0;i<n;i++){var r=fi(e.reader.Bb(16));t.h.push(r)}}}})).parse(e)}function Ls(e,t,n,i){var r=e.length,s=t.length+16+r;0<i&&(s+=4+16*n.size);var a=new Uint8Array(s),o=ve(a),l=0;if(o.setUint32(l,s),l+=4,o.setUint32(l,1886614376),l+=4,1>i?o.setUint32(l,0):o.setUint32(l,16777216),l+=4,a.set(t,l),l+=t.length,0<i)for(o.setUint32(l,n.size),l+=4,n=(t=c(n)).next();!n.done;n=t.next())n=hi(n.value),a.set(n,l),l+=n.length;return o.setUint32(l,r),a.set(e,l+4),a}function Ds(e){var t=this;this.C=e,this.j=this.A=null,this.ja=this.ga=!1,this.H=0,this.h=null,this.o=new ee,this.i=new Map,this.W=[],this.B=new Map,this.K=!1,this.m=new jr,this.g=null,this.s=function(n){2==n.severity&&t.m.reject(n),e.onError(n)},this.ba=new Map,this.ia=new Map,this.L=new Ve((function(){return function(e){var t=e.ba,n=e.ia;n.clear(),t.forEach((function(e,t){return n.set(t,e)})),t=Array.from(n.values()),t.length&&t.every((function(e){return"expired"==e}))&&e.s(new Me(2,6,6014)),e.C.ke(ps(n))}(t)})),this.O=!1,this.M=[],this.$=!1,this.I=new Ve((function(){!function(e){e.i.forEach((function(t,n){var i=t.Nf,r=n.expiration;isNaN(r)&&(r=1/0),r!=i&&(e.C.onExpirationUpdated(n.sessionId,r),t.Nf=r)}))}(t)})),this.m.catch((function(){})),this.l=new cs((function(){return function(e){return M((function(t){switch(t.g){case 1:return e.o.release(),e.o=null,e.m.reject(),e.I.stop(),e.I=null,e.L.stop(),e.L=null,S(t,Gs(e),2);case 2:if(!e.j){t.u(3);break}return w(t,4),S(t,e.j.setMediaKeys(null),6);case 6:k(t,5);break;case 4:x(t);case 5:e.j=null;case 3:e.h=null,e.A=null,e.B=new Map,e.g=null,e.s=function(){},e.C=null,e.da=!1,e.G=null,_(t)}}))}(t)})),this.da=!1,this.F=this.G=null,this.P=function(){return!1}}function Rs(e,t,n,i){i=void 0===i||i,e.B=new Map;for(var r=(n=c(n)).next();!r.done;r=n.next())e.B.set(r.value,{initData:null,initDataType:null});for(r=(n=c(e.g.persistentSessionsMetadata)).next();!r.done;r=n.next())r=r.value,e.B.set(r.sessionId,{initData:r.initData,initDataType:r.initDataType});return e.O=0<e.B.size,Ms(e,t,i)}function Ms(e,t,n){var i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T;return M((function(_){if(1==_.g){for(Ys(e.g.clearKeys,t),!(i=t.some((function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)})))&&n&&(r=fs(e.g.servers),function(e,t){var n=[];for(t.forEach((function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})})),e=c(e),t=e.next();!t.done;t=e.next())(t=t.value).video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}(t,r)),s=new Set,a=c(t),o=a.next();!o.done;o=a.next())for(l=o.value,u=zs(l),d=c(u),h=d.next();!h.done;h=d.next())f=h.value,s.add(f);for(p=c(s),g=p.next();!g.done;g=p.next())Xs(g.value,fs(e.g.servers),fs(e.g.advanced||{}),e.g.keySystemsMapping);for(m=function(t,n){for(var i=[],r=(t=c(t)).next();!r.done;r=t.next()){var s,a=(r=r.value)[n]||e.g.advanced&&e.g.advanced[r.keySystem]&&e.g.advanced[r.keySystem][n]||"";if((s=""==a)&&(s=!!(s=r.keySystem)&&!!s.match(/^com\.widevine\.alpha/)),s&&("audioRobustness"==n?a=[e.g.defaultAudioRobustnessForWidevine]:"videoRobustness"==n&&(a=[e.g.defaultVideoRobustnessForWidevine])),"string"===typeof a)i.push(r);else if(Array.isArray(a))for(0===a.length&&(a=[""]),s=(a=c(a)).next();!s.done;s=a.next()){var o={};i.push(Object.assign({},r,(o[n]=s.value,o)))}}return i},y=c(t),v=y.next();!v.done;v=y.next())(b=v.value).video&&(b.video.drmInfos=m(b.video.drmInfos,"videoRobustness"),b.video.drmInfos=m(b.video.drmInfos,"audioRobustness")),b.audio&&(b.audio.drmInfos=m(b.audio.drmInfos,"videoRobustness"),b.audio.drmInfos=m(b.audio.drmInfos,"audioRobustness"));return S(_,fr(t,e.O,e.da,e.g.preferredKeySystems),2)}return ds(e.l),i||Object.keys(e.g.servers).length?(T=Fs(e,void 0,t),_.return(i?T:T.catch((function(){})))):(e.ga=!0,_.return(Promise.resolve()))}))}function Ps(e){var t;return M((function(n){switch(n.g){case 1:if(e.j.mediaKeys)return n.return();if(!e.G){n.u(2);break}return S(n,e.G,3);case 3:return ds(e.l),n.return();case 2:return w(n,4),e.G=e.j.setMediaKeys(e.A),S(n,e.G,6);case 6:k(n,5);break;case 4:t=x(n),e.s(new Me(2,6,6003,t.message));case 5:ds(e.l),_(n)}}))}function Os(e){var t,n,i,r;return M((function(s){if(1==s.g)return e.B.size?(e.B.forEach((function(t,n){$s(e,n,t)})),S(s,e.m,3)):s.u(2);if(2!=s.g){if(0<(e.h&&e.h.keyIds||new Set([])).size&&function(e){for(var t=c(e.h&&e.h.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if("usable"!==e.ba.get(n.value))return!1;return!0}(e))return s.return(e.m);e.K=!1,e.m=new jr,e.m.catch((function(){}))}for(t=(e.h?e.h.initData:[])||[],n=c(t),i=n.next();!i.done;i=n.next())r=i.value,Ns(e,r.initDataType,r.initData);return Ks(e)&&e.m.resolve(),s.return(e.m)}))}function Ns(e,t,n){if(n.length){if(e.g.ignoreDuplicateInitData){for(var i=e.i.values(),r=(i=c(i)).next();!r.done;r=i.next())if(pe(n,r.value.initData))return;var s=!1;if(e.B.forEach((function(e){!s&&pe(n,e.initData)&&(s=!0)})),s)return}e.K=!0,0<e.i.size&&Ks(e)&&(e.m.resolve(),e.K=!1,e.m=new jr,e.m.catch((function(){}))),function(e,t,n,i){try{var r=e.A.createSession(i)}catch(s){return void e.s(new Me(2,6,6005,s.message))}e.o.D(r,"message",(function(t){e.j&&e.g.delayLicenseRequestUntilPlayed&&e.j.paused&&!e.$?e.M.push(t):Vs(e,t)})),e.o.D(r,"keystatuseschange",(function(t){return Hs(e,t)})),e.i.set(r,{initData:n,initDataType:t,loaded:!1,Nf:1/0,sb:null,type:i});try{n=e.g.initDataTransform(n,t,e.h)}catch(s){return t=s,s instanceof Me||(t=new Me(2,6,6016,s)),void e.s(t)}e.g.logLicenseExchange&&ci(n),r.generateRequest(t,n).catch((function(t){if(!e.l.g){e.i.delete(r);var n=t.errorCode;if(n&&n.systemCode){var i=n.systemCode;0>i&&(i+=Math.pow(2,32)),i="0x"+i.toString(16)}e.s(new Me(2,6,6006,t.message,t,i))}}))}(e,t,n,e.h.sessionType)}}function Us(e){return e=hs(e=e.i.keys(),(function(e){return e.sessionId})),Array.from(e)}function Fs(e,t,n){var i,r,s,a,o,l,u;return M((function(d){switch(d.g){case 1:if(i=new Map,n.length){r=function(e,t,n){for(var i=c(t),r=i.next();!r.done;r=i.next())for(var s=(r=c(zs(r.value))).next();!s.done;s=r.next())s=s.value,n.has(s.keySystem)||n.set(s.keySystem,[]),n.get(s.keySystem).push(s);if(1==n.size&&n.has(""))throw new Me(2,6,6e3);i=e.g.preferredKeySystems,i.length||(r=fs(e.g.servers),1==r.size&&(i=Array.from(r.keys()))),r=c(i);var a=r.next();for(s={};!a.done;s={fh:void 0},a=r.next()){s.fh=a.value;for(var o=(a=c(t)).next();!o.done;o=a.next())if(o=o.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.fh}}(s)))return o.keySystemAccess}for(r=c([!0,!1]),s=r.next();!s.done;s=r.next())for(s=s.value,a=c(t),o=a.next();!o.done;o=a.next())for(var l=(o=c(o.value.decodingInfos)).next();!l.done;l=o.next())if((l=l.value).supported&&l.keySystemAccess){var u=l.keySystemAccess.keySystem;if(!i.includes(u)){var d=n.get(u);for(!d&&e.g.keySystemsMapping[u]&&(d=n.get(e.g.keySystemsMapping[u])),d=(u=c(d)).next();!d.done;d=u.next())if(!!d.value.licenseServerUri==s)return l.keySystemAccess}}return null}(e,n,i),d.u(2);break}return S(d,function(e,t){var n,i,r,s,a,o,l,u,d,h,f,p,g,m,y,v;return M((function(b){switch(b.g){case 1:if(1==t.size&&t.has(""))throw new Me(2,6,6e3);for(i=c(t.values()),r=i.next();!r.done;r=i.next())0==(s=r.value).audioCapabilities.length&&delete s.audioCapabilities,0==s.videoCapabilities.length&&delete s.videoCapabilities;a=c(e.g.preferredKeySystems),o=a.next();case 2:if(o.done){b.u(4);break}if(l=o.value,!t.has(l)){b.u(3);break}return u=t.get(l),w(b,6),S(b,navigator.requestMediaKeySystemAccess(l,[u]),8);case 8:return n=b.h,b.return(n);case 6:x(b);case 7:ds(e.l);case 3:o=a.next(),b.u(2);break;case 4:d=c([!0,!1]),h=d.next();case 9:if(h.done){b.u(11);break}f=h.value,p=c(t.keys()),g=p.next();case 12:if(g.done){h=d.next(),b.u(9);break}if(m=g.value,y=t.get(m),v=y.drmInfos.some((function(e){return!!e.licenseServerUri})),v!=f){b.u(13);break}return w(b,15),S(b,navigator.requestMediaKeySystemAccess(m,[y]),17);case 17:return n=b.h,b.return(n);case 15:x(b);case 16:ds(e.l);case 13:g=p.next(),b.u(12);break;case 11:return b.return(n)}}))}(e,t),3);case 3:r=d.h;case 2:if(!(s=r)){if(!navigator.requestMediaKeySystemAccess)throw new Me(2,6,6020);throw new Me(2,6,6001)}if(ds(e.l),w(d,4),s.getConfiguration(),a=e.g.keySystemsMapping[s.keySystem]||s.keySystem,n.length){var h=a,f=i.get(a),p=[],g=[],m=[],y=[],v=[],b=new Set,T=new Set;Ws(f,p,g,y,m,v,b,T);var _=e.O?"persistent-license":"temporary";for(h={keySystem:h,encryptionScheme:p[0],licenseServerUri:g[0],distinctiveIdentifierRequired:f[0].distinctiveIdentifierRequired,persistentStateRequired:f[0].persistentStateRequired,sessionType:f[0].sessionType||_,audioRobustness:f[0].audioRobustness||"",videoRobustness:f[0].videoRobustness||"",serverCertificate:y[0],serverCertificateUri:m[0],initData:v,keyIds:b},0<T.size&&(h.keySystemUris=T),T=(f=c(f)).next();!T.done;T=f.next())(T=T.value).distinctiveIdentifierRequired&&(h.distinctiveIdentifierRequired=T.distinctiveIdentifierRequired),T.persistentStateRequired&&(h.persistentStateRequired=T.persistentStateRequired);f=h}else f=a,T=t.get(a),h=[],p=[],g=[],m=[],y=[],v=new Set,Ws(T.drmInfos,h,p,m,g,y,v),f={keySystem:f,encryptionScheme:h[0],licenseServerUri:p[0],distinctiveIdentifierRequired:"required"==T.distinctiveIdentifier,persistentStateRequired:"required"==T.persistentState,sessionType:T.sessionTypes[0]||"temporary",audioRobustness:(T.audioCapabilities?T.audioCapabilities[0].robustness:"")||"",videoRobustness:(T.videoCapabilities?T.videoCapabilities[0].robustness:"")||"",serverCertificate:m[0],serverCertificateUri:g[0],initData:y,keyIds:v};if(e.h=f,!e.h.licenseServerUri)throw new Me(2,6,6012,e.h.keySystem);return S(d,s.createMediaKeys(),6);case 6:if(o=d.h,ds(e.l),e.A=o,""==e.g.minHdcpVersion||!("getStatusForPolicy"in e.A)){d.u(7);break}return w(d,8),S(d,e.A.getStatusForPolicy({minHdcpVersion:e.g.minHdcpVersion}),10);case 10:if("usable"!=d.h)throw new Me(2,6,6018);ds(e.l),k(d,7,4);break;case 8:if((l=x(d,4))instanceof Me)throw l;throw new Me(2,6,6019,l.message);case 7:return e.ga=!0,S(d,function(e){var t,n;return M((function(i){switch(i.g){case 1:if(!e.A||!e.h)return i.return();if(!e.h.serverCertificateUri||e.h.serverCertificate&&e.h.serverCertificate.length){i.u(2);break}return t=ns([e.h.serverCertificateUri],e.g.retryParameters),w(i,3),S(i,e.C.Ub.request(5,t,{isPreload:e.P()}).promise,5);case 5:n=i.h,e.h.serverCertificate=me(n.data),k(i,4);break;case 3:throw new Me(2,6,6017,x(i));case 4:if(e.l.g)return i.return();case 2:return e.h.serverCertificate&&e.h.serverCertificate.length?(w(i,6),S(i,e.A.setServerCertificate(e.h.serverCertificate),8)):i.return();case 8:k(i,0);break;case 6:throw new Me(2,6,6004,x(i).message)}}))}(e),11);case 11:ds(e.l),k(d,0);break;case 4:if(u=x(d),ds(e.l,u),e.h=null,u instanceof Me)throw u;throw new Me(2,6,6002,u.message)}}))}function Bs(e){Ks(e)&&e.m.resolve()}function js(e,t){new Ve((function(){t.loaded=!0,Bs(e)})).aa(Js)}function $s(e,t,n){var i,r,s,a,o,l,u;return M((function(c){switch(c.g){case 1:try{i=e.A.createSession("persistent-license")}catch(d){return r=new Me(2,6,6005,d.message),e.s(r),c.return(Promise.reject(r))}return e.o.D(i,"message",(function(t){e.j&&e.g.delayLicenseRequestUntilPlayed&&e.j.paused&&!e.$?e.M.push(t):Vs(e,t)})),e.o.D(i,"keystatuseschange",(function(t){return Hs(e,t)})),s={initData:n.initData,initDataType:n.initDataType,loaded:!1,Nf:1/0,sb:null,type:"persistent-license"},e.i.set(i,s),w(c,2),S(c,i.load(t),4);case 4:return a=c.h,ds(e.l),a||(e.i.delete(i),o=e.g.persistentSessionOnlinePlayback?1:2,e.s(new Me(o,6,6013)),s.loaded=!0),js(e,s),Bs(e),c.return(i);case 2:l=x(c),ds(e.l,l),e.i.delete(i),u=e.g.persistentSessionOnlinePlayback?1:2,e.s(new Me(u,6,6005,l.message)),s.loaded=!0,Bs(e);case 3:return c.return(Promise.resolve())}}))}function Vs(e,t){var n,i,r,s,a,o,l,u,d,h,f,p,g,m;M((function(y){switch(y.g){case 1:if(n=t.target,e.g.logLicenseExchange&&ci(t.message),i=e.i.get(n),r=e.h.licenseServerUri,s=e.g.advanced[e.h.keySystem],"individualization-request"==t.messageType&&s&&s.individualizationServer&&(r=s.individualizationServer),(a=ns([r],e.g.retryParameters)).body=t.message,a.method="POST",a.licenseRequestType=t.messageType,a.sessionId=n.sessionId,a.drmInfo=e.h,i&&(a.initData=i.initData,a.initDataType=i.initDataType),s&&s.headers)for(o in s.headers)a.headers[o]=s.headers[o];if("org.w3.clearkey"===e.h.keySystem){var v=a,b=e.h;try{var T=mt(v.body);if(T){var E=JSON.parse(T);E.type||(E.type=b.sessionType,v.body=yt(JSON.stringify(E)))}}catch(A){}}if(Fe(e.h.keySystem))if((v=gt(a.body,!0,!0)).includes("PlayReadyKeyMessage")){for(T=(b=c(b=jt(v=Mt(v,"PlayReadyKeyMessage"),"HttpHeader"))).next();!T.done;T=b.next())T=jt(E=T.value,"name")[0],E=jt(E,"value")[0],a.headers[Ft(T)]=Ft(E);v=jt(v,"Challenge")[0],a.body=di(Ft(v))}else a.headers["Content-Type"]="text/xml; charset=utf-8";return l=Date.now(),w(y,2),d=e.C.Ub.request(2,a,{isPreload:e.P()}),e.W.push(d),S(y,d.promise,4);case 4:u=y.h,Le(e.W,d),k(y,3);break;case 2:return h=x(y),e.l.g?y.return():(f=new Me(2,6,6007,h),1==e.i.size?(e.s(f),i&&i.sb&&i.sb.reject(f)):(i&&i.sb&&i.sb.reject(f),e.i.delete(n),Ks(e)&&(e.m.resolve(),e.L.aa(.1))),y.return());case 3:return e.l.g?y.return():(e.H+=(Date.now()-l)/1e3,e.g.logLicenseExchange&&ci(u.data),w(y,5),S(y,n.update(u.data),7));case 7:k(y,6);break;case 5:return p=x(y),g=new Me(2,6,6008,p.message),e.s(g),i&&i.sb&&i.sb.reject(g),y.return();case 6:if(e.l.g)return y.return();m=new Kr("drmsessionupdate"),e.C.onEvent(m),i&&(i.sb&&i.sb.resolve(),js(e,i)),_(y)}}))}function Hs(e,t){t=t.target;var n=e.i.get(t),i=!1;t.keyStatuses.forEach((function(t,r){if("string"==typeof r){var s=r;r=t,t=s}if(Fe(e.h.keySystem)&&16==r.byteLength&&(Ge()||et())){var a=(s=ve(r)).getUint32(0,!0),o=s.getUint16(4,!0),l=s.getUint16(6,!0);s.setUint32(0,a,!1),s.setUint16(4,o,!1),s.setUint16(6,l,!1)}"status-pending"!=t&&(n.loaded=!0),"expired"==t&&(i=!0),r=fi(r).slice(0,32),e.ba.set(r,t)}));var r=t.expiration-Date.now();(0>r||i&&1e3>r)&&n&&!n.sb&&(e.i.delete(t),qs(t)),Ks(e)&&(e.m.resolve(),e.L.aa(Zs))}function qs(e){return M((function(t){return 1==t.g?(w(t,2),S(t,Xi(Qs,Promise.all([e.close().catch((function(){})),e.closed])),4)):2!=t.g?k(t,0):(x(t),void _(t))}))}function Gs(e){var t;return M((function(n){return t=Array.from(e.i.entries()),e.i.clear(),S(n,Promise.all(t.map((function(t){var n=(t=c(t)).next().value,i=t.next().value;return M((function(t){return 1==t.g?(w(t,2),e.ja||e.B.has(n.sessionId)||"persistent-license"!==i.type||e.g.persistentSessionOnlinePlayback?S(t,qs(n),5):S(t,n.remove(),5)):2!=t.g?k(t,0):(x(t),void _(t))}))}))),0)}))}function zs(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function Ks(e){return function(e,t){for(var n=(e=c(e)).next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}(e=e.i.values(),(function(e){return e.loaded}))}function Ws(t,n,i,r,s,a,o,l){for(var u=[],h=(t=c(t)).next(),f={};!h.done;f={va:void 0},h=t.next()){if(f.va=h.value,n.includes(f.va.encryptionScheme)||n.push(f.va.encryptionScheme),"org.w3.clearkey"==f.va.keySystem&&f.va.licenseServerUri.startsWith("data:application/json;base64,")?u.includes(f.va.licenseServerUri)||u.push(f.va.licenseServerUri):i.includes(f.va.licenseServerUri)||i.push(f.va.licenseServerUri),s.includes(f.va.serverCertificateUri)||s.push(f.va.serverCertificateUri),f.va.serverCertificate&&(r.some(function(e){return function(t){return pe(t,e.va.serverCertificate)}}(f))||r.push(f.va.serverCertificate)),f.va.initData)for(var p=(h=c(f.va.initData)).next(),g={};!p.done;g={Cf:void 0},p=h.next())g.Cf=p.value,a.some(function(e){return function(t){var n=e.Cf;return!(!t.keyId||t.keyId!=n.keyId)||t.initDataType==n.initDataType&&pe(t.initData,n.initData)}}(g))||a.push(g.Cf);if(f.va.keyIds)for(p=(h=c(f.va.keyIds)).next();!p.done;p=h.next())o.add(p.value);if(f.va.keySystemUris&&l)for(h=(f=c(f.va.keySystemUris)).next();!h.done;h=f.next())l.add(h.value)}if(1==u.length)i.push(u[0]);else if(0<u.length){for(n=[],r=(u=c(u)).next();!r.done;r=u.next())r=e.atob(r.value.split("data:application/json;base64,").pop()),r=JSON.parse(r),n.push.apply(n,d(r.keys));u=JSON.stringify({keys:n}),i.push("data:application/json;base64,"+e.btoa(u))}}function Xs(t,n,i,r){var s=t.keySystem;!s||"org.w3.clearkey"==s&&t.licenseServerUri||(n.size&&n.get(s)&&(n=n.get(s),t.licenseServerUri=n),t.keyIds||(t.keyIds=new Set),(i=i.get(s))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=i.persistentStateRequired),t.serverCertificate||(t.serverCertificate=i.serverCertificate),i.sessionType&&(t.sessionType=i.sessionType),t.serverCertificateUri||(t.serverCertificateUri=i.serverCertificateUri)),r[s]&&(t.keySystem=r[s]),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==s&&(t.keySystem="com.chromecast.playready"))}function Ys(e,t){if(0!=(e=fs(e)).size){e=yi(e);for(var n=(t=c(t)).next();!n.done;n=t.next())(n=n.value).video&&(n.video.drmInfos=[e]),n.audio&&(n.audio.drmInfos=[e])}}(i=Ds.prototype).destroy=function(){return this.l.destroy()},i.configure=function(e,t){this.g=e,t&&(this.P=t),this.I&&this.I.ua(this.g.updateExpirationTime)},i.Jb=function(e){var t=this;return M((function(n){if(1==n.g)return t.j===e?n.return():t.A?(t.j=e,t.o.ma(t.j,"play",(function(){for(var e=c(t.M),n=e.next();!n.done;n=e.next())Vs(t,n.value);t.$=!0,t.M=[]})),t.j.remote?(t.o.D(t.j.remote,"connect",(function(){return Gs(t)})),t.o.D(t.j.remote,"connecting",(function(){return Gs(t)})),t.o.D(t.j.remote,"disconnect",(function(){return Gs(t)}))):"webkitCurrentPlaybackTargetIsWireless"in t.j&&t.o.D(t.j,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return Gs(t)})),t.F=t.h&&t.h.initData.find((function(e){return 0<e.initData.length}))||null,t.F||"com.apple.fps"!==t.h.keySystem||t.B.size?S(n,Ps(t),2):n.u(2)):(t.o.ma(e,"encrypted",(function(){t.s(new Me(2,6,6010))})),n.return());Os(t).catch((function(){})),t.F||t.B.size||t.g.parseInbandPsshEnabled||t.o.D(t.j,"encrypted",(function(e){return function(e,t){return M((function(n){if(1==n.g)return S(n,Ps(e),2);Ns(e,t.initDataType,me(t.initData)),_(n)}))}(t,e)})),_(n)}))},i.vf=function(){var e=this,t=this.i.keys();return t=hs(t,(function(t){var n=e.i.get(t);return{sessionId:t.sessionId,sessionType:n.type,initData:n.initData,initDataType:n.initDataType}})),Array.from(t)},i.md=function(){for(var e=1/0,t=this.i.keys(),n=(t=c(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},i.Vd=function(){return ps(this.ia)};var Qs=1,Js=5,Zs=.5;function ea(e,t,n){for(n=void 0===n||n,this.h=e,this.g=new Set([e]),t=(e=c(t=t||[])).next();!t.done;t=e.next())this.add(t.value,n)}function ta(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=e.codecs.split(",").map((function(e){return Ri(e)})),t=t.codecs.split(",").map((function(e){return Ri(e)})),e.length!=t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function na(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;for(var n=(e=c(e)).next();!n.done;n=e.next())if(!t.has(n.value))return!1;return!0}function ia(){}function ra(){this.g=oa,this.i=(new Map).set(oa,2).set(aa,1),this.h=0}function sa(e,t,n){e.i.set(oa,n).set(aa,t)}ea.prototype.add=function(e,t){var n,i=this.h;if(t=void 0===t||t,!(n=!!i.audio!=!!e.audio||!!i.video!=!!e.video||i.language!=e.language)&&(n=i.audio&&e.audio)){n=i.audio;var r=e.audio;n=!(!((!n.channelsCount||!r.channelsCount||2<n.channelsCount||2<r.channelsCount)&&n.channelsCount!=r.channelsCount||n.spatialAudio!==r.spatialAudio||t&&!ta(n,r))&&na(n.roles,r.roles)&&n.groupId===r.groupId)}return!n&&(n=i.video&&e.video)&&(i=i.video,n=e.video,n=!((!t||ta(i,n))&&na(i.roles,n.roles))),!n&&(this.g.add(e),!0)},ea.prototype.values=function(){return this.g.values()},$("shaka.media.AdaptationSet",ea),$("shaka.config.CodecSwitchingStrategy",{RELOAD:"reload",SMOOTH:"smooth"}),ia.prototype.create=function(){},ia.prototype.configure=function(){},$("shaka.media.AdaptationSetCriteria",ia);var aa=0,oa=1;function la(e,t,n){var i=e.audio&&e.audio.label?e.audio.label:"",r=e.video&&e.video.hdr?e.video.hdr:"",s=!(!e.audio||!e.audio.spatialAudio)&&e.audio.spatialAudio,a=e.video&&e.video.videoLayout?e.video.videoLayout:"",o=e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,l=e.audio&&e.audio.codecs?e.audio.codecs:"";this.g=n(),this.g.configure({language:e.language,role:"",channelCount:o,Oc:r,spatialAudio:s,videoLayout:a,Hc:i,cd:"",codecSwitchingStrategy:t,audioCodec:l})}function ua(e,t,n){this.g=e,this.i=t,this.h=n}function ca(e,t){return M((function(n){if(1==n.g)return S(n,ur(e.h,t,e.g.drm.preferredKeySystems,e.g.drm.keySystemsMapping),2);if(e.g.streaming.dontChooseCodecs||or(t,e.g.preferredVideoCodecs,e.g.preferredAudioCodecs,e.g.preferredDecodingAttributes,e.g.preferredTextFormats),!t.variants.some(Er))throw new Me(2,4,4032);return n.return(ha(e,t))}))}function da(e,t){var n=e.g.restrictions;e=e.i;for(var i=!1,r=(t=c(t.variants)).next();!r.done;r=t.next()){var s=(r=r.value).allowedByApplication;r.allowedByApplication=lr(r,n,e),s!=r.allowedByApplication&&(i=!0)}return i}function ha(e,t){var n=da(e,t);if(t){var i=e.h?e.h.h:null;if(i&&e.h.A)for(var r=c(t.variants),s=r.next();!s.done;s=r.next())s=s.value,fa(e,i.keySystem,s.video),fa(e,i.keySystem,s.audio);pa(e,t)}return n}function fa(e,t,n){if(n)for(var i=(n=c(n.drmInfos)).next();!i.done;i=n.next())if((i=i.value).keySystem==t)for(var r=(i=c(i.initData||[])).next();!r.done;r=i.next())r=r.value,Ns(e.h,r.initDataType,r.initData)}function pa(e,t){e=e.h?e.h.Vd():{};var n=Object.keys(e);n=n.length&&"00"==n[0];for(var i=!1,r=!1,s=new Set,a=new Set,o=(t=c(t.variants)).next();!o.done;o=t.next()){var l=[];(o=o.value).audio&&l.push(o.audio),o.video&&l.push(o.video);for(var u=(l=c(l)).next();!u.done;u=l.next())if((u=u.value).keyIds.size)for(var d=(u=c(u.keyIds)).next();!d.done;d=u.next()){d=d.value;var h=e[n?"00":d];h?ga.includes(h)&&a.add(h):s.add(d)}o.allowedByApplication?o.allowedByKeySystem&&(i=!0):r=!0}if(!i)throw new Me(2,4,4012,e={hasAppRestrictions:r,missingKeys:Array.from(s),restrictedKeyStatuses:Array.from(a)})}la.prototype.create=function(e){return this.g.create(e)},la.prototype.configure=function(){};var ga=["output-restricted","internal-error"];function ma(){}function ya(e,t){ba.set(e,t)}function va(e,t){if(t){var n=ba.get(t.toLowerCase());if(n)return n}throw new Me(2,4,4e3,e,t)}$("shaka.media.ManifestParser",ma),ma.unregisterParserByMime=function(e){ba.delete(e)},ma.registerParserByMime=ya,ma.registerParserByExtension=function(){oe("ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},ma.AccessibilityPurpose={zk:"visually impaired",Qj:"hard of hearing"};var ba=new Map;function Ta(e,t,n,i,r){var s=_a.value(),a=e.subarray(n.start,n.start+n.size),o=ve(a),l=new Uint8Array(n.size+s.byteLength);for(l.set(a,0),(a=ve(l)).setUint32(4,r),l.set(s,n.size),r=o.getUint32(4),a.setUint32(n.size+16,r),Sa(l,0,l.byteLength),r=new Uint8Array(e.byteLength+l.byteLength),n=ze()||Ge()?n.start:n.start+n.size,s=e.subarray(n),r.set(e.subarray(0,n)),r.set(l,n),r.set(s,n+l.byteLength),i=(e=c(i)).next();!i.done;i=e.next())Sa(r,(i=i.value).start,i.size+l.byteLength);return l=ve(r,t.start),t=xs(t),e=l.getUint32(t),l.setUint32(t,e+1),r}function Sa(e,t,n){0!=(t=(e=ve(e,t)).getUint32(0))&&(1==t?(e.setUint32(8,n>>32),e.setUint32(12,4294967295&n)):e.setUint32(0,n))}var _a=new Oe((function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])}));function wa(e,t,n,i,r,s,a,o){this.N=e,this.Na=t,this.wa=n,this.Tc=void 0===i?null:i,this.timescale=void 0===r?null:r,this.g=void 0===s?null:s,this.aesKey=void 0===a?null:a,this.mimeType=this.codecs=null,this.encrypted=void 0!==o&&o}function Ea(e,t){return e===t||(e&&t?e.bc()==t.bc()&&e.$b()==t.$b()&&Re(e.N().sort(),t.N().sort())&&pe(e.Qb(),t.Qb()):e==t)}function ka(e,t,n,i,r,s,a,o,l,u,d,h,f,p,g,m){for(u=void 0===u?[]:u,p=void 0===p?Aa:p,this.startTime=e,this.j=this.endTime=t,this.C=n,this.Na=i,this.wa=r,this.ca=s,this.timestampOffset=a,this.appendWindowStart=o,this.appendWindowEnd=l,this.g=u,this.tilesLayout=void 0===d?"":d,this.A=void 0===h?null:h,this.h=void 0===f?null:f,this.status=p,this.preload=!1,this.l=!0,this.m=!1,this.aesKey=void 0===g?null:g,this.thumbnailSprite=null,this.i=-1,this.s=void 0!==m&&m,this.F=this.o=!1,t=(e=c(this.g)).next();!t.done;t=e.next())t.value.Yg();this.s&&this.g.length&&this.g[this.g.length-1].Xg(),this.B=this.bandwidth=this.mimeType=this.codecs=null}function xa(e,t){e.ca=t;for(var n=(e=c(e.g)).next();!n.done;n=e.next())xa(n.value,t)}wa.prototype.bc=function(){return this.Na},wa.prototype.$b=function(){return this.wa},wa.prototype.Qb=function(){return this.g},$("shaka.media.InitSegmentReference",wa),wa.prototype.getEndByte=wa.prototype.$b,wa.prototype.getStartByte=wa.prototype.bc,(i=ka.prototype).N=function(){return this.C()},i.getStartTime=function(){return this.startTime},i.di=function(){return this.endTime},i.bc=function(){return this.Na},i.$b=function(){return this.wa},i.yi=function(){return this.tilesLayout},i.xi=function(){return this.A},i.cc=function(){return this.status},i.Qi=function(){this.status=Ca},i.Kf=function(){this.preload=!0},i.isPreload=function(){return this.preload},i.Sc=function(){this.l=!1},i.Ii=function(){return this.l},i.Yg=function(){this.o=!0},i.Ki=function(){return this.o},i.Xg=function(){this.F=!0},i.Ji=function(){return this.F},i.Wg=function(){this.m=!0},i.Ei=function(){return this.m},i.ye=function(e){this.thumbnailSprite=e},i.vi=function(){return this.thumbnailSprite},i.offset=function(e){this.startTime+=e,this.endTime+=e,this.j+=e;for(var t=c(this.g),n=t.next();!n.done;n=t.next())(n=n.value).startTime+=e,n.endTime+=e,n.j+=e},i.hg=function(e){null==this.h?W("Sync attempted without sync time!"):(e=this.h-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},i.rj=function(e){this.B=e},i.Qb=function(){return this.B},$("shaka.media.SegmentReference",ka),ka.prototype.getSegmentData=ka.prototype.Qb,ka.prototype.setSegmentData=ka.prototype.rj,ka.prototype.syncAgainst=ka.prototype.hg,ka.prototype.offset=ka.prototype.offset,ka.prototype.getThumbnailSprite=ka.prototype.vi,ka.prototype.setThumbnailSprite=ka.prototype.ye,ka.prototype.hasByterangeOptimization=ka.prototype.Ei,ka.prototype.markAsByterangeOptimization=ka.prototype.Wg,ka.prototype.isLastPartial=ka.prototype.Ji,ka.prototype.markAsLastPartial=ka.prototype.Xg,ka.prototype.isPartial=ka.prototype.Ki,ka.prototype.markAsPartial=ka.prototype.Yg,ka.prototype.isIndependent=ka.prototype.Ii,ka.prototype.markAsNonIndependent=ka.prototype.Sc,ka.prototype.isPreload=ka.prototype.isPreload,ka.prototype.markAsPreload=ka.prototype.Kf,ka.prototype.markAsUnavailable=ka.prototype.Qi,ka.prototype.getStatus=ka.prototype.cc,ka.prototype.getTileDuration=ka.prototype.xi,ka.prototype.getTilesLayout=ka.prototype.yi,ka.prototype.getEndByte=ka.prototype.$b,ka.prototype.getStartByte=ka.prototype.bc,ka.prototype.getEndTime=ka.prototype.di,ka.prototype.getStartTime=ka.prototype.getStartTime,ka.prototype.getUris=ka.prototype.N;var Aa=0,Ca=1;function Ia(e){return 1==e.length&&1e-4>e.end(0)-e.start(0)}function La(e){return!e||Ia(e)?null:e.length?e.end(e.length-1):null}function Da(e,t){return!(!e||!e.length||Ia(e)||t>e.end(e.length-1))&&t>=e.start(0)}function Ra(e,t){if(!e||!e.length||Ia(e))return 0;for(var n=0,i=(e=c(Ma(e))).next();!i.done;i=e.next()){var r=i.value;i=r.start,(r=r.end)>t&&(n+=r-Math.max(i,t))}return n}function Ma(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Pa(){}function Oa(e,t){var n=document.createElement("source");return n.src=e,n.type=void 0===t?"":t,n}function Na(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Ua(){}function Fa(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function Ba(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function ja(e,t){var n=(127&e[t])<<21;return n|=(127&e[t+1])<<14,(n|=(127&e[t+2])<<7)|127&e[t+3]}function $a(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if("APIC"===e.type){if(2>e.size||3!==e.data[0])return null;var n=e.data.subarray(1).indexOf(0);if(-1===n)return null;var i=pt(me(e.data,1,n)),r=e.data[2+n],s=e.data.subarray(3+n).indexOf(0);if(-1===s)return null;var a,o=pt(me(e.data,3+n,s));return a="--\x3e"===i?pt(me(e.data,4+n+s)):ge(e.data.subarray(4+n+s)),t.mimeType=i,t.pictureType=r,t.description=o,t.data=a,t}return"TXXX"===e.type||"WXXX"===e.type?2>e.size||3!==e.data[0]||-1===(i=e.data.subarray(1).indexOf(0))?null:(n=pt(me(e.data,1,i)),e=pt(me(e.data,2+i)).replace(/\0*$/,""),t.description=n,t.data=e,t):"PRIV"===e.type?2>e.size||-1===(n=e.data.indexOf(0))?null:(n=pt(me(e.data,0,n)),t.description=n,"com.apple.streaming.transportStreamTimestamp"==n?(n=e.data.subarray(n.length+1),e=1&n[3],n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=47721858.84),t.data=n):(e=ge(e.data.subarray(n.length+1)),t.data=e),t):"T"===e.type[0]?2>e.size||3!==e.data[0]?null:(e=pt(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):"W"===e.type[0]?(e=pt(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=ge(e.data),t):null}function Va(e){for(var t=0,n=[];Fa(e,t);){var i=ja(e,t+6);for(e[t+5]>>6&1&&(t+=10),i=(t+=10)+i;t+10<i;){var r=e.subarray(t),s=ja(r,4);(s=$a(r={type:String.fromCharCode(r[0],r[1],r[2],r[3]),size:s,data:r.subarray(10,10+s)}))&&n.push(s),t+=r.size+10}Ba(e,t)&&(t+=10)}return n}function Ha(e,t){for(var n=t=void 0===t?0:t,i=0;Fa(e,t);)e[t+5]>>6&1&&(i+=10),i+=10,i+=ja(e,t+6),Ba(e,t+10)&&(i+=10),t+=i;return 0<i?e.subarray(n,n+i):new Uint8Array([])}function qa(e,t){var n=null,i=null,r=null,s=e.R();return 1&t&&(r=e.Yc()),2&t&&e.skip(4),8&t&&(n=e.R()),16&t&&(i=e.R()),{trackId:s,jd:n,kd:i,Bk:r}}function Ga(e,t){return 1==t?(t=e.R(),e=e.R(),{baseMediaDecodeTime:t*Math.pow(2,32)+e}):{baseMediaDecodeTime:e.R()}}function za(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.R(),e.skip(4),e=e.na(),{timescale:t,language:String.fromCharCode(96+(e>>10))+String.fromCharCode(96+((960&e)>>5))+String.fromCharCode(96+(31&e))}}function Ka(e,t,n){var i=e.R(),r=[],s=null;1&n&&(s=e.R()),4&n&&e.skip(4);for(var a=0;a<i;a++){var o={Yf:null,sampleSize:null,ue:null};256&n&&(o.Yf=e.R()),512&n&&(o.sampleSize=e.R()),1024&n&&e.skip(4),2048&n&&(o.ue=0==t?e.R():e.gh()),r.push(o)}return{Fk:i,Xf:r,Wh:s}}function Wa(e){e.skip(6),e.skip(2),e.skip(8);var t=e.na();return e.skip(2),e.skip(2),e.skip(2),{channelCount:t,sampleRate:e=e.na()+e.na()/65536}}function Xa(e){return{codec:ks(e=e.R())}}function Ya(e,t){return t=void 0!==t&&t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)}function Qa(e){return(10>e?"0":"")+e}function Ja(e,t){if(this.j=e,void 0!==t&&t){t=new Uint8Array(e.byteLength);for(var n=0,i=0;i<e.byteLength;i++)2<=i&&3==e[i]&&0==e[i-1]&&0==e[i-2]||(t[n]=e[i],n++);this.j=me(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function Za(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),i=Math.min(4,e.i);0!==i&&(n.set(e.j.subarray(t,t+i)),e.h=new gs(n,0).R(),e.g=8*i,e.i-=i)}function eo(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=8*n,e.g-=n,Za(e)}e.h<<=t,e.g-=t}function to(e,t){var n=Math.min(e.g,t),i=e.h>>>32-n;return e.g-=n,0<e.g?e.h<<=n:0<e.i&&Za(e),0<(n=t-n)?i<<n|to(e,n):i}function no(e){var t;for(t=0;t<e.g;++t)if(0!==(e.h&2147483648>>>t))return e.h<<=t,e.g-=t,t;return Za(e),t+no(e)}function io(e){eo(e,1+no(e))}function ro(e){return to(e,no(e)+1)-1}function so(e){return 1&(e=ro(e))?1+e>>>1:-1*(e>>>1)}function ao(e){return 1===to(e,1)}function oo(e){return to(e,8)}function lo(e,t){for(var n=8,i=8,r=0;r<t;r++)0!==i&&(i=(n+(i=so(e))+256)%256),n=0===i?n:i}function uo(e){return oo(e),ro(e),ro(e)}function co(){this.G=null,this.H=!1,this.m=this.I=null,this.j=[],this.g=[],this.A=this.B=null,this.i=[],this.h=[],this.C=null,this.l=[],this.F=this.o=this.s=null}function ho(e,t){if(1!==(t[0]<<16|t[1]<<8|t[2]))return null;var n={data:new Uint8Array(0),packetLength:t[4]<<8|t[5],pts:null,dts:null,nalus:[]};if(n.packetLength&&n.packetLength>t.byteLength-6)return null;var i=t[7];if(192&i){var r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2;null==e.s&&(e.s=r),n.pts=po(r,e.s),e.s=n.pts,n.dts=n.pts,64&i&&(i=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,null==e.o&&(e.o=i),n.dts=po(i,e.o)),e.o=n.dts}return e=t[8]+9,t.byteLength<=e?null:(n.data=t.subarray(e),n)}function fo(e){var t=e.uc();return 1<t.length&&(e=t[0].pts,t=t[1].pts,!isNaN(t-e))?String(1/(t-e)*9e4):null}function po(e,t){var n=1;for(e>t&&(n=-1);4294967296<Math.abs(t-e);)e+=8589934592*n;return e}function go(e){return!(0>mo(e))}function mo(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71==e[n]&&71==e[n+188]&&71==e[n+376])return n;n++}return-1}ka.Status={Bj:Aa,xk:Ca,Yj:2},$("shaka.util.Dom",Pa),Pa.removeAllChildren=Na,$("shaka.util.Id3Utils",Ua),Ua.getID3Data=Ha,Ua.getID3Frames=Va,$("shaka.util.ExpGolomb",Ja),(i=co.prototype).clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},i.parse=function(e){if(564>e.length)return this;for(var t=Math.max(0,mo(e)),n=e.length-(e.length+t)%188,i=!1,r=t;r<n;r+=188)if(71==e[r]){var s=!!(64&e[r+1]),a=((31&e[r+1])<<8)+e[r+2];if(1<(48&e[r+3])>>4){var o=r+5+e[r+4];if(o==r+188)continue}else o=r+4;switch(a){case 0:s&&(o+=e[o]+1),this.G=(31&e[o+10])<<8|e[o+11];break;case 17:case 8191:break;case this.G:s&&(o+=e[o]+1),a={audio:-1,video:-1,$d:-1,audioCodec:"",videoCodec:""};var l=o+3+((15&(s=e)[o+1])<<8|s[o+2])-4;for(o+=12+((15&s[o+10])<<8|s[o+11]);o<l;){var u=(31&s[o+1])<<8|s[o+2],c=(15&s[o+3])<<8|s[o+4];switch(s[o]){case 6:if(0<c)for(var d=o+5,h=c;2<h;){var f=s[d+1]+2;switch(s[d]){case 5:var p=bt(s.subarray(d+2,d+f));-1==a.audio&&"Opus"===p?(a.audio=u,a.audioCodec="opus"):-1==a.video&&"AV01"===p&&(a.video=u,a.videoCodec="av1");break;case 106:-1==a.audio&&(a.audio=u,a.audioCodec="ac3");break;case 122:-1==a.audio&&(a.audio=u,a.audioCodec="ec3");break;case 124:-1==a.audio&&(a.audio=u,a.audioCodec="aac");break;case 127:"opus"==a.audioCodec&&(p=null,128===s[d+2]&&(p=s[d+3]),null!=p&&(this.F={channelCount:0===(15&p)?2:15&p,Qh:p,sampleRate:48e3}))}d+=f,h-=f}break;case 15:-1==a.audio&&(a.audio=u,a.audioCodec="aac");break;case 17:-1==a.audio&&(a.audio=u,a.audioCodec="aac-loas");break;case 21:-1==a.$d&&(a.$d=u);break;case 27:-1==a.video&&(a.video=u,a.videoCodec="avc");break;case 3:case 4:-1==a.audio&&(a.audio=u,a.audioCodec="mp3");break;case 36:-1==a.video&&(a.video=u,a.videoCodec="hvc");break;case 129:-1==a.audio&&(a.audio=u,a.audioCodec="ac3");break;case 132:case 135:-1==a.audio&&(a.audio=u,a.audioCodec="ec3")}o+=c+5}-1!=(s=a).video&&(this.I=s.video,this.m=s.videoCodec),-1!=s.audio&&(this.B=s.audio,this.A=s.audioCodec),-1!=s.$d&&(this.C=s.$d),i&&!this.H&&(i=!1,r=t-188),this.H=!0;break;case this.I:o=e.subarray(o,r+188),s?this.j.push([o]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(o);break;case this.B:o=e.subarray(o,r+188),s?this.i.push([o]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(o);break;case this.C:o=e.subarray(o,r+188),s?this.l.push([o]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(o);break;default:i=!0}}return this},i.Wi=function(e){return oe("TsParser.parseAvcNalus","Please use parseNalus function instead."),this.Pf(e,{Cd:null,state:null})},i.Pf=function(e,t){var n=e.pts?e.pts/9e4:null,i=(e=e.data).byteLength,r=1;"hvc"==this.m&&(r=2);var s=t.state||0,a=s,o=0,l=[],u=-1,c=0;for(-1==s&&(u=0,c="hvc"==this.m?e[0]>>1&63:31&e[0],s=0,o=1);o<i;){var d=e[o++];s?1===s?s=d?0:2:d?1==d?(d=o-s-1,0<=u?l.push({data:e.subarray(u+r,d),fullData:e.subarray(u,d),type:c,time:n,state:null}):(s=l.length?l[l.length-1]:t.Cd)&&(a&&o<=4-a&&s.state&&(s.data=s.data.subarray(0,s.data.byteLength-a),s.fullData=s.fullData.subarray(0,s.fullData.byteLength-a)),0<d&&(d=e.subarray(0,d),s.data=pi(s.data,d),s.fullData=pi(s.fullData,d),s.state=0)),o<i?(c="hvc"==this.m?e[o]>>1&63:31&e[o],u=o,s=0):s=-1):s=0:s=3:s=d?0:1}return 0<=u&&0<=s&&l.push({data:e.subarray(u+r,i),fullData:e.subarray(u,i),type:c,time:n,state:s}),!l.length&&t.Cd&&(n=l.length?l[l.length-1]:t.Cd)&&(n.data=pi(n.data,e),n.fullData=pi(n.fullData,e)),t.state=s,l},i.getMetadata=function(){for(var e=[],t=c(this.l),n=t.next();!n.done;n=t.next())(n=ho(this,n=pi.apply(li,d(n.value))))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:Va(n.data),dts:n.dts,pts:n.pts});return e},i.fb=function(){if(this.i.length&&!this.h.length){for(var e=!1,t=c(this.i),n=t.next();!n.done;n=t.next()){var i=pi.apply(li,d(n.value)),r=ho(this,i);n=this.h.length?this.h[this.h.length-1]:null,r&&null!=r.pts&&null!=r.dts&&(!n||n.pts!=r.pts&&n.dts!=r.dts)?(this.h.length&&r.dts<(n.dts||0)&&(e=!0),this.h.push(r)):this.h.length&&(i=r?r.data:i)&&((n=this.h.pop()).data=pi(n.data,i),this.h.push(n))}e&&(this.h=this.h.sort((function(e,t){var n=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||n})))}return this.h},i.uc=function(e){if(e=void 0===e||e,this.j.length&&!this.g.length){for(var t=!1,n=c(this.j),i=n.next();!i.done;i=n.next()){var r=pi.apply(li,d(i.value)),s=ho(this,r);i=this.g.length?this.g[this.g.length-1]:null,s&&null!=s.pts&&null!=s.dts&&(!i||i.pts!=s.pts&&i.dts!=s.dts)?(this.g.length&&s.dts<(i.dts||0)&&(t=!0),this.g.push(s)):this.g.length&&(r=s?s.data:r)&&((i=this.g.pop()).data=pi(i.data,r),this.g.push(i))}if(e){for(n={Cd:null,state:null},i=[],s=(r=c(this.g)).next();!s.done;s=r.next())(s=s.value).nalus=this.Pf(s,n),s.nalus.length&&(i.push(s),n.Cd=s.nalus[s.nalus.length-1]);this.g=i}t&&(this.g=this.g.sort((function(e,t){var n=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||n})))}return e?this.g:(e=this.g,this.g=[],e)},i.getStartTime=function(e){if("audio"==e){e=null;var t=this.fb();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return"video"==e?(e=null,(t=this.uc(!1)).length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},i.ld=function(){return{audio:this.A,video:this.m}},i.Zd=function(){for(var e=[],t=c(this.uc()),n=t.next();!n.done;n=t.next())e.push.apply(e,d(n.value.nalus));return e},i.Bi=function(){oe("TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.Af();return{height:e.height,width:e.width}},i.Af=function(){return"hvc"==this.m?function(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.Zd();if(!n.length)return t;if(!(n=n.find((function(e){return 33==e.type}))))return t;var i=new Ja(n.fullData,!0);oo(i),oo(i),to(i,4);var r=to(i,3);ao(i);var s=to(i,2),a=to(i,1),o=to(i,5),l=to(i,32);n=oo(i);for(var u=oo(i),c=oo(i),d=oo(i),h=oo(i),f=oo(i),p=oo(i),g=[],m=[],y=0;y<r;y++)g.push(ao(i)),m.push(ao(i));if(0<r)for(y=r;8>y;y++)to(i,2);for(y=0;y<r;y++)g[y]&&to(i,88),m[y]&&oo(i);ro(i),3==(r=ro(i))&&to(i,1),g=ro(i),m=ro(i);var v=y=0,b=0,T=0;return ao(i)&&(y+=ro(i),v+=ro(i),b+=ro(i),T+=ro(i)),t.width=String(g-(y+v)*(1===r||2===r?2:1)),t.height=String(m-(b+T)*(1===r?2:1)),i=function(e){for(var t=0,n=0;32>n;n++)t|=(e>>n&1)<<31-n;return t>>>0}(l),a=1==a?"H":"L",s="hvc1."+["","A","B","C"][s]+o,s+="."+i.toString(16).toUpperCase(),s+="."+a+p,f&&(s+="."+f.toString(16).toUpperCase()),h&&(s+="."+h.toString(16).toUpperCase()),d&&(s+="."+d.toString(16).toUpperCase()),c&&(s+="."+c.toString(16).toUpperCase()),u&&(s+="."+u.toString(16).toUpperCase()),n&&(s+="."+n.toString(16).toUpperCase()),t.codec=s,t.frameRate=fo(e),t}(this):function(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.Zd();if(!n.length)return t;if(!(n=n.find((function(e){return 7==e.type}))))return t;var i=oo(n=new Ja(n.data)),r=oo(n),s=oo(n);if(io(n),yo.includes(i)){var a=ro(n);if(3===a&&eo(n,1),io(n),io(n),eo(n,1),ao(n)){a=3!==a?8:12;for(var o=0;o<a;o++)ao(n)&&lo(n,6>o?16:64)}}if(io(n),0===(a=ro(n)))ro(n);else if(1===a)for(eo(n,1),io(n),io(n),a=ro(n),o=0;o<a;o++)io(n);io(n),eo(n,1),a=ro(n),o=ro(n);var l=to(n,1);0===l&&eo(n,1),eo(n,1);var u=0,c=0,d=0,h=0;return ao(n)&&(u=ro(n),c=ro(n),d=ro(n),h=ro(n)),t.height=String((2-l)*(o+1)*16-2*d-2*h),t.width=String(16*(a+1)-2*u-2*c),t.codec="avc1."+("0"+i.toString(16).toUpperCase()).slice(-2)+("0"+r.toString(16).toUpperCase()).slice(-2)+("0"+s.toString(16).toUpperCase()).slice(-2),t.frameRate=fo(e),t}(this)},$("shaka.util.TsParser",co),co.syncOffset=mo,co.probe=go,co.prototype.getVideoInfo=co.prototype.Af,co.prototype.getVideoResolution=co.prototype.Bi,co.prototype.getVideoNalus=co.prototype.Zd,co.prototype.getCodecs=co.prototype.ld,co.prototype.getStartTime=co.prototype.getStartTime,co.prototype.getVideoData=co.prototype.uc,co.prototype.getAudioData=co.prototype.fb,co.prototype.getMetadata=co.prototype.getMetadata,co.prototype.parseNalus=co.prototype.Pf,co.prototype.parseAvcNalus=co.prototype.Wi,co.prototype.parse=co.prototype.parse,co.prototype.clearData=co.prototype.clearData,co.Timescale=9e4;var yo=[100,110,122,244,44,83,86,118,128,138,139,134];function vo(e,t,n){this.g=null,this.o=-1,this.l=e,this.i=t,this.m=n,this.j=!1;e:{if("undefined"===typeof libDPIModule&&X("Could not find LCEVC Library dependencies on this page"),"undefined"!==typeof LCEVCdec)this.h=LCEVCdec;else{if("undefined"===typeof LcevcDil){X("Could not find LCEVC Library on this page"),e=!1;break e}this.h=LcevcDil,this.j=!0,oe("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead")}"undefined"===typeof this.h.SupportObject?(X("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||X(this.h.SupportObject.SupportError),e="undefined"!==typeof this.h&&"undefined"!==typeof libDPIModule&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function bo(e){e.g&&e.i.classList.add("shaka-hidden")}function To(e,t,n){var i=0,r=-1;switch(t.mimeType){case"video/webm":i=1;break;case"video/mp4":i=2}switch(n){case"DASH":r=1;break;case"HLS":r=0}e.g&&(e.o=t.id,e.g.setLevelSwitching(t.id,!0),e.g.setContainerFormat(i),e.j||e.g.setStreamingFormat(r))}function So(e,t,n,i){var r=this;this.g=e,this.H=n,this.B=null,this.ga=t,this.l=new Map,this.A=new Map,this.Aa=new Map,this.h=null,this.Ca=!1,this.da=i||null,this.s=new Map,this.o=new ee,this.j=new Map,this.K=null,this.G=new jr,this.Da="",this.Qa=!1,this.sa=!0,this.$=!1,this.C=this.L=null,this.i=_o(this,this.G),this.I=!1,this.M=new cs((function(){return function(e){var t,n,i,r,s,a,o,l,u,d,h,f,p;return M((function(g){if(1==g.g){for(t=[],n=c(e.s),i=n.next();!i.done;i=n.next())for(r=i.value,s=c(r),a=s.next().value,o=s.next().value,l=o[0],u=a,e.s.set(u,o.slice(0,1)),l&&t.push(l.p.catch(Ki)),d=c(o.slice(1)),h=d.next();!h.done;h=d.next())h.value.p.reject(new Me(2,7,7003,void 0));return e.h&&t.push(e.h.destroy()),S(g,Promise.all(t),2)}for(f=c(e.j.values()),p=f.next();!p.done;p=f.next())p.value.destroy();e.o&&(e.o.release(),e.o=null),e.g&&e.C&&e.g.removeChild(e.C),e.g&&e.L&&(e.g.removeChild(e.L),e.g.load(),e.g.disableRemotePlayback=!1),e.g=null,e.L=null,e.C=null,e.B=null,e.i=null,e.h=null,e.ga=null,e.l.clear(),e.Aa.clear(),e.j.clear(),e.K=null,e.s.clear(),e.da=null,e.W.clear(),e.H=null,_(g)}))}(r)})),this.F=!1,this.ba="UNKNOWN",this.Ia=this.Oa=!1,this.Ba=new jr,this.m=!1,this.pa=null,this.W=new Map,this.ja=this.O=this.oa=this.P=null,this.ia=new jr,this.g.remote&&(this.$="disconnected"!=this.g.remote.state,this.o.D(this.g.remote,"connect",(function(){r.$="disconnected"!=r.g.remote.state})),this.o.D(this.g.remote,"connecting",(function(){r.$="disconnected"!=r.g.remote.state})),this.o.D(this.g.remote,"disconnect",(function(){r.$="disconnected"!=r.g.remote.state})))}function _o(t,n){if(t.sa=!0,e.ManagedMediaSource){t.C||(t.g.disableRemotePlayback=!0);var i=new ManagedMediaSource;t.o.D(i,"startstreaming",(function(){t.sa=!0})),t.o.D(i,"endstreaming",(function(){t.sa=!1}))}else i=new MediaSource;return t.o.ma(i,"sourceopen",(function(){URL.revokeObjectURL(t.Da),n.resolve()})),t.o.ma(t.g,"playing",(function(){t.Qa=!0})),t.Da=qo(i),t.g.removeAttribute("src"),t.L&&t.g.removeChild(t.L),t.C&&t.g.removeChild(t.C),t.L=Oa(t.Da),t.g.appendChild(t.L),t.C&&t.g.appendChild(t.C),t.g.load(),i}function wo(e,t,n,i){var r,s,a,o,l,u,d,h,f,p,g,m;return M((function(y){switch(y.g){case 1:return r=_i,s=V,a=H,S(y,function(e,t){var n,i,r,s,a,o,l,u,d,h;return M((function(f){if(1==f.g)return e.createSegmentIndex?S(f,e.createSegmentIndex(),2):f.u(2);if(!e.segmentIndex)return f.return(!1);if(0==e.segmentIndex.getNumReferences())return f.return(!0);for(n=_i,i=new Set,r=c(e.segmentIndex),s=r.next();!s.done;s=r.next())if(a=s.value,o=a.mimeType||e.mimeType||"",l=a.codecs||e.codecs||"",(o!=e.mimeType||l!=e.codecs)&&(u=o+":"+l,!i.has(u)))if(i.add(u),t==n.xa){if(!Vi(xi(o,l)))return f.return(!1)}else if(t==n.la?l=mr(l):t==n.U&&(l=gr(l,o)),d=Ii(e,o,l),h=Ai(o,l),!ie(d)&&!Bn(h))return f.return(!1);return f.return(!0)}))}(n,t),2);case 2:if(a.call(s,y.h,"Type negotiation should happen before MediaSourceEngine.init!"),t==r.U&&i&&(i=gr(i,n.mimeType)),o=xi(n.mimeType,i),t==r.xa){Eo(e,o,e.F,n.external),y.u(0);break}if(l=e.B.forceTransmux,(!ie(o)||!e.F&&Fi.includes(o))&&(l=!0),u=Ai(n.mimeType,i),!l){y.u(4);break}if(d=bi(r.U,(i||"").split(",")),h=bi(r.la,(i||"").split(",")),!d||!h){y.u(5);break}return e.m=!0,S(y,wo(e,r.U,n,d),6);case 6:return S(y,wo(e,r.la,n,h),7);case 7:return y.return();case 5:(f=Bn(u))&&(p=f(),e.j.set(t,p),o=p.convertCodecs(t,u));case 4:g=o+e.B.addExtraFeaturesToSourceBuffer(o),ds(e.M);try{m=e.i.addSourceBuffer(g)}catch(v){throw new Me(2,3,3015,v,"The mediaSource_ status was "+e.i.readyState+" expected 'open'",null)}e.F&&(m.mode=Go),e.o.D(m,"error",(function(){var n=e.s.get(t)[0];n.p.reject(new Me(2,3,3014,e.g.error?e.g.error.code:0,n.uri))})),e.o.D(m,"updateend",(function(){return Uo(e,t)})),e.l.set(t,m),e.A.set(t,o),e.Aa.set(t,!!n.drmInfos.length),_(y)}}))}function Eo(e,t,n,i){e.h||(e.h=new Bi(e.ga),e.h&&(e.h.A=e.B.modifyCueCallback));var r=e.h;i=i||e.Ca,e=e.ba,"application/cea-608"==t||"application/cea-708"==t?r.i=null:(r.i=Gi.get(t)(),r.i.setSequenceMode?r.i.setSequenceMode(n):oe("Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),r.i.setManifestType?r.i.setManifestType(e):oe("Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),r.B=i)}function ko(e){return!e.I&&(!e.i||"ended"==e.i.readyState)}function xo(e){return!e.I&&(!e.i||"closed"==e.i.readyState)}function Ao(e,t){return e.l.size?t==Si?e=e.h.g:e=!(e=Io(e,t))||Ia(e)?null:1==e.length&&0>e.start(0)?0:e.length?e.start(0):null:e=null,e}function Co(e,t){return e.l.size?t==Si?e.h.h:La(Io(e,t)):null}function Io(e,t){if(e.I||e.$)return null;try{return e.l.get(t).buffered}catch(n){return e.l.has(t),null}}function Lo(e,t,n,i,r,s,a,o,l,u){var d,h,f,p,g,m,y,v,b,T,w,E,k,x,A,C;return a=void 0!==a&&a,o=void 0!==o&&o,l=void 0!==l&&l,u=void 0!==u&&u,M((function(I){switch(I.g){case 1:if(t!=(d=_i).xa){I.u(2);break}if("HLS"!=e.ba){I.u(3);break}return S(I,e.Ba,4);case 4:h=I.h,e.h.s=h;case 3:return S(I,function(e,t,n,i,r){var s,a,o,l,u,d,h;return M((function(f){if(1==f.g)return S(f,Promise.resolve(),2);if(!e.i||!e.j)return f.return();if(null==n||null==i)return e.i.parseInit(me(t)),f.return();for(s=e.B?n:e.s,a={periodStart:e.s,segmentStart:n,segmentEnd:i,vttOffset:s},o=e.i.parseMedia(me(t),a,r,[]),l=c(o),u=l.next();!u.done;u=l.next())d=u.value,e.A(d,r||null,a);h=o.filter((function(t){return t.startTime>=e.l&&t.startTime<e.m})),e.j.append(h),null==e.g&&(e.g=Math.max(n,e.l)),e.h=Math.min(i,e.m),_(f)}))}(e.h,n,i?i.startTime:null,i?i.endTime:null,i?i.N()[0]:null),5);case 5:return I.return();case 2:if(u||!e.m){I.u(6);break}return S(I,Lo(e,d.U,n,i,r,s,a,o,l,!0),7);case 7:return S(I,Lo(e,d.la,n,i,r,s,a,o,l,!0),8);case 8:return I.return();case 6:if(!e.l.has(t))return I.return();if(f=e.l.get(t).timestampOffset,p=e.A.get(t),e.j.has(t)&&(p=e.j.get(t).getOriginalMimeType()),i&&(g=function(e,t,n,i,r,s){var a=null,o=[],l=me(n);if(Fi.includes(s))(t=Va(l)).length&&i&&((n=t.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(a=Math.round(n.data)/1e3),e.H.onMetadata([{cueTime:i.startTime,data:l,frames:t,dts:i.startTime,pts:i.startTime}],0,i.endTime));else if(s.includes("/mp4")&&i&&i.ca&&i.ca.timescale){var u=i.ca.timescale;if(!isNaN(u)){var c=null!=r.emsgSchemeIdUris&&0<r.emsgSchemeIdUris.length||e.B.dispatchAllEmsgBoxes,d=0,h=!1;l=new vs,c&&l.S("emsg",(function(t){var n=r.emsgSchemeIdUris;if(0===t.version)var s=t.reader.Ac(),a=t.reader.Ac(),o=t.reader.R(),l=t.reader.R(),u=t.reader.R(),c=t.reader.R(),d=i.startTime+l/o;else o=t.reader.R(),l=(d=t.reader.Yc()/o+i.timestampOffset)-i.startTime,u=t.reader.R(),c=t.reader.R(),s=t.reader.Ac(),a=t.reader.Ac();t=t.reader.Bb(t.reader.getLength()-t.reader.ya()),(n&&n.includes(s)||e.B.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==s?e.H.Vi():(n=d+u/o,(o=new Kr("emsg",o=(new Map).set("detail",{startTime:d,endTime:n,schemeIdUri:s,value:a,timescale:o,presentationTimeDelta:l,eventDuration:u,id:c,messageData:t}))).cancelable=!0,e.H.onEvent(o),o.defaultPrevented||"https://aomedia.org/emsg/ID3"!=s&&"https://developer.apple.com/streaming/emsg-id3"!=s||!(s=Va(t)).length||e.H.onMetadata([{cueTime:d,data:t,frames:s,dts:d,pts:d}],0,n)))})),l.S("prft",(function(t){var n=t.reader,i=t.version;n.R(),t=1e3*(t=n.R())+n.R()/Math.pow(2,32)*1e3,0===i?n=n.R():(i=n.R(),n=n.R(),n=i*Math.pow(2,32)+n),t=new Date(new Date(Date.UTC(1900,0,1,0,0,0)).getTime()+t).getTime(),n=new Kr("prft",n=(new Map).set("detail",{wallClockTime:t,programStartDate:new Date(t-n/u*1e3)})),e.H.onEvent(n)})).box("moof",bs).box("traf",bs).S("tfdt",(function(e){h||(d=Ga(e.reader,e.version).baseMediaDecodeTime/u,h=!0,c||e.parser.stop())})).parse(n,!0),h&&0==i.timestampOffset&&(a=d)}}else s.includes("/mp4")||s.includes("/webm")||!go(l)||(e.W.has(t)?e.W.get(t).clearData():e.W.set(t,new co),null!=(l=(o=e.W.get(t).parse(l)).getStartTime(t))&&(a=l),o=o.getMetadata());return{timestamp:a,metadata:o}}(e,t,n,i,r,p),m=g.timestamp,y=g.metadata,null!=m&&(null==e.P&&t==d.la&&(e.P=m,e.oa=i.startTime,null!=e.O&&(v=0,e.oa==e.ja&&(v=e.P-e.O),e.ia.resolve(v))),null==e.O&&t==d.U&&(e.O=m,e.ja=i.startTime,null!=e.P&&(b=0,e.oa==e.ja&&(b=e.P-e.O),e.ia.resolve(b))),T=m,w=Fi,!e.F&&w.includes(e.A.get(t))&&(T=0),E=i.startTime-T,(.001<=Math.abs(f-E)||a||o)&&(!l||0<E||!f)&&(f=E,e.Ia&&(Fo(e,t,(function(){return Oo(e,t)}),null),Fo(e,t,(function(){return No(e,t,f)}),null))),(t==d.la||!e.l.has(d.la))&&e.Ba.resolve(f)),y.length)&&e.H.onMetadata(y,f,i?i.endTime:null),s&&t==d.la&&(e.h||Eo(e,"application/cea-608",e.F,!1),e.K||(k=p.split(";",1)[0],e.K=new Se(k)),i?(x=e.K.i(n)).length&&function(e,t,n,i,r){for(var s=n+" "+i,a=new Map,o=(t=c(t)).next();!o.done;o=t.next()){var l=o.value;o=l.stream,l=l.cue,a.has(o)||a.set(o,new Map),a.get(o).has(s)||a.get(o).set(s,[]),qi(e,l,r),l.startTime>=e.l&&l.startTime<e.m&&(a.get(o).get(s).push(l),o==e.C&&e.j.append([l]))}for(s=(r=c(a.keys())).next();!s.done;s=r.next())for(s=s.value,e.o.has(s)||e.o.set(s,new Map),o=(t=c(a.get(s).keys())).next();!o.done;o=t.next())o=o.value,l=a.get(s).get(o),e.o.get(s).set(o,l);e.g=null==e.g?Math.max(n,e.l):Math.min(e.g,Math.max(n,e.l)),e.h=Math.max(e.h,Math.min(i,e.m))}(e.h,x,i.startTime,i.endTime,f):e.K.init(n,o)),!e.j.has(t)){I.u(9);break}return S(I,e.j.get(t).transmux(n,r,i,e.i.duration,t),10);case 10:n=I.h;case 9:if(n=function(e,t,n,i,r){n=null==n;var s=e.Aa.get(i),a=e.H.ii();(s=e.B.insertFakeEncryptionInInit&&n&&s)&&(a=Fe(a),s=Ke()||ze()||ot("SOPOpenBrowser")||Ge()&&it()&&a);return s&&"mp4"==Li(e.A.get(i))&&(t=function(e,t){function n(){a=!0}function i(e){o.push(e),bs(e)}var r,s=e=me(e),a=!1,o=[],l=[];if((new vs).box("moov",i).box("trak",i).box("mdia",i).box("minf",i).box("stbl",i).S("stsd",(function(e){r=e,o.push(e),Ts(e)})).S("encv",n).S("enca",n).S("dvav",(function(e){l.push({box:e,Ya:1701733238})})).S("dva1",(function(e){l.push({box:e,Ya:1701733238})})).S("dvh1",(function(e){l.push({box:e,Ya:1701733238})})).S("dvhe",(function(e){l.push({box:e,Ya:1701733238})})).S("dvc1",(function(e){l.push({box:e,Ya:1701733238})})).S("dvi1",(function(e){l.push({box:e,Ya:1701733238})})).S("hev1",(function(e){l.push({box:e,Ya:1701733238})})).S("hvc1",(function(e){l.push({box:e,Ya:1701733238})})).S("avc1",(function(e){l.push({box:e,Ya:1701733238})})).S("avc3",(function(e){l.push({box:e,Ya:1701733238})})).S("ac-3",(function(e){l.push({box:e,Ya:1701733217})})).S("ec-3",(function(e){l.push({box:e,Ya:1701733217})})).S("ac-4",(function(e){l.push({box:e,Ya:1701733217})})).S("mp4a",(function(e){l.push({box:e,Ya:1701733217})})).parse(e),a)return e;if(0==l.length||!r)throw fi(e),new Me(2,3,3019,t);l.reverse();for(var u=(t=c(l)).next();!u.done;u=t.next())u=u.value,s=Ta(s,r,u.box,o,u.Ya);return Ge()&&it()&&!ze()?((t=new Uint8Array(e.byteLength+s.byteLength)).set(s),t.set(e,s.byteLength),t):s}(t,r)),n&&We()&&"mp4"==Li(e.A.get(i))&&(t=function(e){function t(e){i.push({start:e.start,size:e.size}),bs(e)}var n=me(e),i=[];return(new vs).box("moov",t).box("trak",t).box("mdia",t).box("minf",t).box("stbl",t).box("stsd",(function(e){i.push({start:e.start,size:e.size});for(var t=ve(n,e.start),r=0;r<e.size;r++){var s=t.getUint32(r);1633889587==s?t.setUint32(r,1700998451):1684103987==s&&t.setUint32(r,1684366131)}})).parse(n),n}(t)),t}(e,n,i?i.startTime:null,t,i?i.N()[0]:null),!i||!e.F||t==d.xa){I.u(11);break}if(!a&&!o){I.u(11);break}if(A=i.startTime,"HLS"!=e.ba||e.m||t!=d.U||!e.l.has(d.la)){I.u(13);break}return S(I,e.ia,14);case 14:C=I.h,.15<Math.abs(C)&&(A-=C);case 13:Fo(e,t,(function(){return Oo(e,t)}),null),Fo(e,t,(function(){return No(e,t,A)}),null);case 11:return S(I,Fo(e,t,(function(){var i=n;if("video"==t&&e.da){var r=e.da;r.g&&r.g.appendBuffer(i,"video",r.o,-f)}e.l.get(t).appendBuffer(i)}),i?i.N()[0]:null),15);case 15:_(I)}}))}function Do(e,t){var n;return M((function(i){return 1==i.g?t==(n=_i).xa?e.h?S(i,e.h.remove(0,1/0),0):i.return():S(i,Fo(e,t,(function(){return Po(e,t,0,e.i.duration)}),null),4):e.m?S(i,Fo(e,n.U,(function(){return Po(e,n.U,0,e.i.duration)}),null),0):i.u(0)}))}function Ro(e,t,n,i,r,s,a,o,l){var u,c;return M((function(d){return 1==d.g?t==(u=_i).xa?(s||(e.h.s=n),function(e,t,n){e.l=t,e.m=n}(e.h,i,r),d.return()):(c=[],S(d,function(e,t,n,i,r){var s,a,o,l,u,c,d,h,f,p,g,m,y,v;return M((function(b){return 1==b.g?t==(s=_i).xa?b.return(!1):(a=Di(Pi(e.A.get(t))),o=Mi(e.A.get(t)),l=Ho(e,t,n,i),u=l.lg,c=l.tj,d=l.yg,h=l.codec,f=l.mimeType,p=!0,c&&e.A.has(s.U)&&(g=Ho(e,s.U,n,i),m=Di(Pi(e.A.get(s.U))),y=Mi(e.A.get(s.U)),p=m==g.codec&&y==g.yg,g.lg&&g.lg.destroy()),a===h&&o===d&&p?(e.j.has(t)&&!u?(e.j.get(t).destroy(),e.j.delete(t)):!e.j.has(t)&&u?e.j.set(t,u):u&&(e.j.has(t)&&e.j.get(t).transmux!=u.transmux?(e.j.get(t).destroy(),e.j.delete(t),e.j.set(t,u)):u.destroy()),b.return(!1)):(v=!0,(e.m||c&&u&&!e.j.has(t))&&(v=!1),v&&"smooth"===e.B.codecSwitchingStrategy&&re()?S(b,function(e,t,n,i){return Fo(e,t,(function(){if(t!==Si){if(e.A.get(t),re()){e.j.has(t)&&(e.j.get(t).destroy(),e.j.delete(t)),i&&e.j.set(t,i);var r=n+e.B.addExtraFeaturesToSourceBuffer(n);e.l.get(t).changeType(r),e.A.set(t,n)}Uo(e,t)}}),null)}(e,t,f,u),3):(u&&u.destroy(),S(b,Vo(e,r),3)))):b.return(!0)}))}(e,t,a,o,l),2)):(d.h||(c.push(Fo(e,t,(function(){return Oo(e,t)}),null)),e.m&&c.push(Fo(e,u.U,(function(){return Oo(e,u.U)}),null))),s||(c.push(Fo(e,t,(function(){return No(e,t,n)}),null)),e.m&&c.push(Fo(e,u.U,(function(){return No(e,u.U,n)}),null))),0==i&&1/0==r||(c.push(Fo(e,t,(function(){var n=e.l.get(t);n.appendWindowStart=0,n.appendWindowEnd=r,n.appendWindowStart=i,Uo(e,t)}),null)),e.m&&c.push(Fo(e,u.U,(function(){var t=u.U,n=e.l.get(t);n.appendWindowStart=0,n.appendWindowEnd=r,n.appendWindowStart=i,Uo(e,t)}),null))),c.length?S(d,Promise.all(c),0):d.u(0))}))}function Mo(e){M((function(t){return ko(e)||xo(e)?t.return():S(t,Bo(e,(function(){ko(e)||xo(e)||e.i.clearLiveSeekableRange()})),0)}))}function Po(e,t,n,i){i<=n?Uo(e,t):e.l.get(t).remove(n,i)}function Oo(e,t){var n=e.l.get(t),i=n.appendWindowStart,r=n.appendWindowEnd;n.abort(),n.appendWindowStart=i,n.appendWindowEnd=r,Uo(e,t)}function No(e,t,n){0>n&&(n+=.001),e.l.get(t).timestampOffset=n,Uo(e,t)}function Uo(e,t){if(!e.I){var n=e.s.get(t)[0];n&&(n.p.resolve(),jo(e,t))}}function Fo(e,t,n,i){return ds(e.M),n={start:n,p:new jr,uri:i},e.s.get(t).push(n),1==e.s.get(t).length&&$o(e,t),n.p}function Bo(e,t){var n,i,r,s,a,o,l,u,d,h,f;return M((function(p){switch(p.g){case 1:for(ds(e.M),n=[],i=Array.from(e.l.keys()),r=c(i),s=r.next(),a={};!s.done;a={ready:void 0},s=r.next())o=s.value,a.ready=new jr,l={start:function(e){return function(){return e.ready.resolve()}}(a),p:a.ready,uri:null},(u=e.s.get(o)).push(l),n.push(a.ready),1==u.length&&l.start();return w(p,2),S(p,Promise.all(n),4);case 4:k(p,3);break;case 2:throw x(p);case 3:return w(p,5,6),S(p,t(),6);case 6:for(A(p),d=c(i),h=d.next();!h.done;h=d.next())f=h.value,jo(e,f);C(p,0);break;case 5:throw new Me(2,3,3015,x(p),e.g.error||"No error in the media element",null)}}))}function jo(e,t){e.s.get(t).shift(),$o(e,t)}function $o(e,t){var n=e.s.get(t)[0];if(n)try{n.start()}catch(i){"QuotaExceededError"==i.name?n.p.reject(new Me(2,3,3017,t)):n.p.reject(new Me(2,3,3015,i,e.g.error||"No error in the media element",n.uri)),jo(e,t)}}function Vo(e,t){return Bo(e,(function(){return function(e,t){var n,i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,_,w;return M((function(k){switch(k.g){case 1:for(n=_i,e.I=!0,e.m=!1,i=e.g.currentTime,r=e.g.autoplay,s=e.g.paused,e.Qa&&(e.g.autoplay=!1),E(k,2),e.o.Ma(),a=c(e.j.values()),o=a.next();!o.done;o=a.next())o.value.destroy();for(l=c(e.l.values()),u=l.next();!u.done;u=l.next()){d=u.value;try{e.i.removeSourceBuffer(d)}catch(x){}}return e.j.clear(),e.l.clear(),h=e.i.duration,e.G=new jr,e.i=_o(e,e.G),S(k,e.G,4);case 4:!isNaN(h)&&h?e.i.duration=h:!isNaN(e.pa)&&e.pa&&(e.i.duration=e.pa),f=new jr,p=e.i.sourceBuffers,g=t.size,m=0,y=function(){++m===g&&(f.resolve(),e.o.bb(p,"addsourcebuffer",y))},e.o.D(p,"addsourcebuffer",y),v=c(t.keys()),b=v.next();case 5:return b.done?((w=t.get(n.U))&&w.isAudioMuxedInVideo&&(e.m=!0),e.m&&!e.s.has(n.U)&&e.s.set(n.U,[]),e.g.currentTime=i,S(k,f,2)):(T=b.value,_=t.get(T),S(k,wo(e,T,_,_.codecs),6));case 6:b=v.next(),k.u(5);break;case 2:A(k),e.I=!1,ds(e.M),e.o.ma(e.g,"canplaythrough",(function(){e.M.g||(e.g.autoplay=r,s||e.g.play())})),C(k,0)}}))}(e,t)}))}function Ho(e,t,n,i){var r=!1,s=bi("audio",(i||"").split(",")),a=bi("video",(i||"").split(",")),o=a;"audio"==t&&(o=s),o||(o=i),i=xi(n,o);var l=e.B.forceTransmux;if((!ie(i)||!e.F&&Fi.includes(i))&&(l=!0),l&&(n=Bn(e=Ai(n,o)))){var u=n();s&&a&&(r=!0),i=u.convertCodecs(t,e)}return t=Di(Pi(i)),{lg:u,tj:r,yg:Mi(i),codec:t,mimeType:i}}vo.prototype.release=function(){this.g&&(this.g.close(),this.g=null)},$("shaka.lcevc.Dec",vo),vo.prototype.release=vo.prototype.release,(i=So.prototype).destroy=function(){return this.M.destroy()},i.init=function(e,t,n,i){t=void 0!==t&&t,n=void 0===n?"UNKNOWN":n,i=void 0!==i&&i;var r,s,a,o,l,u,d=this;return M((function(h){switch(h.g){case 1:return r=_i,S(h,d.G,2);case 2:if(!ko(d)&&!xo(d)){h.u(3);break}return W("Expected MediaSource to be open during init(); reopening the media source."),d.G=new jr,d.i=_o(d,d.G),S(h,d.G,3);case 3:d.F=t,d.ba=n,d.Oa=i,d.Ia=!d.F&&"HLS"==d.ba&&!d.Oa,d.W.clear(),d.P=null,d.oa=null,d.O=null,d.ja=null,d.ia=new jr,s=c(e.keys()),a=s.next();case 5:if(a.done){h.u(7);break}return o=a.value,l=e.get(o),S(h,wo(d,o,l,l.codecs),8);case 8:d.m?(d.s.set(r.U,[]),d.s.set(r.la,[])):d.s.set(o,[]),a=s.next(),h.u(5);break;case 7:(u=e.get(r.U))&&u.isAudioMuxedInVideo&&(d.m=!0),_(h)}}))},i.configure=function(e){this.B=e,this.h&&(this.h.A=e.modifyCueCallback)},i.Fb=function(){var e={total:this.I?[]:Ma(this.g.buffered),audio:Ma(Io(this,"audio")),video:Ma(Io(this,"video")),text:[]};if(this.h){var t=this.h.g,n=this.h.h;null!=t&&null!=n&&e.text.push({start:t,end:n})}return e},i.remove=function(e,t,n){var i,r=this;return M((function(s){return 1==s.g?e==(i=_i).xa?S(s,r.h.remove(t,n),0):n>t?S(s,Fo(r,e,(function(){return Po(r,e,t,n)}),null),5):s.u(0):r.m?S(s,Fo(r,i.U,(function(){return Po(r,i.U,t,n)}),null),0):s.u(0)}))},i.flush=function(e){var t,n=this;return M((function(i){return 1==i.g?e==(t=_i).xa?i.return():S(i,Fo(n,e,(function(){n.g.currentTime-=.001,Uo(n,e)}),null),2):n.m?S(i,Fo(n,t.U,(function(){var e=t.U;n.g.currentTime-=.001,Uo(n,e)}),null),0):i.u(0)}))},i.endOfStream=function(e){var t=this;return M((function(n){return S(n,Bo(t,(function(){ko(t)||xo(t)||(e?t.i.endOfStream(e):t.i.endOfStream())})),0)}))},i.ab=function(e){var t=this;return M((function(n){return S(n,Bo(t,(function(){if(e<t.i.duration)for(var n=c(t.l.keys()),i=n.next();!i.done;i=n.next()){i=i.value;var r={start:function(){},p:new jr,uri:null};t.s.get(i).unshift(r)}t.i.duration=e,t.pa=e})),0)}))},i.getDuration=function(){return this.i.duration};var qo=e.URL.createObjectURL,Go="sequence";function zo(e,t,n){this.i=e,this.C=t,this.o=this.l=1/0,this.h=1,this.g=this.j=null,this.A=0,this.B=!0,this.I=!1,this.H=0,this.F=void 0===n||n,this.G=0,this.s=!1,this.m=e}function Ko(e,t,n,i){var r=this;this.s=i,this.g=e,this.B=t,this.h=n,this.o=new ee,this.l=!1,this.F=e.readyState,this.G=this.C=this.j=0,this.m=function(e){if(!e.h.stallEnabled)return null;var t=e.h.stallSkip;return new Xo(new Yo(e.g),e.h.stallThreshold,(function(){t?e.g.currentTime+=t:(e.g.pause(),e.g.play()),e.G++,e.s(new Kr("stalldetected"))}))}(this),this.A=!1,this.o.D(e,"waiting",(function(){return Wo(r)})),this.i=new Ve((function(){Wo(r)})).ua(this.h.gapJumpTimerTime)}function Wo(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.l)return}else e.l=!1;if(!e.g.paused||e.g.currentTime==e.j&&(e.g.autoplay||e.g.currentTime!=e.j)){var t;if(e.g.readyState!=e.F&&(e.F=e.g.readyState),!(t=!e.m)){var n=(t=e.m).j,i=Qo(n),r=n.g.currentTime,s=Date.now()/1e3;t.g==r&&t.m==i||(t.l=s,t.g=r,t.m=i,t.h=!1),(i=(r=s-t.l)>=t.o&&i&&!t.h)&&(t.i&&t.i(t.g,r),t.h=!0,t.g=n.g.currentTime),t=!i}t&&(t=e.g.currentTime,i=function(e,t,n){return e&&e.length&&!Ia(e)&&0<=(e=Ma(e).findIndex((function(e,i,r){return e.start>t&&(0==i||r[i-1].end-t<=n)})))?e:null}(n=e.g.buffered,t,e.h.gapDetectionThreshold),null==i||0==i&&!e.A||(r=n.start(i),(s=e.h.gapPadding)&&(r=Math.ceil(100*(r+s))/100),r>=e.B.nb()||.001>r-t||(0!=i&&n.end(i-1),e.g.currentTime=r,t==e.j&&(e.j=r),e.C++,e.s(new Kr("gapjumped")))))}}}function Xo(e,t,n){this.j=e,this.m=Qo(e),this.g=e.g.currentTime,this.l=Date.now()/1e3,this.h=!1,this.o=t,this.i=n}function Yo(e){this.g=e}function Qo(e){if(e.g.paused||0==e.g.playbackRate||0==e.g.buffered.length)var t=!1;else e:{t=e.g.currentTime;for(var n=(e=c(Ma(e.g.buffered))).next();!n.done;n=e.next())if(!(t<(n=n.value).start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function Jo(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=Zo.value().get(t),n.ma(e,t,i))}(i=zo.prototype).getDuration=function(){return this.l},i.li=function(){return this.h},i.qh=function(e){this.i=e},i.ab=function(e){this.l=e},i.pi=function(){return this.i},i.oh=function(e){this.A=e},i.Dc=function(e){e&&!this.B&&(this.I=!0),this.B=e},i.xe=function(e){this.o=e},i.Yd=function(){return this.o},i.bg=function(e){this.C=e},i.ci=function(){return this.C},i.bh=function(e,t){if(0!=e.length){var n=(Date.now()+this.A)/1e3;if(0!=(e=e.filter((function(e){return e.start+t<n}))).length){var i=e[e.length-1].end+t;this.ie(e[0].start+t),this.h=e.reduce((function(e,t){return Math.max(e,t.end-t.start)}),this.h),this.g=Math.max(this.g,i),null!=this.i&&this.F&&!this.s&&(this.i=n-this.g-this.h)}}},i.Dd=function(e){if(0!=e.length){for(var t=e[0].startTime,n=e[0].endTime,i=(Date.now()+this.A)/1e3,r=(e=c(e)).next();!r.done;r=e.next())i<(r=r.value).startTime||(t=Math.min(t,r.startTime),n=Math.max(n,r.endTime),this.h=Math.max(this.h,r.endTime-r.startTime));this.ie(t),this.g=Math.max(this.g,n),null!=this.i&&this.F&&!this.s&&(this.i=i-this.g-this.h)}},i.ah=function(e,t){this.ie(e),1/0==t||this.T()||(this.g=Math.max(this.g,t))},i.mi=function(){return this.g},i.de=function(){this.s=!0},i.Li=function(){return this.s},i.ph=function(e){this.m=e},i.hi=function(){return this.m},i.ie=function(e){null==this.j?this.j=e:this.I||(this.j=Math.min(this.j,e))},i.Lf=function(e){this.h=Math.max(this.h,e)},i.offset=function(e){null!=this.j&&(this.j+=e),null!=this.g&&(this.g+=e)},i.T=function(){return 1/0==this.l&&!this.B},i.wc=function(){return 1/0!=this.l&&!this.B},i.ob=function(){return Math.max(this.H,this.ac()-this.o)},i.th=function(e){this.H=e},i.ac=function(){return this.T()||this.wc()?Math.min(Math.max(0,(Date.now()+this.A)/1e3-this.h-this.i)+this.G,this.l):this.g?Math.min(this.g,this.l):this.l},i.od=function(e){var t=Math.max(this.j,this.H);return 1/0==this.o?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.ac()-this.o+e,this.nb()))},i.Gb=function(){return this.od(0)},i.nb=function(){return Math.max(0,this.ac()-(this.T()||this.wc()?this.C:0))},i.Ch=function(){return!(null==this.i||null!=this.g&&this.F)},i.nh=function(e){this.G=e},i.$h=function(){return this.G},$("shaka.media.PresentationTimeline",zo),zo.prototype.getAvailabilityTimeOffset=zo.prototype.$h,zo.prototype.setAvailabilityTimeOffset=zo.prototype.nh,zo.prototype.usingPresentationStartTime=zo.prototype.Ch,zo.prototype.getSeekRangeEnd=zo.prototype.nb,zo.prototype.getSeekRangeStart=zo.prototype.Gb,zo.prototype.getSafeSeekRangeStart=zo.prototype.od,zo.prototype.getSegmentAvailabilityEnd=zo.prototype.ac,zo.prototype.setUserSeekStart=zo.prototype.th,zo.prototype.getSegmentAvailabilityStart=zo.prototype.ob,zo.prototype.isInProgress=zo.prototype.wc,zo.prototype.isLive=zo.prototype.T,zo.prototype.offset=zo.prototype.offset,zo.prototype.notifyMaxSegmentDuration=zo.prototype.Lf,zo.prototype.notifyMinSegmentStartTime=zo.prototype.ie,zo.prototype.getInitialProgramDateTime=zo.prototype.hi,zo.prototype.setInitialProgramDateTime=zo.prototype.ph,zo.prototype.isStartTimeLocked=zo.prototype.Li,zo.prototype.lockStartTime=zo.prototype.de,zo.prototype.getMaxSegmentEndTime=zo.prototype.mi,zo.prototype.notifyPeriodDuration=zo.prototype.ah,zo.prototype.notifySegments=zo.prototype.Dd,zo.prototype.notifyTimeRange=zo.prototype.bh,zo.prototype.getDelay=zo.prototype.ci,zo.prototype.setDelay=zo.prototype.bg,zo.prototype.getSegmentAvailabilityDuration=zo.prototype.Yd,zo.prototype.setSegmentAvailabilityDuration=zo.prototype.xe,zo.prototype.setStatic=zo.prototype.Dc,zo.prototype.setClockOffset=zo.prototype.oh,zo.prototype.getPresentationStartTime=zo.prototype.pi,zo.prototype.setDuration=zo.prototype.ab,zo.prototype.setPresentationStartTime=zo.prototype.qh,zo.prototype.getMaxSegmentDuration=zo.prototype.li,zo.prototype.getDuration=zo.prototype.getDuration,Ko.prototype.release=function(){this.o&&(this.o.release(),this.o=null),null!=this.i&&(this.i.stop(),this.i=null),this.m&&(this.m.release(),this.m=null),this.g=this.B=this.s=null},Ko.prototype.le=function(){this.A=!0,this.i&&this.i.ua(this.h.gapJumpTimerTime),Wo(this)},Xo.prototype.release=function(){this.i=this.j=null};var Zo=new Oe((function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])}));function el(e,t,n,i){var r=this;this.g=e,this.m=t,this.s=n,this.l=null,this.j=function(){return null==r.l&&(r.l=i()),r.l},this.o=!1,this.h=new ee,this.i=new sl(e),Jo(this.g,HTMLMediaElement.HAVE_METADATA,this.h,(function(){il(r,r.j())}))}function tl(e){return e.o?e.g.currentTime:e.j()}function nl(e,t){0<e.g.readyState?al(e.i,t):Jo(e.g,HTMLMediaElement.HAVE_METADATA,e.h,(function(){il(e,e.j())}))}function il(e,t){.001>Math.abs(e.g.currentTime-t)?rl(e):(e.h.ma(e.g,"seeking",(function(){rl(e)})),al(e.i,e.g.currentTime&&0!=e.g.currentTime?e.g.currentTime:t))}function rl(e){e.o=!0,e.h.D(e.g,"seeking",(function(){return e.m()})),e.s(e.g.currentTime)}function sl(e){var t=this;this.g=e,this.m=10,this.j=this.l=this.i=0,this.h=new Ve((function(){0>=t.i||t.g.currentTime!=t.l||t.g.currentTime===t.j?t.h.stop():(t.g.currentTime=t.j,t.i--)}))}function al(e,t){e.l=e.g.currentTime,e.j=t,e.i=e.m,e.g.currentTime=t,e.h.ua(.1)}function ol(e){this.h=e,this.j=!1,this.g=null,this.i=new ee}function ll(e,t,n,i,r,s){var a=this;this.i=e,this.g=t.presentationTimeline,this.l=n,this.s=r,this.o=null,this.j=new Ko(e,t.presentationTimeline,n,s),this.h=new el(e,(function(){e:{var e=a.j;e.l=!0,e.A=!1,e.i&&e.i.ua(e.h.gapJumpTimerTime),Wo(e);var t=tl(a.h);if(e=cl(a,t),.001<Math.abs(e-t)){if(t=!1,!Ye()||Ye()&&rt())t=!0;else{var n=Date.now()/1e3,i=Ye()&&st()?3:1;(!a.o||a.o<n-i)&&(a.o=n,t=!0)}if(t){nl(a.h,e),e=void 0;break e}}a.s(),e=void 0}return e}),(function(e){var t=a.j;t.g.seeking&&!t.l&&(t.l=!0,t.j=e),t.i&&t.i.ua(t.h.gapJumpTimerTime),Wo(t)}),(function(){var e=i;return null==e?e=1/0>a.g.getDuration()?a.g.Gb():a.g.nb():0>e&&(e=a.g.nb()+e),ul(a,dl(a,e))})),this.m=new Ve((function(){if(0!=a.i.readyState&&!a.i.paused){var e=tl(a.h),t=a.g.Gb(),n=a.g.nb();3>n-t&&(t=n-3),e<t&&(e=cl(a,e),a.i.currentTime=e)}}))}function ul(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function cl(e,t){var n=e.l.rebufferingGoal,i=e.l.safeSeekOffset,r=e.g.Gb(),s=e.g.nb(),a=e.g.getDuration();3>s-r&&(r=s-3);var o=e.g.od(n),l=e.g.od(i);return n=e.g.od(n+i),t>=a?ul(e,t):t>s?s-e.l.safeSeekEndOffset:t<r?Da(e.i.buffered,l)?l:n:t>=o||Da(e.i.buffered,t)?t:n}function dl(e,t){var n=e.g.Gb();return t<n?n:t>(e=e.g.nb())?e:t}function hl(e){this.g=e,this.m=null,this.i=0,this.o=!1}function fl(e){return e.g[0]||null}function pl(e,t,n){return new hl([e=new ka(e,e+t,(function(){return n}),0,null,null,e,e,e+t)])}function gl(e,t,n,i){this.i=e,this.h=t,this.g=n,this.reverse=i}function ml(){hl.call(this,[]),this.h=[]}function yl(e){var t=this;this.g=e,this.j=!1,this.i=this.g.Xd(),this.h=new Ve((function(){t.g.Zg(.25*t.i)}))}function vl(e){e.h.stop();var t=e.j?0:e.i;if(0<=t)try{return void(e.g.Xd()!=t&&e.g.eg(t))}catch(n){}e.h.ua(.25),0!=e.g.Xd()&&e.g.eg(0)}function bl(e){var t=this;this.j=e,this.g=new ee,this.h=new Set,this.i=new Ve((function(){Tl(t,!1)})).rb(),e.paused||this.i.ua(.25),this.g.D(e,"playing",(function(){t.i.rb().ua(.25)})),this.g.D(e,"pause",(function(){t.i.stop()}))}function Tl(e,t){for(var n=e.j.currentTime,i=(e=c(e.h)).next();!i.done;i=e.next())i.value.j(n,t)}function Sl(e){Yr.call(this),this.g=new Map,this.h=e}function _l(e,t,n){return!!((e=e.h()[n])&&0<e.length&&(n=e[e.length-1].end,t>=e[0].start&&t<n))}function wl(e){var t={bandwidth:e.bandwidth||0,audioSamplingRate:null,codecs:e.codecs,contentType:e.type,frameRate:null,height:null,mimeType:e.mimeType,channelsCount:null,pixelAspectRatio:null,width:null,label:null,roles:e.roles,language:null};return"video"==e.type&&(t.frameRate=e.frameRate||null,t.height=e.height||null,t.pixelAspectRatio=e.pixelAspectRatio||null,t.width=e.width||null),"audio"==e.type&&(t.audioSamplingRate=e.audioSamplingRate,t.channelsCount=e.channelsCount,t.label=e.label||null,t.language=e.language),t}function El(e){Yr.call(this),this.h=new Map,this.i=e,this.g=null}function kl(e,t,n,i){this.m=e,this.i=t,this.l=n,this.h=new Map,this.j=new Map,this.g=null,this.o=i}function xl(e,t){e.l=t;for(var n=(e=c(e.h.values())).next();!n.done;n=e.next())n.value.g=t}function Al(e,t,n){if(n=void 0!==n&&n,!e.i.segmentIndex)return Promise.resolve();if(e.g||(e.g=e.i.segmentIndex.Pb(t,!0,e.o)),!e.g)return Promise.resolve();for(n&&e.g.next(),t=[];e.h.size<e.m&&(n=e.g.next().value);){var i=!0;n.isPreload()&&null!=n.wa&&(i=!1),2==n.cc()&&(i=!1),n.Qb()&&(i=!1),i&&n.ca&&t.push(Cl(e,n.ca)),i&&!e.h.has(n)&&(i=new Pl(e.l),t.push(Ol(i,n,e.i)),e.h.set(n,i))}return Dl(e),Promise.all(t)}function Cl(e,t){if(!e.i.segmentIndex||t.Qb()||Array.from(e.j.keys()).some((function(e){return Ea(e,t)})))return Promise.resolve();var n=new Pl(e.l),i=Ol(n,t,e.i);return e.j.set(t,n),i}function Il(e,t){for(var n=(t=c(t.keys())).next();!n.done;n=t.next())(n=n.value)&&Ml(e,n)}function Ll(e){Il(e,e.h),Il(e,e.j),e.g=null}function Dl(e){for(var t=Array.from(e.h.keys()),n=c(e.j.keys()),i=n.next(),r={};!i.done;r={Df:void 0},i=n.next())r.Df=i.value,t.some(function(e){return function(t){return Ea(t.ca,e.Df)}}(r))||Ml(e,r.Df)}function Rl(e,t){e.m=t;for(var n=Array.from(e.h.keys());n.length>t;){var i=n.pop();i&&Ml(e,i)}Dl(e)}function Ml(e,t){var n=e.h;t instanceof wa&&(n=e.j),e=n.get(t),n.delete(t),e&&e.abort()}function Pl(e){this.g=e,this.Fd=this.gg=null}function Ol(e,t,n){var i=new Uint8Array(0);return e.Fd=e.g(t,n,(function(t){return M((function(n){if(1==n.g)return i=0<i.byteLength?pi(i,t):t,e.gg?S(n,e.gg(i),3):n.u(0);i=new Uint8Array(0),_(n)}))})),e.Fd.promise.catch((function(e){return e instanceof Me&&7001==e.code?Promise.resolve():Promise.reject(e)}))}function Nl(e){var t=Mi(e);return{type:t.split("/")[0],mimeType:t,codecs:e=Pi(e),language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,Kd:null,colorGamut:null,frameRate:null}}function Ul(e,t,n){function i(e){a=e.name;var t=e.reader;t.skip(24);var n=t.na(),i=t.na();t.skip(50),p=String(n),f=String(i),e.reader.ta()&&bs(e)}function r(e){var t=Wa(e.reader);g=t.channelCount,m=t.sampleRate,s(e.name)}function s(e){switch(e=e.toLowerCase()){case"avc1":case"avc3":l.push(e+".42E01E"),d=!0;break;case"hev1":case"hvc1":l.push(e+".1.6.L93.90"),d=!0;break;case"dvh1":case"dvhe":l.push(e+".05.04"),d=!0;break;case"vp09":l.push(e+".00.10.08"),d=!0;break;case"av01":l.push(e+".0.01M.08"),d=!0;break;case"mp4a":o.push("mp4a.40.2"),u=!0;break;case"ac-3":case"ec-3":case"ac-4":case"opus":case"flac":o.push(e),u=!0}}var a,o=[],l=[],u=!1,d=!1,h=null,f=null,p=null,g=null,m=null,y=null,v=null;if((new vs).box("moov",bs).box("trak",bs).box("mdia",bs).S("mdhd",(function(e){h=za(e.reader,e.version).language})).box("minf",bs).box("stbl",bs).S("stsd",Ts).box("mp4a",(function(e){var t=Wa(e.reader);g=t.channelCount,m=t.sampleRate,e.reader.ta()?bs(e):s(e.name)})).box("esds",(function(e){e=e.reader;for(var t,n,i="mp4a";e.ta();){t=e.V();for(var r=e.V();128&r;)r=e.V();if(3==t)e.na(),128&(r=e.V())&&e.na(),64&r&&e.skip(e.V()),32&r&&e.na();else if(4==t)n=e.V(),e.skip(12);else if(5==t)break}n&&(i+="."+Ya(n),5==t&&e.ta()&&(31===(n=(248&(t=e.V()))>>3)&&e.ta()&&(n=32+((7&t)<<3)+((224&e.V())>>5)),i+="."+n)),o.push(i),u=!0})).box("ac-3",r).box("ec-3",r).box("ac-4",r).box("Opus",r).box("fLaC",r).box("avc1",i).box("avc3",i).box("hev1",i).box("hvc1",i).box("dva1",i).box("dvav",i).box("dvh1",i).box("dvhe",i).box("vp09",i).box("av01",i).box("avcC",(function(e){var t=a||"";switch(a){case"dvav":t="avc3";break;case"dva1":t="avc1"}(e=e.reader).skip(1),e=t+"."+Ya(e.V())+Ya(e.V())+Ya(e.V()),l.push(e),d=!0})).box("hvcC",(function(e){var t=a||"";switch(a){case"dvh1":t="hvc1";break;case"dvhe":t="hev1"}var n=e.reader;n.skip(1);var i=["","A","B","C"][(e=n.V())>>6],r=31&e,s=n.R(),o=(32&e)>>5?"H":"L";e=[n.V(),n.V(),n.V(),n.V(),n.V(),n.V()],n=n.V();for(var u=0,c=0;32>c&&(u|=1&s,31!=c);c++)u<<=1,s>>=1;for(t=t+"."+i+r+"."+Ya(u,!0),t+="."+o+n,i="",r=e.length;r--;)((o=e[r])||i)&&(i="."+o.toString(16).toUpperCase()+i);t+=i,l.push(t),d=!0})).box("dvcC",(function(e){var t=a||"";switch(a){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.V(),n=n.V(),l.push(t+"."+Qa(e>>1&127)+"."+Qa(e<<5&32|n>>3&31)),d=!0})).box("dvvC",(function(e){var t=a||"";switch(a){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.V(),n=n.V(),l.push(t+"."+Qa(e>>1&127)+"."+Qa(e<<5&32|n>>3&31)),d=!0})).S("vpcC",(function(e){var t=a||"",n=e.reader;e=n.V();var i=n.V();n=n.V()>>4&15,l.push(t+"."+Qa(e)+"."+Qa(i)+"."+Qa(n)),d=!0})).box("av1C",(function(e){var t=a||"";if("dav1"===a)t="av01";var n=e.reader;n.skip(1);var i=(e=n.V())>>>5,r=(64&(n=n.V()))>>6;l.push(t+"."+i+"."+Qa(31&e)+(n>>>7?"H":"M")+"."+Qa(2===i&&r?(32&n)>>5?12:10:r?10:8)+"."+((16&n)>>4)+"."+((8&n)>>3)+((4&n)>>2)+(3&n)+"."+Qa(1)+"."+Qa(1)+"."+Qa(1)+".0"),d=!0})).box("enca",_s).box("encv",Ss).box("sinf",bs).box("frma",(function(e){s(e=Xa(e.reader).codec)})).box("colr",(function(e){l=l.map((function(t){if(t.startsWith("av01.")){var n=e.reader,i=n.ya(),r=n.Bb(4),s=String.fromCharCode(r[0]);if(s+=String.fromCharCode(r[1]),s+=String.fromCharCode(r[2]),"nclx"===(s+=String.fromCharCode(r[3]))){r=n.na(),s=n.na();var a=n.na(),o=n.V()>>7,l=t.split(".");10==l.length&&(l[6]=Qa(r),l[7]=Qa(s),l[8]=Qa(a),l[9]=String(o),t=l.join("."))}n.seek(i)}return t}));var t=function(e){var t=null,n=null,i=e.Bb(4),r=String.fromCharCode(i[0]);if(r+=String.fromCharCode(i[1]),r+=String.fromCharCode(i[2]),"nclx"===(r+=String.fromCharCode(i[3]))){switch(e.na()){case 1:case 5:case 6:case 7:t="srgb";break;case 9:t="rec2020";break;case 11:case 12:t="p3"}switch(i=e.na(),e.na(),i){case 1:case 6:case 13:case 14:case 15:n="SDR";break;case 16:n="PQ";break;case 18:n="HLG"}}return{colorGamut:t,Kd:n}}(e.reader),n=t.colorGamut;y=t.Kd,v=n})).parse(e||t,!0),!o.length&&!l.length)return null;var b=u&&!d,T=new Map;if(d&&!n){n=new Se("video/mp4"),e&&n.init(e);try{n.i(t);for(var S=c(n.j()),_=S.next();!_.done;_=S.next()){var w=_.value;T.set(w,w)}}catch(E){}n.g()}return{type:b?"audio":"video",mimeType:b?"audio/mp4":"video/mp4",codecs:Fl(o.concat(l)).join(", "),language:h,height:f,width:p,channelCount:g,sampleRate:m,closedCaptions:T,Kd:y,colorGamut:v,frameRate:null}}function Fl(e){for(var t=new Set,n=[],i=(e=c(e)).next();!i.done;i=e.next()){var r=Ri(i=i.value);t.has(r)||(n.push(i),t.add(r))}return t=Ti("audio",n),i=Ti("video",n),e=Ti(Si,n),i=function(e){if(1>=e.length)return e;var t=e.find((function(e){return e.startsWith("dvav.")||e.startsWith("dva1.")||e.startsWith("dvh1.")||e.startsWith("dvhe.")||e.startsWith("dav1.")||e.startsWith("dvc1.")||e.startsWith("dvi1.")}));return t?ie('video/mp4; codecs="'+t+'"')?[t]:e.filter((function(e){return e!=t})):e}(i),t=t.concat(i).concat(e),n.length&&!t.length?n:t}function Bl(t,n,i){var r,s,a,o,l;return M((function(u){if(1==u.g)return(r=n).cryptoKey?u.u(2):S(u,r.fetchKey(),3);if(!(s=r.iv))for(s=me(new ArrayBuffer(16)),a=r.firstMediaSequenceNumber+i,o=s.byteLength-1;0<=o;o--)s[o]=255&a,a>>=8;return l="CBC"==n.blockCipherMode?{name:"AES-CBC",iv:s}:{name:"AES-CTR",counter:s,length:64},u.return(e.crypto.subtle.decrypt(l,r.cryptoKey,t))}))}function jl(e,t,n,i,r){return e=ns(e,i,r),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function $l(e,t){var n=this;this.g=t,this.j=e,this.i=null,this.H=new Map,this.C=1,this.s=this.l=null,this.K=0,this.h=new Map,this.G=!1,this.L=null,this.B=!1,this.m=new cs((function(){return function(e){var t,n,i,r,s,a;return M((function(o){if(1==o.g){for(t=[],n=c(e.h.values()),i=n.next();!i.done;i=n.next())ru(r=i.value),t.push(su(r)),r.X&&(Ll(r.X),r.X=null);for(s=c(e.o.values()),a=s.next();!a.done;a=s.next())Ll(a.value);return S(o,Promise.all(t),2)}e.h.clear(),e.o.clear(),e.g=null,e.j=null,e.i=null,e.A&&e.A.stop(),e.A=null,_(o)}))}(n)})),this.M=Date.now()/1e3,this.o=new Map,this.I={projection:null,hfov:null},this.P=0,this.O=1/0,this.F=null,this.A=new Ve((function(){if(n.j&&n.g)if(n.j.presentationTimeline.T()){var e=n.j.presentationTimeline.Gb(),t=n.j.presentationTimeline.nb();1<t-e?function(e,t,n){M((function(i){return ko(e)||xo(e)?i.return():S(i,Bo(e,(function(){ko(e)||xo(e)||e.i.setLiveSeekableRange(t,n)})),0)}))}(n.g.Z,e,t):Mo(n.g.Z)}else Mo(n.g.Z),n.A&&n.A.stop()}))}function Vl(e,t){for(var n=0>e.g.gb(),i=c(e.h.values()),r=i.next();!r.done;r=i.next())(r=r.value).ha&&r.ha.bd(n),r.X&&r.X.bd(n);for(r=(i=c(e.o.values())).next();!r.done;r=i.next())r.value.bd(n);(n=e.h.get("video"))&&(i=n.stream)&&(t?(t=i.trickModeVideo)&&!n.fc&&(Gl(e,t,!1,0,!1),n.fc=i):(t=n.fc)&&(n.fc=null,Gl(e,t,!0,0,!1)))}function Hl(e,t,n,i,r,s){n=void 0!==n&&n,i=void 0===i?0:i,r=void 0!==r&&r,s=void 0!==s&&s,e.l=t,e.G&&(t.video&&Gl(e,t.video,n,i,r,s),t.audio&&Gl(e,t.audio,n,i,r,s))}function ql(e,t){M((function(n){if(1==n.g)return e.F=null,e.s=t,e.G?t.segmentIndex?n.u(2):S(n,t.createSegmentIndex(),2):n.return();Gl(e,t,!0,0,!1),_(n)}))}function Gl(e,t,n,i,r,s){var a=e.h.get(t.type);a||t.type!=Si?a&&(a.fc&&(t.trickModeVideo?(a.fc=t,t=t.trickModeVideo):a.fc=null),a.stream!=t||r)&&(e.o.has(t)?a.X=e.o.get(t):a.X&&function(e,t){t&&t!==e.i&&(Ll(e),e.i=t)}(a.X,t),t.type==Si&&(r=xi(t.mimeType,t.codecs),Eo(e.g.Z,r,e.j.sequenceMode,t.external)),!e.o.has(a.stream)&&a.stream.closeSegmentIndex&&(a.Ga?(r="("+a.type+":"+a.stream.id+")",e.H.has(r)||e.H.set(r,a.stream.closeSegmentIndex)):a.stream.closeSegmentIndex()),r=a.stream.isAudioMuxedInVideo!=t.isAudioMuxedInVideo,a.stream=t,a.ha=null,a.ug=!!s,r?ou(e,!0,!1):(n?a.fd?a.Me=!0:a.Ga?(a.lc=!0,a.Sd=i,a.Me=!0):(ru(a),nu(e,a,!0,i).catch((function(t){e.g&&e.g.onError(t)}))):a.Ga||a.kb||iu(e,a,0),function(e,t){var n,i;return M((function(r){if(1==r.g)return t.qb?(n=t.stream,i=t.qb,n.segmentIndex?r.u(2):S(r,n.createSegmentIndex(),2)):r.return();if(t.qb!=i||t.stream!=n)return r.return();var s=e.g.nd(),a=Co(e.g.Z,t.type),o=t.stream.segmentIndex.find(t.La?t.La.endTime:s),l=null==o?null:t.stream.segmentIndex.get(o);o=l&&l.wa?l.wa-l.Na:null,l&&!o&&(o=(l.endTime-l.getStartTime())*(t.stream.bandwidth||0)/8),o?((l=l.ca)&&(o+=(l.wa?l.wa-l.Na:null)||0),s=8*o/(l=e.g.getBandwidthEstimate())<(a||0)-s-e.i.rebufferingGoal||t.qb.h.g>o):s=!1,s&&t.qb.abort(),_(r)}))}(e,a).catch((function(t){e.g&&e.g.onError(t)})))):function(e,t){var n,i,r,s,a;M((function(o){switch(o.g){case 1:return n=_i,e.K++,i=e.K,w(o,2),S(o,Do(e.g.Z,n.xa),4);case 4:k(o,3);break;case 2:r=x(o),e.g&&e.g.onError(r);case 3:s=xi(t.mimeType,t.codecs),Eo(e.g.Z,s,e.j.sequenceMode,t.external),(e.g.Z.ga.isTextVisible()||e.i.alwaysStreamText)&&e.K==i&&(a=Kl(e,t),e.h.set(n.xa,a),iu(e,a,0)),_(o)}}))}(e,t)}function zl(e,t){t.fd||t.lc||(t.Ga?(t.lc=!0,t.Sd=0):null==Ao(e.g.Z,t.type)?null==t.kb&&iu(e,t,0):(ru(t),nu(e,t,!1,0).catch((function(t){e.g&&e.g.onError(t)}))))}function Kl(e,t){return{stream:t,type:t.type,ha:null,X:Wl(e,t),La:null,Rc:null,ce:null,yc:null,xc:null,fc:null,endOfStream:!1,Ga:!1,kb:null,lc:!1,Sd:0,Me:!1,fd:!1,$c:!0,Tf:!1,qd:!1,qb:null}}function Wl(e,t){if("video"===t.type&&e.i.disableVideoPrefetch||"audio"===t.type&&e.i.disableAudioPrefetch||t.type===Si&&("application/cea-608"==t.mimeType||"application/cea-708"==t.mimeType)||t.type===Si&&e.i.disableTextPrefetch)return null;if(e.o.has(t))return e.o.get(t);var n=e.h.get(t.type);return(n=n&&n.X)&&t===n.i?n:0<e.i.segmentPrefetchLimit?new kl(e.i.segmentPrefetchLimit,t,(function(t,n,i){return tu(t,n,i||null,e.i.retryParameters,e.g.Ub)}),0>e.g.gb()):null}function Xl(t,n){var i,r,s,a,o,l;return M((function(u){switch(u.g){case 1:if(ds(t.m),n.Ga||null==n.kb||n.fd)return u.return();if(n.kb=null,!n.lc){u.u(2);break}return S(u,nu(t,n,n.Me,n.Sd),3);case 3:return u.return();case 2:if(function(e,t){for(var n=c(e.H.entries()),i=n.next();!i.done;i=n.next()){var r=c(i.value);i=r.next().value,r=r.next().value,i.includes(t.type)&&(r(),e.H.delete(i))}}(t,n),n.stream.segmentIndex){u.u(4);break}return i=n.stream,w(u,5),S(u,n.stream.createSegmentIndex(),7);case 7:k(u,6);break;case 5:return r=x(u),S(u,au(t,n,r),8);case 8:return u.return();case 6:if(i!=n.stream)return i.closeSegmentIndex&&i.closeSegmentIndex(),n.Ga||n.kb||iu(t,n,0),u.return();case 4:w(u,9),s=function(t,n){if(Zl(n))return function(e,t){var n=Co(e,"video")||0;Hi(e.h,t,n)}(t.g.Z,n.stream.originalId||""),null;if(n.type==Si&&function(e){e.h&&Hi(e.h,"",0)}(t.g.Z),n.stream.isAudioMuxedInVideo)return null;var i=t.i.updateIntervalSeconds/Math.max(1,Math.abs(t.g.gb()));if(!function(e){return e.sa&&!e.$&&!e.I}(t.g.Z)&&n.type!=Si)return i/2;var r=t.g.nd();if("audio"===n.type)for(var s=c(t.o.keys()),a=s.next();!a.done;a=s.next())(a=t.o.get(a.value)).Ja(r,!0),Al(a,r);s=n.La?n.La.endTime:r;var o=function(e,t,n){return t==Si?null==(e=e.h).h||e.h<n?0:e.h-Math.max(n,e.g):Ra(e=Io(e,t),n)}(t.g.Z,n.type,r),l=Math.max(1,Math.max(t.i.rebufferingGoal,t.i.bufferingGoal)*t.C),u=t.j.presentationTimeline.getDuration()-s;if(a=Co(t.g.Z,n.type),1e-6>u&&a)return n.endOfStream=!0,"video"==n.type&&(t=t.h.get(Si))&&Zl(t)&&(t.endOfStream=!0),null;if(n.endOfStream=!1,o>=l)return i/2;if(l=!n.ha,a=function(e,t,n,i){if(t.ha)return(n=t.ha.current())&&t.La&&.001>Math.abs(t.La.startTime-n.startTime)&&(n=t.ha.next().value),n;if(t.La||i)return n=t.La?t.La.endTime:i,e=0>e.g.gb(),t.stream.segmentIndex&&(t.ha=t.stream.segmentIndex.Pb(n,!1,e)),t.ha&&t.ha.next().value;i=e.j.sequenceMode?0:e.i.inaccurateManifestTolerance;var r=Math.max(n-i,0);e=0>e.g.gb();var s=null;return i&&(t.stream.segmentIndex&&(t.ha=t.stream.segmentIndex.Pb(r,!1,e)),s=t.ha&&t.ha.next().value),s||(t.stream.segmentIndex&&(t.ha=t.stream.segmentIndex.Pb(n,!1,e)),s=t.ha&&t.ha.next().value),s}(t,n,r,a),!a)return i;o=!1,l&&n.ug&&(o=!0,n.ug=!1),l=1/0;for(var d=(u=c(u=Array.from(t.h.values()))).next();!d.done;d=u.next())Zl(d=d.value)||d.ha&&!d.ha.current()||(l=Math.min(l,d.La?d.La.endTime:r));return s>=l+t.j.presentationTimeline.h?i:(n.X&&n.ha&&!t.o.has(n.stream)&&(n.X.Ja(a.startTime),Al(n.X,a.startTime)),function(t,n,i,r,s){var a,o,l,u,c,d,h,f,p,g,m,y,v,b,T,E;return M((function(A){switch(A.g){case 1:if(a=_i,o=n.stream,l=n.ha,n.Ga=!0,w(A,2),2==r.cc())throw new Me(1,1,1011);return S(A,function(e,t,n,i){var r,s,a,o,l,u,c,d,h,f,p,g,m,y,v,b;return M((function(T){switch(T.g){case 1:if(r=_i,s=null==t.La,a=[],o=Math.max(0,Math.max(n.appendWindowStart,e.P)-.1),l=Math.min(n.appendWindowEnd,e.O)+.01,u=n.codecs||t.stream.codecs,c=Ri(u),d=Mi(n.mimeType||t.stream.mimeType),(h=n.timestampOffset)==t.ce&&o==t.yc&&l==t.xc&&c==t.Hf&&d==t.If){T.u(2);break}if(f=t.Hf&&t.If&&function(e,t,n,i){if(t==Si)var r=!1;else{r=Di(Pi(e.A.get(t)));var s=Mi(e.A.get(t)),a=xi(n,i),o=e.B.forceTransmux;(!ie(a)||!e.F&&Fi.includes(a))&&(o=!0),n=Ai(n,i),o&&(o=Bn(n))&&(a=(o=o()).convertCodecs(t,n),o.destroy()),t=Di(Pi(a)),a=Mi(a),r=r!==t||s!==a}return!!r&&("smooth"!==e.B.codecSwitchingStrategy||!re()||e.m)}(e.g.Z,t.type,d,u),!f){T.u(3);break}if(p=null,t.type===r.la?p=e.h.get(r.U):t.type===r.U&&(p=e.h.get(r.la)),!p){T.u(3);break}return S(T,su(p).catch((function(){})),5);case 5:p.Rc=null,p.yc=null,p.xc=null,zl(e,p);case 3:return S(T,Yl(e,t,h,o,l,n,c,d),2);case 2:return Ea(n.ca,t.Rc)||(t.Rc=n.ca,n.l&&n.ca&&(g=eu(e,t,n.ca),m=function(){var s,a,o,l,u,c;return M((function(d){switch(d.g){case 1:return w(d,2),S(d,g,4);case 4:return s=d.h,ds(e.m),a=null,o=new Map,l={projection:null,hfov:null},(new vs).box("moov",bs).box("trak",bs).box("mdia",bs).S("mdhd",(function(e){a=za(e.reader,e.version).timescale})).box("hdlr",(function(e){switch((e=e.reader).skip(8),e.Ac()){case"soun":o.set(r.U,a);break;case"vide":o.set(r.la,a)}a=null})).box("minf",bs).box("stbl",bs).S("stsd",Ts).box("encv",Ss).box("avc1",Ss).box("avc3",Ss).box("hev1",Ss).box("hvc1",Ss).box("dvav",Ss).box("dva1",Ss).box("dvh1",Ss).box("dvhe",Ss).box("dvc1",Ss).box("dvi1",Ss).box("vexu",bs).box("proj",bs).S("prji",(function(e){e=e.reader.Ac(),l.projection=e})).box("hfov",(function(e){e=e.reader.R()/1e3,l.hfov=e})).parse(s),function(e,t){if(e.I.projection!=t.projection||e.I.hfov!=t.hfov){if(null!=t.projection||null!=t.hfov){var n=(new Map).set("detail",t);n=new Kr("spatialvideoinfo",n)}else n=new Kr("nospatialvideoinfo");n.cancelable=!0,e.g.onEvent(n),e.I=t}}(e,l),o.has(t.type)?n.ca.timescale=o.get(t.type):null!=a&&(n.ca.timescale=a),u=t.stream.closedCaptions&&0<t.stream.closedCaptions.size,S(d,e.g.zg(t.type,s),5);case 5:return S(d,Lo(e.g.Z,t.type,s,null,t.stream,u,t.$c,i),6);case 6:k(d,0);break;case 2:throw c=x(d),t.Rc=null,c}}))},y=n.startTime,s&&(null!=(v=Co(e.g.Z,t.type))&&(y=v)),e.g.Ui(y,n.ca),a.push(m()))),b=t.La?t.La.i:null,n.i!=b&&a.push(function(e,t,n){var i,r;return M((function(s){return 1==s.g?t==(i=_i).xa?s.return():(t==i.la&&(e.Ba=new jr),!e.F||(r=Co(e,t))&&.1>Math.abs(r-n)?s.return():(Fo(e,t,(function(){return Oo(e,t)}),null),e.m&&Fo(e,i.U,(function(){return Oo(e,i.U)}),null),S(s,Fo(e,t,(function(){return No(e,t,n)}),null),2))):e.m?S(s,Fo(e,i.U,(function(){return No(e,i.U,n)}),null),0):s.u(0)}))}(e.g.Z,t.type,n.startTime)),S(T,Promise.all(a),0)}}))}(t,n,r,s),4);case 4:return ds(t.m),t.B?A.return():(u="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,c=e.ReadableStream,t.i.lowLatencyMode&&t.j.isLowLatency&&c&&u&&("HLS"!=t.j.type||r.m)?(h=new Uint8Array(0),p=f=!1,m=function(e){var a,l,u;return M((function(c){switch(c.g){case 1:if(f)return c.return();if(p=!0,ds(t.m),t.B)return c.return();if(w(c,2),h=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(h,e),a=!1,l=0,(new vs).box("mdat",(function(e){l=e.size+e.start,a=!0})).parse(h,!1,!0),!a){c.u(4);break}return u=h.subarray(0,l),h=h.subarray(l),S(c,Ql(t,n,i,o,r,u,!0,s),5);case 5:n.X&&n.ha&&Al(n.X,r.startTime,!0);case 4:k(c,0);break;case 2:g=x(c),_(c)}}))},S(A,eu(t,n,r,m),9)):S(A,eu(t,n,r),7));case 7:return d=A.h,ds(t.m),t.B?A.return():(ds(t.m),n.lc?(n.Ga=!1,iu(t,n,0),A.return()):S(A,Ql(t,n,i,o,r,d,!1,s),6));case 9:if(y=A.h,g)throw g;if(p){A.u(10);break}return f=!0,ds(t.m),t.B?A.return():n.lc?(n.Ga=!1,iu(t,n,0),A.return()):S(A,Ql(t,n,i,o,r,y,!1,s),10);case 10:n.X&&n.ha&&Al(n.X,r.startTime,!0);case 6:if(ds(t.m),t.B)return A.return();n.La=r,l.next(),n.Ga=!1,n.Tf=!1,v=t.g.Z.Fb(),b=v[n.type],JSON.stringify(b),n.lc||(T=null,n.type===a.la?T=t.h.get(a.U):n.type===a.U&&(T=t.h.get(a.la)),T&&T.type==a.U?t.g.le(r,n.stream,T.stream.isAudioMuxedInVideo):t.g.le(r,n.stream,n.stream.codecs.includes(","))),iu(t,n,0),k(A,0);break;case 2:if(E=x(A),ds(t.m,E),t.B)return A.return();if(n.Ga=!1,7001==E.code)n.Ga=!1,ru(n),iu(t,n,0),A.u(0);else{if(n.type!=a.xa||!t.i.ignoreTextStreamFailures)return 3017==E.code?S(A,function(e,t,n){var i,r,s,a;return M((function(o){if(1==o.g){if(i=Array.from(e.h.values()),i.some((function(e){return e!=t&&e.Tf})))return o.u(2);if(r=0===e.i.maxDisabledTime&&1011==n.code?1:e.i.maxDisabledTime,e.g.disableStream(t.stream,r))return o.return();if(20<(s=Math.round(100*e.C)))e.C-=.2;else{if(!(4<s))return t.qd=!0,e.B=!0,e.g.onError(n),o.return();e.C-=.04}return t.Tf=!0,a=e.g.nd(),S(o,Jl(e,t,a),2)}iu(e,t,4),_(o)}))}(t,n,E),0):(n.qd=!0,1==E.category&&n.X&&Ml(n.X,r),E.severity=2,S(A,au(t,n,E),0));t.h.delete(a.xa),A.u(0)}}}))}(t,n,r,a,o).catch((function(){})),null)}(t,n),null!=s&&(iu(t,n,s),n.qd=!1),k(u,10);break;case 9:return a=x(u),S(u,au(t,n,a),11);case 11:return u.return();case 10:if(o=Array.from(t.h.values()),!t.G||!o.every((function(e){return e.endOfStream}))){u.u(0);break}return S(u,t.g.Z.endOfStream(),13);case 13:ds(t.m),0!=(l=t.g.Z.getDuration())&&l<t.j.presentationTimeline.getDuration()&&t.j.presentationTimeline.ab(l),_(u)}}))}function Yl(e,t,n,i,r,s,a,o){var l,u,c,d;return M((function(h){if(1==h.g)return l=_i,u=new Map,e.l.audio&&u.set(l.U,e.l.audio),e.l.video&&u.set(l.la,e.l.video),w(h,2),t.yc=i,t.xc=r,a&&(t.Hf=a),o&&(t.If=o),t.ce=n,c=e.j.sequenceMode||"HLS"==e.j.type,S(h,Ro(e.g.Z,t.type,n,i,r,c,s.mimeType||t.stream.mimeType,s.codecs||t.stream.codecs,u),4);if(2!=h.g)return k(h,0);throw d=x(h),t.yc=null,t.xc=null,t.Hf=null,t.If=null,t.ce=null,d}))}function Ql(e,t,n,i,r,s,a,o){var l,u,c,d,h,f;return a=void 0!==a&&a,o=void 0!==o&&o,M((function(p){switch(p.g){case 1:return l=i.closedCaptions&&0<i.closedCaptions.size,e.i.shouldFixTimestampOffset&&(c="video/mp4"==i.mimeType||"audio/mp4"==i.mimeType,d=null,r.ca&&(d=r.ca.timescale),(h=c&&d&&"video"===i.type&&"DASH"==e.j.type)&&(u=new vs),h&&u.box("moof",bs).box("traf",bs).S("tfdt",(function(n){var i,s,a,o,l;return M((function(u){return i=Ga(n.reader,n.version),(s=i.baseMediaDecodeTime)?(a=-s/d,(Number(t.ce)||0)<a?(o=t.yc,l=t.xc,S(u,Yl(e,t,a,o,l,r),0)):u.u(0)):u.return()}))})),h&&u.parse(s,!1,a)),S(p,Jl(e,t,n),2);case 2:return ds(e.m),f=t.$c,t.$c=!1,S(p,e.g.zg(t.type,s),3);case 3:return S(p,Lo(e.g.Z,t.type,s,r,i,l,f,o,a),4);case 4:ds(e.m),_(p)}}))}function Jl(e,t,n){var i,r,s,a,o,l,u,c;return M((function(d){return 1==d.g?((i=t.stream.segmentIndex)instanceof ml&&i.Ja(e.j.presentationTimeline.ob()),r=Math.max(e.i.bufferBehind*e.C,e.j.presentationTimeline.h),null==(s=Ao(e.g.Z,t.type))?(e.F==t&&(e.F=null),d.return()):(a=n-s,o=e.i.evictionGoal,l=e.j.presentationTimeline.Gb(),u=e.j.presentationTimeline.nb(),c=a-r,u-l>o&&(c=Math.max(a-r,l-o-s)),c<=o?d.return():S(d,e.g.Z.remove(t.type,s,s+c),2))):4!=d.g?(ds(e.m),e.F?S(d,Jl(e,e.F,n),4):d.u(0)):(ds(e.m),void _(d))}))}function Zl(e){return e&&e.type==Si&&("application/cea-608"==e.stream.mimeType||"application/cea-708"==e.stream.mimeType)}function eu(e,t,n,i){var r,s,a,o,l;return M((function(u){switch(u.g){case 1:if(r=n.Qb())return u.return(r);if(s=null,t.X){var c=t.X,d=c.h;n instanceof wa&&(d=c.j),d.has(n)?(c=d.get(n),i&&(c.gg=i),s=c.Fd):s=null}return s||(s=tu(n,t.stream,i||null,e.i.retryParameters,e.g.Ub)),a=0,t.ha&&(a=t.ha.h),t.qb=s,S(u,s.promise,2);case 2:if(o=u.h,t.qb=null,l=o.data,!n.aesKey){u.u(3);break}return S(u,Bl(l,n.aesKey,a),4);case 4:l=u.h;case 3:return u.return(l)}}))}function tu(e,t,n,i,r,s){s=void 0!==s&&s;var a=e instanceof ka?e:void 0,o=a?1:0;return(e=jl(e.N(),e.Na,e.wa,i,n)).contentType=t.type,r.request(os,e,{type:o,stream:t,segment:a,isPreload:s})}function nu(e,t,n,i){var r,s;return M((function(a){return 1==a.g?(t.lc=!1,t.Me=!1,t.Sd=0,t.fd=!0,t.La=null,t.ha=null,t.X&&!e.o.has(t.stream)&&Ll(t.X),i?(r=e.g.nd(),s=e.g.Z.getDuration(),S(a,e.g.Z.remove(t.type,r+i,s),3)):S(a,Do(e.g.Z,t.type),4)):3!=a.g?(ds(e.m),n?S(a,e.g.Z.flush(t.type),3):a.u(3)):(ds(e.m),t.fd=!1,t.endOfStream=!1,t.Ga||t.kb||iu(e,t,0),void _(a))}))}function iu(e,t,n){var i=t.type;(i!=Si||e.h.has(i))&&(t.kb=new $e((function(){var n;return M((function(i){return 1==i.g?(w(i,2),S(i,Xl(e,t),4)):2!=i.g?k(i,0):(n=x(i),e.g&&e.g.onError(n),void _(i))}))})).aa(n))}function ru(e){null!=e.kb&&(e.kb.stop(),e.kb=null)}function su(e){return M((function(t){return e.qb?S(t,e.qb.abort(),0):t.u(0)}))}function au(e,t,n){var i;return M((function(r){if(1==r.g)return S(r,Br(e.L),2);if(ds(e.m),1===n.category&&1003!=n.code){if(t.fc)return Vl(e,!1),r.return();i=0===e.i.maxDisabledTime&&1011==n.code?1:e.i.maxDisabledTime,n.handled=e.g.disableStream(t.stream,i),n.handled&&(n.severity=1)}n.handled&&1011==n.code||e.g.onError(n),n.handled||e.i.failureCallback(n),_(r)}))}function ou(e,t,n){var i,r,s,a,o,l;return t=void 0!==t&&t,n=void 0===n||n,M((function(u){if(1==u.g){if(i=Date.now()/1e3,r=e.i.minTimeBetweenRecoveries,!t){if(!e.i.allowMediaSourceRecoveries||i-e.M<r)return u.return(!1);e.M=i}return s=_i,(a=e.h.get(s.U))&&(a.Rc=null,a.yc=null,a.xc=null,n&&zl(e,a),su(a).catch((function(){})),a.ha&&a.ha.Vf()),(o=e.h.get(s.la))&&(o.Rc=null,o.yc=null,o.xc=null,n&&zl(e,o),su(o).catch((function(){})),o.ha&&o.ha.Vf()),l=new Map,e.l.audio&&l.set(s.U,e.l.audio),e.l.video&&l.set(s.la,e.l.video),S(u,Vo(e.g.Z,l),2)}return!o||o.Ga||o.kb||iu(e,o,0),!a||a.Ga||a.kb||iu(e,a,0),u.return(!0)}))}function lu(){}function uu(e,t,n,i,r){var s,a=r in i,o=a?n.constructor==Object&&0==Object.keys(i).length:n.constructor==Object&&0==Object.keys(n).length,l=a||o,u=!0;for(s in t){var c=r+"."+s,d=a?i[r]:n[s];l||s in n?void 0===t[s]?void 0===d||l?delete e[s]:e[s]=It(d):o?e[s]=t[s]:d.constructor==Object&&t[s]&&t[s].constructor==Object?(e[s]||(e[s]=It(d)),c=uu(e[s],t[s],d,i,c),u=u&&c):typeof t[s]!=typeof d||null==t[s]||"function"!=typeof t[s]&&t[s].constructor!=d.constructor?(W("Invalid config, wrong type for "+c),u=!1):("function"==typeof n[s]&&n[s].length!=t[s].length&&X("Unexpected number of arguments for "+c),e[s]=t[s]):(W("Invalid config, unrecognized key "+c),u=!1)}return u}function cu(e,t){for(var n={},i=n,r=0,s=0;!(0>(r=e.indexOf(".",r)));)0!=r&&"\\"==e[r-1]||(i[s=e.substring(s,r).replace(/\\\./g,".")]={},i=i[s],s=r+1),r+=1;return i[e.substring(s).replace(/\\\./g,".")]=t,n}function du(e,t){return e&&t}function hu(e,t){function n(e){return e&&"object"===typeof e&&!Array.isArray(e)}return e=function e(t,i){return Object.keys(t).reduce((function(r,s){var a=t[s];return i.hasOwnProperty(s)?a instanceof HTMLElement&&i[s]instanceof HTMLElement?a.isEqualNode(i[s])||(r[s]=a):n(a)&&n(i[s])?(a=e(a,i[s]),(0<Object.keys(a).length||!n(a))&&(r[s]=a)):Array.isArray(a)&&Array.isArray(i[s])?De(a,i[s])||(r[s]=a):Number.isNaN(a)&&Number.isNaN(i[s])||a!==i[s]&&(r[s]=a):r[s]=a,r}),{})}(e,t),function e(t){for(var i=c(Object.keys(t)),r=i.next();!r.done;r=i.next())if(!(t[r=r.value]instanceof HTMLElement))if(n(t[r])&&0===Object.keys(t[r]).length)delete t[r];else{var s=t[r];Array.isArray(s)&&0===s.length||"function"==typeof t[r]?delete t[r]:n(t[r])&&(e(t[r]),0===Object.keys(t[r]).length&&delete t[r])}}(e),e}function fu(){this.g=null}function pu(){}function gu(e){return new zn(e=mt(e)).wb}function mu(e,t,n){function i(e){ve(s).setUint32(a,e.byteLength,!0),a+=4,s.set(me(e),a),a+=e.byteLength}if(!n||!n.byteLength)throw new Me(2,6,6015);var r;r="string"==typeof t?vt(t,!0):t,e=vt(e=mt(e),!0);var s=new Uint8Array(12+e.byteLength+r.byteLength+n.byteLength),a=0;return i(e),i(r),i(n),s}function yu(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,mu(e,n=mt(e).split("skd://").pop(),t))}function vu(e,t){2===e&&(t.headers["Content-Type"]="application/octet-stream")}function bu(){}function Tu(){var t=1/0;navigator.connection&&navigator.connection.saveData&&(t=360);var n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(t,n,i){return"apple"===e.shakaMediaKeysPolyfill&&"skd"==n&&(n=i.serverCertificate,t=mu(t,i=gu(t),n)),t},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:ze(),minHdcpVersion:"",ignoreDuplicateInitData:!ot("Tizen 2"),defaultAudioRobustnessForWidevine:"SW_SECURE_CRYPTO",defaultVideoRobustnessForWidevine:"SW_SECURE_DECODE"};(ze()||et())&&n.preferredKeySystems.push("com.microsoft.playready");var i="reload",r=!1;!re()||Ke()||et()||Ze()||Xe()&&79===Qe()||Ye()&&!rt()&&!st()||it()&&Ge()||(i="smooth",r=!0),r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,disableIFrames:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,continueLoadingWhenPaused:!0,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!0,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2":"com.apple.fps","urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c":"com.huawei.wiseplay"},manifestPreprocessor:wu,manifestPreprocessorTXml:Eu,sequenceMode:!1,multiTypeVariantsAllowed:r,useStreamOnceInPeriodFlattening:!1,updatePeriod:-1,enableFastSwitching:!0,ignoreSupplementalCodecs:!1},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',liveSegmentsDelay:3,sequenceMode:!(We()||ot("Tizen 2")||Xe()&&38===Qe()||et()||Ze()),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,disableClosedCaptionsDetection:!1,updatePeriod:-1,allowLowLatencyByteRangeOptimization:!0,ignoreSupplementalCodecs:!1},mss:{manifestPreprocessor:wu,manifestPreprocessorTXml:Eu,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}};var s={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},failureCallback:function(e){return du([e])},rebufferingGoal:0,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapPadding:0,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,safeSeekEndOffset:0,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,forceHTTP:!1,forceHTTPS:!1,minBytesForProgressEvents:16e3,preferNativeDash:!1,preferNativeHls:!1,updateIntervalSeconds:1,observeQualityChanges:!1,maxDisabledTime:30,segmentPrefetchLimit:0,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:{enabled:!1,targetLatency:.5,targetLatencyTolerance:.5,maxPlaybackRate:1.1,minPlaybackRate:.95,panicMode:!1,panicThreshold:60,dynamicTargetLatency:{enabled:!1,stabilityThreshold:60,rebufferIncrement:.5,maxAttempts:10,maxLatency:4,minLatency:1}},allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,preloadNextUrlWindow:30,loadTimeout:30,clearDecodingCache:et()||Ze(),dontChooseCodecs:!1,shouldFixTimestampOffset:Xe()||Ke()};(Xe()||Ke()||Ye()||tt())&&(s.stallSkip=0),(navigator.userAgent.match(/Edge\//)||ze())&&(s.gapPadding=.01),Ke()&&(s.gapPadding=2);var a={trackSelectionCallback:function(e){return M((function(t){return t.return(e)}))},downloadSizeCallback:function(e){var t;return M((function(n){return 1==n.g?navigator.storage&&navigator.storage.estimate?S(n,navigator.storage.estimate(),3):n.return(!0):(t=n.h,n.return(t.usage+e<.95*t.quota))}))},progressCallback:function(e,t){return du([e,t])},usePersistentLicense:!0,numberOfParallelDownloads:5};t={enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:20,minTimeToSwitch:Je()?.5:0,preferNetworkInformationBandwidth:!1},i={codecSwitchingStrategy:i,addExtraFeaturesToSourceBuffer:function(e){return du([e],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,modifyCueCallback:function(e,t){return du([e,t])},dispatchAllEmsgBoxes:!1};var o=!1,l=!1,u=!0;at()&&(l=o=!0,u=!1);var h={drm:n,manifest:r,streaming:s,mediaSource:i,offline:a,abrFactory:function(){return new Pr},adaptationSetCriteriaFactory:function(){return new(Function.prototype.bind.apply(fu,[null].concat(d(P.apply(0,arguments)))))},abr:t,autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferredTextFormats:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[],version:1},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1},ads:{customPlayheadTracker:o,skipPlayDetection:l,supportsMultipleMediaElements:u,disableHLSInterstitial:!1,disableDASHInterstitial:!1},ignoreHardwareResolution:!1};return a.trackSelectionCallback=function(t){return M((function(n){return n.return(function(t,n,i){var r=i;"AUTO"==r&&(r=e.matchMedia("(color-gamut: p3)").matches?t.some((function(e){return!(!e.hdr||"HLG"!=e.hdr)}))?"HLG":"PQ":"SDR");var s=t.filter((function(e){return!("variant"!=e.type||e.hdr&&e.hdr!=r)}));i=[];var a=rr(n,s.map((function(e){return e.language})));a&&(i=s.filter((function(e){return er(e.language)==a}))),0==i.length&&(i=s.filter((function(e){return e.primary}))),0==i.length&&(s.map((function(e){return e.language})),i=s);var o=i.filter((function(e){return e.height&&480>=e.height}));for(o.length&&(o.sort((function(e,t){return t.height-e.height})),i=o.filter((function(e){return e.height==o[0].height}))),n=[],i.length&&(s=Math.floor(i.length/2),i.sort((function(e,t){return e.bandwidth-t.bandwidth})),n.push(i[s])),t=c(t),i=t.next();!i.done;i=t.next())(i=i.value).type!=Si&&"image"!=i.type||n.push(i);return n}(t,h.preferredAudioLanguage,h.preferredVideoHdrLevel))}))},h}function Su(){return{streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}}}function _u(e,t,n){var i={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:[],audioRobustness:[],sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:"",headers:{}}};return uu(e,t,n||Tu(),i,"")}function wu(e){return du([e],e)}function Eu(e){return du([e],e)}function ku(){this.g=null,this.h=[]}function xu(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration);for(var i=(e=c(e.h)).next();!i.done;i=e.next())n+=(i=i.value).state==t?i.duration:0;return n}function Au(){this.i=this.h=null,this.g=[]}function Cu(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function Iu(){this.mc=this.Vg=this.s=this.A=this.I=this.B=this.o=this.j=this.H=this.C=this.i=this.P=this.W=this.L=this.M=this.O=this.l=this.m=NaN,this.K=0,this.F=this.G=NaN,this.g=new ku,this.h=new Au}function Lu(e,t,n,i){Yr.call(this),this.M=e,this.W=t,this.Aa=i.networkingEngine,this.B=n,this.o=null,this.sa=0,this.Oa=i.Ic,this.F=i.Oi,this.Qa=i.Pi,this.g=i.config,this.l=this.G=this.h=null,this.ia=!1,this.H=i.Zi,this.oa=!1,this.i=null,this.da=!1,this.j=this.C=null,this.ba=!1,this.L=new Map,this.pa=!1,this.Ba=i.Yi,this.$=new Iu,this.ga=new jr,this.m=new jr,this.O=null,this.s=!1,this.Ia=i.Mh,this.ja=null,this.Da=i.Lh,this.P=!1,this.K=[],this.I=[],this.A=!0}function Du(e,t,n){(e=t?e.I:e.K)?e.push(n):n()}function Ru(e,t){if(e.O=t,e.P=!0,e.K)for(var n=(t=c(e.K)).next();!n.done;n=t.next())(n=n.value)();e.K=null}function Mu(e){if(e.s)throw new Me(2,7,7003)}function Pu(e,t){e.dispatchEvent(new Kr("onstatechange",(new Map).set("state",t)))}function Ou(e,t){var n,i,r,s;return M((function(a){switch(a.g){case 1:if(!e.h||e.i)return a.return();if(Pu(e,"drm-engine"),e.sa=Date.now()/1e3,e.i=e.Oa(),e.F.h=e.i,e.i.configure(e.g.drm,(function(){return e.A})),!da(e.F,e.h)){a.u(2);break}return n=new Kr("trackschanged",void 0),S(a,Promise.resolve(),3);case 3:Mu(e),e.dispatchEvent(n);case 2:return i=kr(e.h.variants),r=!0,e.h&&e.h.presentationTimeline&&"HLS"!=e.h.type&&(r=e.h.presentationTimeline.T()),S(a,Rs(e.i,i,e.h.offlineSessionIds,r),4);case 4:if(Mu(e),!t){a.u(5);break}return S(a,e.i.Jb(t),6);case 6:Mu(e);case 5:return S(a,ca(e.F,e.h),7);case 7:if(!a.h){a.u(0);break}return s=new Kr("trackschanged",void 0),S(a,Promise.resolve(),9);case 9:e.dispatchEvent(s),_(a)}}))}function Nu(e,t,n){var i,r,s,a,o;return M((function(l){return 1==l.g?(i=e.g.streaming.segmentPrefetchLimit||2,r=new kl(i,t,(function(t,n,i){return tu(t,n,i||null,e.g.streaming.retryParameters,e.Aa,e.A)}),!1),e.L.set(t.id,r),t.segmentIndex?l.u(2):S(l,t.createSegmentIndex(),2)):(s=e.B||0,(o=(a=t.segmentIndex.Pb(s))?a.current():null)||(o=fl(t.segmentIndex)),o?n?o.ca?S(l,Cl(r,o.ca),0):l.u(0):S(l,Al(r,o.startTime),0):l.u(0))}))}function Uu(e,t){Yr.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{Gc:null,Fc:ju,vc:function(e,t){return Fu(n,"enter",e,t)}},{Gc:Bu,Fc:ju,vc:function(e,t){return Fu(n,"enter",e,t)}},{Gc:$u,Fc:ju,vc:function(e,t){return Fu(n,"enter",e,t)}},{Gc:ju,Fc:Bu,vc:function(e,t){return Fu(n,"exit",e,t)}},{Gc:ju,Fc:$u,vc:function(e,t){return Fu(n,"exit",e,t)}},{Gc:Bu,Fc:$u,vc:function(e,t){return Fu(n,"skip",e,t)}},{Gc:$u,Fc:Bu,vc:function(e,t){return Fu(n,"skip",e,t)}}],this.h=new ee,this.h.D(this.i,"regionremove",(function(e){n.g.delete(e.region)}))}function Fu(e,t,n,i){t=new Kr(t,new Map([["region",n],["seeking",i]])),e.dispatchEvent(t)}el.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.m=function(){},this.g=null},sl.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},(i=ol.prototype).ready=function(){var e=this;Jo(this.h,HTMLMediaElement.HAVE_CURRENT_DATA,this.i,(function(){!function(){if(null==e.g||0==e.g&&1/0!=e.h.duration)e.j=!0;else{var t=e.h.currentTime,n=e.g;0>e.g&&(n=Math.max(0,t+e.g)),t!=n?(e.i.ma(e.h,"seeking",(function(){e.j=!0})),e.h.currentTime=n):e.j=!0}}()}))},i.release=function(){this.i&&(this.i.release(),this.i=null),this.h=null},i.Se=function(e){this.g=this.j?this.g:e},i.Ld=function(){return(this.j?this.h.currentTime:this.g)||0},i.tg=function(){return 0},i.sg=function(){return 0},i.$g=function(){},(i=ll.prototype).ready=function(){this.m.ua(.25)},i.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.i=this.h=this.g=this.l=null,this.s=function(){}},i.Se=function(e){nl(this.h,e)},i.Ld=function(){var e=tl(this.h);return 0<this.i.readyState&&!this.i.paused?dl(this,e):e},i.tg=function(){return this.j.G},i.sg=function(){return this.j.C},i.$g=function(){this.j.le()},(i=hl.prototype).getNumReferences=function(){return this.g.length},i.getNumEvicted=function(){return this.i},i.release=function(){this.o||(this.g=[],this.m&&this.m.stop(),this.m=null)},i.Ri=function(){this.o=!0},i.Eb=function(e){for(var t=c(this.g),n=t.next();!n.done;n=t.next())e(n.value)},i.find=function(e){for(var t=this.g.length-1,n=t;0<=n;--n){var i=this.g[n],r=n<t?this.g[n+1].startTime:i.endTime;if(e>=i.startTime&&e<r)return n+this.i}return this.g.length&&e<this.g[0].startTime?this.i:null},i.get=function(e){return 0==this.g.length||0>(e-=this.i)||e>=this.g.length?null:this.g[e]},i.offset=function(e){if(!this.o)for(var t=c(this.g),n=t.next();!n.done;n=t.next())n.value.offset(e)},i.fe=function(e){if(!this.o&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.g=this.g.filter((function(e){return Math.round(1e3*e.startTime)/1e3<t})),this.g.push.apply(this.g,d(e))}},i.zd=function(e,t){var n=this;e=e.filter((function(e){return e.endTime>t&&(0==n.g.length||e.endTime>n.g[0].startTime)})),this.fe(e),this.Ja(t)},i.Ja=function(e){if(!this.o){var t=this.g.length;this.g=this.g.filter((function(t){return t.endTime>e})),this.i+=t-this.g.length}},i.Lc=function(e,t,n){if(n=void 0!==n&&n,!this.o){for(;this.g.length&&this.g[this.g.length-1].startTime>=t;)this.g.pop();for(;this.g.length&&this.g[0].endTime<=e;)this.g.shift(),n||this.i++;0!=this.g.length&&((t=new ka((e=this.g[this.g.length-1]).startTime,t,e.C,e.Na,e.wa,e.ca,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.A,e.h,e.status,e.aesKey)).mimeType=e.mimeType,t.codecs=e.codecs,t.i=e.i,this.g[this.g.length-1]=t)}},i.De=function(e,t){var n=this;this.o||(this.m&&this.m.stop(),this.m=new Ve((function(){var e=t();e?n.g.push.apply(n.g,d(e)):(n.m.stop(),n.m=null)})),this.m.ua(e))},hl.prototype[Symbol.iterator]=function(){return this.Pb(0)},hl.prototype.Pb=function(e,t,n){t=void 0!==t&&t,n=void 0!==n&&n;var i=this.find(e);if(null==i)return null;var r=this.get(i);n?i++:i--;var s=-1;if(r&&0<r.g.length)for(var a=r.g.length-1;0<=a;--a){var o=r.g[a];if(e>=o.startTime&&e<o.endTime){if(!t){for(;a&&!o.l;)a--,o=r.g[a];if(!o.l)return W("No independent partial segment found!"),null}n?i--:i++,s=a-1;break}}return new gl(this,i,s,n)},$("shaka.media.SegmentIndex",hl),hl.forSingleSegment=pl,hl.prototype.getIteratorForTime=hl.prototype.Pb,hl.prototype.updateEvery=hl.prototype.De,hl.prototype.fit=hl.prototype.Lc,hl.prototype.evict=hl.prototype.Ja,hl.prototype.mergeAndEvict=hl.prototype.zd,hl.prototype.offset=hl.prototype.offset,hl.prototype.get=hl.prototype.get,hl.prototype.find=hl.prototype.find,hl.prototype.markImmutable=hl.prototype.Ri,hl.prototype.release=hl.prototype.release,hl.prototype.getNumEvicted=hl.prototype.getNumEvicted,hl.prototype.getNumReferences=hl.prototype.getNumReferences,(i=gl.prototype).bd=function(e){this.reverse=e},i.Vh=function(){return this.h},i.current=function(){var e=this.i.get(this.h);return e&&0<e.g.length&&e.s&&this.g>=e.g.length&&(this.h++,this.g=0,e=this.i.get(this.h)),e&&0<e.g.length?e.g[this.g]:e},i.next=function(){var e=this.i.get(this.h);return this.reverse?e&&0<e.g.length?(this.g--,0>this.g&&(this.h--,this.g=(e=this.i.get(this.h))&&0<e.g.length?e.g.length-1:0)):(this.h--,this.g=0):e&&0<e.g.length?(this.g++,e.s&&this.g==e.g.length&&(this.h++,this.g=0)):(this.h++,this.g=0),{value:e=this.current(),done:!e}},i.Vf=function(){var e=this.current();if(e.o&&!e.l&&(e=this.i.get(this.h))&&0<e.g.length)for(var t=e.g[this.g];t.l&&!(0>=this.g);)this.g--,t=e.g[this.g]},$("shaka.media.SegmentIterator",gl),gl.prototype.resetToLastIndependent=gl.prototype.Vf,gl.prototype.next=gl.prototype.next,gl.prototype.current=gl.prototype.current,gl.prototype.currentPosition=gl.prototype.Vh,gl.prototype.setReverse=gl.prototype.bd,y(ml,hl),(i=ml.prototype).clone=function(){var e=new ml;return e.h=this.h.slice(),e.i=this.i,e},i.release=function(){for(var e=c(this.h),t=e.next();!t.done;t=e.next())t.value.release();this.h=[]},i.Eb=function(e){for(var t=c(this.h),n=t.next();!n.done;n=t.next())n.value.Eb(e)},i.find=function(e){for(var t=this.i,n=c(this.h),i=n.next();!i.done;i=n.next()){var r=(i=i.value).find(e);if(null!=r)return r+t;t+=i.getNumEvicted()+i.getNumReferences()}return null},i.get=function(e){for(var t=this.i,n=c(this.h),i=n.next();!i.done;i=n.next()){var r=(i=i.value).get(e-t);if(r)return r;r=i.getNumReferences(),t+=i.getNumEvicted()+r}return null},i.offset=function(){},i.fe=function(){},i.Ja=function(e){for(var t=c(this.h),n=t.next();!n.done;n=t.next())n.value.Ja(e);for(;1<this.h.length&&0==this.h[0].getNumReferences();)e=this.h.shift(),this.i+=e.getNumEvicted(),e.release()},i.zd=function(){},i.Lc=function(){},i.De=function(){},$("shaka.media.MetaSegmentIndex",ml),ml.prototype.updateEvery=ml.prototype.De,ml.prototype.fit=ml.prototype.Lc,ml.prototype.mergeAndEvict=ml.prototype.zd,ml.prototype.evict=ml.prototype.Ja,ml.prototype.merge=ml.prototype.fe,ml.prototype.offset=ml.prototype.offset,ml.prototype.get=ml.prototype.get,ml.prototype.find=ml.prototype.find,ml.prototype.forEachTopLevelReference=ml.prototype.Eb,ml.prototype.release=ml.prototype.release,yl.prototype.release=function(){this.set(this.rc()),this.h&&(this.h.stop(),this.h=null),this.g=null},yl.prototype.set=function(e){this.i=e,vl(this)},yl.prototype.rc=function(){return this.g.rc()},bl.prototype.release=function(){this.g&&(this.g.release(),this.g=null),this.i.stop();for(var e=c(this.h),t=e.next();!t.done;t=e.next())t.value.release();this.h.clear()},y(Sl,Yr),Sl.prototype.release=function(){this.g.clear(),Yr.prototype.release.call(this)},Sl.prototype.j=function(e){for(var t=c(this.g.values()),n=t.next();!n.done;n=t.next()){var i=(n=n.value).bf;e:{for(var r=n.Hd,s=r.length-1;0<=s;s--){var a=r[s];if(a.position<=e){r=a.Tc;break e}}r=null}s=r&&!(i===r||i&&r&&i.bandwidth==r.bandwidth&&i.audioSamplingRate==r.audioSamplingRate&&i.codecs==r.codecs&&i.contentType==r.contentType&&i.frameRate==r.frameRate&&i.height==r.height&&i.mimeType==r.mimeType&&i.channelsCount==r.channelsCount&&i.pixelAspectRatio==r.pixelAspectRatio&&i.width==r.width),a=r&&i&&r.label&&i.label&&i.label!==r.label;var o=r&&i&&r.language&&i.language&&i.language!==r.language;i=r&&i&&r.roles&&i.roles&&!Re(i.roles,r.roles),(a||o||i)&&_l(this,e,r.contentType)&&(n.bf=r,i=new Kr("audiotrackchange",new Map([["quality",r],["position",e]])),this.dispatchEvent(i)),s&&_l(this,e,r.contentType)&&(n.bf=r,JSON.stringify(r),n=new Kr("qualitychange",new Map([["quality",r],["position",e]])),this.dispatchEvent(n))}},y(El,Yr),El.prototype.release=function(){this.h.clear(),this.g&&(this.g.stop(),this.g=null),Yr.prototype.release.call(this)},kl.prototype.Ja=function(e,t){t=void 0!==t&&t;for(var n=c(this.h.keys()),i=n.next();!i.done;i=n.next())e>(i=i.value).endTime&&Ml(this,i);t&&Dl(this)},kl.prototype.bd=function(e){this.o=e,this.g&&this.g.bd(e)},Pl.prototype.abort=function(){this.Fd&&this.Fd.abort()},(i=$l.prototype).destroy=function(){return this.m.destroy()},i.configure=function(e){if(this.i=e,this.L=new Fr({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0),e.disableAudioPrefetch){var t=this.h.get("audio");t&&t.X&&(Ll(t.X),t.X=null);for(var n=(t=c(this.o.keys())).next();!n.done;n=t.next())n=n.value,Ll(this.o.get(n)),this.o.delete(n)}for(e.disableTextPrefetch&&(t=this.h.get(Si))&&t.X&&(Ll(t.X),t.X=null),e.disableVideoPrefetch&&(t=this.h.get("video"))&&t.X&&(Ll(t.X),t.X=null),n=(t=c(this.h.keys())).next();!n.done;n=t.next())(n=this.h.get(n.value)).X?(Rl(n.X,e.segmentPrefetchLimit),0<e.segmentPrefetchLimit||(Ll(n.X),n.X=null)):0<e.segmentPrefetchLimit&&(n.X=Wl(this,n.stream));e.disableAudioPrefetch||function(e){for(var t=e.i.segmentPrefetchLimit,n=e.i.prefetchAudioLanguages,i=c(e.j.variants),r=i.next(),s={};!r.done;s={vb:void 0},r=i.next())if(s.vb=r.value,s.vb.audio)if(e.o.has(s.vb.audio)){if(Rl(r=e.o.get(s.vb.audio),t),!(0<t&&n.some(function(e){return function(t){return Qi(e.vb.audio.language,t)}}(s)))){var a=e.h.get(s.vb.audio.type);r!==(a&&a.X)&&Ll(r),e.o.delete(s.vb.audio)}}else 0>=t||!n.some(function(e){return function(t){return Qi(e.vb.audio.language,t)}}(s))||!(r=Wl(e,s.vb.audio))||(s.vb.audio.segmentIndex||s.vb.audio.createSegmentIndex(),e.o.set(s.vb.audio,r))}(this)},i.start=function(e){var t=this;return M((function(n){if(1==n.g)return S(n,function(e,t){var n,i,r,s,a,o,l,u,d;return M((function(h){if(1==h.g){if(n=_i,!e.l)throw new Me(2,5,5006);return i=new Map,r=new Set,e.l.audio&&(i.set(n.U,e.l.audio),r.add(e.l.audio)),e.l.video&&(i.set(n.la,e.l.video),r.add(e.l.video)),e.s&&(i.set(n.xa,e.s),r.add(e.s)),S(h,e.g.Z.init(i,e.j.sequenceMode,e.j.type,e.j.ignoreManifestTimestampsInSegmentsMode),2)}for(ds(e.m),e.updateDuration(),s=c(i.keys()),a=s.next();!a.done;a=s.next())o=a.value,l=i.get(o),e.h.has(o)||(u=Kl(e,l),t.has(l.id)&&(xl(d=t.get(l.id),(function(t,n,i){return tu(t,n,i||null,e.i.retryParameters,e.g.Ub)})),u.X=d),e.h.set(o,u),iu(e,u,0));_(h)}))}(t,e||new Map),2);ds(t.m),t.G=!0,_(n)}))},i.$c=function(){if(this.g)for(var e=this.g.nd(),t=c(this.h.keys()),n=t.next();!n.done;n=t.next()){var i=n.value;n=this.h.get(i);var r=this.g.Z;if(i==Si?r=null!=(r=r.h).g&&null!=r.h&&(e>=r.g&&e<r.h):r=Da(r=Io(r,i),e),!r){if(n.X&&(n.X.g=null),"audio"===n.type)for(var s=(r=c(this.o.values())).next();!s.done;s=r.next())s.value.g=null;n.ha=null,(null!=Co(this.g.Z,i)||n.Ga)&&zl(this,n),n.qb&&(n.qb.abort(),n.qb=null),i===Si&&((i=this.g.Z).K&&i.K.g()),n.$c=!0}}},i.updateDuration=function(){var t=!(!(t=e.ManagedMediaSource||e.MediaSource)||!t.prototype)&&(!!t.prototype.setLiveSeekableRange&&!!t.prototype.clearLiveSeekableRange),n=this.j.presentationTimeline.getDuration();1/0>n?(t&&(this.A&&this.A.stop(),Mo(this.g.Z)),this.g.Z.ab(n)):t?(this.A&&this.A.ua(.5),this.g.Z.ab(1/0)):this.g.Z.ab(Math.pow(2,32))},$("shaka.util.ConfigUtils",lu),lu.getDifferenceFromConfigObjects=hu,lu.convertToConfigObject=cu,lu.mergeConfigObjects=uu,fu.prototype.configure=function(e){this.g=e},fu.prototype.create=function(t){var n=[];n=function(e,t){t=er(t);var n=rr(t,e.map((function(e){return ir(e)})));return n?e.filter((function(e){return n==ir(e)})):[]}(t,this.g.language);var i=t.filter((function(e){return e.primary}));return t=function(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))}(n=n.length?n:i.length?i:t,this.g.role),t.length&&(n=t),this.g.videoLayout&&(t=function(e,t){return e.filter((function(e){return!e.video||!e.video.videoLayout||e.video.videoLayout==t}))}(n,this.g.videoLayout),t.length&&(n=t)),this.g.Oc&&(t=function(t,n){return"AUTO"==n&&(n=e.matchMedia("(color-gamut: p3)").matches?t.some((function(e){return!(!e.video||!e.video.hdr||"HLG"!=e.video.hdr)}))?"HLG":"PQ":"SDR"),t.filter((function(e){return!e.video||!e.video.hdr||e.video.hdr==n}))}(n,this.g.Oc),t.length&&(n=t)),this.g.channelCount&&(t=function(e,t){return e.filter((function(e){return!e.audio||!e.audio.channelsCount||e.audio.channelsCount==t}))}(n,this.g.channelCount),t.length&&(n=t)),this.g.Hc&&(t=function(e,t){return e.filter((function(e){return!(!e.audio||!e.audio.label)&&e.audio.label.toLowerCase()==t.toLowerCase()}))}(n,this.g.Hc),t.length&&(n=t)),this.g.cd&&(t=function(e,t){return e.filter((function(e){return!(!e.video||!e.video.label)&&e.video.label.toLowerCase()==t.toLowerCase()}))}(n,this.g.cd),t.length&&(n=t)),t=function(e,t){return e.filter((function(e){return!e.audio||e.audio.spatialAudio==t}))}(n,this.g.spatialAudio),t.length&&(n=t),this.g.audioCodec&&(t=function(e,t){return e.filter((function(e){return!e.audio||e.audio.codecs==t}))}(n,this.g.audioCodec),t.length&&(n=t)),new ea(n[0],n,!("smooth"==this.g.codecSwitchingStrategy&&re()))},$("shaka.util.FairPlayUtils",pu),pu.commonFairPlayResponse=function(e,t){if(2===e){try{var n=pt(t.data)}catch(r){return}e=!1,"<ckc>"===(n=n.trim()).substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0);try{var i=JSON.parse(n);i.ckc&&(n=i.ckc,e=!0),i.CkcMessage&&(n=i.CkcMessage,e=!0),i.License&&(n=i.License,e=!0)}catch(r){}e&&(t.data=ge(di(n)))}},pu.expressplayFairPlayRequest=function(e,t){vu(e,t)},pu.conaxFairPlayRequest=function(e,t){vu(e,t)},pu.ezdrmFairPlayRequest=function(e,t){vu(e,t)},pu.verimatrixFairPlayRequest=function(e,t){2===e&&(e=ci(e=me(t.body)),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=yt("spc="+e))},pu.expressplayInitDataTransform=function(e,t,n){return yu(e,t,n)},pu.conaxInitDataTransform=function(t,n,i){if("skd"!==n)return t;n=i.serverCertificate,i=mt(t).split("skd://").pop().split("?").shift(),i=e.atob(i);var r=new ArrayBuffer(2*i.length);r=ye(r);for(var s=0,a=i.length;s<a;s++)r[s]=i.charCodeAt(s);return mu(t,r,n)},pu.ezdrmInitDataTransform=function(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,mu(e,n=mt(e).split(";").pop(),t))},pu.verimatrixInitDataTransform=function(e,t,n){return yu(e,t,n)},pu.initDataTransform=mu,pu.defaultGetContentId=gu,pu.isFairPlaySupported=function(){var e;return M((function(t){return 1==t.g?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},w(t,2),S(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.g?t.return(!0):(x(t),t.return(!1))}))},$("shaka.util.PlayerConfiguration",bu),bu.mergeConfigObjects=_u,bu.createDefaultForLL=Su,bu.createDefault=Tu,y(Lu,Yr),(i=Lu.prototype).getStartTime=function(){return this.B},i.Nc=function(){return this.M},i.wf=function(){return this.h},i.getStats=function(){return this.$},i.start=function(){var t=this;!function(){var n;M((function(i){switch(i.g){case 1:return S(i,Promise.resolve(),2);case 2:return w(i,3),S(i,function(e){var t,n,i,r,s,a,o,l,u;return M((function(d){switch(d.g){case 1:if(Pu(e,"manifest-parser"),e.l||(e.G=va(e.M,e.W),e.l=e.G(),e.l.configure(e.g.manifest,(function(){return e.A}))),t=Date.now()/1e3,Pu(e,"manifest"),e.h){d.u(2);break}return S(d,e.l.start(e.M,e.Qa),3);case 3:if(e.h=d.h,1!=e.h.variants.length){d.u(2);break}for(n=[],i=e.h.variants[0],r=c([i.video,i.audio]),s=r.next();!s.done;s=r.next())(a=s.value)&&!a.segmentIndex&&n.push(a.createSegmentIndex());if(!(0<n.length)){d.u(2);break}return S(d,Promise.all(n),2);case 2:return e.ga.resolve(),o=new Kr("manifestparsed",void 0),S(d,Promise.resolve(),7);case 7:if(e.dispatchEvent(o),0==e.h.variants.length)throw new Me(2,4,4036);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}(e.h),l=Date.now()/1e3,u=l-t,e.$.H=u,_(d)}}))}(t),5);case 5:if(Mu(t),"webkit"===e.shakaMediaKeysPolyfill){i.u(6);break}return S(i,Ou(t),7);case 7:Mu(t);case 6:return S(i,function(e){var t,n,i,r,s,a;return M((function(o){return e.o||(e.o=e.g.adaptationSetCriteriaFactory(),e.o.configure({language:e.g.preferredAudioLanguage,role:e.g.preferredVariantRole,channelCount:e.g.preferredAudioChannelCount,Oc:e.g.preferredVideoHdrLevel,spatialAudio:e.g.preferSpatialAudio,videoLayout:e.g.preferredVideoLayout,Hc:e.g.preferredAudioLabel,cd:e.g.preferredVideoLabel,codecSwitchingStrategy:e.g.mediaSource.codecSwitchingStrategy,audioCodec:""})),e.Da&&(t=e.g.abrFactory,e.C=t,e.j=t(),e.j.configure(e.g.abr)),e.Ia?(n=e.h.presentationTimeline.T(),i=kr(e.h.variants),r=e.o.create(i),e.j.configure(e.g.abr),e.j.setVariants(Array.from(r.values())),(s=e.j.chooseVariant())?(a=[],e.ja=s,s.video&&a.push(Nu(e,s.video,n)),s.audio&&a.push(Nu(e,s.audio,n)),S(o,Promise.all(a),0)):o.u(0)):o.u(0)}))}(t),8);case 8:if(Mu(t),!t.i){i.u(9);break}return S(i,function(e){return M((function(t){return 1==t.g?e.K?S(t,e.m,3):t.u(0):S(t,Promise.all(e.W.map((function(e){return e.promise}))),0)}))}(t.i),10);case 10:Mu(t);case 9:t.m.resolve(),k(i,0);break;case 3:(n=x(i))instanceof Me&&(7001==n.code||7003==n.code)||t.m.reject(n),_(i)}}))}()},i.dispatchEvent=function(e){return this.O?this.O.dispatchEvent(e):Yr.prototype.dispatchEvent.call(this,e)},i.onError=function(e){2===e.severity&&(this.m.reject(e),this.destroy());var t=(new Map).set("detail",e);t=new Kr("error",t),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)},i.configure=function(e,t){e=cu(e,t),_u(this.g,e)},i.getConfiguration=function(){return It(this.g)},i.zj=function(){return this.m},i.destroy=function(){var e,t,n=this;return M((function(i){switch(i.g){case 1:if(n.s=!0,!n.l||n.ia){i.u(2);break}return S(i,n.l.stop(),2);case 2:if(!n.j||n.ba){i.u(4);break}return S(i,n.j.stop(),4);case 4:if(n.H&&!n.oa&&n.H.release(),!n.i||n.da){i.u(6);break}return S(i,n.i.destroy(),6);case 6:if(0<n.L.size&&!n.pa)for(e=c(n.L.values()),t=e.next();!t.done;t=e.next())Ll(t.value);_(i)}}))},$("shaka.media.PreloadManager",Lu),Lu.prototype.destroy=Lu.prototype.destroy,Lu.prototype.waitForFinish=Lu.prototype.zj,y(Uu,Yr),Uu.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,Yr.prototype.release.call(this)},Uu.prototype.j=function(e,t){if(!this.l||0!=e){this.l=!1;for(var n=c(this.i.h.values()),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.g.get(i),s=e<i.startTime?Bu:e>i.endTime?$u:ju;this.g.set(i,s);for(var a=c(this.m),o=a.next();!o.done;o=a.next())(o=o.value).Gc==r&&o.Fc==s&&o.vc(i,t)}}};var Bu=1,ju=2,$u=3;function Vu(e,t,n){var i,r,s,a,o,l,u;return M((function(c){switch(c.g){case 1:var d=new zn(e).Za.split("/").pop().split(".");return i=1==d.length?"":d.pop().toLowerCase(),(r=Hu.get(i))?c.return(r):(s=0,a=ns([e],n),w(c,2),a.method="HEAD",S(c,t.request(s,a).promise,4));case 4:o=c.h,r=o.headers["content-type"],k(c,3);break;case 2:if(!(l=x(c))||1002!=l.code&&1001!=l.code){c.u(3);break}return a.method="GET",S(c,t.request(s,a).promise,6);case 6:u=c.h,r=u.headers["content-type"];case 3:return c.return(r?r.toLowerCase().split(";").shift():"")}}))}var Hu=(new Map).set("mp4","video/mp4").set("m4v","video/mp4").set("m4a","audio/mp4").set("webm","video/webm").set("weba","audio/webm").set("mkv","video/webm").set("ts","video/mp2t").set("ogv","video/ogg").set("ogg","audio/ogg").set("mpg","video/mpeg").set("mpeg","video/mpeg").set("mov","video/quicktime").set("m3u8","application/x-mpegurl").set("mpd","application/dash+xml").set("ism","application/vnd.ms-sstr+xml").set("mp3","audio/mpeg").set("aac","audio/aac").set("flac","audio/flac").set("wav","audio/wav").set("sbv","text/x-subviewer").set("srt","text/srt").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml").set("lrc","application/x-subtitle-lrc").set("ssa","text/x-ssa").set("ass","text/x-ssa").set("jpeg","image/jpeg").set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif").set("html","text/html").set("htm","text/html");function qu(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map((function(t){return qu(t,e)})).join("");if(!e.payload)return e.payload;var n=[],i=e.fontWeight>=Dn,r=e.fontStyle==Mn,s=e.textDecoration.includes(On);return i&&n.push(["b"]),r&&n.push(["i"]),s&&n.push(["u"]),""==(r=e.color)&&t&&(r=t.color),i="",(r=Gu(r))&&(i+="."+r),""==(r=e.backgroundColor)&&t&&(r=t.backgroundColor),(t=Gu(r))&&(i+=".bg_"+t),i&&n.push(["c",i]),n.reduceRight((function(e,t){var n=c(t);return"<"+(t=n.next().value)+(void 0===(n=n.next().value)?"":n)+">"+e+"</"+t+">"}),e.payload)}function Gu(e){var t=(e=e.toLowerCase()).replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(256|parseInt(t[1],10)).toString(16).slice(1)+(256|parseInt(t[2],10)).toString(16).slice(1)+(256|parseInt(t[3],10)).toString(16).slice(1):e.startsWith("#")&&7<e.length&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function zu(e,t){for(var n=[],i=(e=c(Ku(e))).next();!i.done;i=e.next())if((i=i.value).isContainer)n.push.apply(n,d(zu(i.nestedCues,i)));else{var r=i.clone();r.nestedCues=[],r.payload=qu(i,t),n.push(r)}return n}function Ku(e){for(var t=[],n=(e=c(e)).next(),i={};!n.done;i={Ze:void 0},n=e.next())i.Ze=n.value,t.some(function(e){return function(t){return fn(e.Ze,t)}}(i))||t.push(i.Ze);return t}function Wu(e){function t(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}if(e.startTime>=e.endTime)return null;var n=new VTTCue(e.startTime,e.endTime,e.payload);n.id=t(e.startTime.toString())+t(e.endTime.toString())+t(e.payload),n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,e.size&&(n.size=e.size);try{n.align=e.textAlign}catch(i){}return"center"==e.textAlign&&"center"!=n.align&&(n.align="middle"),"vertical-lr"==e.writingMode?n.vertical="lr":"vertical-rl"==e.writingMode&&(n.vertical="rl"),1==e.lineInterpretation&&(n.snapToLines=!1),null!=e.line&&(n.line=e.line),null!=e.position&&(n.position=e.position),n}function Xu(e){if(1/0===e.endTime||e.endTime<e.startTime)return null;var t=new dn(e.startTime,e.endTime,e.text);return t.line="number"===typeof e.line?e.line:null,e.lineAlign&&(t.lineAlign=e.lineAlign),t.lineInterpretation=e.snapToLines?kn:1,t.position="number"===typeof e.position?e.position:null,e.positionAlign&&(t.positionAlign=e.positionAlign),t.size=e.size,t.textAlign=e.align,"lr"===e.vertical?t.writingMode="vertical-lr":"rl"===e.vertical&&(t.writingMode="vertical-rl"),e.region&&(t.region.id=e.region.id,t.region.height=e.region.lines,t.region.heightUnits=2,t.region.regionAnchorX=e.region.regionAnchorX,t.region.regionAnchorY=e.region.regionAnchorY,t.region.scroll=e.region.scroll,t.region.viewportAnchorX=e.region.viewportAnchorX,t.region.viewportAnchorY=e.region.viewportAnchorY,t.region.viewportAnchorUnits=Ae,t.region.width=e.region.width,t.region.widthUnits=Ae),pn(t),t}function Yu(e,t){for(this.h=e,this.i=t,this.g=null,t=(e=c(Array.from(this.h.textTracks))).next();!t.done;t=e.next())"metadata"!==(t=t.value).kind&&"chapters"!==t.kind&&(t.mode="disabled",t.label==this.i&&(this.g=t));this.g&&(this.g.mode="hidden")}function Qu(e){e.h&&!e.g&&(e.g=e.h.addTextTrack("subtitles",e.i),e.g.mode="hidden")}function Ju(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var i=c(Array.from(e.cues)),r=i.next();!r.done;r=i.next())(r=r.value)&&t(r)&&e.removeCue(r);e.mode=n}function Zu(){}function ec(t,n){var i=this;document.fullscreenEnabled||X("Using UITextDisplayer in a browser without Fullscreen API support causes subtitles to not be rendered in fullscreen"),this.s=!1,this.h=[],this.j=t,this.B=n,this.F=this.m=null,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.B.appendChild(this.g),this.o=new Ve((function(){i.j.paused||rc(i)})),tc(this),this.l=new Map,this.i=new ee,this.i.D(document,"fullscreenchange",(function(){rc(i,!0)})),this.i.D(this.j,"seeking",(function(){rc(i,!0)})),this.i.D(this.j,"ratechange",(function(){tc(i)})),this.i.D(this.j,"resize",(function(){var e=i.j,t=e.videoWidth;e=e.videoHeight,i.m=t&&e?t/e:null})),this.A=null,"ResizeObserver"in e&&(this.A=new ResizeObserver((function(){rc(i,!0)})),this.A.observe(this.g)),this.C=new Map}function tc(e){e.o&&(e.h.length?e.o.ua((e.F?e.F.captionsUpdatePeriod:.25)/Math.max(1,Math.abs(e.j.playbackRate))):e.o.stop())}function nc(e,t){for(;null!=t;){if(t==e.g)return!0;t=t.parentElement}return!1}function ic(e,t,n,i,r){for(var s=!1,a=[],o=[],l=(t=c(t)).next();!l.done;l=t.next()){l=l.value,r.push(l);var u=e.l.get(l),d=l.startTime<=i&&l.endTime>i,h=u?u.Fh:null;u&&(a.push(u.af),u.Cc&&a.push(u.Cc),d||(s=!0,e.l.delete(l),u=null)),d&&(o.push(l),u?nc(e,h)||(s=!0):(sc(e,l,r),h=(u=e.l.get(l)).Fh,s=!0)),0<l.nestedCues.length&&h&&ic(e,l.nestedCues,h,i,r),r.pop()}if(s){for(r=(i=c(a)).next();!r.done;r=i.next())(r=r.value).parentElement&&r.parentElement.removeChild(r);for(o.sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime})),i=(o=c(o)).next();!i.done;i=o.next())(i=e.l.get(i.value)).Cc?(i.Cc.contains(n)&&i.Cc.removeChild(n),n.appendChild(i.Cc),i.Cc.appendChild(i.af)):n.appendChild(i.af)}}function rc(e,t){if(e.g){var n=e.j.currentTime;if(!e.s||void 0!==t&&t){for(var i=(t=c(e.C.values())).next();!i.done;i=t.next())Na(i.value);Na(e.g),e.l.clear(),e.C.clear()}e.s&&ic(e,e.h,e.g,n,[])}}function sc(e,t,n){var i=1<n.length,r=i?"span":"div";t.lineBreak&&(r="br"),t.rubyTag&&(r=t.rubyTag),i=!i&&0<t.nestedCues.length;var s=document.createElement(r);if("br"!=r&&function(e,t,n,i,r){var s=t.style,a=0==n.nestedCues.length,o=1<i.length;s.whiteSpace="pre-wrap";var l=n.payload.replace(/\s+$/g,(function(e){return"\xa0".repeat(e.length)}));if(s.webkitTextStrokeColor=n.textStrokeColor,s.webkitTextStrokeWidth=n.textStrokeWidth,s.color=n.color,s.direction=n.direction,s.opacity=n.opacity,s.paddingLeft=ac(n.linePadding,n,e.B),s.paddingRight=ac(n.linePadding,n,e.B),s.textCombineUpright=n.textCombineUpright,s.textShadow=n.textShadow,n.backgroundImage)s.backgroundImage="url('"+n.backgroundImage+"')",s.backgroundRepeat="no-repeat",s.backgroundSize="contain",s.backgroundPosition="center",n.backgroundColor&&(s.backgroundColor=n.backgroundColor),s.width="100%",s.height="100%";else{if(n.nestedCues.length)var u=t;else u=document.createElement("span"),t.appendChild(u);n.border&&(u.style.border=n.border),r||((t=function(e,t){for(var n=e.length-1;0<=n;n--){var i=t(e[n]);if(i||0===i)return i}return null}(i,(function(e){return e.backgroundColor})))?u.style.backgroundColor=t:l&&(u.style.backgroundColor="rgba(0, 0, 0, 0.8)")),l&&(u.textContent=l)}o&&!i[i.length-1].isContainer?s.display="inline":(s.display="flex",s.flexDirection="column",s.alignItems="center","left"==n.textAlign||"start"==n.textAlign?(s.width="100%",s.alignItems="start"):"right"!=n.textAlign&&"end"!=n.textAlign||(s.width="100%",s.alignItems="end"),s.justifyContent="before"==n.displayAlign?"flex-start":"center"==n.displayAlign?"center":"flex-end");a||(s.margin="0"),s.fontFamily=n.fontFamily,s.fontWeight=n.fontWeight.toString(),s.fontStyle=n.fontStyle,s.letterSpacing=n.letterSpacing,s.fontSize=ac(n.fontSize,n,e.B),i=n.line,null!=i&&(a=n.lineInterpretation,a==kn&&(a=1,o=16,e.m&&1>e.m&&(o=32),i=0>i?100+i/o*100:i/o*100),1==a&&(s.position="absolute",n.writingMode==En?(s.width="100%",n.lineAlign==xn?s.top=i+"%":"end"==n.lineAlign&&(s.bottom=100-i+"%")):"vertical-lr"==n.writingMode?(s.height="100%",n.lineAlign==xn?s.left=i+"%":"end"==n.lineAlign&&(s.right=100-i+"%")):(s.height="100%",n.lineAlign==xn?s.right=i+"%":"end"==n.lineAlign&&(s.left=100-i+"%")))),s.lineHeight=n.lineHeight,e=function(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==vn?n:"left"===e||"start"===e&&t===wn||"end"===e&&"rtl"===t?"line-left":"right"===e||"start"===e&&"rtl"===t||"end"===e&&t===wn?"line-right":"center"}(n),"line-left"==e?(s.cssFloat="left",null!==n.position&&(s.position="absolute",n.writingMode==En?(s.left=n.position+"%",s.width="auto"):s.top=n.position+"%")):"line-right"==e?(s.cssFloat="right",null!==n.position&&(s.position="absolute",n.writingMode==En?(s.right=100-n.position+"%",s.width="auto"):s.bottom=n.position+"%")):null!==n.position&&50!=n.position&&(s.position="absolute",n.writingMode==En?(s.left=n.position+"%",s.width="auto"):s.top=n.position+"%"),s.textAlign=n.textAlign,s.textDecoration=n.textDecoration.join(" "),s.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&s.writingMode==n.writingMode||(s.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==En?s.width=n.size+"%":s.height=n.size+"%")}(e,s,t,n,i),n=null,t.region&&t.region.id){var a=t.region,o=e.m===4/3?2.5:1.9;if(n=a.id+"_"+a.width+"x"+a.height+(a.heightUnits==Ae?"%":"px")+"-"+a.viewportAnchorX+"x"+a.viewportAnchorY+(a.viewportAnchorUnits==Ae?"%":"px"),e.C.has(n))n=e.C.get(n);else{r=document.createElement("span");var l=a.heightUnits==Ae?"%":"px",u=a.widthUnits==Ae?"%":"px",c=a.viewportAnchorUnits==Ae?"%":"px";r.id="shaka-text-region---"+n,r.classList.add("shaka-text-region"),r.style.position="absolute";var d=a.height,h=a.width;2===a.heightUnits&&(d=5.33*a.height,l="%"),2===a.widthUnits&&(h=a.width*o,u="%"),r.style.height=d+l,r.style.width=h+u,2===a.viewportAnchorUnits?(o=a.viewportAnchorY/75*100,l=a.viewportAnchorX/(e.m===4/3?160:210)*100,o-=a.regionAnchorY*d/100,l-=a.regionAnchorX*h/100,r.style.top=o+"%",r.style.left=l+"%"):(r.style.top=a.viewportAnchorY-a.regionAnchorY*d/100+c,r.style.left=a.viewportAnchorX-a.regionAnchorX*h/100+c),0!==a.heightUnits&&0!==a.widthUnits&&0!==a.viewportAnchorUnits&&(a=Math.max(0,Math.min(100-(parseInt(r.style.width.slice(0,-1),10)||0),parseInt(r.style.left.slice(0,-1),10)||0)),r.style.top=Math.max(0,Math.min(100-(parseInt(r.style.height.slice(0,-1),10)||0),parseInt(r.style.top.slice(0,-1),10)||0))+"%",r.style.left=a+"%"),r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",r.style.justifyContent="before"==t.displayAlign?"flex-start":"center"==t.displayAlign?"center":"flex-end",e.C.set(n,r),n=r}}r=s,i&&((r=document.createElement("span")).classList.add("shaka-text-wrapper"),r.style.backgroundColor=t.backgroundColor,r.style.lineHeight="normal",s.appendChild(r)),e.l.set(t,{af:s,Fh:r,Cc:n})}function ac(e,t,n){var i=(i=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(i[1]),unit:i[2]}:null;if(!i)return e;var r=i.value;switch(i.unit){case"%":return r/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*r/t.cellResolution.rows+"px";default:return e}}function oc(e,t){this.h=e,this.g=t,this.i=void 0,this.s=!1,this.F=!0,this.l=this.B=!1,this.o=this.m=void 0,this.A=0,this.G=!1,this.C=new ee,this.j=null}function lc(t){return t.g.sessionId||(t.g.sessionId=e.crypto.randomUUID()),{v:t.g.version,sf:t.i,sid:t.g.sessionId,cid:t.g.contentId,mtp:t.h.getBandwidthEstimate()/1e3}}function uc(e,t,n){n=void 0===n?{}:n;var i=void 0===i?e.g.useHeaders:i;if(e.g.enabled){Object.assign(n,lc(e)),n.pr=e.h.gb();var r=n.ot===gc||n.ot===mc;if(e.B&&r&&(n.bs=!0,n.su=!0,e.B=!1),null==n.su&&(n.su=e.F),n.v===Tc&&(e.h.T()&&(n.ltc=e.h.Wd()),void 0!=(r=!e.G&&e.o&&e.m?e.o-(e.A||e.m):void 0)&&(n.msd=r,e.G=!0)),e=function(e,t){var n=e.g.includeKeys;return n.length?Object.keys(t).reduce((function(e,i){return n.includes(i)&&(e[i]=t[i]),e}),{}):t}(e,n),i)i=function(e){for(var t=Object.keys(e),n={},i=["Object","Request","Session","Status"],r=[{},{},{},{}],s={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,ltc:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,msd:2,bs:3,rtp:3},a=(t=c(t)).next();!a.done;a=t.next())a=a.value,r[null!=s[a]?s[a]:1][a]=e[a];for(e=0;e<r.length;e++)(s=dc(r[e]))&&(n["CMCD-"+i[e]]=s);return n}(e),Object.keys(i).length&&Object.assign(t.headers,i);else{var s=dc(e);s&&(t.uris=t.uris.map((function(e){return hc(e,s)})))}}}function cc(e,t){if(!(t=e.h.Fb()[t]).length)return 0;var n=e.h.getCurrentTime();return(e=t.find((function(e){return e.start<=n&&e.end>=n})))?1e3*(e.end-n):0}function dc(e){function t(e){return 100*n(e/100)}function n(e){return Math.round(e)}for(var i,r=[],s={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(e){return encodeURIComponent(e)},rtp:t,tb:n},a=Object.keys(e||{}).sort(),o=(a=c(a)).next();!o.done;o=a.next()){var l=e[o=o.value];if(i=l,!Number.isNaN(i)&&null!=i&&""!==i&&!1!==i&&("v"!==o||1!==l)&&("pr"!=o||1!==l)){var u=s[o];u&&(l=u(l));var d;d="string"===(u=typeof l)&&"ot"!==o&&"sf"!==o&&"st"!==o?o+"="+JSON.stringify(l):"boolean"===u?o:"symbol"===u?o+"="+l.description:o+"="+l,r.push(d)}}return r.join(",")}function hc(e,t){return!t||e.includes("offline:")?e:((e=new zn(e)).g.set("CMCD",t),e.toString())}(i=Yu.prototype).configure=function(){},i.remove=function(e,t){return!!this.g&&(Ju(this.g,(function(n){return n.startTime<t&&n.endTime>e})),!0)},i.append=function(e){if(this.g){var t=zu(e),n=[];e=this.g.cues?Array.from(this.g.cues):[];for(var i=(t=c(t)).next(),r={};!i.done;r={Pc:void 0},i=t.next())r.Pc=i.value,!e.some(function(e){return function(t){return t.startTime==e.Pc.startTime&&t.endTime==e.Pc.endTime&&t.text==e.Pc.payload}}(r))&&r.Pc.payload&&(i=Wu(r.Pc))&&n.push(i);for(t=(e=c(e=n.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?n.indexOf(t)-n.indexOf(e):n.indexOf(e)-n.indexOf(t)})))).next();!t.done;t=e.next())this.g.addCue(t.value)}},i.destroy=function(){return this.g&&(Ju(this.g,(function(){return!0})),this.g.mode="disabled"),this.g=this.h=null,Promise.resolve()},i.isTextVisible=function(){return!!this.g&&"showing"==this.g.mode},i.setTextVisibility=function(e){e&&!this.g&&Qu(this),this.g&&(this.g.mode=e?"showing":"hidden")},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){Qu(this)},$("shaka.text.SimpleTextDisplayer",Yu),Yu.prototype.enableTextDisplayer=Yu.prototype.enableTextDisplayer,Yu.prototype.setTextLanguage=Yu.prototype.setTextLanguage,Yu.prototype.setTextVisibility=Yu.prototype.setTextVisibility,Yu.prototype.isTextVisible=Yu.prototype.isTextVisible,Yu.prototype.destroy=Yu.prototype.destroy,Yu.prototype.append=Yu.prototype.append,Yu.prototype.remove=Yu.prototype.remove,Yu.prototype.configure=Yu.prototype.configure,(i=Zu.prototype).configure=function(){},i.remove=function(){},i.append=function(){},i.destroy=function(){},i.isTextVisible=function(){return!1},i.setTextVisibility=function(){},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){},$("shaka.text.StubTextDisplayer",Zu),Zu.prototype.enableTextDisplayer=Zu.prototype.enableTextDisplayer,Zu.prototype.setTextLanguage=Zu.prototype.setTextLanguage,Zu.prototype.setTextVisibility=Zu.prototype.setTextVisibility,Zu.prototype.isTextVisible=Zu.prototype.isTextVisible,Zu.prototype.destroy=Zu.prototype.destroy,Zu.prototype.append=Zu.prototype.append,Zu.prototype.remove=Zu.prototype.remove,Zu.prototype.configure=Zu.prototype.configure,(i=ec.prototype).configure=function(e){this.F=e,tc(this)},i.append=function(e){for(var t=[].concat(d(this.h)),n=(e=c(Ku(e))).next(),i={};!n.done;i={$e:void 0},n=e.next())i.$e=n.value,t.some(function(e){return function(t){return fn(t,e.$e)}}(i))||this.h.push(i.$e);this.h.length&&tc(this),rc(this)},i.destroy=function(){return this.g?(this.B.removeChild(this.g),this.g=null,this.s=!1,this.h=[],this.o&&(this.o.stop(),this.o=null),this.l.clear(),this.i&&(this.i.release(),this.i=null),this.A&&(this.A.disconnect(),this.A=null),Promise.resolve()):Promise.resolve()},i.remove=function(e,t){if(!this.g)return!1;var n=this.h.length;return this.h=this.h.filter((function(n){return n.startTime<e||n.endTime>=t})),rc(this,n>this.h.length),this.h.length||tc(this),!0},i.isTextVisible=function(){return this.s},i.setTextVisibility=function(e){this.s=e,rc(this,!0)},i.setTextLanguage=function(e){e&&"und"!=e?this.g.setAttribute("lang",e):this.g.setAttribute("lang","")},i.enableTextDisplayer=function(){},$("shaka.text.UITextDisplayer",ec),ec.prototype.enableTextDisplayer=ec.prototype.enableTextDisplayer,ec.prototype.setTextLanguage=ec.prototype.setTextLanguage,ec.prototype.setTextVisibility=ec.prototype.setTextVisibility,ec.prototype.isTextVisible=ec.prototype.isTextVisible,ec.prototype.remove=ec.prototype.remove,ec.prototype.destroy=ec.prototype.destroy,ec.prototype.append=ec.prototype.append,ec.prototype.configure=ec.prototype.configure,$("shaka.text.WebVttGenerator",(function(){})),oc.prototype.setMediaElement=function(e){this.j=e,function(e){e.C.ma(e.j,"play",(function(){e.m||(e.m=Date.now())})),e.C.ma(e.j,"playing",(function(){e.o||(e.o=Date.now())}))}(this)},oc.prototype.configure=function(e){this.g=e};var fc="m",pc="a",gc="v",mc="av",yc="i",vc="c",bc="tt",Tc=2,Sc="d",_c="ld",wc="h",Ec="lh";function kc(e){this.h=e,this.g=null}function xc(e){return!e||"false"!==e.toLowerCase()&&(/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}$("shaka.util.CmcdManager.StreamingFormat",{DASH:Sc,Uj:_c,HLS:wc,Vj:Ec,hk:"s",OTHER:"o"}),(i=kc.prototype).configure=function(e){this.h=e},i.Ng=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(Cc)?1e3*this.g.get(Cc):null},i.Mg=function(){return this.h.enabled&&this.g&&this.g.has(Ac)?1e3*this.g.get(Ac):null},i.ri=function(){return this.h.enabled&&this.g&&this.g.has(Ic)?this.g.get(Ic):null},i.si=function(){return this.h.enabled&&this.g&&this.g.has(Lc)?this.g.get(Lc):null},i.getBandwidthEstimate=function(e){var t=this.Mg();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return 0<n&&1>=n?e*(1-n)+t*n:e},$("shaka.util.CmsdManager",kc),kc.prototype.getBandwidthEstimate=kc.prototype.getBandwidthEstimate,kc.prototype.getRoundTripTime=kc.prototype.si,kc.prototype.getResponseDelay=kc.prototype.ri,kc.prototype.getEstimatedThroughput=kc.prototype.Mg,kc.prototype.getMaxBitrate=kc.prototype.Ng;var Ac="etp",Cc="mb",Ic="rd",Lc="rtt";function Dc(){this.g=null,this.h=[]}function Rc(e,t){return M((function(n){if(1==n.g)return e.g?S(n,new Promise((function(t){return e.h.push(t)})),2):n.u(2);e.g=t,_(n)}))}function Mc(t,n,i){n=void 0===n?null:n,Yr.call(this);var r=this;this.m=Rd,this.h=null,this.pe=n,this.oa=!1,this.Be=new ee,this.wd=new ee,this.l=new ee,this.Ia=new ee,this.Db=new ee,this.G=this.I=this.C=this.F=null,this.Le=0,this.ba=new Dc,this.ja=this.Oa=this.W=this.i=this.Qa=this.H=this.j=this.dc=this.M=this.rg=this.ga=this.L=this.ud=this.O=this.pa=this.K=this.Ob=null,this.sa=!1,this.Ba=this.o=null,this.qg=1e9,this.Ed=[],this.pg=-1,this.g=ad(this),this.Oe={streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}},this.P=null,this.Ne=-1,this.Da=null,this.ia={width:1/0,height:1/0},this.ne=new ua(this.g,this.ia,null),this.te=[],this.A=null,this.$=this.g.adaptationSetCriteriaFactory(),this.$.configure({language:this.g.preferredAudioLanguage,role:this.g.preferredVariantRole,channelCount:this.g.preferredAudioChannelCount,Oc:this.g.preferredVideoHdrLevel,spatialAudio:this.g.preferSpatialAudio,videoLayout:this.g.preferredVideoLayout,Hc:this.g.preferredAudioLabel,cd:this.g.preferredVideoLabel,codecSwitchingStrategy:this.g.mediaSource.codecSwitchingStrategy,audioCodec:""}),this.Nb=this.g.preferredTextLanguage,this.Bd=this.g.preferredTextRole,this.yd=this.g.preferForcedSubs,this.xd=[],i&&i(this),this.L=function(e){return new oc({getBandwidthEstimate:function(){return e.o?e.o.getBandwidthEstimate():NaN},Fb:function(){return e.Fb()},getCurrentTime:function(){return e.h?e.h.currentTime:0},gb:function(){return e.gb()},xb:function(){return e.xb()},tc:function(){return e.tc()},T:function(){return e.T()},Wd:function(){return e.Wd()}},e.g.cmcd)}(this),this.ga=new kc(this.g.cmsd),this.F=Kc(this),this.F.cg(this.g.streaming.forceHTTP),this.F.dg(this.g.streaming.forceHTTPS),this.F.o=this.g.streaming.minBytesForProgressEvents,this.Rb=this.da=this.s=null,this.Qe=!1,this.Pe=new Ve((function(){return M((function(e){return 1==e.g?r.da?S(e,r.Jb(r.Rb,!0),3):e.u(0):4!=e.g?S(e,r.load(r.da),4):(r.Qe?r.Rb.pause():r.Rb.play(),r.da=null,r.Qe=!1,void _(e))}))})),Ud&&(this.s=Ud(),this.s.configure(this.g.ads),this.Db.D(this.s,"ad-content-pause-requested",(function(e){var t;return M((function(n){if(1==n.g)return r.Pe.stop(),r.da?n.u(0):(r.Rb=r.h,r.Qe=r.Qc(),t=e.saveLivePosition||!1,S(n,r.Fg(!0,t),3));r.da=n.h,_(n)}))})),this.Db.D(this.s,"ad-content-resume-requested",(function(e){if(e=e.offset||0,r.da){var t=r.da;t.B&&e&&(t.B+=e)}r.Pe.aa(.1)})),this.Db.D(this.s,"ad-content-attach-requested",(function(){return M((function(e){return r.h||!r.Rb?e.u(0):S(e,r.Jb(r.Rb,!0),0)}))}))),this.Be.D(e,"online",(function(){_d(r),r.Wf()})),this.qe=new Ve((function(){for(var e=Date.now()/1e3,t=!1,n=!0,i=c(r.i.variants),s=i.next();!s.done;s=i.next())0<(s=s.value).disabledUntilTime&&s.disabledUntilTime<=e&&(s.disabledUntilTime=0,t=!0),0<s.disabledUntilTime&&(n=!1);n&&r.qe.stop(),t&&fd(r,!1,void 0,!1,!1)})),this.Aa=null,t&&(oe("Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.Jb(t,!0)),this.B=null}function Pc(e){null!=e.M&&(bo(e.M),e.M.release(),e.M=null)}function Oc(e,t){return new Kr(e,t)}function Nc(e,t){Nd.set(e,t)}function Uc(e,t){e.dispatchEvent(Oc("onstatechange",(new Map).set("state",t)))}function Fc(e,t){var n;return M((function(i){return 1==i.g?(n=++e.Le,S(i,Rc(e.ba,t),2)):n!=e.Le?(e.ba.release(),i.return(!0)):i.return(!1)}))}function Bc(e,t){var n,i;return t=void 0!==t&&t,M((function(r){if(1==r.g)return n=null,e.i&&e.H&&e.Qa&&e.W?(i=e.h.currentTime,e.T()&&!t&&(i=null),S(r,$c(e,e.W,i,e.Oa,!0,!1,!1),3)):r.u(2);if(2!=r.g){n=r.h,e.te.push(n),e.H&&e.H.setMediaElement&&e.H.setMediaElement(null);var s=n,a=e.H,o=e.Qa;s.h=e.i,s.l=a,s.G=o,s=n,a=e.Ba,s.j=e.o,s.C=a,n.o=e.$,n.start(),e.i=null,e.H=null,e.Qa=null,e.o=null,e.Ba=null}return r.return(n)}))}function jc(e,t,n,i,r){var s,a,o;return r=void 0!==r&&r,M((function(l){return 1==l.g?i?l.u(2):S(l,Vc(e,t),3):(2!=l.g&&(i=l.h),function(e,t){if(!He())return!0;if(t){if(""==(e.h||ut()).canPlayType(t))return!1;if(!He()||!ba.has(t))return!0;if(Oi(t))return Je()&&(e.g.drm.servers["com.apple.fps"]||e.g.drm.servers["com.apple.fps.1_0"])?e.g.streaming.useNativeHlsForFairPlay:e.g.streaming.preferNativeHls;if("application/dash+xml"===t||"video/vnd.mpeg.dash.mpd"===t)return e.g.streaming.preferNativeDash}return!1}(e,i)?l.return(null):(s=!1,a=!0,r&&(e.o&&e.Ba==e.g.abrFactory&&(a=!1),e.h&&"AUDIO"===e.h.nodeName&&(s=!0)),o=$c(e,t,n,i||null,!r,s,a),o=r?o.then((function(e){return e.A=!1,e})):o.then((function(t){return e.te.push(t),t})),l.return(o)))}))}function $c(e,t,n,i,r,s,a){var o,l,u,d,h,f,p,g,m,y,v,b;return r=void 0===r||r,s=void 0!==s&&s,a=void 0===a||a,M((function(T){return 1==T.g?(o=null,l=It(e.g),s&&(l.manifest.disableVideo=!0),u=function(){return o.P&&o.s?null:o},d=function(){return u()?u().getConfiguration():e.g},1/0!=e.ia.width||1/0!=e.ia.height||e.g.ignoreHardwareResolution?T.u(2):S(T,ct(),3)):(2!=T.g&&(h=T.h,e.ia.width=h.width,e.ia.height=h.height),f=new ua(l,e.ia,null),p={networkingEngine:e.F,filter:function(e){var t;return M((function(n){return 1==n.g?S(n,ca(f,e),2):4!=n.g?n.h?(t=Oc("trackschanged"),S(n,Promise.resolve(),4)):n.u(0):(o.dispatchEvent(t),void _(n))}))},makeTextStreamsForClosedCaptions:function(t){return function(e,t){for(var n=new Set,i=c(t.textStreams),r=i.next();!r.done;r=i.next())"application/cea-608"!=(r=r.value).mimeType&&"application/cea-708"!=r.mimeType||n.add(r.originalId);for(i=c(t.variants),r=i.next();!r.done;r=i.next())if((r=r.value.video)&&r.closedCaptions)for(var s=c(r.closedCaptions.keys()),a=s.next();!a.done;a=s.next())if(a=a.value,!n.has(a)){var o=a.startsWith("CC")?"application/cea-608":"application/cea-708",l=new ml,u=r.closedCaptions.get(a);o={id:e.qg++,originalId:a,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:l,mimeType:o,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:u,originalLanguage:u,label:null,type:Si,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:r.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([xi(o,"")]),isAudioMuxedInVideo:!1},t.textStreams.push(o),n.add(a)}}(e,t)},onTimelineRegionAdded:function(e){var t=o.H,n=e.schemeIdUri+"_"+e.id+"_"+e.startTime.toFixed(1)+"_"+e.endTime.toFixed(1);t.h.has(n)||(t.h.set(n,e),e=new Kr("regionadd",new Map([["region",e]])),t.dispatchEvent(e),function(e){e.g||(e.g=new Ve((function(){for(var t=e.i(),n=c(e.h),i=n.next();!i.done;i=n.next()){var r=c(i.value);i=r.next().value,(r=r.next().value).endTime<t.start&&(e.h.delete(i),i=new Kr("regionremove",new Map([["region",r]])),e.dispatchEvent(i))}!e.h.size&&e.g&&(e.g.stop(),e.g=null)})).ua(2))}(t))},onEvent:function(e){return o.dispatchEvent(e)},onError:function(e){return o.onError(e)},isLowLatencyMode:function(){return d().streaming.lowLatencyMode},updateDuration:function(){e.j&&o.P&&e.j.updateDuration()},newDrmInfo:function(e){var t=o.i,n=t?t.h:null;n&&t.A&&fa(f,n.keySystem,e)},onManifestUpdated:function(){var t=(new Map).set("isLive",e.T());o.dispatchEvent(Oc("manifestupdated",t)),Du(o,!1,(function(){e.s&&e.s.onManifestUpdated(e.T())}))},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},onMetadata:function(t,n,i,r){var s=t;"com.apple.hls.interstitial"==t&&(s="com.apple.quicktime.HLS",t={startTime:n,endTime:i,values:r},e.s)&&e.s.onHLSInterstitialMetadata(e,e.h,t),t=(r=c(r)).next();for(var a={};!t.done;a={Rf:void 0},t=r.next())a.Rf=t.value,"ID"!=a.Rf.name&&Du(o,!1,function(t){return function(){zc(e,n,i,s,t.Rf)}}(a))},disableStream:function(t){return e.disableStream(t,e.g.streaming.maxDisabledTime)},addFont:function(t,n){return e.addFont(t,n)}},(g=new El((function(){return e.$a()}))).addEventListener("regionadd",(function(t){var n=t.region;Ed(e,"timelineregionadded",n,o),Du(o,!1,(function(){e.s&&(e.s.onDashTimedMetadata(n),e.s.onDASHInterstitialMetadata(e,e.h,n))}))})),m=null,l.streaming.observeQualityChanges&&((m=new Sl((function(){return e.Fb()}))).addEventListener("qualitychange",(function(t){kd(e,t.quality,t.position)})),m.addEventListener("audiotrackchange",(function(t){kd(e,t.quality,t.position,!0)}))),y=!0,v={Ub:e.F,onError:function(e){return o.onError(e)},ke:function(t){Du(o,!0,(function(){var n=t,i=Oc("keystatuschanged");e.dispatchEvent(i);var r=Object.keys(n);1==r.length&&""==r[0]&&(r=["00"],n={"00":n[""]}),i=1==r.length&&"00"==r[0];var s=!1;if(r.length){r=e.keySystem();for(var a=fs(e.g.drm.clearKeys),o=c(e.i.variants),l=o.next();!l.done;l=o.next()){var u=[];(l=l.value).audio&&u.push(l.audio),l.video&&u.push(l.video);for(var d=(u=c(u)).next();!d.done;d=u.next()){var h=d.value;if(d=l.allowedByKeySystem,h.keyIds.size)if(h.drmInfos.length&&!a.size){for(var f=(h=c(h.drmInfos)).next();!f.done;f=h.next())if((f=f.value).keyIds.size&&f.keySystem==r){l.allowedByKeySystem=!0;for(var p=(f=c(f.keyIds)).next();!p.done;p=f.next())p=p.value,((p=n[i?"00":p])||e.C.F)&&(l.allowedByKeySystem=l.allowedByKeySystem&&!!p&&!ga.includes(p))}}else for(l.allowedByKeySystem=!0,f=(h=c(h.keyIds)).next();!f.done;f=h.next())f=f.value,((f=n[i?"00":f])||e.C.F)&&(l.allowedByKeySystem=l.allowedByKeySystem&&!!f&&!ga.includes(f));d!=l.allowedByKeySystem&&(s=!0)}}}s&&(md(e),!hd(e))||(n=e.j.l)&&!n.allowedByKeySystem&&fd(e)}))},onExpirationUpdated:function(e,t){var n=Oc("expirationupdated");o.dispatchEvent(n),(n=o.l)&&n.onExpirationUpdated&&n.onExpirationUpdated(e,t)},onEvent:function(t){o.dispatchEvent(t),"drmsessionupdate"==t.type&&y&&(y=!1,t=Date.now()/1e3-o.sa,(e.A||o.getStats()).j=t,e.M&&bo(e.M))}},b=Kc(e,u),ts(e.F,b),o=new Lu(t,i,n,{config:l,Pi:p,Zi:g,Yi:m,Ic:function(){return e.Ic(v)},Oi:f,networkingEngine:b,Mh:r,Lh:a}),T.return(o))}))}function Vc(e,t){var n,i;return M((function(r){return 1==r.g?(n=e.g.manifest.retryParameters,S(r,Vu(t,e.F,n),2)):("application/x-mpegurl"==(i=r.h)&&Je()&&(i="application/vnd.apple.mpegurl"),r.return(i))}))}function Hc(e){var t=e.g.textDisplayFactory;t!==e.Je&&(e.B=t(),e.B.configure?e.B.configure(e.g.textDisplayer):oe("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.Je=t,e.B.setTextVisibility(e.oa))}function qc(e){var t,n,i;return M((function(r){if(1==r.g)return Uc(e,"media-source"),e.h.removeAttribute("src"),Na(e.h),Hc(e),t=function(e,t,n,i){return new So(e,t,n,i)}(e.h,e.B,{ii:function(){return e.keySystem()},onMetadata:function(t,n,i){for(var r=(t=c(t)).next();!r.done;r=t.next())if((r=r.value).data&&"number"==typeof r.cueTime&&r.frames){var s=r.cueTime+n,a=i;a&&s>a&&(a=s);for(var o=c(r.frames),l=o.next();!l.done;l=o.next())zc(e,s,a,"org.id3",l.value);e.s&&e.s.onHlsTimedMetadata(r,s)}},onEvent:function(t){return e.dispatchEvent(t)},Vi:function(){e.H&&e.H.update&&e.H.update()}},e.M),t.configure(e.g.mediaSource),n=e.g.manifest,i=n.segmentRelativeVttTiming,t.Ca=i,S(r,t.G,2);e.I=t,_(r)}))}function Gc(e,t,n){function i(){return ud(e)}e.l.D(t,"playing",i),e.l.D(t,"pause",i),e.l.D(t,"ended",i),e.l.D(t,"ratechange",(function(){var t=e.h.playbackRate;0!=t&&(e.K&&(e.K.set(t),e.m==Md&&e.o.playbackRateChanged(t),ld(e,t)),t=Oc("ratechange"),e.dispatchEvent(t))})),t.remote&&(e.l.D(t.remote,"connect",(function(){return md(e)})),e.l.D(t.remote,"connecting",(function(){return md(e)})),e.l.D(t.remote,"disconnect",(function(){return M((function(n){if(1==n.g)return e.j&&"disconnected"==t.remote.state?S(n,ou(e.j),2):n.u(2);md(e),_(n)}))}))),t.audioTracks&&(e.l.D(t.audioTracks,"addtrack",(function(){return md(e)})),e.l.D(t.audioTracks,"removetrack",(function(){return md(e)})),e.l.D(t.audioTracks,"change",(function(){return md(e)}))),t.textTracks&&(e.l.D(t.textTracks,"addtrack",(function(t){if(t.track)switch(t=t.track,t.kind){case"metadata":!function(e,t){if("metadata"==t.kind){t.mode="hidden",e.l.D(t,"cuechange",(function(){if(t.activeCues)for(var n=c(t.activeCues),i=n.next();!i.done;i=n.next())i=i.value,zc(e,i.startTime,i.endTime,i.type,i.value),e.s&&e.s.onCueMetadataChange(i.value);if(t.cues){n=[];for(var r=(i=c(t.cues)).next(),s={};!r.done;s={Zb:void 0},r=i.next())s.Zb=r.value,"com.apple.quicktime.HLS"==s.Zb.type&&null!=s.Zb.startTime&&(r=n.find(function(e){return function(t){return t.startTime==e.Zb.startTime&&t.endTime==e.Zb.endTime}}(s)),r||(r={startTime:s.Zb.startTime,endTime:s.Zb.endTime,values:[]},n.push(r)),r.values.push(s.Zb.value));for(i=(n=c(n)).next();!i.done;i=n.next())(i=i.value).values.some((function(e){return"X-ASSET-URI"==e.key||"X-ASSET-LIST"==e.key}))&&e.s&&(i.values.push({key:"CUE",description:"",data:0!=i.startTime||e.T()?"ONCE":"ONCE,PRE",mimeType:null,pictureType:null}),e.s.onHLSInterstitialMetadata(e,e.h,i))}}));var n=new Ve((function(){for(var t=function(e){return Array.from(e.h.textTracks).filter((function(e){return"metadata"==e.kind}))}(e),n=(t=c(t)).next();!n.done;n=t.next())n.value.mode="hidden"})).rb().aa(.5);e.xd.push((function(){n.stop()}))}}(e,t);break;case"chapters":!function(e,t){if(t&&"chapters"==t.kind){t.mode="hidden";var n=new Ve((function(){t.mode="hidden"})).rb().aa(.5);e.xd.push((function(){n.stop()}))}}(e,t);break;default:md(e)}})),e.l.D(t.textTracks,"removetrack",(function(){return md(e)})),e.l.D(t.textTracks,"change",(function(){return md(e)}))),"none"!=t.preload&&e.l.ma(t,"loadedmetadata",(function(){e.A.C=Date.now()/1e3-n}))}function zc(e,t,n,i,r){t=(new Map).set("startTime",t).set("endTime",n).set("metadataType",i).set("payload",r),e.dispatchEvent(Oc("metadata",t))}function Kc(e,t){function n(n){t()?t().dispatchEvent(n):e.dispatchEvent(n)}function i(e){t()?Du(t(),!0,e):e()}return t||(t=function(){return null}),new Zr((function(n,i,r,s){var a=t()?t().j:e.o;a&&a.segmentDownloaded(n,i,r,s)}),(function(t,r,s){n(Oc("downloadheadersreceived",r=(new Map).set("headers",t).set("request",r).set("requestType",s))),i((function(){if(e.ga){var n=e.ga;if(n.h.enabled){var i=t["cmsd-static"];if(i)try{var r=new Map,s=i.split(",");for(i=0;i<s.length;i++){var a=s[i].split("=");r.set(a[0],xc(a[1]))}}catch(d){}if(r=t["cmsd-dynamic"]){try{var o=new Map,l=r.split(";");for(r=1;r<l.length;r++){var u=l[r].split("=");o.set(u[0],xc(u[1]))}var c=o}catch(d){c=null}c&&(n.g=c)}}}}))}),(function(e,t){n(Oc("downloadcompleted",e=(new Map).set("request",e).set("response",t)))}),(function(e,t,i,r){n(Oc("downloadfailed",e=(new Map).set("request",e).set("error",t).set("httpResponseCode",i).set("aborted",r)))}),(function(t,n,r){i((function(){var i=e.L,s=r;if(s=void 0===s?{}:s,i.g.enabled)if("HEAD"===n.method)uc(i,n);else switch(t){case 0:try{if(i.g.enabled){if(s.type){e:{switch(s.type){case 4:var a=i.l?_c:Sc;break e;case 3:case 2:a=i.l?Ec:wc;break e;case 5:a="s";break e}a=void 0}i.i=a}uc(i,n,{ot:fc,su:!i.s})}}catch(C){Y("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",C)}break;case os:try{if(i.g.enabled){var o=s.segment;a=0,o&&(a=o.endTime-o.startTime);var l={d:1e3*a,st:i.h.T()?"l":"v"};l.ot=function(e){if(0===e.type)return yc;if(e=e.stream){var t=e.type;if("video"==t)return e.codecs&&e.codecs.includes(",")?mc:gc;if("audio"==t)return pc;if("text"==t)return"application/mp4"===e.mimeType?bc:vc}}(s);var u=l.ot===gc||l.ot===pc||l.ot===mc||l.ot===bc,d=s.stream;if(d){var h=i.h.gb();if(u&&(l.bl=function(e,t){if(!(t=e.h.Fb()[t]).length)return NaN;var n=e.h.getCurrentTime();return(e=t.find((function(e){return e.start<=n&&e.end>=n})))?1e3*(e.end-n):NaN}(i,d.type),l.ot!==bc)){var f=cc(i,d.type);l.dl=h?f/Math.abs(h):f}if(d.bandwidth&&(l.br=d.bandwidth/1e3),d.segmentIndex&&o){var p=d.segmentIndex.Pb(o.endTime,!0,0>h);if(p){var g=p.next().value;if(g&&g!=o){if(!Re(o.N(),g.N())){var m=g.N()[0],y=n.uris[0],v=new URL(m),b=new URL(y);if(v.origin!==b.origin)var T=m;else{for(var S=v.pathname.split("/").slice(1),_=b.pathname.split("/").slice(1,-1);S[0]===_[0];)S.shift(),_.shift();for(;_.length;)_.shift(),S.unshift("..");T=S.join("/")}l.nor=T}if((g.Na||g.wa)&&(o.Na!=g.Na||o.wa!=g.wa)){var w=g.Na+"-";g.wa&&(w+=g.wa),l.nrr=w}}}var E=i.h.gb()||1,k=cc(i,d.type)||500,x=d.bandwidth,A=x?x*(o.endTime-o.startTime)/1e3/(k/E/1e3)*i.g.rtpSafetyFactor:NaN;isNaN(A)||(l.rtp=A)}}u&&l.ot!==bc&&(l.tb=function(e,t){var n=e.h.tc();if(!n.length)return NaN;e=n[0];for(var i=(n=c(n)).next();!i.done;i=n.next())"variant"===(i=i.value).type&&i.bandwidth>e.bandwidth&&(e=i);switch(t){case gc:return e.videoBandwidth||NaN;case pc:return e.audioBandwidth||NaN;default:return e.bandwidth}}(i,l.ot)/1e3),uc(i,n,l)}}catch(C){Y("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",C)}break;case 2:case 5:case 6:uc(i,n,{ot:"k"});break;case 4:uc(i,n,{ot:"o"})}}))}),(function(n,i,r,s){(n=t()?t().l:e.H)&&n.banLocation&&n.banLocation(s)}),(function(n,i){if(i.data){i=i.data.byteLength;var r=t()?t().getStats():e.A;r&&(r.mc=isNaN(r.mc)?i:r.mc+i,0===n&&(r.Vg=i))}}))}function Wc(e,t,n){e.O=new ra,e.O.g=aa,sa(e.O,n,Math.min(.5,n/2)),od(e),e.pa=new Ve((function(){Xc(e)})),e.g.streaming.rebufferingGoal&&e.pa.ua(.25),e.l.D(t,"waiting",(function(){return Xc(e)})),e.l.D(t,"stalled",(function(){return Xc(e)})),e.l.D(t,"canplaythrough",(function(){return Xc(e)})),e.l.D(t,"progress",(function(){return Xc(e)})),e.l.D(t,"seeked",(function(){return Xc(e)}))}function Xc(e){switch(e.m){case Pd:if(e.Qc())var t=!0;else{var n=La(e.h.buffered);t=null!=n&&n>=e.h.duration-1}break;case Md:e:if(e.Qc()||ko(e.I))t=!0;else{if(e.i.presentationTimeline.T()){n=e.i.presentationTimeline.ac();var i=La(e.h.buffered);if(null!=i&&i>=n){t=!0;break e}}t=!1}break;default:t=!1}i=Ra(e.h.buffered,e.h.currentTime);var r=t,s=(n=e.O).i.get(n.g);t=n.g,i=r||i>=s&&0<i?oa:aa,n.g=i,(t=t!=i)&&i===oa&&(n.h=Date.now()),t&&od(e)}function Yc(e){if(e.ne=new ua(e.g,e.ia,e.C),e.H){var t=It(e.g.manifest);e.h&&"AUDIO"===e.h.nodeName&&(t.disableVideo=!0),e.H.configure(t)}if(e.C&&e.C.configure(e.g.drm),e.j){e.j.configure(e.g.streaming);try{e.m!=Dd&&ha(e.ne,e.i)&&md(e)}catch(r){wd(e,r)}e.o&&hd(e),!(t=e.j.l)||t.allowedByApplication&&t.allowedByKeySystem||fd(e)}if(e.F&&(e.F.cg(e.g.streaming.forceHTTP),e.F.dg(e.g.streaming.forceHTTPS),e.F.o=e.g.streaming.minBytesForProgressEvents),e.I&&(e.I.configure(e.g.mediaSource),e.I.Ca=e.g.manifest.segmentRelativeVttTiming),e.B)if(t=e.g.textDisplayFactory,e.Je!=t){var n=e.B;if(e.B=t(),e.B.configure?e.B.configure(e.g.textDisplayer):oe("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.B.setTextLanguage||oe("Text displayer w/ setTextLanguage",'Text displayer should have a "setTextLanguage" method!'),e.B.setTextVisibility(n.isTextVisible()),n.destroy(),e.I){n=e.I;var i=e.B;n.ga=i,n.h&&(n.h.j=i)}e.Je=t,e.j&&((n=(t=e.j).h.get(Si))&&Gl(t,n.stream,!0,0,!0))}else e.B.configure&&e.B.configure(e.g.textDisplayer);e.o&&(e.o.configure(e.g.abr),e.g.abr.enabled?e.o.enable():e.o.disable(),Td(e)),e.O&&(t=e.g.streaming.rebufferingGoal,sa(e.O,t,Math.min(.5,t/2))),e.pa&&(e.g.streaming.rebufferingGoal?e.pa.ua(.25):e.pa.stop()),e.i&&Ad(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.s&&e.s.configure(e.g.ads),e.L&&e.L.configure(e.g.cmcd),e.ga&&e.ga.configure(e.g.cmsd)}function Qc(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{nc:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}function Jc(e,t){var n=e.segmentIndex.find(t);if(null==n)return null;var i=Qc((n=e.segmentIndex.get(n)).tilesLayout||e.tilesLayout);if(!i)return null;var r=e.width||0;e=e.height||0;var s=r/i.nc,a=e/i.rows,o=i.nc*i.rows,l=n.j-n.startTime;l=n.A||l/o;var u=n.startTime,c=0,d=0;return 1<o&&(t=Math.floor((t-n.startTime)/l),u=n.startTime+t*l,c=t%i.nc*s,d=Math.floor(t/i.nc)*a),t=!1,(i=n.thumbnailSprite)&&(t=!0,a=i.height,c=i.positionX,d=i.positionY,s=i.width),{segment:n,imageHeight:e,imageWidth:r,height:a,positionX:c,positionY:d,startTime:u,duration:l,uris:n.N(),width:s,sprite:t}}function Zc(e,t){e.l.D(t,"cuechange",(function(){e.B.remove(0,Math.max(0,e.h.currentTime-e.g.streaming.bufferBehind));var n=Array.from(t.activeCues||[]).map(Xu).filter(Wi);e.B.append(n)})),t.mode=document.pictureInPictureElement?"showing":"hidden"}function ed(e){return Array.from(e.h.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label}))}function td(e){return Array.from(e.h.textTracks).filter((function(e){return"chapters"==e.kind}))}function nd(e,t){var n;return M((function(i){switch(i.g){case 1:return w(i,2),S(i,Vu(t,e.F,e.g.streaming.retryParameters),4);case 4:n=i.h,k(i,3);break;case 2:x(i);case 3:if(n)return i.return(n);throw new Me(1,2,2011,t)}}))}function id(e,t,n,i,r,s,a){var o,l,u,c;return M((function(d){if(1==d.g)return"text/vtt"!=r||a.length?S(d,rd(e,t,e.F,e.g.streaming.retryParameters),3):d.u(2);2!=d.g&&(o=d.h,l=sd(e,o,r,a),u=new Blob([l],{type:"text/vtt"}),t=qo(u),r="text/vtt"),c=document.createElement("track");var h=e.L,f=t;try{if(h.g.enabled){var p=lc(h);p.ot=vc,p.su=!0;var g=hc(f,dc(p))}else g=f}catch(m){Y("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",m),g=f}return c.src=g,c.label=s,c.kind=i,c.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(c),d.return(c)}))}function rd(e,t,n,i){var r,s,a;return M((function(o){if(1==o.g){r=os,(s=ns([t],i)).method="GET";var l=e.L;try{l.g.enabled&&uc(l,s,{ot:vc,su:!0})}catch(u){Y("CMCD_TEXT_ERROR","Could not generate text CMCD data.",u)}return S(o,n.request(r,s).promise,2)}return a=o.h,o.return(a.data)}))}function sd(e,t,n,i){var r=$i(n);if(r)return n=r(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=me(t),function(e,t){function n(e){for(var n=e,i=c(t),r=i.next();!r.done;r=i.next())(r=r.value).end&&r.start<e&&(n+=r.end-r.start);return(10>(e=Math.floor(n/3600))?"0":"")+e+":"+(10>(i=Math.floor(n/60%60))?"0":"")+i+":"+(10>(r=Math.floor(n%60))?"0":"")+r+"."+(100>(n=Math.floor(1e3*n%1e3))?10>n?"00":"0":"")+n}var i=zu(e);e="WEBVTT\n\n";for(var r=(i=c(i)).next();!r.done;r=i.next())e+=n((r=r.value).startTime)+" --\x3e "+n(r.endTime)+function(e){var t=[];switch(e.textAlign){case"left":t.push("align:left");break;case"right":t.push("align:right");break;case bn:t.push("align:middle");break;case"start":t.push("align:start");break;case"end":t.push("align:end")}switch(e.writingMode){case"vertical-lr":t.push("vertical:lr");break;case"vertical-rl":t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(r)+"\n",e+=r.payload+"\n\n";return e}(t=n.parseMedia(t,e,null,[]),i);throw new Me(2,2,2014,n)}function ad(e){var t=Tu();return t.streaming.failureCallback=function(t){if(e.T()){var n=null;1001==t.code||1002==t.code?(n=1,e.g.streaming.lowLatencyMode&&(n=.1)):1003==t.code&&(n=.1),null!=n&&(t.severity=1,e.Wf(n))}},t.textDisplayFactory=function(){return!e.pe||Je()&&!document.fullscreenEnabled?HTMLMediaElement.prototype.addTextTrack?new Yu(e.h,"Shaka Player TextTrack"):new Zu:new ec(e.h,e.pe)},t}function od(e){var t=e.Ef();if(e.A&&e.O&&e.G){if(0==e.g.streaming.rebufferingGoal){var n=e.K;n.j=!1,vl(n)}else(n=e.K).j=t,vl(n);if(e.L&&(n=e.L,t||n.s||(n.s=!0),n.s&&t&&(n.B=!0),n.F=t),ud(e),n=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts,e.g.streaming.liveSync.dynamicTargetLatency.enabled&&t&&e.Ne<n){n=e.g.streaming.liveSync.dynamicTargetLatency.maxLatency;var i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;e.P&&(e.P=Math.min(e.P+ ++e.Ne*r,n-i))}}t=(new Map).set("buffering",t),e.dispatchEvent(Oc("buffering",t))}function ld(e,t){e.Ia.Ma(),e.T()&&e.Ia.D(e.h,"timeupdate",(function(){var n=e.h.currentTime,i=e.$a(),r=e.g.streaming.safeSeekOffset;0<t?Math.floor(n)>=Math.floor(i.end)&&e.dd():Math.floor(n)<=Math.floor(i.start+r)&&e.dd()}))}function ud(e){if(e.A&&e.O){var t=e.A.g,n="playing";e.O.g==aa?n="buffering":e.Qc()?n="ended":e.h.paused&&(n="paused");var i=n;if(null==t.g)t.g={timestamp:Date.now()/1e3,state:i,duration:0},t=!0;else{var r=Date.now()/1e3;t.g.duration=r-t.g.timestamp,t.g.state==i?t=!1:(t.h.push(t.g),t.g={timestamp:r,state:i,duration:0},t=!0)}t&&(n=(new Map).set("newstate",n),e.dispatchEvent(Oc("statechanged",n)))}}function cd(e){var t=e.h.playbackRate,n=e.T();if(e.g.streaming.vodDynamicPlaybackRate&&!n){var i=e.g.streaming.vodDynamicPlaybackRateLowBufferRate,r=e.Kg();r<=e.g.streaming.vodDynamicPlaybackRateBufferRatio?t!=i&&e.Jd(i,!1):1==r&&t!==e.K.rc()&&e.dd()}if(n&&(n=e.$a(),Number.isFinite(n.end)&&!(e.h.currentTime<n.start||e.h.paused))){i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.enabled;var s=e.g.streaming.liveSync.dynamicTargetLatency.stabilityThreshold;if(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled)var a=e.g.streaming.liveSync.targetLatency,o=a+i,l=Math.max(0,a-i),u=e.g.streaming.liveSync.maxPlaybackRate,c=e.g.streaming.liveSync.minPlaybackRate;else e.i&&e.i.serviceDescription&&(a=e.i.serviceDescription.targetLatency,null!=e.i.serviceDescription.targetLatency?o=e.i.serviceDescription.targetLatency+i:null!=e.i.serviceDescription.maxLatency&&(o=e.i.serviceDescription.maxLatency),null!=e.i.serviceDescription.targetLatency?l=Math.max(0,e.i.serviceDescription.targetLatency-i):null!=e.i.serviceDescription.minLatency&&(l=e.i.serviceDescription.minLatency),u=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSync.maxPlaybackRate,c=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSync.minPlaybackRate);e.P||"number"!==typeof a||(e.P=a);var d=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts;r&&e.Da&&null!==e.P&&"number"===typeof a&&e.Ne<d&&Date.now()-e.Da>1e3*s&&(s=e.g.streaming.liveSync.dynamicTargetLatency.minLatency,e.P=Math.max(e.P-(a-s)/2,s+i),e.Da=Date.now()),r&&null!==e.P&&(o=e.P+i,l=e.P-i),a=n.end-e.h.currentTime,i=0,e.m==Pd&&(0<(r=e.h.buffered).length&&(i=r.end(r.length-1),i=Math.max(u,i-n.end))),n=e.g.streaming.liveSync.panicMode,r=1e3*e.g.streaming.liveSync.panicThreshold,s=Date.now()-e.O.h,n&&!c&&(c=e.g.streaming.liveSync.minPlaybackRate),n&&c&&s<=r?t!=c&&e.Jd(c,!1):void 0!=o&&u&&a-i>o?(t!=u&&e.Jd(u,!1),e.Da=null):void 0!=l&&c&&a-i<l?(t!=c&&e.Jd(c,!1),e.Da=null):t!==e.K.rc()&&(e.dd(),e.Da=Date.now())}}function dd(e){if(e.h){var t=function(t,n){var i=void 0===i?Number.EPSILON:i;if(t===n)i=!0;else{var r=Math.abs(t-n);i=r<=i||i!==Number.EPSILON&&Math.abs(r-i)<=Number.EPSILON}return!!((i||n>t)&&e.pg<t)&&(e.pg=t,!0)},n=e.$a();if(n=0<(n=n.end-n.start)?e.h.currentTime/n:0,!isNaN(n)){if(t(0,n*=100))var i=Oc("started");else t(25,n)?i=Oc("firstquartile"):t(50,n)?i=Oc("midpoint"):t(75,n)?i=Oc("thirdquartile"):(t(100,n)&&(i=Oc("complete")),e.g&&1/0!=e.g.playRangeEnd&&e.Qc()&&e.h.pause());i&&e.dispatchEvent(i)}}}function hd(e){try{pa(e.ne,e.i)}catch(n){return wd(e,n),!1}var t=kr(e.i.variants);return t=e.$.create(t),e.o.setVariants(Array.from(t.values())),!0}function fd(e,t,n,i,r){var s;t=void 0===t||t,n=void 0===n?0:n,i=void 0!==i&&i,r=void 0===r||r,(s=hd(e)?e.o.chooseVariant():null)&&pd(e,s,r,t,n,i)}function pd(e,t,n,i,r,s){s=void 0!==s&&s;var a=e.j.l;if(t==a)i&&Hl(e.j,t,i,r,!0);else{var o=e.A.h;o.h!=t&&(o.h=t,o.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),Hl(e.j,t,i,r,s,n),i=null,a&&(i=yr(a)),(t=yr(t)).active=!0,n?(n=(new Map).set("oldTrack",i).set("newTrack",t),e.M&&To(e.M,t,e.xf()),Cd(e,n=Oc("adaptation",n))):yd(e,i,t)}}function gd(e,t){var n=Array.from(e.h.audioTracks).find((function(e){return e.enabled}));t.enabled=!0,n&&(t.id!==n.id&&(n.enabled=!1),yd(e,n=_r(n),t=_r(t)))}function md(e){Cd(e,Oc("trackschanged"))}function yd(e,t,n){t=(new Map).set("oldTrack",t).set("newTrack",n),e.M&&To(e.M,n,e.xf()),Cd(e,n=Oc("variantchanged",t))}function vd(e){Cd(e,Oc("textchanged"))}function bd(e){Cd(e,Oc("texttrackvisibility"))}function Td(e){e.g.abr.enabled||_d(e),Cd(e,Oc("abrstatuschanged",(new Map).set("newStatus",e.g.abr.enabled)))}function Sd(e){var t=e.sc().find((function(e){return e.active}));t&&e.B&&e.B.setTextLanguage&&e.B.setTextLanguage(t.language)}function _d(e,t){if(t=void 0===t||t,e.m==Md){e.qe.stop();for(var n=c(e.i.variants),i=n.next();!i.done;i=n.next())i.value.disabledUntilTime=0;t&&hd(e)}}function wd(e,t){var n,i,r,s;return M((function(a){switch(a.g){case 1:if(e.m==Dd)return a.return();if(1===t.severity&&e.A.K++,n=!0,!(e.sa&&e.i&&e.j)||3016!=t.code&&3014!=t.code&&3015!=t.code&&3018!=t.code){a.u(2);break}return w(a,3),S(a,ou(e.j),5);case 5:i=a.h,n=!i,i&&(r=Oc("mediasourcerecovered"),e.dispatchEvent(r)),k(a,2);break;case 3:x(a),n=!0;case 2:if(!n)return a.return();2===t.severity&&_d(e,!1),s=Oc("error",(new Map).set("detail",t)),e.dispatchEvent(s),s.defaultPrevented&&(t.handled=!0),_(a)}}))}function Ed(e,t,n,i){i=void 0===i?e:i,e=(new Map).set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement,eventNode:n.eventNode}),i.dispatchEvent(Oc(t,e))}function kd(e,t,n,i){i=void 0!==i&&i,t=(new Map).set("mediaQuality",{bandwidth:t.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate,height:t.height,mimeType:t.mimeType,channelsCount:t.channelsCount,pixelAspectRatio:t.pixelAspectRatio,width:t.width,label:t.label,roles:t.roles,language:t.language}).set("position",n),e.dispatchEvent(Oc(i?"audiotrackchanged":"mediaqualitychanged",t))}function xd(e,t){if(t=void 0===t||t,!e.h.error)return t?new Me(2,3,3016):null;var n=e.h.error.code;return t||1!=n?((t=e.h.error.msExtendedCode)&&(0>t&&(t+=Math.pow(2,32)),t=t.toString(16)),new Me(2,3,3016,n,t,e.h.error.message)):null}function Ad(e,t,n){0<t&&(e.T()||e.th(t)),n<(t=e.getDuration())&&(e.T()||e.ab(n))}function Cd(e,t){M((function(n){if(1==n.g)return S(n,Promise.resolve(),2);e.m!=Dd&&e.dispatchEvent(t),_(n)}))}function Id(e){for(var t=new Set,n=(e=c(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(er(n.language)):t.add("und");return t}function Ld(e){for(var t=new Map,n=new Map,i=(e=c(e)).next();!i.done;i=e.next()){var r="und",s=[];(i=i.value).language&&(r=er(i.language)),(s="variant"==i.type?i.audioRoles:i.roles)&&s.length||(s=[""]),t.has(r)||t.set(r,new Set);for(var a=(s=c(s)).next();!a.done;a=s.next())a=a.value,t.get(r).add(a),i.label&&(n.has(r)||n.set(r,new Map),n.get(r).set(a,i.label))}var o=[];return t.forEach((function(e,t){for(var i=(e=c(e)).next();!i.done;i=e.next()){i=i.value;var r=null;n.has(t)&&n.get(t).has(i)&&(r=n.get(t).get(i)),o.push({language:t,role:i,label:r})}})),o}Dc.prototype.release=function(){0<this.h.length?this.h.shift()():this.g=null},y(Mc,Yr),(i=Mc.prototype).destroy=function(){var e,t=this;return M((function(n){switch(n.g){case 1:return t.m==Dd?n.return():(Pc(t),e=t.detach(),t.m=Dd,S(n,e,2));case 2:return S(n,t.cf(),3);case 3:if(t.Be&&(t.Be.release(),t.Be=null),t.wd&&(t.wd.release(),t.wd=null),t.l&&(t.l.release(),t.l=null),t.Ia&&(t.Ia.release(),t.Ia=null),t.Db&&(t.Db.release(),t.Db=null),t.Ba=null,t.g=null,t.A=null,t.pe=null,t.L=null,t.ga=null,!t.F){n.u(4);break}return S(n,t.F.destroy(),5);case 5:t.F=null;case 4:t.o&&(t.o.release(),t.o=null),Yr.prototype.release.call(t),_(n)}}))},i.Jb=function(e,t){t=void 0===t||t;var n,i,r,s=this;return M((function(a){switch(a.g){case 1:if(s.m==Dd)throw new Me(2,7,7e3);if(n=s.h&&s.h==e,!s.h||s.h==e){a.u(2);break}return S(a,s.detach(),2);case 2:return S(a,Fc(s,"attach"),4);case 4:if(a.h)return a.return();if(w(a,5,6),n||(Uc(s,"attach"),i=function(){var e=xd(s,!1);e&&wd(s,e)},s.wd.D(e,"error",i),s.h=e,s.L&&s.L.setMediaElement(e)),!t||!He()||s.I){a.u(6);break}return S(a,qc(s),6);case 6:A(a),s.ba.release(),C(a,0);break;case 5:return r=x(a),S(a,s.detach(),10);case 10:throw r}}))},i.Nh=function(e){this.rg=e},i.detach=function(e){e=void 0!==e&&e;var t=this;return M((function(n){if(1==n.g){if(t.m==Dd)throw new Me(2,7,7e3);return S(n,t.kc(!1,e),2)}if(3!=n.g)return S(n,Fc(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.wd.Ma(),t.h=null),Uc(t,"detach"),t.s&&!e&&t.s.release()}finally{t.ba.release()}_(n)}))},i.kc=function(t,n){t=void 0===t||t,n=void 0!==n&&n;var i,r,s,a,o,l,u,d,h,f,p=this;return M((function(g){switch(g.g){case 1:return p.m!=Dd&&(p.m=Rd),S(g,Fc(p,"unload"),2);case 2:return g.h?g.return():(E(g,3),p.sa=!1,Uc(p,"unload"),t&&!He()&&(t=!1),Pc(p),i=p.xd.map((function(e){return e()})),p.xd=[],S(g,Promise.all(i),5));case 5:if(p.dispatchEvent(Oc("unloading")),p.ud&&(p.ud.release(),p.ud=null),p.h&&(p.l.Ma(),p.Ia.Ma()),p.qe.stop(),p.Ob&&(p.Ob.release(),p.Ob=null),p.pa&&(p.pa.stop(),p.pa=null),!p.H){g.u(6);break}return S(g,p.H.stop(),7);case 7:p.H=null,p.Qa=null;case 6:if(!p.o){g.u(8);break}return S(g,p.o.stop(),8);case 8:if(!p.j){g.u(10);break}return S(g,p.j.destroy(),11);case 11:p.j=null;case 10:if(p.K&&(p.K.release(),p.K=null),p.G&&(p.G.release(),p.G=null),"webkit"!==e.shakaMediaKeysPolyfill||!p.C){g.u(12);break}return S(g,p.C.destroy(),13);case 13:p.C=null;case 12:if(!p.I){g.u(14);break}return S(g,p.I.destroy(),15);case 15:p.I=null;case 14:if(p.s&&!n&&p.s.onAssetUnload(),p.da&&!n&&(p.da.destroy(),p.da=null),n||p.Pe.stop(),p.L&&function(e){e.s=!1,e.F=!0,e.B=!1,e.l=!1,e.m=0,e.o=0,e.A=0,e.G=!1,e.j=null,e.C.Ma()}(p.L),p.ga&&(p.ga.g=null),!p.B){g.u(16);break}return S(g,p.B.destroy(),17);case 17:p.B=null;case 16:if(p.h&&(Na(p.h),p.h.src&&(p.h.removeAttribute("src"),p.h.load())),!p.C){g.u(18);break}return S(g,p.C.destroy(),19);case 19:p.C=null;case 18:if(p.Aa&&p.W!=p.Aa.Nc()&&(p.Aa.s||p.Aa.destroy(),p.Aa=null),p.W=null,p.Oa=null,p.O=null,p.i){for(r=c(p.i.variants),s=r.next();!s.done;s=r.next())for(a=s.value,o=c([a.audio,a.video]),l=o.next();!l.done;l=o.next())(u=l.value)&&u.segmentIndex&&u.segmentIndex.release();for(d=c(p.i.textStreams),h=d.next();!h.done;h=d.next())(f=h.value).segmentIndex&&f.segmentIndex.release()}p.g&&p.g.streaming.clearDecodingCache&&(Lr.clear(),je.clear()),p.i=null,p.A=new Iu,p.Je=null,p.Da=null,p.P=null,p.Ne=-1,p.Ed=[],p.pg=-1,p.F&&p.F.Bg(),od(p);case 3:A(g),p.ba.release(),C(g,4);break;case 4:if(t&&He()&&!p.I&&p.h)return S(g,qc(p),0);g.u(0)}}))},i.yj=function(e){this.ja=e},i.load=function(t,n,i){n=void 0===n?null:n;var r,s,a,o,l,u,d,h,f,p,g,m,y,v=this;return M((function(b){switch(b.g){case 1:if(v.m==Dd)throw new Me(2,7,7e3);if(r=null,s="",t instanceof Lu){if(t.s)throw new Me(2,7,7006);s=(r=t).Nc()||""}else s=t||"";return S(b,Rc(v.ba,"load"),2);case 2:if(v.ba.release(),!v.h)throw new Me(2,7,7002);if(!v.W){b.u(3);break}return v.W=s,S(b,v.kc(!1),3);case 3:if(a=++v.Le,o=function(){return M((function(e){if(1==e.g)return v.Le==a?e.u(0):r?S(e,r.destroy(),3):e.u(3);throw new Me(2,7,7e3)}))},l=function(e,t){return M((function(n){switch(n.g){case 1:return E(n,2),S(n,Rc(v.ba,t),4);case 4:return S(n,o(),5);case 5:return S(n,e(),6);case 6:return S(n,o(),7);case 7:r&&v.g&&(r.g=v.g);case 2:A(n),v.ba.release(),C(n,0)}}))},w(b,5,6),null==n&&r&&(n=r.getStartTime()),v.ja=n,v.sa=!1,v.dispatchEvent(Oc("loading")),r){i=r.W,b.u(8);break}if(i){b.u(8);break}return S(b,l((function(){return M((function(e){if(1==e.g)return S(e,Vc(v,s),2);i=e.h,_(e)}))}),"guessMimeType_"),8);case 8:if(u=!!r,r){Ru(r,v),v.A=r.getStats(),b.u(11);break}return S(b,jc(v,s,n,i,!0),12);case 12:(r=b.h)?(r.A=!1,Ru(r,v),v.A=r.getStats(),r.start(),r.m.catch((function(){}))):v.A=new Iu;case 11:return d=!r,h=Date.now()/1e3,v.A=r?r.getStats():new Iu,v.W=s,v.Oa=i||null,d?S(b,l((function(){return M((function(e){return S(e,function(e,t){var n,i,r,s,a;return M((function(o){return 1==o.g?(n=_i,i=Date.now()/1e3,r=!0,e.C=e.Ic({Ub:e.F,onError:function(t){wd(e,t)},ke:function(){},onExpirationUpdated:function(){var t=Oc("expirationupdated");e.dispatchEvent(t)},onEvent:function(t){e.dispatchEvent(t),"drmsessionupdate"==t.type&&r&&(r=!1,e.A.j=Date.now()/1e3-i)}}),e.C.configure(e.g.drm),s={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},(a={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:t?Mi(t):"",codecs:t?Pi(t):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.la,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1}).fullMimeTypes.add(xi(a.mimeType,a.codecs)),t.startsWith("audio/")?(a.type=n.U,s.audio=a):s.video=a,e.C.da=!0,S(o,Rs(e.C,[s],[]),2)):S(o,e.C.Jb(e.h),0)}))}(v,i),0)}))}),"initializeSrcEqualsDrmInner_"),23):S(b,l((function(){return M((function(e){if(1==e.g)return S(e,Promise.race([r.ga,r.m]),2);v.Qa=r.G;var t=r;t.ia=!0,v.H=t.l,v.i=r.wf(),_(e)}))}),"waitForFinish"),15);case 15:if(v.I){b.u(16);break}return S(b,l((function(){return M((function(e){return S(e,qc(v),0)}))}),"initializeMediaSourceEngineInner_"),16);case 16:return v.i&&v.i.textStreams.length&&(v.B.enableTextDisplayer?v.B.enableTextDisplayer():oe("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),S(b,l((function(){return M((function(e){return S(e,r.m,0)}))}),"waitForFinish"),18);case 18:if(v.g=r.getConfiguration(),v.ne=r.F,v.H&&v.H.setMediaElement&&v.h&&v.H.setMediaElement(v.h),v.ud=function(e){return e.oa=!0,e.H}(r),v.dc=r.Ba,(f=r.o)&&(v.$=f),u&&v.h&&"AUDIO"===v.h.nodeName&&(function(e){for(var t=c(e.i.variants),n=t.next();!n.done;n=t.next())(n=n.value).video&&(n.video.closeSegmentIndex(),n.video=null),n.bandwidth=n.audio&&n.audio.bandwidth?n.audio.bandwidth:0;e.i.variants=e.i.variants.filter((function(e){return e.audio}))}(v),v.configure("manifest.disableVideo",!0)),r.i){b.u(19);break}return S(b,l((function(){return M((function(e){return S(e,Ou(r,v.h),0)}))}),"drmEngine_.init"),19);case 19:return v.C=function(e){return e.da=!0,e.i}(r),S(b,l((function(){return M((function(e){return S(e,v.C.Jb(v.h),0)}))}),"drmEngine_.attach"),21);case 21:return!(p=r.C)||v.Ba&&v.Ba==p||(v.o=function(e){return e.ba=!0,e.j}(r),v.Ba=r.C,"function"!=typeof v.o.setMediaElement&&(oe("AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),v.o.setMediaElement=function(){}),"function"!=typeof v.o.setCmsdManager&&(oe("AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),v.o.setCmsdManager=function(){}),"function"!=typeof v.o.trySuggestStreams&&(oe("AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),v.o.trySuggestStreams=function(){})),g=function(e){return e.pa=!0,e.L}(r),m=r.ja,S(b,l((function(){return M((function(e){return S(e,function(e,t,n,i){var r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,w,E,k,x;return M((function(A){switch(A.g){case 1:Uc(e,"load"),r=e.h,e.K=new yl({Xd:function(){return r.playbackRate},rc:function(){return r.defaultPlaybackRate},eg:function(e){r.playbackRate=e},Zg:function(e){r.currentTime+=e}}),Gc(e,r,t),function(e,t){t.lcevc.enabled?(Pc(e),null==e.M&&(e.M=new vo(e.h,e.rg,t.lcevc),e.I&&(e.I.da=e.M))):Pc(e)}(e,e.g),e.Nb=e.g.preferredTextLanguage,e.Bd=e.g.preferredTextRole,e.yd=e.g.preferForcedSubs,Ad(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.o.init((function(t,n,i){e.i&&e.j&&t!=e.j.l&&pd(e,t,!0,void 0!==n&&n,void 0===i?0:i)})),e.o.setMediaElement(r),e.o.setCmsdManager(e.ga),e.j=function(e){return new $l(e.i,{nd:function(){return e.G?e.G.Ld():0},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},gb:function(){return e.gb()},Z:e.I,Ub:e.F,onError:function(t){return wd(e,t)},onEvent:function(t){return e.dispatchEvent(t)},le:function(t,n,i){var r=t.startTime;if(t=t.endTime,(n=n.type)!=Si){if(e.G){e.G.$g();var s=Ao(e.I,n);!e.T()&&e.h.paused&&!e.h.seeking&&null!=s&&0<s&&e.G.Ld()<s&&e.G.Se(s)}Xc(e)}i=(new Map).set("start",r).set("end",t).set("contentType",n).set("isMuxed",i),e.dispatchEvent(Oc("segmentappended",i))},Ui:function(t,n){(n=n.Tc)&&e.dc&&function(e,t,n){var i=function(e,t){var n=e.g.get(t);return n||(n={Hd:[],bf:null,contentType:t},e.g.set(t,n)),n}(e,t.contentType);!function(e,t){if((e=e.h()[t.contentType])&&0<e.length){var n=e[0].start,i=e[e.length-1].end,r=t.Hd;t.Hd=r.filter((function(e,t){return!(e.position<=n&&t+1<r.length&&r[t+1].position<=n||e.position>=i)}))}else t.Hd=[]}(e,i),e={Tc:t,position:n},0<=(t=(i=i.Hd).findIndex((function(e){return e.position>=n})))?i.splice(t,i[t].position==n?1:0,e):i.push(e)}(e.dc,n,t)},zg:function(t,n){var i=e.C;if(i.g.parseInbandPsshEnabled&&!i.F&&["audio","video"].includes(t)){t=new Is(me(n)),n=0;for(var r=c(t.data),s=r.next();!s.done;s=r.next())n+=s.value.length;if(0==n)i=Promise.resolve();else{for(n=new Uint8Array(n),r=0,s=(t=c(t.data)).next();!s.done;s=t.next())s=s.value,n.set(s,r),r+=s.length;Ns(i,"cenc",n),i=i.m}}else i=Promise.resolve();return i},disableStream:function(t,n){return e.disableStream(t,n)}})}(e),e.j.configure(e.g.streaming),e.m=Md,e.dispatchEvent(Oc("streaming")),s=n;case 2:for((o=e.j.l)||s||(s=hd(e)?e.o.chooseVariant():null),l=[],u=c([(a=o||s).video,a.audio]),d=u.next();!d.done;d=u.next())(h=d.value)&&!h.segmentIndex&&l.push(h.createSegmentIndex());if(!(0<l.length)){A.u(4);break}return S(A,Promise.all(l),4);case 4:if(!a||0!=a.disabledUntilTime){A.u(2);break}if(e.H&&e.H.onInitialVariantChosen&&e.H.onInitialVariantChosen(a),e.i.isLowLatency&&(e.g.streaming.lowLatencyMode?e.configure(e.Oe):X("Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.")),e.L&&(function(e,t){e.l=t,e.l?e.i==Sc?e.i=_c:e.i==wc&&(e.i=Ec):e.i==_c?e.i=Sc:e.i==Ec&&(e.i=wc)}(e.L,e.i.isLowLatency&&e.g.streaming.lowLatencyMode),function(e,t){if(e.g&&e.g.enabled&&e.g.version==Tc&&e.j&&e.j.autoplay){var n=e.j.play();n&&n.then((function(){e.A=t})).catch((function(){e.A=0}))}}(e.L,1e3*t)),Ad(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),function(e,t,n){e.j.presentationTimeline.T()||(e.P=t,e.O=n)}(e.j,e.g.playRangeStart,e.g.playRangeEnd),f=function(t){e.G=function(e,t){return new ll(e.h,e.i,e.g.streaming,t,(function(){e.Ob&&Tl(e.Ob,!0),e.j&&e.j.$c(),e.O&&Xc(e)}),(function(t){return e.dispatchEvent(t)}))}(e,t),e.Ob=function(e,t){t=new Uu(e.ud,e.T()||0<t),t.addEventListener("enter",(function(t){Ed(e,"timelineregionenter",t.region)})),t.addEventListener("exit",(function(t){Ed(e,"timelineregionexit",t.region)})),t.addEventListener("skip",(function(t){var n=t.region;t.seeking||(Ed(e,"timelineregionenter",n),Ed(e,"timelineregionexit",n))}));var n=new bl(e.h);return n.h.add(t),e.dc&&n.h.add(e.dc),n}(e,t),Wc(e,r,e.g.streaming.rebufferingGoal)},e.g.streaming.startAtSegmentBoundary||(null==(p=e.ja)&&e.i.startTime&&(p=e.i.startTime),f(p)),o){A.u(7);break}if(!e.g.streaming.startAtSegmentBoundary){A.u(8);break}return g=e.i.presentationTimeline,m=e.ja||e.h.currentTime,null==e.ja&&e.i.startTime&&(m=e.i.startTime),y=g.Gb(),v=g.nb(),m<y?m=y:m>v&&(m=v),S(A,function(e,t){var n,i,r,s,a;return M((function(o){return 1==o.g?(n=e.audio,i=e.video,r=function(e,t){var n,i,r;return M((function(s){return 1==s.g?e?e.segmentIndex?s.u(2):S(s,e.createSegmentIndex(),2):s.return(null):(i=(n=e.segmentIndex.Pb(t))?n.next().value:null)?(r=i.startTime,s.return(r)):s.return(null)}))},S(o,r(n,t),2)):3!=o.g?(s=o.h,S(o,r(i,t),3)):null!=(a=o.h)&&null!=s?o.return(Math.max(a,s)):null!=a?o.return(a):null!=s?o.return(s):o.return(t)}))}(s,m),9);case 9:b=A.h,f(b);case 8:pd(e,s,!0,!1,0);case 7:return e.G.ready(),e.sc().find((function(e){return e.active}))||((T=xr(e.i.textStreams,e.Nb,e.Bd,e.yd)[0]||null)&&Cu(e.A.h,T,!0),s&&(T?(function(e,t,n){if(0==e.g.autoShowText)return!1;if(1==e.g.autoShowText)return!0;var i=er(e.g.preferredTextLanguage);if(n=er(n.language),2==e.g.autoShowText)return Qi(n,i);if(3==e.g.autoShowText)return!!t&&(e=er(t.language),Qi(n,i)&&!Qi(e,n));return X("Invalid autoShowText setting!"),!1}(e,s.audio,T)&&(e.oa=!0),e.oa&&e.B.setTextVisibility(!0),bd(e)):e.oa=!1),T&&(e.g.streaming.alwaysStreamText||e.Ff())&&(ql(e.j,T),Sd(e))),S(A,e.j.start(i),10);case 10:e.g.abr.enabled&&(e.o.enable(),Td(e)),md(e),hd(e),e.i.variants.some((function(e){return e.primary})),((w=e.T())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.i.serviceDescription||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(E=function(){return cd(e)},e.l.D(r,"timeupdate",E)),w||(k=function(){return dd(e)},e.l.D(r,"timeupdate",k),dd(e),e.i.nextUrl&&(0<e.g.streaming.preloadNextUrlWindow&&(x=function(){var t;return M((function(n){if(1==n.g)return t=e.$a().end-e.h.currentTime,!isNaN(t)&&t<=e.g.streaming.preloadNextUrlWindow?(e.l.bb(r,"timeupdate",x),S(n,e.preload(e.i.nextUrl),4)):n.u(0);e.Aa=n.h,_(n)}))},e.l.D(r,"timeupdate",x)),e.l.D(r,"ended",(function(){e.load(e.Aa||e.i.nextUrl)})))),e.s&&e.s.onManifestUpdated(w),e.sa=!0,_(A)}}))}(v,h,m,g),0)}))}),"loadInner_"),22);case 22:!function(e){if(e.I)for(var t=c(e.I),n=t.next();!n.done;n=t.next())(n=n.value)();e.I=null}(r),v.Oa&&Je()&&Oi(v.Oa)&&function(t,n,i){t.g&&e.ManagedMediaSource&&t.i&&(t.C&&t.g.removeChild(t.C),t.C=Oa(n,i),t.g.appendChild(t.C),t.g.disableRemotePlayback=!1)}(v.I,v.W,v.Oa),b.u(14);break;case 23:return S(b,l((function(){return M((function(e){return S(e,function(e,t,n){var i,r,s,a,o,l,u,d,h,f,p,g;return M((function(m){switch(m.g){case 1:if(Uc(e,"src-equals"),i=e.h,e.G=new ol(i),r=!1,e.xd.push((function(){r=!0})),null!=e.ja&&e.G.Se(e.ja),e.K=new yl({Xd:function(){return i.playbackRate},rc:function(){return i.defaultPlaybackRate},eg:function(e){i.playbackRate=e},Zg:function(e){i.currentTime+=e}}),s=e.g.streaming.rebufferingGoal,Wc(e,i,s),i.textTracks&&(Hc(e),a=function(){var t=ed(e).find((function(e){return"disabled"!==e.mode}));t&&(t.mode="showing")},o=function(){var t=ed(e).find((function(e){return"disabled"!==e.mode}));t&&(t.mode="hidden")},e.l.D(i,"enterpictureinpicture",(function(){return a()})),e.l.D(i,"leavepictureinpicture",(function(){return o()})),i.remote?(e.l.D(i.remote,"connect",(function(){return o()})),e.l.D(i.remote,"connecting",(function(){return o()})),e.l.D(i.remote,"disconnect",(function(){return o()}))):"webkitCurrentPlaybackTargetIsWireless"in i&&e.l.D(i,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return o()})),(l=i).webkitSupportsFullscreen&&e.l.D(l,"webkitpresentationmodechanged",(function(){"inline"!=l.webkitPresentationMode?a():o()}))),Gc(e,i,t),u=function(e,t,n){try{if(!e.g.enabled)return t;var i=lc(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var r=pc;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":r=mc;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":r=fc;break e}r=void 0}return i.ot=r,i.su=!0,hc(t,dc(i))}catch(a){return Y("CMCD_SRC_ERROR","Could not generate src CMCD data.",a),t}}(e.L,e.W,n),!u.includes("#t=")&&(0<e.g.playRangeStart||isFinite(e.g.playRangeEnd))&&(u+="#t=",0<e.g.playRangeStart&&(u+=e.g.playRangeStart),isFinite(e.g.playRangeEnd)&&(u+=","+e.g.playRangeEnd)),!e.I){m.u(2);break}return S(m,e.I.destroy(),3);case 3:e.I=null;case 2:return Na(i),i.src=u,(Ke()||Xe())&&i.load(),"none"!=i.preload&&!i.autoplay&&Oi(n)&&Je()&&i.load(),e.m=Pd,e.dispatchEvent(Oc("streaming")),d=new jr,Jo(i,HTMLMediaElement.HAVE_METADATA,e.l,(function(){e.G.ready(),d.resolve()})),Jo(i,HTMLMediaElement.HAVE_CURRENT_DATA,e.l,(function(){var t,n,s,a,o;return M((function(l){if(1==l.g)return function(e){var t=e.g.preferredAudioLanguage;""!=t&&e.kh(t,e.g.preferredVariantRole)}(e),(t=ed(e)).find((function(e){return"disabled"!=e.mode}))?(0<t.length&&(e.oa=!0,e.B.setTextVisibility(!0)),l.u(2)):S(l,new Promise((function(t){e.l.ma(i.textTracks,"change",t),new Ve(t).aa(1)})),2);if(r)return l.return();for(ed(e).length&&(e.B.enableTextDisplayer?e.B.enableTextDisplayer():oe("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),n=!1,s=c(t),a=s.next();!a.done;a=s.next())"disabled"!==(o=a.value).mode&&(n?(o.mode="disabled",X("Found more than one enabled text track, disabling it",o)):(Zc(e,o),n=!0));!function(e){var t=e.g.preferredTextLanguage;""!=t&&e.Zf(t,e.g.preferredTextRole,e.g.preferForcedSubs)}(e),_(l)}))})),i.error?d.reject(xd(e)):"none"==i.preload&&(X('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),d.resolve()),e.l.ma(i,"error",(function(){d.reject(xd(e))})),S(m,Xi(e.g.streaming.loadTimeout,d),4);case 4:((h=e.T())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(f=function(){return cd(e)},e.l.D(i,"timeupdate",f)),h||(p=function(){return dd(e)},e.l.D(i,"timeupdate",p),dd(e)),e.s&&(e.s.onManifestUpdated(h),h&&(g=e.$a().end,e.l.D(i,"progress",(function(){var t=e.$a().end;g!=t&&(e.s.onManifestUpdated(e.T()),g=t)})))),e.sa=!0,_(m)}}))}(v,h,i),0)}))}),"srcEqualsInner_"),14);case 14:v.dispatchEvent(Oc("loaded"));case 6:if(A(b),!r){b.u(25);break}return S(b,r.destroy(),25);case 25:v.Aa=null,C(b,0);break;case 5:if(!(y=x(b))||7e3==y.code){b.u(27);break}return S(b,v.kc(!1),27);case 27:throw y}}))},i.uj=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var n,i=this;return M((function(r){return 1==r.g?S(r,Bc(i),2):3!=r.g?(n=r.h,S(r,i.kc(e,t),3)):r.return(n)}))},i.Fg=function(e,t){e=void 0!==e&&e,t=void 0!==t&&t;var n,i=this;return M((function(r){return 1==r.g?S(r,Bc(i,t),2):3!=r.g?(n=r.h,S(r,i.detach(e),3)):r.return(n)}))},i.preload=function(e,t,n){t=void 0===t?null:t;var i,r=this;return M((function(s){return 1==s.g?S(s,jc(r,e,t,n),2):((i=s.h)?i.start():wd(r,new Me(2,7,7005)),s.return(i))}))},i.cf=function(){var e,t,n,i,r=this;return M((function(s){for(e=[],t=c(r.te),n=t.next();!n.done;n=t.next())(i=n.value).s||e.push(i.destroy());return r.te=[],S(s,Promise.all(e),0)}))},i.cj=function(){for(var e=this.ba;e.g;)e.release()},i.Ic=function(e){return new Ds(e)},i.configure=function(e,t){if(2==arguments.length&&"string"==typeof e&&(e=cu(e,t)),e.streaming&&"forceTransmuxTS"in e.streaming&&(oe("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(oe("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming&&(oe("streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead."),e.streaming.preferNativeHls=e.streaming.useNativeHlsOnSafari&&Je(),delete e.streaming.useNativeHlsOnSafari),e.streaming&&"boolean"==typeof e.streaming.liveSync){oe("streaming.liveSync","Please Use streaming.liveSync.enabled instead.");var n=e.streaming.liveSync;e.streaming.liveSync={},e.streaming.liveSync.enabled=n}if(e.streaming&&(!e.streaming.liveSync||!("targetLatency"in e.streaming.liveSync))&&("liveSyncMinLatency"in e.streaming||"liveSyncMaxLatency"in e.streaming)){n=e.streaming.liveSyncMinLatency||0;var i=Math.abs((e.streaming.liveSyncMaxLatency||1)-n)/2;e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=n+i,e.streaming.liveSync.targetLatencyTolerance=i}if(e.streaming&&"liveSyncMaxLatency"in e.streaming&&(oe("streaming.liveSyncMaxLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMaxLatency),e.streaming&&"liveSyncMinLatency"in e.streaming&&(oe("streaming.liveSyncMinLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMinLatency),e.streaming&&"liveSyncTargetLatency"in e.streaming&&(oe("streaming.liveSyncTargetLatency","Please Use streaming.liveSync.targetLatency instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=e.streaming.liveSyncTargetLatency,delete e.streaming.liveSyncTargetLatency),e.streaming&&"liveSyncTargetLatencyTolerance"in e.streaming&&(oe("streaming.liveSyncTargetLatencyTolerance","Please Use streaming.liveSync.targetLatencyTolerance instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatencyTolerance=e.streaming.liveSyncTargetLatencyTolerance,delete e.streaming.liveSyncTargetLatencyTolerance),e.streaming&&"liveSyncPlaybackRate"in e.streaming&&(oe("streaming.liveSyncPlaybackRate","Please Use streaming.liveSync.maxPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.maxPlaybackRate=e.streaming.liveSyncPlaybackRate,delete e.streaming.liveSyncPlaybackRate),e.streaming&&"liveSyncMinPlaybackRate"in e.streaming&&(oe("streaming.liveSyncMinPlaybackRate","Please Use streaming.liveSync.minPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.minPlaybackRate=e.streaming.liveSyncMinPlaybackRate,delete e.streaming.liveSyncMinPlaybackRate),e.streaming&&"liveSyncPanicMode"in e.streaming&&(oe("streaming.liveSyncPanicMode","Please Use streaming.liveSync.panicMode instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicMode=e.streaming.liveSyncPanicMode,delete e.streaming.liveSyncPanicMode),e.streaming&&"liveSyncPanicThreshold"in e.streaming&&(oe("streaming.liveSyncPanicThreshold","Please Use streaming.liveSync.panicThreshold instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicThreshold=e.streaming.liveSyncPanicThreshold,delete e.streaming.liveSyncPanicThreshold),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){oe("mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var r=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return r},delete e.mediaSource.sourceBufferExtraFeatures}if(e.manifest&&e.manifest.hls&&"useSafariBehaviorForLive"in e.manifest.hls&&(oe("manifest.hls.useSafariBehaviorForLive configuration","Please Use liveSync config to keep on live Edge instead."),delete e.manifest.hls.useSafariBehaviorForLive),e.streaming&&"parsePrftBox"in e.streaming&&(oe("streaming.parsePrftBox configuration","Now fired without needing a configuration."),delete e.streaming.parsePrftBox),e.manifest&&e.manifest.dash&&"enableAudioGroups"in e.manifest.dash&&(oe("manifest.dash.enableAudioGroups configuration","It is now enabled by default and cannot be disabled."),delete e.manifest.dash.enableAudioGroups),e.streaming&&"dispatchAllEmsgBoxes"in e.streaming&&(oe("streaming.dispatchAllEmsgBoxes configuration","Please Use mediaSource.dispatchAllEmsgBoxes instead."),e.mediaSource.dispatchAllEmsgBoxes=e.streaming.dispatchAllEmsgBoxes,delete e.streaming.dispatchAllEmsgBoxes),e.streaming&&"autoLowLatencyMode"in e.streaming&&(oe("streaming.autoLowLatencyMode configuration","Please Use streaming.lowLatencyMode instead."),e.streaming.lowLatencyMode=e.streaming.autoLowLatencyMode,delete e.streaming.autoLowLatencyMode),e.drm&&e.drm.advanced){for(var s in n=!1,e.drm.advanced){var a=e.drm.advanced[s];i=a.videoRobustness,a=a.audioRobustness,"videoRobustness"in e.drm.advanced[s]&&!Array.isArray(e.drm.advanced[s].videoRobustness)&&(e.drm.advanced[s].videoRobustness=[i],n=!0),"audioRobustness"in e.drm.advanced[s]&&!Array.isArray(e.drm.advanced[s].audioRobustness)&&(e.drm.advanced[s].audioRobustness=[a],n=!0)}n&&oe("AdvancedDrmConfiguration's videoRobustness and audioRobustness","These properties are no longer strings but array of strings, please update your usage of these properties.")}return s=_u(this.g,e,ad(this)),Yc(this),s},i.Uh=function(e){this.Oe=e},i.getConfiguration=function(){var e=ad(this);return _u(e,this.g,ad(this)),e},i.bi=function(){return this.Oe},i.Og=function(){return _u(ad(this),this.g,ad(this)),hu(this.g,ad(this))},i.Kg=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(e>=(t=Math.min(this.h.currentTime+t,this.$a().end)))return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},i.gj=function(){for(var e in this.g)delete this.g[e];_u(this.g,ad(this),ad(this)),Yc(this)},i.ji=function(){return this.m},i.xf=function(){return this.i?this.i.type:null},i.ni=function(){return this.h},i.xb=function(){return this.F},i.Nc=function(){return this.W},i.Jg=function(){return this.s?this.s:null},i.T=function(){return this.i&&!this.Ka()?this.i.presentationTimeline.T():!(!this.h||!this.h.src)&&1/0==this.h.duration},i.wc=function(){return!!this.i&&this.i.presentationTimeline.wc()},i.Fi=function(){if(this.i&&!this.Ka()){var e=this.i.variants;return!!e.length&&!e[0].video}return!(!this.h||!this.h.src)&&(this.h.videoTracks?0==this.h.videoTracks.length:0==this.h.videoHeight)},i.$a=function(){if(this.i&&!this.Ka()){if(!this.sa&&"HLS"==this.i.type)return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.Gb(),end:e.nb()}}if(this.h&&this.h.src&&(e=this.h.seekable)&&e.length){var t=this.g?this.g.playRangeStart:0;t=Math.max(e.start(0),t);var n=this.g?this.g.playRangeEnd:1/0;return{start:t,end:e=Math.min(e.end(e.length-1),n)}}return{start:0,end:0}},i.Ci=function(){this.T()&&(this.h.currentTime=this.$a().end)},i.Gi=function(){return this.sa},i.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},i.drmInfo=function(){return this.C?this.C.h:null},i.md=function(){return this.C?this.C.md():1/0},i.vf=function(){return this.C?this.C.vf():[]},i.Vd=function(){return this.C?this.C.Vd():{}},i.Ef=function(){return!!this.O&&this.O.g==aa},i.gb=function(){return this.h?this.K?this.K.i:1:0},i.Jd=function(e,t){t=void 0===t||t,0==e?X("A trick play rate of 0 is unsupported!"):(this.K.set(e),this.m==Md&&(this.o.playbackRateChanged(e),Vl(this.j,t&&1<Math.abs(e))),ld(this,e))},i.dd=function(){var e=this.K.rc();this.m==Pd&&this.K.set(e),this.m==Md&&(this.K.set(e),this.o.playbackRateChanged(e),Vl(this.j,!1)),this.Ia.Ma()},i.tc=function(){if(this.i&&!this.Ka()){for(var e=this.j?this.j.l:null,t=[],n=0,i=c(this.i.variants),r=i.next();!r.done;r=i.next())if(Er(r=r.value)){var s=yr(r);s.active=r==e,s.active||1==n||null==e||r.video!=e.video||r.audio!=e.audio||(s.active=!0),s.active&&n++,t.push(s)}return t}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map((function(e){return _r(e)})):[]},i.sc=function(){if(this.i&&!this.Ka()){for(var e=this.j?this.j.s:null,t=[],n=c(this.i.textStreams),i=n.next();!i.done;i=n.next()){var r=vr(i=i.value);r.active=i==e,t.push(r)}return t}return this.h&&this.h.src&&this.h.textTracks?ed(this).map((function(e){return Sr(e)})):[]},i.gi=function(){var e=this.Ed;return this.i&&(e=this.i.imageStreams),e.map((function(e){return br(e)}))},i.Xh=function(e){var t,n,i,r=this;return M((function(s){return 1==s.g?r.m!=Md&&r.m!=Pd?s.return(null):(t=r.Ed,r.i&&(t=r.i.imageStreams),(n=t.find((function(t){return t.id==e})))?n.segmentIndex?s.u(2):S(s,n.createSegmentIndex(),2):s.return(null)):(i=[],n.segmentIndex.Eb((function(e){var t=Qc(e.tilesLayout||n.tilesLayout);if(t){t=t.rows*t.nc;for(var r=e.j-e.startTime,s=0;s<t;s++){var a=Jc(n,e.startTime+r*s/t);a&&i.push(a)}}})),n.closeSegmentIndex&&n.closeSegmentIndex(),s.return(i))}))},i.wi=function(e,t){var n,i,r=this;return M((function(s){return 1==s.g?r.m!=Md&&r.m!=Pd?s.return(null):(n=r.Ed,r.i&&(n=r.i.imageStreams),(i=n.find((function(t){return t.id==e})))?i.segmentIndex?s.u(2):S(s,i.createSegmentIndex(),2):s.return(null)):s.return(Jc(i,t))}))},i.lh=function(e){var t=this;this.i&&this.G&&(function(){var n=t.i.textStreams.find((function(t){return t.id==e.id}));n&&n!=t.j.s&&(Cu(t.A.h,n,!1),ql(t.j,n),vd(t),Sd(t),t.Nb=n.language)}(),!this.Ka())||function(){if(t.h&&t.h.textTracks){var n=ed(t),i=n.find((function(e){return"disabled"!==e.mode}));(n=n.find((function(t){return Tr(t)===e.id})))&&(i!==n&&(i&&(i.mode="disabled",t.l.bb(i,"cuechange"),t.B.remove(0,1/0)),n&&Zc(t,n)),vd(t),Sd(t))}}()},i.$f=function(e,t,n){var i=this;t=void 0!==t&&t,n=void 0===n?0:n,this.i&&this.G&&(function(){var r=i.i.variants.find((function(t){return t.id==e.id}));if(r&&Er(r)){var s=i.j.l;i.g.abr.enabled&&(s.video!=r.video||s.audio&&r.audio&&s.audio.language==r.audio.language&&s.audio.channelsCount==r.audio.channelsCount&&s.audio.label==r.audio.label)&&X("Changing tracks while abr manager is enabled will likely result in the selected track being overridden. Consider disabling abr before calling selectVariantTrack()."),i.Ka()?pd(i,r,!1,!1,0):pd(i,r,!1,t||!1,n||0),i.$=new la(r,i.g.mediaSource.codecSwitchingStrategy,i.g.adaptationSetCriteriaFactory),hd(i)}}(),!this.Ka())||function(){if(i.h&&i.h.audioTracks)for(var t=Array.from(i.h.audioTracks),n=(t=c(t)).next();!n.done;n=t.next())if(Tr(n=n.value)==e.id){gd(i,n);break}}()},i.Zh=function(){return Ld(this.tc())},i.ui=function(){return Ld(this.sc())},i.Yh=function(){return Array.from(Id(this.tc()))},i.ti=function(){return Array.from(Id(this.sc()))},i.kh=function(e,t,n,i,r,s,a){var o=this;n=void 0===n?0:n,i=void 0===i?0:i,r=void 0===r?"":r,s=void 0!==s&&s,a=void 0===a?"":a,this.i&&this.G&&(function(){function l(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0}o.$=o.g.adaptationSetCriteriaFactory(),o.$.configure({language:e,role:t||"",channelCount:n||0,Oc:"",spatialAudio:s||!1,videoLayout:"",Hc:a||"",cd:"",codecSwitchingStrategy:o.g.mediaSource.codecSwitchingStrategy,audioCodec:r||""});for(var u=o.j.l,d=o.$.create(o.i.variants),h=null,f=(d=c(d.values())).next();!f.done;f=d.next())Er(f=f.value)&&(!h||l(h,u)>l(f,u))&&(h=f);h!=u&&(h?(u=yr(h),o.$f(u,!0,i||0)):fd(o))}(),!this.Ka())||function(){if(o.h&&o.h.audioTracks){var n=xr(o.tc(),e,t||"",!1)[0];n&&o.$f(n)}}()},i.Zf=function(e,t,n){var i=this;n=void 0!==n&&n,this.i&&this.G&&(function(){i.Nb=e,i.Bd=t||"",i.yd=n||!1;var r=xr(i.i.textStreams,i.Nb,i.Bd,i.yd)[0]||null;r&&r!=i.j.s&&(Cu(i.A.h,r,!1),i.g.streaming.alwaysStreamText||i.Ff())&&(ql(i.j,r),vd(i),Sd(i))}(),!this.Ka())||function(){var r=xr(i.sc(),e,t||"",n||!1)[0];r&&i.lh(r)}()},i.lj=function(e,t,n){var i=this;t=void 0===t||t,n=void 0===n?0:n,this.i&&this.G&&(function(){for(var r=null,s=c(i.i.variants),a=s.next();!a.done;a=s.next())if((a=a.value).audio.label==e){r=a;break}null!=r&&(i.$=i.g.adaptationSetCriteriaFactory(),i.$.configure({language:r.language,role:"",channelCount:0,Oc:"",spatialAudio:!1,videoLayout:"",cd:"",Hc:e,codecSwitchingStrategy:i.g.mediaSource.codecSwitchingStrategy,audioCodec:""}),fd(i,t,n))}(),!this.Ka())||function(){if(i.h&&i.h.audioTracks){for(var t=Array.from(i.h.audioTracks),n=null,r=(t=c(t)).next();!r.done;r=t.next())(r=r.value).label==e&&(n=r);n&&gd(i,n)}}()},i.Ff=function(){var e=this.oa;return this.B?this.B.isTextVisible():e},i.Lg=function(){return this.h&&this.h.currentSrc&&this.h.textTracks?td(this).map((function(e){return Sr(e)})):[]},i.ai=function(e){if(!this.h||!this.h.currentSrc||!this.h.textTracks)return[];var t=er(e),n=td(this).filter((function(e){return er(e.language)==t}));if(!n||!n.length)return[];e=[];for(var i=new Set,r=(n=c(n)).next();!r.done;r=n.next())if((r=r.value)&&r.cues)for(var s=(r=c(r.cues)).next();!s.done;s=r.next()){var a=s.value;(s=a.id)&&""!=s||(s=a.startTime+"-"+a.endTime+"-"+a.text),a={id:s,title:a.text,startTime:a.startTime,endTime:a.endTime},i.has(s)||(e.push(a),i.add(s))}return e},i.rh=function(e){e=!!e,this.oa!=e&&(this.oa=e,this.m==Md?(this.B.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.j.s||0<(e=xr(this.i.textStreams,this.Nb,this.Bd,this.yd)).length&&(ql(this.j,e[0]),vd(this),Sd(this)):function(e){var t=e.h.get(Si);t&&(ru(t),su(t).catch((function(){})),e.F=e.h.get(Si),e.h.delete(Si)),e.s=null}(this.j))):this.h&&this.h.src&&this.h.textTracks&&this.B.setTextVisibility(e),bd(this))},i.oi=function(){if(this.G)var e=this.G.Ld();else{if(null==this.ja)return new Date;e=this.ja}if(this.i&&!this.Ka()){var t=this.i.presentationTimeline;return new Date(1e3*((t.m||t.i)+e))}return this.h&&this.h.getStartDate?(t=this.h.getStartDate(),isNaN(t.getTime())?null:new Date(t.getTime()+1e3*e)):null},i.Pg=function(){if(this.i&&!this.Ka()){var e=this.i.presentationTimeline;return new Date(1e3*(e.m||e.i))}return this.h&&this.h.getStartDate?(e=this.h.getStartDate(),isNaN(e.getTime())?null:e):null},i.Yd=function(){return this.T()&&this.i?this.i.presentationTimeline.Yd():null},i.Fb=function(){if(this.m==Md)return this.I.Fb();var e={total:[],audio:[],video:[],text:[]};return this.m==Pd&&(e.total=Ma(this.h.buffered)),e},i.Wd=function(){if(!this.h||!this.h.currentTime)return null;var e=this.Pg().getTime()+1e3*this.h.currentTime;return Math.floor(Date.now()-e)},i.getStats=function(){if(this.m!=Md&&this.m!=Pd)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,manifestSizeBytes:NaN,bytesDownloaded:NaN,nonFatalErrorCount:NaN,manifestPeriodCount:NaN,manifestGapCount:NaN,switchHistory:[],stateHistory:[]};ud(this);var e=this.h,t=e.currentTime/e.duration;if(!isNaN(t)&&!this.T()){var n=this.A;t=Math.round(100*t),n.i=isNaN(n.i)?t:Math.max(n.i,t)}if(this.G&&(this.A.P=this.G.sg(),this.A.W=this.G.tg()),e.getVideoPlaybackQuality){n=e.getVideoPlaybackQuality(),t=this.A;var i=Number(n.totalVideoFrames);t.O=Number(n.droppedVideoFrames),t.M=i,this.A.L=Number(n.corruptedVideoFrames)}if(this.C?n=(n=this.C).H?n.H:NaN:n=NaN,this.A.o=n,this.m==Md){if(n=this.j.l,t=this.j.s,n){var r=(i=this.K?this.K.i:1)*n.bandwidth;t&&t.bandwidth&&(r+=i*t.bandwidth),this.A.A=r}n&&n.video&&(t=this.A,i=n.video.height||NaN,t.m=n.video.width||NaN,t.l=i),this.T()&&(n=this.Wd()||0,this.A.B=n/1e3),this.i&&(this.A.G=this.i.periodCount,this.A.F=this.i.gapCount,this.i.presentationTimeline&&(this.A.I=this.i.presentationTimeline.h)),n=this.o.getBandwidthEstimate(),this.A.s=n}this.m==Pd&&((n=this.A).mc=isNaN(n.mc)?NaN:n.mc+NaN,n=this.A,t=e.videoHeight||NaN,n.m=e.videoWidth||NaN,n.l=t);var s=this.A;e=s.m,n=s.l,t=s.A,i=s.M,r=s.O;for(var a=s.L,o=s.W,l=s.P,u=s.s,d=s.i,h=s.C,f=s.H,p=s.j,g=xu(s.g,"playing"),m=xu(s.g,"paused"),y=xu(s.g,"buffering"),v=s.o,b=s.B,T=s.I,S=s.Vg,_=s.mc,w=s.K,E=s.G,k=s.F,x=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=c(e.h),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.g&&n.push(t(e.g)),n}(s.g),A=[],C=(s=c(s.h.g)).next();!C.done;C=s.next())C=C.value,A.push({timestamp:C.timestamp,id:C.id,type:C.type,fromAdaptation:C.fromAdaptation,bandwidth:C.bandwidth});return{width:e,height:n,streamBandwidth:t,decodedFrames:i,droppedFrames:r,corruptedFrames:a,stallsDetected:o,gapsJumped:l,estimatedBandwidth:u,completionPercent:d,loadLatency:h,manifestTimeSeconds:f,drmTimeSeconds:p,playTime:g,pauseTime:m,bufferingTime:y,licenseTime:v,liveLatency:b,maxSegmentDuration:T,manifestSizeBytes:S,bytesDownloaded:_,nonFatalErrorCount:w,manifestPeriodCount:E,manifestGapCount:k,stateHistory:x,switchHistory:A}},i.Jh=function(e,t,n,i,r,s,a){a=void 0!==a&&a;var o,l,u,c,d,h,f,p,g,m,y,v,b=this;return M((function(T){switch(T.g){case 1:if(b.m!=Md&&b.m!=Pd)throw new Me(1,7,7004);if("subtitles"!=n&&"captions"!=n&&X("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),i){T.u(2);break}return S(T,nd(b,e),3);case 3:i=T.h;case 2:if(o=[],b.s&&(o=b.s.getCuePoints()),b.m!=Pd){T.u(4);break}return a&&(n="forced"),S(T,id(b,e,t,n,i,s||"",o),5);case 5:if(l=er(t),u=b.sc(),c=u.find((function(e){return er(e.language)==l&&e.label==(s||"")&&e.kind==n})))return md(b),T.return(c);throw new Me(1,2,2012);case 4:if(d=_i,h=b.$a(),f=h.end-h.start,b.i&&(f=b.i.presentationTimeline.getDuration()),1/0==f)throw new Me(1,4,4033);if(!o.length){T.u(6);break}return S(T,rd(b,e,b.F,b.g.streaming.retryParameters),7);case 7:p=T.h,g=sd(b,p,i,o),m=new Blob([g],{type:"text/vtt"}),e=qo(m),i="text/vtt";case 6:if(y={id:b.qg++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:pl(0,f,[e]),mimeType:i||"",codecs:r||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:s||null,type:d.xa,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!a,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([xi(i||"",r||"")]),isAudioMuxedInVideo:!1},v=xi(y.mimeType,y.codecs),!Vi(v))throw new Me(2,2,2014,i);return b.i.textStreams.push(y),md(b),T.return(vr(y))}}))},i.Kh=function(e,t){var n,i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,_=this;return M((function(w){switch(w.g){case 1:if(_.m!=Md&&_.m!=Pd)throw new Me(1,7,7004);if(t){w.u(2);break}return S(w,nd(_,e),3);case 3:t=w.h;case 2:if("text/vtt"!=t)throw new Me(1,2,2017,e);if(n=_i,i=_.$a(),r=i.end-i.start,_.i&&(r=_.i.presentationTimeline.getDuration()),1/0==r)throw new Me(1,4,4045);return S(w,rd(_,e,_.F,_.g.streaming.retryParameters),4);case 4:if(s=w.h,!(a=$i(t)))throw new Me(2,2,2014,t);for(o=a(),l={periodStart:0,segmentStart:0,segmentEnd:r,vttOffset:0},u=me(s),d=o.parseMedia(u,l,e,[]),h=[],f=c(d),p=f.next(),g={};!p.done;g={Ie:void 0,Jc:void 0},p=f.next())g.Jc=p.value,g.Ie=null,m=function(t){return function(){return null==t.Ie&&(t.Ie=gi([e],[t.Jc.payload])),t.Ie||[]}}(g),y=new ka(g.Jc.startTime,g.Jc.endTime,m,0,null,null,0,0,1/0),g.Jc.payload.includes("#xywh")&&(4===(v=g.Jc.payload.split("#xywh=")[1].split(",")).length&&y.ye({height:parseInt(v[3],10),positionX:parseInt(v[0],10),positionY:parseInt(v[1],10),width:parseInt(v[2],10)})),h.push(y);if(b=t,!h.length){w.u(5);break}return S(w,Vu(h[0].N()[0],_.F,_.g.manifest.retryParameters),6);case 6:b=w.h;case 5:return T={id:_.qg++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new hl(h),mimeType:b||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.Re,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([xi(b||"","")]),isAudioMuxedInVideo:!1},_.m==Pd?_.Ed.push(T):_.i.imageStreams.push(T),md(_),w.return(br(T))}}))},i.Ih=function(e,t,n){var i,r,s,a,o=this;return M((function(l){switch(l.g){case 1:if(o.m!=Md&&o.m!=Pd)throw new Me(1,7,7004);if(n){l.u(2);break}return S(l,nd(o,e),3);case 3:n=l.h;case 2:return i=[],o.s&&(i=o.s.getCuePoints()),S(l,id(o,e,t,"chapters",n,"",i),4);case 4:if(r=l.h,s=o.Lg(),!(a=s.find((function(e){return e.language==t})))){l.u(5);break}return S(l,new Promise((function(e,t){o.l.ma(r,"load",e),o.l.ma(r,"error",(function(){t(new Me(1,2,2015))}))})),6);case 6:return md(o),l.return(a);case 5:throw new Me(1,2,2012)}}))},i.qj=function(e,t){this.ia.width=e,this.ia.height=t},i.Wf=function(e){if(this.m==Md){var t=this.j;if(e=void 0===e?.1:e,t.m.g)t=!1;else if(t.B)t=!1;else{for(var n=c(t.h.values()),i=n.next();!i.done;i=n.next())!(i=i.value).qd||i.Ga||i.kb||(i.qd=!1,iu(t,i,e));t=!0}}else t=!1;return t},i.wf=function(){return X("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},i.ki=function(){return this.Qa},i.ei=function(){var e={video:null,audio:null,text:null};if(this.m!=Md)return e;for(var t=this.j.l,n=this.h.currentTime,i=(t=c([t.video,t.audio,this.j.s])).next();!i.done;i=t.next())if((i=i.value)&&i.segmentIndex){var r=i.segmentIndex.find(n);r={codecs:(r=i.segmentIndex.get(r)).codecs||i.codecs,mimeType:r.mimeType||i.mimeType,bandwidth:r.bandwidth||i.bandwidth},"video"==i.type?(r.width=i.width,r.height=i.height,e.video=r):"audio"==i.type?e.audio=r:i.type==Si&&(e.text=r)}return e},i.uh=function(e){this.pe=e},i.disableStream=function(e,t){if(!this.g.abr.enabled||this.m===Dd||!navigator.onLine||0==t||!this.i)return!1;if(this.i.variants.some((function(t){var n=t[e.type];return!(!n||n.id===e.id||t.disabledUntilTime)&&("audio"!=e.type||e.language===n.language)}))){for(var n=!1,i=!1,r=c(this.i.variants),s=r.next();!s.done;s=r.next()){var a=(s=s.value)[e.type];a&&(a.id===e.id?(s.disabledUntilTime=Date.now()/1e3+t,n=!0):a.trickModeVideo&&a.trickModeVideo.id==e.id&&(i=!0))}return!(!n&&i)&&(this.qe.ua(1),t=this.Fb().video.reduce((function(e,t){return e+t.end-t.start}),0),fd(this,!1,t,!0,!1),!0)}return!1},i.addFont=function(t,n){var i,r,s,a,o;return M((function(l){if(1==l.g)return"fonts"in document&&"FontFace"in e?S(l,document.fonts.ready,3):l.u(0);if(!("entries"in document.fonts))return l.return();for(i=function(e){for(var t=[],n=(e=e.entries()).next();!1===n.done;)t.push(n.value),n=e.next();return t},r=c(i(document.fonts)),s=r.next();!s.done;s=r.next())if((a=s.value).family==t&&"swap"==a.display)return l.return();o=new FontFace(t,"url("+n+")",{display:"swap"}),document.fonts.add(o),_(l)}))},i.Ka=function(){return!(!this.h||!this.h.remote)&&"disconnected"!=this.h.remote.state},i.Qc=function(){return!(this.h&&!this.h.ended)||this.sa&&!this.T()&&this.h.currentTime>=this.$a().end},$("shaka.Player",Mc),Mc.prototype.isEnded=Mc.prototype.Qc,Mc.prototype.isRemotePlayback=Mc.prototype.Ka,Mc.prototype.addFont=Mc.prototype.addFont,Mc.prototype.setVideoContainer=Mc.prototype.uh,Mc.prototype.getFetchedPlaybackInfo=Mc.prototype.ei,Mc.prototype.getManifestParserFactory=Mc.prototype.ki,Mc.prototype.getManifest=Mc.prototype.wf,Mc.prototype.retryStreaming=Mc.prototype.Wf,Mc.prototype.setMaxHardwareResolution=Mc.prototype.qj,Mc.prototype.addChaptersTrack=Mc.prototype.Ih,Mc.prototype.addThumbnailsTrack=Mc.prototype.Kh,Mc.prototype.addTextTrackAsync=Mc.prototype.Jh,Mc.prototype.getStats=Mc.prototype.getStats,Mc.prototype.getBufferedInfo=Mc.prototype.Fb,Mc.prototype.getSegmentAvailabilityDuration=Mc.prototype.Yd,Mc.prototype.getPresentationStartTimeAsDate=Mc.prototype.Pg,Mc.prototype.getPlayheadTimeAsDate=Mc.prototype.oi,Mc.prototype.setTextTrackVisibility=Mc.prototype.rh,Mc.prototype.getChapters=Mc.prototype.ai,Mc.prototype.getChaptersTracks=Mc.prototype.Lg,Mc.prototype.isTextTrackVisible=Mc.prototype.Ff,Mc.prototype.selectVariantsByLabel=Mc.prototype.lj,Mc.prototype.selectTextLanguage=Mc.prototype.Zf,Mc.prototype.selectAudioLanguage=Mc.prototype.kh,Mc.prototype.getTextLanguages=Mc.prototype.ti,Mc.prototype.getAudioLanguages=Mc.prototype.Yh,Mc.prototype.getTextLanguagesAndRoles=Mc.prototype.ui,Mc.prototype.getAudioLanguagesAndRoles=Mc.prototype.Zh,Mc.prototype.selectVariantTrack=Mc.prototype.$f,Mc.prototype.selectTextTrack=Mc.prototype.lh,Mc.prototype.getThumbnails=Mc.prototype.wi,Mc.prototype.getAllThumbnails=Mc.prototype.Xh,Mc.prototype.getImageTracks=Mc.prototype.gi,Mc.prototype.getTextTracks=Mc.prototype.sc,Mc.prototype.getVariantTracks=Mc.prototype.tc,Mc.prototype.cancelTrickPlay=Mc.prototype.dd,Mc.prototype.trickPlay=Mc.prototype.Jd,Mc.prototype.getPlaybackRate=Mc.prototype.gb,Mc.prototype.isBuffering=Mc.prototype.Ef,Mc.prototype.getKeyStatuses=Mc.prototype.Vd,Mc.prototype.getActiveSessionsMetadata=Mc.prototype.vf,Mc.prototype.getExpiration=Mc.prototype.md,Mc.prototype.drmInfo=Mc.prototype.drmInfo,Mc.prototype.keySystem=Mc.prototype.keySystem,Mc.prototype.isFullyLoaded=Mc.prototype.Gi,Mc.prototype.goToLive=Mc.prototype.Ci,Mc.prototype.seekRange=Mc.prototype.$a,Mc.prototype.isAudioOnly=Mc.prototype.Fi,Mc.prototype.isInProgress=Mc.prototype.wc,Mc.prototype.isLive=Mc.prototype.T,Mc.prototype.getAdManager=Mc.prototype.Jg,Mc.prototype.getAssetUri=Mc.prototype.Nc,Mc.prototype.getNetworkingEngine=Mc.prototype.xb,Mc.prototype.getMediaElement=Mc.prototype.ni,Mc.prototype.getManifestType=Mc.prototype.xf,Mc.prototype.getLoadMode=Mc.prototype.ji,Mc.prototype.resetConfiguration=Mc.prototype.gj,Mc.prototype.getBufferFullness=Mc.prototype.Kg,Mc.prototype.getNonDefaultConfiguration=Mc.prototype.Og,Mc.prototype.getConfigurationForLowLatency=Mc.prototype.bi,Mc.prototype.getConfiguration=Mc.prototype.getConfiguration,Mc.prototype.configurationForLowLatency=Mc.prototype.Uh,Mc.prototype.configure=Mc.prototype.configure,Mc.prototype.releaseAllMutexes=Mc.prototype.cj,Mc.prototype.destroyAllPreloads=Mc.prototype.cf,Mc.prototype.preload=Mc.prototype.preload,Mc.prototype.detachAndSavePreload=Mc.prototype.Fg,Mc.prototype.unloadAndSavePreload=Mc.prototype.uj,Mc.prototype.load=Mc.prototype.load,Mc.prototype.updateStartTime=Mc.prototype.yj,Mc.prototype.unload=Mc.prototype.kc,Mc.prototype.detach=Mc.prototype.detach,Mc.prototype.attachCanvas=Mc.prototype.Nh,Mc.prototype.attach=Mc.prototype.Jb,Mc.probeSupport=function(t){var n,i,r,s,a;return t=void 0===t||t,M((function(o){switch(o.g){case 1:if(n={},!t){o.u(2);break}return S(o,function(){var t,n,i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,E,A,C,I,L,D,R,P,O,N,U,F,B,j;return M((function($){if(1==$.g){if(t="org.w3.clearkey com.widevine.alpha com.widevine.alpha.experiment com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.chromecast.playready com.apple.fps.1_0 com.apple.fps com.huawei.wiseplay".split(" "),!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration)){for(n={},i=c(t),r=i.next();!r.done;r=i.next())s=r.value,n[s]=null;return $.return(n)}for(a="1.0 1.1 1.2 1.3 1.4 2.0 2.1 2.2 2.3".split(" "),l={"com.widevine.alpha":o=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],"com.widevine.alpha.experiment":o,"com.microsoft.playready.recommendation":["150","2000","3000"]},h={videoCapabilities:u=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],audioCapabilities:d=[{contentType:'audio/mp4; codecs="mp4a.40.2"'},{contentType:'audio/webm; codecs="opus"'}],initDataTypes:["cenc","sinf","skd","keyids"]},f=[null,"cenc","cbcs","cbcs-1-9"],p=new Map,g=function(e,t){var n,i,r,s,o,l,u,d,h,f,g,m,y;return M((function(v){switch(v.g){case 1:return w(v,2),S(v,t.createMediaKeys(),5);case 5:n=v.h;case 4:k(v,3);break;case 2:return x(v),v.return();case 3:if(r=!!(i=t.getConfiguration().sessionTypes)&&i.includes("persistent-license"),We()&&(r=!1),s=t.getConfiguration().videoCapabilities,o=t.getConfiguration().audioCapabilities,l={persistentState:r,encryptionSchemes:[],videoRobustnessLevels:[],audioRobustnessLevels:[],minHdcpVersions:[]},p.has(e)&&p.get(e)?l=p.get(e):p.set(e,l),(u=s[0].encryptionScheme)&&!l.encryptionSchemes.includes(u)&&l.encryptionSchemes.push(u),(d=s[0].robustness)&&!l.videoRobustnessLevels.includes(d)&&l.videoRobustnessLevels.push(d),(h=o[0].robustness)&&!l.audioRobustnessLevels.includes(h)&&l.audioRobustnessLevels.push(h),"getStatusForPolicy"in n){for(f=[],g=c(a),m=g.next(),y={};!m.done;y={rd:void 0},m=g.next())y.rd=m.value,l.minHdcpVersions.includes(y.rd)||f.push(n.getStatusForPolicy({minHdcpVersion:y.rd}).then(function(e){return function(t){"usable"!=t||l.minHdcpVersions.includes(e.rd)||l.minHdcpVersions.push(e.rd)}}(y)));return S(v,Promise.all(f),0)}v.u(0)}}))},m=function(e,t,n,i){var r,s,a,o,l,u,d,f,p,m;return M((function(y){switch(y.g){case 1:for(w(y,2),r=It(h),s=c(r.videoCapabilities),a=s.next();!a.done;a=s.next())(o=a.value).encryptionScheme=t,o.robustness=n;for(l=c(r.audioCapabilities),u=l.next();!u.done;u=l.next())(d=u.value).encryptionScheme=t,d.robustness=i;return(f=It(r)).persistentState="required",f.sessionTypes=["persistent-license"],p=[f,r],rt()?S(y,Xi(5,navigator.requestMediaKeySystemAccess(e,p)),7):S(y,navigator.requestMediaKeySystemAccess(e,p),6);case 6:m=y.h,y.u(5);break;case 7:m=y.h;case 5:return S(y,g(e,m),8);case 8:k(y,0);break;case 2:x(y),_(y)}}))},y=function(e,t,n,i){var r,s,a;return M((function(o){switch(o.g){case 1:return w(o,2),r={type:"media-source",video:{contentType:u[0].contentType,width:640,height:480,bitrate:1,framerate:1},audio:{contentType:d[0].contentType,channels:2,bitrate:1,samplerate:1},keySystemConfiguration:{keySystem:e,video:{encryptionScheme:t,robustness:n},audio:{encryptionScheme:t,robustness:i}}},rt()?S(o,Xi(5,navigator.mediaCapabilities.decodingInfo(r)),7):S(o,navigator.mediaCapabilities.decodingInfo(r),6);case 6:s=o.h,o.u(5);break;case 7:s=o.h;case 5:return a=s.keySystemAccess,S(o,g(e,a),8);case 8:k(o,0);break;case 2:x(o),_(o)}}))},v=c(t),b=v.next();!b.done;b=v.next())T=b.value,p.set(T,null);for(E=function(e){return!("org.w3.clearkey"===e&&Je()||e&&e.match(/^com\.apple\.fps/)&&it()||Fe(e)&&(nt()||Je())||Fe(e)&&ot("Firefox")||"com.huawei.wiseplay"===e&&(it()||nt()))},A=[],C=c(f),I=C.next();!I.done;I=C.next())for(L=I.value,D=c(t),R=D.next();!R.done;R=D.next())P=R.value,E(P)&&(A.push(m(P,L,"","")),A.push(y(P,L,"","")));for(O=c(t),N=O.next();!N.done;N=O.next())for(U=N.value,F=c(l[U]||[]),B=F.next();!B.done;B=F.next())j=B.value,E(U)&&(A.push(m(U,null,j,"")),A.push(m(U,null,"",j)),A.push(y(U,null,j,"")),A.push(y(U,null,"",j)));return S($,Promise.all(A),2)}return $.return(ps(p))}))}(),3);case 3:n=o.h;case 2:return i=function(){var e={};if(He())for(var t=c(ba.keys()),n=t.next();!n.done;n=t.next())e[n.value]=!0;for(n=(t=c(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!n.done;n=t.next())e[n=n.value]=He()?ba.has(n):qe(n);return e}(),r=function(){for(var e='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.05.01",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.01",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(d(Fi)),t={},n=(e=c(e)).next();!n.done;n=e.next()){Vi(n=n.value)?t[n]=!0:t[n]=He()?ie(n)||!!Bn(n):qe(n);var i=n.split(";")[0];t[i]=t[i]||t[n]}return t}(),S(o,ct(),4);case 4:return s=o.h,a={manifest:i,media:r,drm:n,hardwareResolution:s},Nd.forEach((function(e,t){a[t]=e()})),o.return(a)}}))},Mc.isBrowserSupported=function(){return e.Promise||X("A Promise implementation or polyfill is required"),!(!(e.Promise&&e.Uint8Array&&Array.prototype.forEach)||ot("Trident/"))&&(!!He()||qe("application/x-mpegurl"))},Mc.setAdManagerFactory=function(e){Ud=e},Mc.registerSupportPlugin=Nc,Mc.prototype.destroy=Mc.prototype.destroy;var Dd=0,Rd=1,Md=2,Pd=3;Mc.LoadMode={DESTROYED:Dd,NOT_LOADED:Rd,MEDIA_SOURCE:Md,SRC_EQUALS:Pd},Mc.version="v4.13.8";var Od=["4","13"];ce=new function(e){this.g=e,this.i=le,this.h=ue}(new ae(Number(Od[0]),Number(Od[1])));var Nd=new Map,Ud=null;function Fd(){this.g=[],this.i=this.l=this.j=this.h=0}function Bd(e){return e.g.length?e.g.reduce((function(e,t){return e+t}),0)/e.g.length:0}function jd(e,t,n){var i=this;this.g=e,this.h=t,this.j=n,this.i=!1,this.l=this.h.getVolume(),this.m=new ee,this.m.D(this.h,google.ima.AdEvent.Type.PAUSED,(function(){i.i=!0})),this.m.D(this.h,google.ima.AdEvent.Type.RESUMED,(function(){i.i=!1}))}function $d(){}function Vd(e,t){for(var n=[],i=(e=c(Ut(e,"Ad"))).next();!i.done;i=e.next())if((i=$t(i.value,"InLine"))&&(i=$t(i,"Creatives")))for(var r=(i=c(Ut(i,"Creative"))).next();!r.done;r=i.next()){var s=$t(r=r.value,"Linear");if(s&&Hd(n,t,s),r=$t(r,"NonLinearAds"))for(var a=(r=c(r=Ut(r,"NonLinear"))).next();!a.done;a=r.next())e:{s=n;var o=t,l=a.value,u=$t(l,"StaticResource");if(u)a=u.attributes.creativeType;else{if(!(u=$t(l,"HTMLResource")))break e;a="text/html"}if(u=Bt(u)){"text/html"===a&&(u="data:text/html;charset=UTF-8,"+encodeURIComponent(u));var d=Ht(l,"width",Yt)||Ht(l,"expandedWidth",Yt),h=Ht(l,"height",Yt)||Ht(l,"expandedHeight",Yt);if(d||h){var f=null;(l=l.attributes.minSuggestedDuration)&&(f=At(l)),l=0,null!=o&&(l=o),s.push({id:null,groupId:null,startTime:l,endTime:null,uri:u,mimeType:a,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:f,once:!0,pre:null==o,post:1/0==o,timelineRange:!1,loop:!1,overlay:{viewport:{x:0,y:0},topLeft:{x:0,y:0},size:{x:d||0,y:h||0}}})}}}}return n}function Hd(e,t,n){var i=0;null!=t&&(i=t);var r=null;if(n.attributes.skipoffset&&(r=At(n.attributes.skipoffset),isNaN(r)&&(r=null)),n=$t(n,"MediaFiles")){var s=Ut(n,"MediaFile");for(n=s,(s=s.filter((function(e){return"streaming"==e.attributes.delivery}))).length&&(n=s),n=n.sort((function(e,t){return(parseInt(t.attributes.height,10)||0)-(parseInt(e.attributes.height,10)||0)})),s=(n=c(n)).next();!s.done;s=n.next())if(!(s=s.value).attributes.apiFramework){var a=Bt(s);if(a){e.push({id:null,groupId:null,startTime:i,endTime:null,uri:a,mimeType:s.attributes.type||null,isSkippable:null!=r,skipOffset:r,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:null,once:!0,pre:null==t,post:1/0==t,timelineRange:!1,loop:!1,overlay:null});break}}}}function qd(t,n,i,r,s){var a=this;this.s=t,this.i=n,this.F=!1,this.A=this.o=null,this.G=NaN,this.l=s,this.j=null,this.h=new ee,google.ima.settings.setLocale(i),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.C=new google.ima.AdDisplayContainer(this.s,this.i),this.C.initialize(),this.m=new google.ima.AdsLoader(this.C),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.13.8"),this.g=null,this.B=r||new google.ima.AdsRenderingSettings,this.h.D(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(t){!function(t,n){if(t.l(new Kr("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-t.G))),t.o.customPlayheadTracker){var i={currentTime:t.i.currentTime};t.g=n.getAdsManager(i,t.B),t.i.muted?t.g.setVolume(0):t.g.setVolume(t.i.volume),t.h.D(t.i,"timeupdate",(function(){t.i.duration&&(i.currentTime=t.i.currentTime)})),t.h.D(t.i,"volumechange",(function(){t.j&&(t.j.setVolume(t.i.volume),t.i.muted&&t.j.setMuted(!0))}))}else t.g=n.getAdsManager(t.i,t.B);t.l(new Kr("ima-ad-manager-loaded",(new Map).set("imaAdManager",t.g)));var r=t.g.getCuePoints();if(r.length){n=[];for(var s=(r=c(r)).next();!s.done;s=r.next())n.push({start:s.value,end:null});t.l(new Kr("ad-cue-points-changed",(new Map).set("cuepoints",n)))}!function(e){function t(t,n){t=(new Map).set("originalEvent",t),e.l(new Kr(n,t))}e.h.D(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){Gd(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(t){Kd(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.STARTED,(function(t){Kd(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,(function(e){t(e,"ad-first-quartile")})),e.h.D(e.g,google.ima.AdEvent.Type.MIDPOINT,(function(e){t(e,"ad-midpoint")})),e.h.D(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,(function(e){t(e,"ad-third-quartile")})),e.h.D(e.g,google.ima.AdEvent.Type.COMPLETE,(function(e){t(e,"ad-complete")})),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(t){Wd(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){Wd(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPED,(function(e){t(e,"ad-skipped")})),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,(function(e){t(e,"ad-volume-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,(function(e){t(e,"ad-muted")})),e.h.D(e.g,google.ima.AdEvent.Type.PAUSED,(function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))})),e.h.D(e.g,google.ima.AdEvent.Type.RESUMED,(function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))})),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(n){e.j&&t(n,"ad-skip-state-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.CLICK,(function(e){t(e,"ad-clicked")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_PROGRESS,(function(e){t(e,"ad-progress")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_BUFFERING,(function(e){t(e,"ad-buffering")})),e.h.D(e.g,google.ima.AdEvent.Type.IMPRESSION,(function(e){t(e,"ad-impression")})),e.h.D(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,(function(e){t(e,"ad-duration-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.USER_CLOSE,(function(e){t(e,"ad-closed")})),e.h.D(e.g,google.ima.AdEvent.Type.LOADED,(function(e){t(e,"ad-loaded")})),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(e){t(e,"all-ads-completed")})),e.h.D(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,(function(e){t(e,"ad-linear-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_METADATA,(function(e){t(e,"ad-metadata")})),e.h.D(e.g,google.ima.AdEvent.Type.LOG,(function(e){t(e,"ad-recoverable-error")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,(function(e){t(e,"ad-break-ready")})),e.h.D(e.g,google.ima.AdEvent.Type.INTERACTION,(function(e){t(e,"ad-interaction")}))}(t);try{t.g.init(t.i.offsetWidth,t.i.offsetHeight,zd(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),t.h.D(t.i,"loadeddata",(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,zd(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),"ResizeObserver"in e?(t.A=new ResizeObserver((function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,zd(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),t.A.observe(t.i)):t.h.D(document,"fullscreenchange",(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,zd(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),t.F||t.o.skipPlayDetection?t.g.start():t.h.ma(t.i,"play",(function(){t.F=!0,t.g.start()}))}catch(a){Wd(t,null)}}(a,t)})),this.h.D(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){Gd(a,e)})),this.h.D(this.i,"ended",(function(){a.m.contentComplete()})),this.h.ma(this.i,"play",(function(){a.F=!0}))}function Gd(e,t){t.getError(),t=(new Map).set("originalEvent",t),e.l(new Kr("ad-error",t)),Wd(e,null),e.l(new Kr("ad-cue-points-changed",(new Map).set("cuepoints",[])))}function zd(e){return document.fullscreenEnabled?!!document.fullscreenElement:!!(e=e.i).webkitSupportsFullscreen&&e.webkitDisplayingFullscreen}function Kd(e,t){var n=t.getAd();n?(e.j=new jd(n,e.g,e.i),t.type!=google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED||e.o.supportsMultipleMediaElements||e.l(new Kr("ad-content-pause-requested")),t=(new Map).set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.l(new Kr("ad-started",t)),e.j.isLinear()&&(e.s.setAttribute("ad-active","true"),e.o.customPlayheadTracker||e.i.pause(),e.i.muted?((t=e.j).l=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):X("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function Wd(e,t){t&&t.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED&&!e.o.supportsMultipleMediaElements&&e.l(new Kr("ad-content-resume-requested")),e.l(new Kr("ad-stopped",(new Map).set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.s.removeAttribute("ad-active"),e.o.customPlayheadTracker||e.i.ended||e.i.play())}function Xd(e,t,n,i,r,s){this.g=e,this.i=t,this.j=(this.h=t.isSkippable)?t.skipOffset||0:t.skipOffset,this.l=t.skipFor,this.A=n,this.o=i,this.m=r,this.s=s,this.B=t.overlay}function Yd(e,t,n){this.g=e,this.j=t,this.h=n,this.i=null==e.overlay}function Qd(e,t,n,i){function r(){if(!s.I&&s.m&&!s.B.Ka()){s.m=s.i.currentTime,s.s&&!s.s.pre&&!s.s.post&&s.m<s.s.startTime&&(s.s=null);var e=th(s);e&&nh(s,e,1,1,Date.now())}}var s=this;if(this.O=null,this.G=e,this.B=t,this.i=n,this.H=null,this.A=!0,this.h=this.i,this.j=i,this.K=new Set,this.F=new Set,this.C=new Map,this.g=new Mc,rh(this),this.L=new ee,this.l=new ee,this.I=!1,this.W=this.o=this.s=this.m=null,this.L.D(this.i,"timeupdate",(function(){if(!(s.I||s.m||s.B.Ka())){s.m=s.i.currentTime;var e=th(s,!0);e&&nh(s,e,1,1,Date.now())}})),this.L.D(this.i,"ended",(function(){r()})),this.M=new Ve(r),"requestVideoFrameCallback"in this.i&&!at()){var a=this.i,o=function(){r(),a.requestVideoFrameCallback(o)};a.requestVideoFrameCallback(o)}else this.M.ua(.025);this.P=new Ve((function(){var e,t,n,i,r,a,o,l,u,d,h;return M((function(f){switch(f.g){case 1:if(!s.F.size||null==s.m){f.u(0);break}if((e=s.B.m)==Dd||e==Rd)return f.return();t=!1,n=Array.from(s.F),i=s.B.$a(),r=c(n),a=r.next();case 3:if(a.done){f.u(5);break}if((o=a.value)==s.s){f.u(4);break}if(l=o.endTime||o.startTime,!(1<=i.start-l)){0<(u=o.startTime-s.m)&&10>=u&&!s.C.has(o)&&ah(o)&&s.C.set(o,s.g.preload(o.uri,null,o.mimeType||void 0)),f.u(4);break}if(!s.C.has(o)){f.u(7);break}return S(f,s.C.get(o),8);case 8:(d=f.h)&&d.destroy(),s.C.delete(o);case 7:h=JSON.stringify(o),s.K.has(h)&&s.K.delete(h),s.F.delete(o),o.overlay||(t=!0);case 4:a=r.next(),f.u(3);break;case 5:t&&ih(s),_(f)}}))})).ua(1)}function Jd(e){if(e.G&&e.O&&!e.I){var t=e.O.supportsMultipleMediaElements,n=e.i;n.webkitSupportsFullscreen&&n.webkitDisplayingFullscreen&&(t=!1),e.A==t&&(e.A=!t,e.A?(e.h=e.i,e.H&&(e.H.parentElement&&e.G.removeChild(e.H),e.H=null)):(e.H||((t=document.createElement(e.i.tagName)).autoplay=!0,t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.display="none",t.setAttribute("playsinline",""),e.H=t),e.h=e.H))}}function Zd(e,t){var n;M((function(i){if(1==i.g)return rh(e),S(i,function(e,t){var n,i,r,s,a,o,l,u,c,d,h,f,p,g,m,y,v,b,T,_,E,A,C,I,L,D,R,P,O,N,U,F,B,j,$,V,H,q,G,z,K;return M((function(M){switch(M.g){case 1:if(n=[],!t)return M.return(n);if(i=t.values.find((function(e){return"X-ASSET-URI"==e.key})),r=t.values.find((function(e){return"X-ASSET-LIST"==e.key})),!i&&!r)return M.return(n);if(s=null,(a=t.values.find((function(e){return"ID"==e.key})))&&(s=a.data),o=null==s?Math.floor(10*t.startTime)/10:t.startTime,(l=t.endTime)&&1/0!=t.endTime&&"number"==typeof t.endTime&&(l=null==s?Math.floor(10*t.endTime)/10:t.endTime),u=t.values.find((function(e){return"X-RESTRICT"==e.key})),d=c=!0,u&&u.data&&(h=u.data,c=!h.includes("SKIP"),d=!h.includes("JUMP")),f=c?0:null,(p=t.values.find((function(e){return"X-ENABLE-SKIP-AFTER"==e.key})))&&(g=p.data,f=parseFloat(g),isNaN(f)&&(f=c?0:null)),m=null,(y=t.values.find((function(e){return"X-ENABLE-SKIP-FOR"==e.key})))&&(v=y.data,m=parseFloat(v),isNaN(f)&&(m=null)),b=null,(T=t.values.find((function(e){return"X-RESUME-OFFSET"==e.key})))&&(_=T.data,b=parseFloat(_),isNaN(b)&&(b=null)),E=null,(A=t.values.find((function(e){return"X-PLAYOUT-LIMIT"==e.key})))&&(C=A.data,E=parseFloat(C),isNaN(E)&&(E=null)),D=L=I=!1,(R=t.values.find((function(e){return"CUE"==e.key})))&&(P=R.data,I=P.includes("ONCE"),L=P.includes("PRE"),D=P.includes("POST")),O=!1,(N=t.values.find((function(e){return"X-TIMELINE-OCCUPIES"==e.key})))?(U=N.data,O=U.includes("RANGE")):!T&&e.B.T()&&(O=!L&&!D),i){if(!(F=i.data))return M.return(n);n.push({id:s,groupId:null,startTime:o,endTime:l,uri:F,mimeType:null,isSkippable:c,skipOffset:f,skipFor:m,canJump:d,resumeOffset:b,playoutLimit:E,once:I,pre:L,post:D,timelineRange:O,loop:!1,overlay:null}),M.u(2);break}if(!r){M.u(2);break}return(B=r.data)?(w(M,4),S(M,sh(e,B,{type:11}),6)):M.return(n);case 6:for(j=M.h,$=pt(j),V=JSON.parse($),(H=V["SKIP-CONTROL"])&&("number"==typeof(q=H["ENABLE-SKIP-AFTER"])&&(f=parseFloat(q),isNaN(q)&&(f=c?0:null)),"number"==typeof(G=H["ENABLE-SKIP-FOR"])&&(m=parseFloat(G),isNaN(G)&&(m=null))),z=0;z<V.ASSETS.length;z++)(K=V.ASSETS[z]).URI&&n.push({id:s+"_shaka_asset_"+z,groupId:s,startTime:o,endTime:l,uri:K.URI,mimeType:null,isSkippable:c,skipOffset:f,skipFor:m,canJump:d,resumeOffset:b,playoutLimit:E,once:I,pre:L,post:D,timelineRange:O,loop:!1,overlay:null});k(M,2);break;case 4:x(M);case 2:return M.return(n)}}))}(e,t),2);(n=i.h).length?eh(e,n):X("Unsupported HLS interstitial",t),_(i)}))}function eh(e,t){var n,i,r,s,a,o,l,u;M((function(d){switch(d.g){case 1:n=!1,i=c(t),r=i.next();case 2:if(r.done){d.u(4);break}if(!(s=r.value).uri){X("Missing URL in interstitial",s),d.u(3);break}if(s.mimeType){d.u(5);break}return w(d,6),a=e.g.xb(),S(d,Vu(s.uri,a,e.B.getConfiguration().streaming.retryParameters),8);case 8:s.mimeType=d.h,k(d,5);break;case 6:x(d);case 5:if(o=s.id||JSON.stringify(s),e.K.has(o)){d.u(3);break}s.loop&&!s.overlay&&X("Loop is only supported in overlay interstitials",s),s.overlay||(n=!0),e.K.add(o),e.F.add(s),l=!1,s.pre&&null==e.m?l=!0:0!=s.startTime||s.canJump?null!=e.m&&(0<(u=s.startTime-e.m)&&10>=u&&(l=!0)):l=!0,l&&!e.C.has(s)&&ah(s)&&e.C.set(s,e.g.preload(s.uri,null,s.mimeType||void 0));case 3:r=i.next(),d.u(2);break;case 4:n&&ih(e),_(d)}}))}function th(e,t,n){t=void 0!==t&&t,n=void 0===n?null:n;var i=0,r=null;if(e.F.size&&null!=e.m){var s=e.i.ended,a=Array.from(e.F).sort((function(e,t){return t.startTime-e.startTime})),o=a;for(o=t?a.filter((function(e){return e.pre})):s?a.filter((function(e){return e.post})):a.filter((function(e){return!e.pre&&!e.post})),o=(a=c(o)).next();!o.done;o=a.next()){o=o.value;var l=!1;if(t)l=o.pre;else if(s)l=o.post;else if(!o.pre&&!o.post){var u=e.m-Math.round(1e3*o.startTime)/1e3;0<u&&(1>=u||!o.canJump)&&(l=!(null==n&&e.s&&!e.s.pre&&!e.s.post&&e.s.startTime>=o.startTime))}l&&(!e.s||o.startTime>=e.s.startTime)&&(i==(n||0)?r=o:r&&!o.canJump&&.001<Math.round(1e3*o.startTime)/1e3-Math.round(1e3*r.startTime)/1e3&&(r=o,i=0),i++)}}return r}function nh(e,t,n,i,r,s){s=void 0===s?0:s,e.s=t,Jd(e),!e.h.parentElement&&e.G&&e.G.appendChild(e.h),1==i&&1==n&&(n=Array.from(e.F).filter((function(e){return t.pre?e.pre==t.pre:t.post?e.post==t.post:.001>Math.abs(e.startTime-t.startTime)})).length),t.once&&(s++,e.F.delete(t),t.overlay||ih(e)),t.mimeType&&(t.mimeType.startsWith("image/")||"text/html"===t.mimeType)?t.overlay?function(e,t,n,i,r){function s(){e.o&&(e.o.stop(),e.o=null),e.G.removeChild(l),e.j(new Kr("ad-stopped"));var s=th(e,t.pre,i-r);s?(e.l.Ma(),nh(e,s,n,++i,Date.now(),r)):e.I=!1}var a=t.overlay,o="text/html"==t.mimeType?"iframe":"img",l=document.createElement(o);l.style.objectFit="contain",l.style.position="absolute",l.style.border="none",e.j(new Kr("ad-started",(new Map).set("ad",new Yd(t,n,i)))),"iframe"==o?l.src=t.uri:(l.src=t.uri,l.onerror=function(t){e.j(new Kr("ad-error",(new Map).set("originalEvent",t))),s()});var u=a.viewport,c=a.topLeft;a=a.size,0==u.x&&0==u.y?(l.width=t.overlay.size.x,l.height=t.overlay.size.y,l.style.bottom="10%",l.style.left="0",l.style.right="0",l.style.width="100%",t.overlay.size.y||"iframe"!=o||(l.style.height="auto")):(l.style.height=a.y/u.y*100+"%",l.style.left=c.x/u.x*100+"%",l.style.top=c.y/u.y*100+"%",l.style.width=a.x/u.x*100+"%"),e.G.appendChild(l);var d=Date.now();e.o&&e.o.stop(),e.o=new Ve((function(){t.playoutLimit&&(Date.now()-d)/1e3>t.playoutLimit||t.endTime&&e.i.currentTime>t.endTime?(e.j(new Kr("ad-complete")),s()):e.i.currentTime<t.startTime&&(e.j(new Kr("ad-skipped")),s())})),t.playoutLimit&&!t.endTime?e.o.aa(t.playoutLimit):t.endTime&&e.o.ua(.025)}(e,t,n,i,s):X("Unsupported interstitial",t):e.A&&t.overlay?X("Unsupported interstitial",t):function(e,t,n,i,r,s){var a,o,l,u,c,d,h,f,p,g,m,y,v,b,T,E,A;M((function(C){switch(C.g){case 1:if(a=Date.now(),e.I=!0,!e.A||1!=i){C.u(2);break}return e.j(new Kr("ad-content-pause-requested",(new Map).set("saveLivePosition",!0))),o=new jr,l=function(t){return M((function(n){if(1==n.g)return"detach"!=t.state?n.u(0):at()?S(n,new Promise((function(e){return new Ve(e).aa(.1)})),3):n.u(3);o.resolve(),e.l.bb(e.B,"onstatechange",l),_(n)}))},e.l.D(e.B,"onstatechange",l),S(C,o,2);case 2:return e.A||(e.h.style.display="",t.overlay?(e.h.loop=t.loop,u=t.overlay.viewport,c=t.overlay.topLeft,d=t.overlay.size,e.h.style.height=d.y/u.y*100+"%",e.h.style.left=c.x/u.x*100+"%",e.h.style.top=c.y/u.y*100+"%",e.h.style.width=d.x/u.x*100+"%"):(e.i.pause(),null!=t.resumeOffset&&0!=t.resumeOffset&&(e.i.currentTime+=t.resumeOffset),e.h.loop=!1,e.h.style.height="100%",e.h.style.left="0",e.h.style.top="0",e.h.style.width="100%")),h=!1,f=function(){if(!e.A&&!t.overlay&&null==t.resumeOffset)if(t.timelineRange&&t.endTime&&1/0!=t.endTime)e.i.currentTime!=t.endTime&&(e.i.currentTime=t.endTime);else{var n=Date.now();e.i.currentTime+=(n-r)/1e3,r=n}},p=function(a){var o,l;return M((function(u){if(1==u.g){if(f(),o=th(e,t.pre,i-s),a&&t.groupId)for(;o&&o.groupId==t.groupId;)i++,o=th(e,t.pre,i-s);return e.o&&(!t.groupId||o&&o.groupId!=t.groupId)&&(e.o.stop(),e.o=null),o&&!o.overlay?u.u(2):(t.post&&(e.m=null,e.s=null),e.A?S(u,e.g.detach(),4):S(u,e.g.kc(),4))}2!=u.g&&(e.A&&(null==(l=t.resumeOffset)&&(l=t.timelineRange&&t.endTime&&1/0!=t.endTime?t.endTime-(e.m||0):(Date.now()-r)/1e3),e.j(new Kr("ad-content-resume-requested",(new Map).set("offset",l)))),e.j(new Kr("ad-stopped")),e.l.Ma(),e.I=!1,e.A?ih(e):(e.h.style.display="none",f(),e.i.ended||e.i.play())),Jd(e),o&&(e.j(new Kr("ad-stopped")),e.l.Ma(),nh(e,o,n,++i,r,s)),_(u)}))},g=function(t){return M((function(n){return h?n.return():(h=!0,e.j(new Kr("ad-error",(new Map).set("originalEvent",t))),S(n,p(!1),0))}))},m=function(){return M((function(t){if(1==t.g)return h?t.return():(h=!0,S(t,p(!1),2));e.j(new Kr("ad-complete")),_(t)}))},e.W=function(){return M((function(t){return h?t.return():(h=!0,e.j(new Kr("ad-skipped")),S(t,p(!0),0))}))},y=new Xd(e.h,t,e.W,n,i,!e.A),e.A||(y.setMuted(e.i.muted),y.setVolume(e.i.volume)),e.j(new Kr("ad-started",(new Map).set("ad",y))),(v=y.canSkipNow())&&e.j(new Kr("ad-skip-state-changed")),e.l.ma(e.g,"error",g),e.l.D(e.h,"timeupdate",(function(){if(e.h.duration){var t=y.canSkipNow();v!=t&&0<y.getRemainingTime()&&0<y.getDuration()&&e.j(new Kr("ad-skip-state-changed")),v=t}})),e.l.ma(e.g,"firstquartile",(function(){f(),e.j(new Kr("ad-first-quartile"))})),e.l.ma(e.g,"midpoint",(function(){f(),e.j(new Kr("ad-midpoint"))})),e.l.ma(e.g,"thirdquartile",(function(){f(),e.j(new Kr("ad-third-quartile"))})),e.l.ma(e.g,"complete",m),e.l.D(e.h,"play",(function(){e.j(new Kr("ad-resumed"))})),e.l.D(e.h,"pause",(function(){var t=e.g.getConfiguration();e.h.currentTime>=t.playRangeEnd?m():e.j(new Kr("ad-paused"))})),e.l.D(e.h,"volumechange",(function(){e.h.muted?e.j(new Kr("ad-muted")):e.j(new Kr("ad-volume-changed"))})),w(C,4),rh(e),t.startTime&&t.endTime&&1/0!=t.endTime&&t.startTime!=t.endTime&&(0<(b=t.endTime-t.startTime)&&e.g.configure("playRangeEnd",b)),t.playoutLimit&&!e.o&&(e.o=new Ve((function(){e.W()})).aa(t.playoutLimit),e.g.configure("playRangeEnd",t.playoutLimit)),S(C,e.g.Jb(e.h),6);case 6:return e.C.has(t)?S(C,e.C.get(t),10):S(C,e.g.load(t.uri,null,t.mimeType||void 0),8);case 10:return T=C.h,e.C.delete(t),S(C,T?e.g.load(T):e.g.load(t.uri,null,t.mimeType||void 0),8);case 8:E=(Date.now()-a)/1e3,e.j(new Kr("ads-loaded",(new Map).set("loadTime",E))),e.A&&e.i.play(),k(C,0);break;case 4:if(A=x(C),!e.I)return C.return();g(A),_(C)}}))}(e,t,n,i,r,s)}function ih(e){for(var t=[],n=c(e.F),i=n.next(),r={};!i.done;r={Xb:void 0},i=n.next())(i=i.value).overlay||(r.Xb={start:i.startTime,end:null},i.pre?(r.Xb.start=0,r.Xb.end=null):i.post?(r.Xb.start=-1,r.Xb.end=null):i.timelineRange&&(r.Xb.end=i.endTime),t.find(function(e){return function(t){return e.Xb.start==t.start&&e.Xb.end==t.end}}(r))||t.push(r.Xb));e.j(new Kr("ad-cue-points-changed",(new Map).set("cuepoints",t)))}function rh(e){e.g.configure(e.B.Og()),e.g.configure("ads.disableHLSInterstitial",!0),e.g.configure("ads.disableDASHInterstitial",!0),e.g.configure("playRangeEnd",1/0),ts(e.B.xb(),e.g.xb())}function sh(e,t,n){var i,r;return M((function(s){return 1==s.g?(i=ns([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),S(s,e.B.xb().request(7,i,n).promise,2)):(r=s.h,s.return(r.data))}))}function ah(e){return!(e=e.mimeType)||!e.startsWith("image/")&&"text/html"!==e}function oh(e,t,n,i,r){this.h=e,this.j=At(this.h.skipOffset),this.g=r,this.i=t,this.l=n,this.o=i,this.m=!1}function lh(e,t,n,i){this.B=e,this.K=t,this.h=n,this.l=null,this.P=NaN,this.i=i,this.I=!1,this.A=null,this.j=[],this.M=[],this.L=this.C=this.g=null,this.F=new Map,this.m=[],this.s=[],this.G="",this.O=!0,this.H="",this.o=new ee}function uh(e,t){var n,i,r,s,a,o,l,u;M((function(c){return 1==c.g?t.staticResource?(n=ch(t),e.F.get(n)?c.return():(i={type:9},r=ns([t.staticResource],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),s=e.K.request(7,r,i),w(c,2),e.F.set(n,[]),S(c,s.promise,4))):c.return():2!=c.g?(a=c.h,o=pt(a.data),l=JSON.parse(o),u=l.apps,e.F.set(n,u),k(c,0)):(x(c),e.F.delete(n),void _(c))}))}function ch(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function dh(e){var t=e.h.currentTime;if(0!=t&&null==e.A){for(var n,i,r=c(e.j),s=r.next();!s.done;s=r.next())for(var a=c((s=s.value).ads),o=a.next();!o.done;o=a.next())if(o=o.value,i){if(o.startTimeInSeconds<t&&o.startTimeInSeconds>i.startTimeInSeconds+i.durationInSeconds){i=o,n=s;break}}else o.startTimeInSeconds<t&&(i=o,n=s);n&&i&&!e.M.includes(i.adId)&&(e.A=t,e.h.currentTime=n.startTimeInSeconds)}}function hh(e){if(e.h.duration&&(e.g||e.j.length)){var t=e.h.currentTime,n=!1;if(e.g){n=!0;var i=e.C,r=i.startTimeInSeconds+.5*i.durationInSeconds,s=i.startTimeInSeconds+.75*i.durationInSeconds;t>=i.startTimeInSeconds+.25*i.durationInSeconds&&!e.s.includes("firstQuartile")?(e.s.push("firstQuartile"),gh(e,"firstQuartile")):t>=r&&!e.s.includes("midpoint")?(e.s.push("midpoint"),gh(e,"midpoint")):t>=s&&!e.s.includes("thirdQuartile")&&(e.s.push("thirdQuartile"),gh(e,"thirdQuartile")),i=e.g.getRemainingTime(),r=e.g.getDuration(),e.g.canSkipNow()&&0<i&&0<r&&gh(e,"skipStateChanged"),0<r&&(0>=i||i>r)&&fh(e)}if(!e.g||!e.g.isLinear()){e:for(i=c(e.j),r=i.next();!r.done&&(r=r.value,!e.g||!e.g.isLinear());r=i.next())for(s=0;s<r.ads.length;s++){var a=r.ads[s],o=a.startTimeInSeconds+a.durationInSeconds;if(a.startTimeInSeconds<=t&&o>t){if(e.M.includes(a.adId)){if(e.h.ended)continue;e.h.currentTime=o;break e}fh(e),e.L=r,e.g=new oh(a,s+1,r.ads.length,!0,e.h),e.C=a,0===s&&gh(e,"breakStart"),ph(e);break}}if(!e.g)for(r=(i=c(e.j)).next();!r.done&&(r=r.value,!e.g);r=i.next())for(s=0;s<r.nonLinearAdsList.length;s++)if((a=r.nonLinearAdsList[s]).nonLinearAdList.length){o=r.startTimeInSeconds;var l=e.F.get(ch(a.nonLinearAdList[0]));if(o<=t&&l&&l.length){fh(e),o=e;for(var u=(l=c(l)).next();!u.done;u=l.next())if((u=u.value).data.source.length){var d=document.createElement("img");d.src=u.data.source[0].url,d.style.top=(u.placeholder.top||0)+"%",d.style.height=100-(u.placeholder.top||0)+"%",d.style.left=(u.placeholder.left||0)+"%",d.style.maxWidth=100-(u.placeholder.left||0)+"%",d.style.objectFit="contain",d.style.position="absolute",o.B.appendChild(d)}e.L=r,e.g=new oh(a,s+1,r.ads.length,!1,e.h),e.C=a,0===s&&gh(e,"breakStart"),ph(e);break}}n&&!e.g&&(t=e.h.currentTime,e.A&&e.A>t&&(e.h.currentTime=e.A),e.A=null)}}}function fh(e){if(e.g){for(;e.B.lastChild;)e.B.removeChild(e.B.firstChild);e.I||e.M.push(e.C.adId);var t=e.g.m;gh(e,void 0!==t&&t?"skip":"complete");for(var n=(t=c(e.m)).next();!n.done;n=t.next())n=n.value,e.o.bb(n.target,n.type,n.listener);e.m=[],e.s=[],(t=e.g.getPositionInSequence())===(n=e.g.getSequenceLength())&&gh(e,"breakEnd"),e.g=null,e.C=null,e.L=null}}function ph(e){var t=!1;e.h.paused?t=!0:(gh(e,"impression"),gh(e,"start")),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted&&gh(e,"mute")}}),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted||gh(e,"unmute")}}),e.m.push({target:e.h,type:"play",listener:function(){t?(gh(e,"impression"),gh(e,"start"),t=!1):gh(e,"resume")}}),e.m.push({target:e.h,type:"pause",listener:function(){gh(e,"pause")}});for(var n=c(e.m),i=n.next();!i.done;i=n.next())i=i.value,e.o.D(i.target,i.type,i.listener)}function gh(e,t){var n=e.C.trackingEvents.find((function(e){return e.eventType==t}));if(n||(n=e.L.adBreakTrackingEvents.find((function(e){return e.eventType==t}))),n)for(var i={type:10},r=(n=c(n.beaconUrls)).next();!r.done;r=n.next())(r=r.value)&&""!=r&&((r=ns([r],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4})).method="POST",e.K.request(7,r,i));switch(t){case"impression":e.i(new Kr("ad-impression"));break;case"start":e.i(new Kr("ad-started",(new Map).set("ad",e.g)));break;case"mute":e.i(new Kr("ad-muted"));break;case"unmute":e.i(new Kr("ad-volume-changed"));break;case"resume":e.i(new Kr("ad-resumed"));break;case"pause":e.i(new Kr("ad-paused"));break;case"firstQuartile":e.i(new Kr("ad-first-quartile"));break;case"midpoint":e.i(new Kr("ad-midpoint"));break;case"thirdQuartile":e.i(new Kr("ad-third-quartile"));break;case"complete":e.i(new Kr("ad-complete")),e.i(new Kr("ad-stopped"));break;case"skip":e.i(new Kr("ad-skipped")),e.i(new Kr("ad-stopped"));break;case"breakStart":e.B.setAttribute("ad-active","true");break;case"breakEnd":e.B.removeAttribute("ad-active");break;case"skipStateChanged":e.i(new Kr("ad-skip-state-changed"))}}function mh(e,t){this.g=e,this.i=null,this.h=t}function yh(e,t,n,i){var r=this;this.s=e,this.l=t,this.j=null,this.F=NaN,this.i=i,this.G=!1,this.A=this.m=this.o=null,this.B="",this.C=[],this.h=new ee,(e=new google.ima.dai.api.UiSettings).setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.s,e),this.i(new Kr("ima-stream-manager-loaded",(new Map).set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,(function(e){!function(e,t){e.i(new Kr("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-e.F))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.G||e.h.D(e.l,"seeked",(function(){var t=e.l.currentTime;if(0!=t){e.g.streamTimeForContentTime(t);var n=e.g.previousCuePointForStreamTime(t);n&&!n.played&&(e.o=t,e.l.currentTime=n.start)}}))}(r,e)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,(function(){r.B.length?r.j.resolve(r.B):r.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),r.j=null})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,(function(){})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,(function(e){e=e.getAd(),r.m=new mh(e,r.l),r.A&&(r.m.i=r.A),r.i(new Kr("ad-started",(new Map).set("ad",r.m))),r.s.setAttribute("ad-active","true")})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,(function(){r.s.removeAttribute("ad-active");var e=r.l.currentTime;r.o&&r.o>e&&(r.l.currentTime=r.o,r.o=null)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,(function(e){r.A=e.getStreamData().adProgressData,r.m&&(r.m.i=r.A)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,(function(){r.i(new Kr("ad-first-quartile"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,(function(){r.i(new Kr("ad-midpoint"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,(function(){r.i(new Kr("ad-third-quartile"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,(function(){r.i(new Kr("ad-complete")),r.i(new Kr("ad-stopped")),r.s.removeAttribute("ad-active"),r.m=null})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,(function(){r.i(new Kr("ad-skipped")),r.i(new Kr("ad-stopped"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,(function(e){var t=e.getStreamData();e=[];for(var n=(t=c(t.cuepoints)).next();!n.done;n=t.next())n=n.value,e.push({start:n.start,end:n.end});r.C=e,r.i(new Kr("ad-cue-points-changed",(new Map).set("cuepoints",e)))}))}function vh(){Yr.call(this),this.h=this.i=this.j=this.g=null,this.m=new Fd,this.o=navigator.language,this.l=null}function bh(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.m.g.push(t.loadTime);break;case"ad-started":e.m.h++;break;case"ad-complete":e.m.j++;break;case"ad-skipped":e.m.l++;break;case"ad-error":e.m.i++}e.dispatchEvent(t)}function Th(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Kr){var n={};for(i in t)(e=t[i])&&"object"==typeof e?"detail"==i&&(n[i]=e):i in Event||(n[i]=e);return n}if(t instanceof Error){var i=new Set(["name","message","stack"]);for(n in t)i.add(n);for(e=(n=c(Object.getOwnPropertyNames(t))).next();!e.done;e=n.next())i.add(e.value);for(n={},e=(i=c(i)).next();!e.done;e=i.next())n[e=e.value]=t[e];t={__type__:"Error",contents:n}}else if(t instanceof TimeRanges){for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},n=(t=c(Ma(t))).next();!n.done;n=t.next())e=(n=n.value).end,i.start.push(n.start),i.end.push(e);t=i}else t=ArrayBuffer.isView(t)&&1===t.BYTES_PER_ELEMENT?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return t}}))}function Sh(e){return JSON.parse(e,(function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){for(n in e=t.contents,t=Error(e.message),e)t[n]=e[n];n=t}else n=t;return n}))}(i=jd.prototype).needsSkipUI=function(){return!1},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!0},i.getDuration=function(){return this.g.getDuration()},i.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},i.getRemainingTime=function(){return this.h.getRemainingTime()},i.isPaused=function(){return this.i},i.isSkippable=function(){return 0<=this.g.getSkipTimeOffset()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return this.h.getAdSkippableState()},i.skip=function(){return this.h.skip()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.resume()},i.getVolume=function(){return this.h.getVolume()},i.setVolume=function(e){return this.j.volume=e,this.h.setVolume(e)},i.isMuted=function(){return 0==this.h.getVolume()},i.isLinear=function(){return this.g.isLinear()},i.resize=function(e,t){var n=!1,i=this.j;document.fullscreenEnabled?n=!!document.fullscreenElement:i.webkitSupportsFullscreen&&(n=i.webkitDisplayingFullscreen),this.h.resize(e,t,n?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},i.setMuted=function(e){(this.j.muted=e)?(this.l=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.l)},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return this.g.getMediaUrl()},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.g=null},$("shaka.ads.ClientSideAd",jd),jd.prototype.release=jd.prototype.release,jd.prototype.getPodIndex=jd.prototype.getPodIndex,jd.prototype.getTimeOffset=jd.prototype.getTimeOffset,jd.prototype.getMediaUrl=jd.prototype.getMediaUrl,jd.prototype.getAdvertiserName=jd.prototype.getAdvertiserName,jd.prototype.getCreativeAdId=jd.prototype.getCreativeAdId,jd.prototype.getAdId=jd.prototype.getAdId,jd.prototype.getVastMediaWidth=jd.prototype.getVastMediaWidth,jd.prototype.getVastMediaHeight=jd.prototype.getVastMediaHeight,jd.prototype.getVastMediaBitrate=jd.prototype.getVastMediaBitrate,jd.prototype.getDescription=jd.prototype.getDescription,jd.prototype.getTitle=jd.prototype.getTitle,jd.prototype.getPositionInSequence=jd.prototype.getPositionInSequence,jd.prototype.getSequenceLength=jd.prototype.getSequenceLength,jd.prototype.setMuted=jd.prototype.setMuted,jd.prototype.resize=jd.prototype.resize,jd.prototype.isLinear=jd.prototype.isLinear,jd.prototype.isMuted=jd.prototype.isMuted,jd.prototype.setVolume=jd.prototype.setVolume,jd.prototype.getVolume=jd.prototype.getVolume,jd.prototype.play=jd.prototype.play,jd.prototype.pause=jd.prototype.pause,jd.prototype.skip=jd.prototype.skip,jd.prototype.canSkipNow=jd.prototype.canSkipNow,jd.prototype.getTimeUntilSkippable=jd.prototype.getTimeUntilSkippable,jd.prototype.isSkippable=jd.prototype.isSkippable,jd.prototype.isPaused=jd.prototype.isPaused,jd.prototype.getRemainingTime=jd.prototype.getRemainingTime,jd.prototype.getMinSuggestedDuration=jd.prototype.getMinSuggestedDuration,jd.prototype.getDuration=jd.prototype.getDuration,jd.prototype.isUsingAnotherMediaElement=jd.prototype.isUsingAnotherMediaElement,jd.prototype.hasCustomClick=jd.prototype.hasCustomClick,jd.prototype.isClientRendering=jd.prototype.isClientRendering,jd.prototype.needsSkipUI=jd.prototype.needsSkipUI,$("shaka.ads.Utils",$d),$d.ADS_LOADED="ads-loaded",$d.AD_STARTED="ad-started",$d.AD_FIRST_QUARTILE="ad-first-quartile",$d.AD_MIDPOINT="ad-midpoint",$d.AD_THIRD_QUARTILE="ad-third-quartile",$d.AD_COMPLETE="ad-complete",$d.AD_STOPPED="ad-stopped",$d.AD_SKIPPED="ad-skipped",$d.AD_VOLUME_CHANGED="ad-volume-changed",$d.AD_MUTED="ad-muted",$d.AD_PAUSED="ad-paused",$d.AD_RESUMED="ad-resumed",$d.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",$d.CUEPOINTS_CHANGED="ad-cue-points-changed",$d.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",$d.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",$d.AD_CLICKED="ad-clicked",$d.AD_PROGRESS="ad-progress",$d.AD_BUFFERING="ad-buffering",$d.AD_IMPRESSION="ad-impression",$d.AD_DURATION_CHANGED="ad-duration-changed",$d.AD_CLOSED="ad-closed",$d.AD_LOADED="ad-loaded",$d.ALL_ADS_COMPLETED="all-ads-completed",$d.AD_LINEAR_CHANGED="ad-linear-changed",$d.AD_METADATA="ad-metadata",$d.AD_RECOVERABLE_ERROR="ad-recoverable-error",$d.AD_ERROR="ad-error",$d.AD_BREAK_READY="ad-break-ready",$d.AD_INTERACTION="ad-interaction",$d.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",$d.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",$d.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",qd.prototype.configure=function(e){this.o=e},qd.prototype.stop=function(){this.g&&this.g.stop(),this.s&&Na(this.s)},qd.prototype.release=function(){this.stop(),this.A&&this.A.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy(),this.C.destroy()},(i=Xd.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return this.s},i.getDuration=function(){var e=this.g.duration;return isNaN(e)?-1:e},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){var e=this.g.duration;return isNaN(e)?-1:e-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return this.h&&null!=this.l?this.getDuration()-this.getRemainingTime()<this.j+this.l:this.h},i.getTimeUntilSkippable=function(){if(this.isSkippable()){var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)}return Math.max(this.getRemainingTime(),0)},i.canSkipNow=function(){return this.h&&0==this.getTimeUntilSkippable()},i.skip=function(){this.canSkipNow()&&this.A()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return null==this.B},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.o},i.getPositionInSequence=function(){return this.m},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getAdId=function(){return this.i.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.i.uri},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.g=null},$("shaka.ads.InterstitialAd",Xd),Xd.prototype.release=Xd.prototype.release,Xd.prototype.getPodIndex=Xd.prototype.getPodIndex,Xd.prototype.getTimeOffset=Xd.prototype.getTimeOffset,Xd.prototype.getMediaUrl=Xd.prototype.getMediaUrl,Xd.prototype.getAdvertiserName=Xd.prototype.getAdvertiserName,Xd.prototype.getCreativeAdId=Xd.prototype.getCreativeAdId,Xd.prototype.getAdId=Xd.prototype.getAdId,Xd.prototype.getVastMediaWidth=Xd.prototype.getVastMediaWidth,Xd.prototype.getVastMediaHeight=Xd.prototype.getVastMediaHeight,Xd.prototype.getVastMediaBitrate=Xd.prototype.getVastMediaBitrate,Xd.prototype.getDescription=Xd.prototype.getDescription,Xd.prototype.getTitle=Xd.prototype.getTitle,Xd.prototype.getPositionInSequence=Xd.prototype.getPositionInSequence,Xd.prototype.getSequenceLength=Xd.prototype.getSequenceLength,Xd.prototype.setMuted=Xd.prototype.setMuted,Xd.prototype.resize=Xd.prototype.resize,Xd.prototype.isLinear=Xd.prototype.isLinear,Xd.prototype.isMuted=Xd.prototype.isMuted,Xd.prototype.setVolume=Xd.prototype.setVolume,Xd.prototype.getVolume=Xd.prototype.getVolume,Xd.prototype.play=Xd.prototype.play,Xd.prototype.pause=Xd.prototype.pause,Xd.prototype.skip=Xd.prototype.skip,Xd.prototype.canSkipNow=Xd.prototype.canSkipNow,Xd.prototype.getTimeUntilSkippable=Xd.prototype.getTimeUntilSkippable,Xd.prototype.isSkippable=Xd.prototype.isSkippable,Xd.prototype.isPaused=Xd.prototype.isPaused,Xd.prototype.getRemainingTime=Xd.prototype.getRemainingTime,Xd.prototype.getMinSuggestedDuration=Xd.prototype.getMinSuggestedDuration,Xd.prototype.getDuration=Xd.prototype.getDuration,Xd.prototype.isUsingAnotherMediaElement=Xd.prototype.isUsingAnotherMediaElement,Xd.prototype.hasCustomClick=Xd.prototype.hasCustomClick,Xd.prototype.isClientRendering=Xd.prototype.isClientRendering,Xd.prototype.needsSkipUI=Xd.prototype.needsSkipUI,(i=Yd.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return-1},i.isPaused=function(){return!1},i.isSkippable=function(){return!1},i.getTimeUntilSkippable=function(){return 0},i.canSkipNow=function(){return!1},i.skip=function(){},i.pause=function(){},i.play=function(){},i.getVolume=function(){return 1},i.setVolume=function(){},i.isMuted=function(){return!1},i.isLinear=function(){return this.i},i.resize=function(){},i.setMuted=function(){},i.getSequenceLength=function(){return this.j},i.getPositionInSequence=function(){return this.h},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getAdId=function(){return this.g.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.g.uri},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){},$("shaka.ads.InterstitialStaticAd",Yd),Yd.prototype.release=Yd.prototype.release,Yd.prototype.getPodIndex=Yd.prototype.getPodIndex,Yd.prototype.getTimeOffset=Yd.prototype.getTimeOffset,Yd.prototype.getMediaUrl=Yd.prototype.getMediaUrl,Yd.prototype.getAdvertiserName=Yd.prototype.getAdvertiserName,Yd.prototype.getCreativeAdId=Yd.prototype.getCreativeAdId,Yd.prototype.getAdId=Yd.prototype.getAdId,Yd.prototype.getVastMediaWidth=Yd.prototype.getVastMediaWidth,Yd.prototype.getVastMediaHeight=Yd.prototype.getVastMediaHeight,Yd.prototype.getVastMediaBitrate=Yd.prototype.getVastMediaBitrate,Yd.prototype.getDescription=Yd.prototype.getDescription,Yd.prototype.getTitle=Yd.prototype.getTitle,Yd.prototype.getPositionInSequence=Yd.prototype.getPositionInSequence,Yd.prototype.getSequenceLength=Yd.prototype.getSequenceLength,Yd.prototype.setMuted=Yd.prototype.setMuted,Yd.prototype.resize=Yd.prototype.resize,Yd.prototype.isLinear=Yd.prototype.isLinear,Yd.prototype.isMuted=Yd.prototype.isMuted,Yd.prototype.setVolume=Yd.prototype.setVolume,Yd.prototype.getVolume=Yd.prototype.getVolume,Yd.prototype.play=Yd.prototype.play,Yd.prototype.pause=Yd.prototype.pause,Yd.prototype.skip=Yd.prototype.skip,Yd.prototype.canSkipNow=Yd.prototype.canSkipNow,Yd.prototype.getTimeUntilSkippable=Yd.prototype.getTimeUntilSkippable,Yd.prototype.isSkippable=Yd.prototype.isSkippable,Yd.prototype.isPaused=Yd.prototype.isPaused,Yd.prototype.getRemainingTime=Yd.prototype.getRemainingTime,Yd.prototype.getMinSuggestedDuration=Yd.prototype.getMinSuggestedDuration,Yd.prototype.getDuration=Yd.prototype.getDuration,Yd.prototype.isUsingAnotherMediaElement=Yd.prototype.isUsingAnotherMediaElement,Yd.prototype.hasCustomClick=Yd.prototype.hasCustomClick,Yd.prototype.isClientRendering=Yd.prototype.isClientRendering,Yd.prototype.needsSkipUI=Yd.prototype.needsSkipUI,(i=Qd.prototype).configure=function(e){this.O=e,Jd(this)},i.stop=function(){this.l&&this.l.Ma(),this.K.clear(),this.F.clear(),this.g.cf(),this.C.clear(),this.g.detach(),this.I=!1,this.s=this.m=null,this.A=!0,this.h=this.i,this.H=null,this.G&&Na(this.G),this.o&&(this.o.stop(),this.o=null)},i.release=function(){this.stop(),this.L&&this.L.release(),this.l&&this.l.release(),this.M&&(this.M.stop(),this.M=null),this.P&&(this.P.stop(),this.P=null),this.g.destroy()},i.yf=function(){return this.g},i.addAdUrlInterstitial=function(e){var t,n,i,r,s,a,o,l,u,h=this;return M((function(f){switch(f.g){case 1:return S(f,sh(h,e,t={type:12}),2);case 2:if(n=f.h,!(i=Rt(n,"VAST,vmap:VMAP")))throw new Me(2,10,10007);if(r=[],"VAST"==i.tagName){r=Vd(i,h.m),f.u(3);break}if("vmap:VMAP"!=i.tagName){f.u(3);break}for(var p=[],g=c(Ut(i,"vmap:AdBreak")),m=g.next();!m.done;m=g.next()){var y=m.value,v=y.attributes.timeOffset;v&&(m=null,m="start"==v?0:"end"==v?1/0:At(v),(y=$t(y,"vmap:AdSource"))&&(y=$t(y,"vmap:AdTagURI"))&&(y=Ft(y))&&p.push({time:m,uri:y}))}s=c(p),a=s.next();case 5:if(a.done){f.u(3);break}return o=a.value,S(f,sh(h,o.uri,t),8);case 8:if(l=f.h,!(u=Rt(l,"VAST")))throw new Me(2,10,10007);r.push.apply(r,d(Vd(u,o.time))),a=s.next(),f.u(5);break;case 3:eh(h,r),_(f)}}))},(i=oh.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.h.durationInSeconds},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return"number"==typeof this.j},i.getTimeUntilSkippable=function(){if("number"!=typeof this.j)return this.getRemainingTime();var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.m=!0,this.g.currentTime+=this.getRemainingTime()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return this.o},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.l?this.l:1},i.getPositionInSequence=function(){return this.i?this.i:1},i.getTitle=function(){return this.h.adTitle},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getAdId=function(){return this.h.adId},i.getCreativeAdId=function(){return this.h.creativeId},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.l=this.i=this.g=this.h=null},$("shaka.ads.MediaTailorAd",oh),oh.prototype.release=oh.prototype.release,oh.prototype.getPodIndex=oh.prototype.getPodIndex,oh.prototype.getTimeOffset=oh.prototype.getTimeOffset,oh.prototype.getMediaUrl=oh.prototype.getMediaUrl,oh.prototype.getAdvertiserName=oh.prototype.getAdvertiserName,oh.prototype.getCreativeAdId=oh.prototype.getCreativeAdId,oh.prototype.getAdId=oh.prototype.getAdId,oh.prototype.getVastMediaWidth=oh.prototype.getVastMediaWidth,oh.prototype.getVastMediaHeight=oh.prototype.getVastMediaHeight,oh.prototype.getVastMediaBitrate=oh.prototype.getVastMediaBitrate,oh.prototype.getDescription=oh.prototype.getDescription,oh.prototype.getTitle=oh.prototype.getTitle,oh.prototype.getPositionInSequence=oh.prototype.getPositionInSequence,oh.prototype.getSequenceLength=oh.prototype.getSequenceLength,oh.prototype.setMuted=oh.prototype.setMuted,oh.prototype.resize=oh.prototype.resize,oh.prototype.isLinear=oh.prototype.isLinear,oh.prototype.isMuted=oh.prototype.isMuted,oh.prototype.setVolume=oh.prototype.setVolume,oh.prototype.getVolume=oh.prototype.getVolume,oh.prototype.play=oh.prototype.play,oh.prototype.pause=oh.prototype.pause,oh.prototype.skip=oh.prototype.skip,oh.prototype.canSkipNow=oh.prototype.canSkipNow,oh.prototype.getTimeUntilSkippable=oh.prototype.getTimeUntilSkippable,oh.prototype.isSkippable=oh.prototype.isSkippable,oh.prototype.isPaused=oh.prototype.isPaused,oh.prototype.getRemainingTime=oh.prototype.getRemainingTime,oh.prototype.getMinSuggestedDuration=oh.prototype.getMinSuggestedDuration,oh.prototype.getDuration=oh.prototype.getDuration,oh.prototype.isUsingAnotherMediaElement=oh.prototype.isUsingAnotherMediaElement,oh.prototype.hasCustomClick=oh.prototype.hasCustomClick,oh.prototype.isClientRendering=oh.prototype.isClientRendering,oh.prototype.needsSkipUI=oh.prototype.needsSkipUI,lh.prototype.stop=function(){for(var e=c(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.o.bb(t.target,t.type,t.listener);fh(this),this.m=[],this.s=[],this.G="",this.O=!0,this.H="",this.A=null,this.j=[],this.M=[],this.F.clear()},lh.prototype.release=function(){this.stop(),this.o&&this.o.release()},lh.prototype.onManifestUpdated=function(e){this.I=e,""!=this.G&&(function(e,t,n){var i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b;M((function(T){if(1==T.g)return i={type:8},r=ns([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),s=e.K.request(7,r,i),w(T,2),S(T,s.promise,4);if(2!=T.g){if(a=T.h,o=[],l=pt(a.data),0<(u=JSON.parse(l)).avails.length){if(JSON.stringify(e.j)!=JSON.stringify(u.avails)){for(e.j=u.avails,d=c(e.j),h=d.next();!h.done;h=d.next())for(f=h.value,p=c(f.nonLinearAdsList),g=p.next();!g.done;g=p.next())for(m=g.value,y=c(m.nonLinearAdList),v=y.next();!v.done;v=y.next())b=v.value,uh(e,b);o=e.getCuePoints(),e.i(new Kr("ad-cue-points-changed",(new Map).set("cuepoints",o)))}}else e.j.length&&e.i(new Kr("ad-cue-points-changed",(new Map).set("cuepoints",o))),fh(e),e.j=[];return n&&(e.I||0<o.length)&&function(e){hh(e),e.I||(dh(e),e.o.D(e.h,"seeked",(function(){dh(e)})),e.o.D(e.h,"ended",(function(){fh(e)}))),e.o.D(e.h,"timeupdate",(function(){hh(e)}))}(e),k(T,0)}x(T),_(T)}))}(this,this.G,this.O),this.O=!1)},lh.prototype.getCuePoints=function(){for(var e=[],t=c(this.j),n=t.next();!n.done;n=t.next())for(var i=(n=c(n.value.ads)).next();!i.done;i=n.next())i=i.value,e.push({start:i.startTimeInSeconds,end:i.startTimeInSeconds+i.durationInSeconds});return e},(i=mh.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.i?this.i.duration:-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},i.isPaused=function(){return this.h.paused},i.isSkippable=function(){return this.g.isSkippable()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.h.currentTime+=this.getRemainingTime()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.play()},i.getVolume=function(){return this.h.volume},i.setVolume=function(e){this.h.volume=e},i.isMuted=function(){return this.h.muted},i.isLinear=function(){return!0},i.resize=function(){},i.setMuted=function(e){this.h.muted=e},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.i=this.g=null},$("shaka.ads.ServerSideAd",mh),mh.prototype.release=mh.prototype.release,mh.prototype.getPodIndex=mh.prototype.getPodIndex,mh.prototype.getTimeOffset=mh.prototype.getTimeOffset,mh.prototype.getMediaUrl=mh.prototype.getMediaUrl,mh.prototype.getAdvertiserName=mh.prototype.getAdvertiserName,mh.prototype.getCreativeAdId=mh.prototype.getCreativeAdId,mh.prototype.getAdId=mh.prototype.getAdId,mh.prototype.getVastMediaWidth=mh.prototype.getVastMediaWidth,mh.prototype.getVastMediaHeight=mh.prototype.getVastMediaHeight,mh.prototype.getVastMediaBitrate=mh.prototype.getVastMediaBitrate,mh.prototype.getDescription=mh.prototype.getDescription,mh.prototype.getTitle=mh.prototype.getTitle,mh.prototype.getPositionInSequence=mh.prototype.getPositionInSequence,mh.prototype.getSequenceLength=mh.prototype.getSequenceLength,mh.prototype.setMuted=mh.prototype.setMuted,mh.prototype.resize=mh.prototype.resize,mh.prototype.isLinear=mh.prototype.isLinear,mh.prototype.isMuted=mh.prototype.isMuted,mh.prototype.setVolume=mh.prototype.setVolume,mh.prototype.getVolume=mh.prototype.getVolume,mh.prototype.play=mh.prototype.play,mh.prototype.pause=mh.prototype.pause,mh.prototype.skip=mh.prototype.skip,mh.prototype.canSkipNow=mh.prototype.canSkipNow,mh.prototype.getTimeUntilSkippable=mh.prototype.getTimeUntilSkippable,mh.prototype.isSkippable=mh.prototype.isSkippable,mh.prototype.isPaused=mh.prototype.isPaused,mh.prototype.getRemainingTime=mh.prototype.getRemainingTime,mh.prototype.getMinSuggestedDuration=mh.prototype.getMinSuggestedDuration,mh.prototype.getDuration=mh.prototype.getDuration,mh.prototype.isUsingAnotherMediaElement=mh.prototype.isUsingAnotherMediaElement,mh.prototype.hasCustomClick=mh.prototype.hasCustomClick,mh.prototype.isClientRendering=mh.prototype.isClientRendering,mh.prototype.needsSkipUI=mh.prototype.needsSkipUI,(i=yh.prototype).configure=function(){},i.stop=function(){this.B="",this.o=null,this.C=[]},i.release=function(){this.stop(),this.h&&this.h.release()},i.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},i.getCuePoints=function(){return this.C},y(vh,Yr),(i=vh.prototype).setLocale=function(e){this.o=e},i.configure=function(e){this.l=e,this.g&&this.g.configure(this.l),this.j&&this.j.configure(this.l),this.h&&this.h.configure(this.l)},i.initInterstitial=function(e,t,n){var i=this;this.g&&this.g.release(),this.g=new Qd(e,t,n,(function(e){return bh(i,e)})),this.g.configure(this.l)},i.initClientSide=function(t,n,i){var r=this;if(!e.google||!google.ima||!google.ima.AdsLoader)throw new Me(2,10,1e4);this.j&&this.j.release(),this.j=new qd(t,n,this.o,i,(function(e){return bh(r,e)})),this.j.configure(this.l)},i.release=function(){this.g&&(this.g.release(),this.g=null),this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.h&&(this.h.release(),this.h=null),Yr.prototype.release.call(this)},i.onAssetUnload=function(){this.g&&this.g.stop(),this.j&&this.j.stop(),this.i&&this.i.stop(),this.h&&this.h.stop(),this.dispatchEvent(new Kr("ad-stopped")),this.dispatchEvent(new Kr("ad-content-attach-requested")),this.m=new Fd},i.requestClientSideAds=function(e){if(!this.j)throw new Me(1,10,10001);var t=this.j;t.g&&t.g.destroy(),t.m&&t.m.contentComplete(),t.G=Date.now()/1e3,t.m.requestAds(e)},i.updateClientSideAdsRenderingSettings=function(e){if(!this.j)throw new Me(1,10,10001);var t=this.j;t.B=e,t.g&&t.g.updateAdsRenderingSettings(t.B)},i.initMediaTailor=function(e,t,n){var i=this;this.i&&this.i.release(),this.i=new lh(e,t,n,(function(e){return bh(i,e)}))},i.requestMediaTailorStream=function(e,t,n){if(!this.i)throw new Me(1,10,10005);var i=this.i;return n=void 0===n?"":n,i.l?e=Promise.reject(new Me(1,10,10004)):(i.l=new jr,function(e,t,n){var i,r,s,a,o,l,u,c,d,h,f,p;M((function(g){if(1==g.g)return i={type:7},(r=ns([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4})).method="POST",n&&(s=JSON.stringify(n),r.body=yt(s)),a=e.K.request(7,r,i),w(g,2),S(g,a.promise,4);if(2!=g.g){if(o=g.h,l=pt(o.data),!(u=JSON.parse(l)).manifestUrl||!u.trackingUrl)throw Error("Insufficient data from MediaTailor.");return c=new zn(t),d=new zn(u.trackingUrl),e.G=c.resolve(d).toString(),h=Date.now()/1e3,f=h-e.P,e.i(new Kr("ads-loaded",(new Map).set("loadTime",f))),p=new zn(u.manifestUrl),e.l.resolve(c.resolve(p).toString()),e.l=null,k(g,0)}if(x(g),!e.H.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,g.return();e.l.resolve(e.H),e.l=null,_(g)}))}(i,e,t),i.H=n||"",i.P=Date.now()/1e3,e=i.l),e},i.addMediaTailorTrackingUrl=function(e){if(!this.i)throw new Me(1,10,10005);var t=this.i;t.G=e,t.i(new Kr("ads-loaded",(new Map).set("loadTime",0)))},i.initServerSide=function(t,n){var i=this;if(!e.google||!google.ima||!google.ima.dai)throw new Me(2,10,10002);this.h&&this.h.release(),this.h=new yh(t,n,this.o,(function(e){return bh(i,e)})),this.h.configure(this.l)},i.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.h)throw new Me(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&X('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.13.8",(n=this.h).j?e=Promise.reject(new Me(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.G=!0),n.j=new jr,n.g.requestStream(e),n.B=t||"",n.F=Date.now()/1e3,e=n.j),e},i.replaceServerSideAdTagParameters=function(e){if(!this.h)throw new Me(1,10,10003);(e.mpt||e.mpv)&&X('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.mpt="Shaka Player",e.mpv="v4.13.8",this.h.g.replaceAdTagParameters(e)},i.getServerSideCuePoints=function(){return oe("AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},i.getCuePoints=function(){var e=[];return this.h&&(e=e.concat(this.h.getCuePoints())),this.i&&(e=e.concat(this.i.getCuePoints())),e},i.getStats=function(){var e=this.m;return{loadTimes:e.g,averageLoadTime:Bd(e),started:e.h,playedCompletely:e.j,skipped:e.l,errors:e.i}},i.onManifestUpdated=function(e){this.i&&this.i.onManifestUpdated(e)},i.onDashTimedMetadata=function(e){this.h&&"urn:google:dai:2018"==e.schemeIdUri&&this.h.g.processMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},i.onHlsTimedMetadata=function(e,t){this.h&&this.h.g.processMetadata("ID3",e.data,t)},i.onCueMetadataChange=function(e){this.h&&this.h.onCueMetadataChange(e)},i.onHLSInterstitialMetadata=function(e,t,n){this.l&&this.l.disableHLSInterstitial||(this.g||this.initInterstitial(null,e,t),this.g&&Zd(this.g,n))},i.onDASHInterstitialMetadata=function(e,t,n){if(!this.l||!this.l.disableDASHInterstitial){var i=n.schemeIdUri;if("urn:mpeg:dash:event:alternativeMPD:insert:2025"==i||"urn:mpeg:dash:event:alternativeMPD:replace:2025"==i){if(this.g||this.initInterstitial(null,e,t),this.g){for(e=this.g,i=(t=c(n.eventNode.children)).next();!i.done;i=t.next())if("AlternativeMPD"==(i=i.value).tagName&&(i=i.attributes.uri)){var r=i;break}r?(t="urn:mpeg:dash:event:alternativeMPD:replace:2025"==n.schemeIdUri,i="urn:mpeg:dash:event:alternativeMPD:insert:2025"==n.schemeIdUri,(t||i)&&eh(e,[{id:n.id,groupId:null,startTime:n.startTime,endTime:n.endTime,uri:r,mimeType:null,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:i?0:null,playoutLimit:null,once:!1,pre:!1,post:!1,timelineRange:t&&!i,loop:!1,overlay:null}])):X("Unsupported MPD alternate",n)}}else"urn:mpeg:dash:event:2012"==i&&n.eventNode&&$t(n.eventNode,"OverlayEvent")&&(this.g||this.initInterstitial(null,e,t),this.g&&function(e,t){var n=$t(t.eventNode,"OverlayEvent"),i=n.attributes.uri,r=n.attributes.mimeType,s="true"==n.attributes.loop;if(i&&r){var a={viewport:{x:1920,y:1080},topLeft:{x:0,y:0},size:{x:1920,y:1080}},o=$t(n,"Viewport"),l=$t(n,"TopLeft");if(n=$t(n,"Size"),o&&l&&n){if(null==(a=Ht(o,"x",Yt)))return;if(null==(o=Ht(o,"y",Yt)))return;var u=Ht(l,"x",Yt);if(null==u)return;if(null==(l=Ht(l,"y",Yt)))return;var c=Ht(n,"x",Yt);if(null==c)return;if(null==(n=Ht(n,"y",Yt)))return;a={viewport:{x:a,y:o},topLeft:{x:u,y:l},size:{x:c,y:n}}}eh(e,[{id:t.id,groupId:null,startTime:t.startTime,endTime:t.endTime,uri:i,mimeType:r,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:!1,pre:!1,post:!1,timelineRange:!0,loop:s,overlay:a}])}}(this.g,n))}},i.addCustomInterstitial=function(e){if(!this.g)throw new Me(1,10,10006);eh(this.g,[e])},i.addAdUrlInterstitial=function(e){if(!this.g)throw new Me(1,10,10006);return this.g.addAdUrlInterstitial(e)},i.getInterstitialPlayer=function(){if(!this.g)throw new Me(1,10,10006);return this.g.yf()},$("shaka.ads.AdManager",vh),vh.prototype.getInterstitialPlayer=vh.prototype.getInterstitialPlayer,vh.prototype.addAdUrlInterstitial=vh.prototype.addAdUrlInterstitial,vh.prototype.addCustomInterstitial=vh.prototype.addCustomInterstitial,vh.prototype.onDASHInterstitialMetadata=vh.prototype.onDASHInterstitialMetadata,vh.prototype.onHLSInterstitialMetadata=vh.prototype.onHLSInterstitialMetadata,vh.prototype.onCueMetadataChange=vh.prototype.onCueMetadataChange,vh.prototype.onHlsTimedMetadata=vh.prototype.onHlsTimedMetadata,vh.prototype.onDashTimedMetadata=vh.prototype.onDashTimedMetadata,vh.prototype.onManifestUpdated=vh.prototype.onManifestUpdated,vh.prototype.getStats=vh.prototype.getStats,vh.prototype.getCuePoints=vh.prototype.getCuePoints,vh.prototype.getServerSideCuePoints=vh.prototype.getServerSideCuePoints,vh.prototype.replaceServerSideAdTagParameters=vh.prototype.replaceServerSideAdTagParameters,vh.prototype.requestServerSideStream=vh.prototype.requestServerSideStream,vh.prototype.initServerSide=vh.prototype.initServerSide,vh.prototype.addMediaTailorTrackingUrl=vh.prototype.addMediaTailorTrackingUrl,vh.prototype.requestMediaTailorStream=vh.prototype.requestMediaTailorStream,vh.prototype.initMediaTailor=vh.prototype.initMediaTailor,vh.prototype.updateClientSideAdsRenderingSettings=vh.prototype.updateClientSideAdsRenderingSettings,vh.prototype.requestClientSideAds=vh.prototype.requestClientSideAds,vh.prototype.onAssetUnload=vh.prototype.onAssetUnload,vh.prototype.release=vh.prototype.release,vh.prototype.initClientSide=vh.prototype.initClientSide,vh.prototype.initInterstitial=vh.prototype.initInterstitial,vh.prototype.configure=vh.prototype.configure,vh.prototype.setLocale=vh.prototype.setLocale,vh.ADS_LOADED="ads-loaded",vh.AD_STARTED="ad-started",vh.AD_FIRST_QUARTILE="ad-first-quartile",vh.AD_MIDPOINT="ad-midpoint",vh.AD_THIRD_QUARTILE="ad-third-quartile",vh.AD_COMPLETE="ad-complete",vh.AD_STOPPED="ad-stopped",vh.AD_SKIPPED="ad-skipped",vh.AD_VOLUME_CHANGED="ad-volume-changed",vh.AD_MUTED="ad-muted",vh.AD_PAUSED="ad-paused",vh.AD_RESUMED="ad-resumed",vh.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",vh.CUEPOINTS_CHANGED="ad-cue-points-changed",vh.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",vh.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",vh.AD_CLICKED="ad-clicked",vh.AD_PROGRESS="ad-progress",vh.AD_BUFFERING="ad-buffering",vh.AD_IMPRESSION="ad-impression",vh.AD_DURATION_CHANGED="ad-duration-changed",vh.AD_CLOSED="ad-closed",vh.AD_LOADED="ad-loaded",vh.ALL_ADS_COMPLETED="all-ads-completed",vh.AD_LINEAR_CHANGED="ad-linear-changed",vh.AD_METADATA="ad-metadata",vh.AD_RECOVERABLE_ERROR="ad-recoverable-error",vh.AD_ERROR="ad-error",vh.AD_BREAK_READY="ad-break-ready",vh.AD_INTERACTION="ad-interaction",vh.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",vh.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",vh.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",Ud=function(){return new vh};var _h="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),wh="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Eh=["loop","playbackRate"],kh=["pause","play"],xh=(new Map).set("getAssetUri",2).set("getAudioLanguages",4).set("getAudioLanguagesAndRoles",4).set("getBufferFullness",1).set("getBufferedInfo",2).set("getExpiration",2).set("getKeyStatuses",2).set("getPlaybackRate",2).set("getTextLanguages",4).set("getTextLanguagesAndRoles",4).set("getImageTracks",2).set("getThumbnails",2).set("isAudioOnly",10).set("isBuffering",1).set("isInProgress",1).set("isLive",10).set("isTextTrackVisible",1).set("keySystem",10).set("seekRange",1).set("getLoadMode",10).set("getManifestType",10).set("isFullyLoaded",1).set("isEnded",1),Ah=(new Map).set("getConfiguration",4).set("getConfigurationForLowLatency",4).set("getStats",5).set("getTextTracks",2).set("getVariantTracks",2),Ch=(new Map).set("getPlayheadTimeAsDate",1).set("getPresentationStartTimeAsDate",20).set("getSegmentAvailabilityDuration",20),Ih=[["getConfiguration","configure","getConfigurationForLowLatency","configurationForLowLatency"]],Lh=[["isTextTrackVisible","setTextTrackVisibility"]],Dh="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure configurationForLowLatency getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),Rh=["attach","attachCanvas","detach","load","unload"];function Mh(e,t,n,i,r,s,a){var o=this;this.G=e,this.K=a,this.l=new Ve(t),this.L=n,this.s=!1,this.A=i,this.F=r,this.M=s,this.i=this.m=!1,this.I="",this.o=null,this.B=function(){return Uh(o)},this.C=function(e,t){switch((e=Sh(t)).type){case"event":var n=e.targetName,i=Wr(e.event);o.A(n,i);break;case"update":for(i in n=e.update)for(var r in e=o.g[i]||{},n[i])e[r]=n[i][r];o.s&&(o.L(),o.s=!1);break;case"asyncComplete":if(i=e.id,r=e.error,e=o.h.get(i),o.h.delete(i),e)if(r){for(n in i=new Me(r.severity,r.category,r.code),r)i[n]=r[n];e.reject(i)}else e.resolve()}},this.g={video:{},player:{}},this.H=0,this.h=new Map,this.j=null,qh.add(this)}function Ph(e,t){var n=e.M();Vh=t,t.addUpdateListener(e.B),t.addMessageListener("urn:x-cast:com.google.shaka.v2",e.C),Uh(e),Bh(e,{type:"init",initState:n,appData:e.o}),e.j.resolve()}function Oh(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.j.reject(new Me(2,8,n,t))}function Nh(e){var t=Vh;t.removeUpdateListener(e.B),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.C)}function Uh(e){var t=!!Vh&&"connected"==Vh.status;if(e.i&&!t){for(var n in e.F(),e.g)e.g[n]={};Fh(e)}e.i=t,e.I=t?Vh.receiver.friendlyName:"",e.l.rb()}function Fh(e){if(e.h)for(var t=c(e.h.keys()),n=t.next();!n.done;n=t.next()){n=n.value;var i=e.h.get(n);e.h.delete(n),i.reject(new Me(1,7,7e3))}}function Bh(e,t){t=Th(t);var n=Vh;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,(function(){}),Q)}catch(i){throw t=new Me(2,8,8005,i),n=new Kr("error",(new Map).set("detail",t)),e.A("player",n),e.Mc(),t}}(i=Mh.prototype).destroy=function(){return qh.delete(this),Fh(this),Vh&&Nh(this),this.l&&(this.l.stop(),this.l=null),this.F=this.A=null,this.i=this.m=!1,this.C=this.B=this.j=this.h=this.g=this.o=null,Promise.resolve()},i.pb=function(){return this.i},i.Sf=function(){return this.I},i.init=function(){if(this.G.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.l.rb();var t=new chrome.cast.SessionRequest(this.G,[],null,this.K,null);t=new chrome.cast.ApiConfig(t,(function(e){for(var t=c(qh),n=t.next();!n.done;n=t.next()){var i=e;(n=n.value).j=new jr,n.s=!0,Ph(n,i)}}),(function(e){for(var t=c(qh),n=t.next();!n.done;n=t.next())n=n.value,$h="available"==e,n.l.rb()}),"origin_scoped"),chrome.cast.initialize(t,(function(){}),(function(){})),$h&&this.l.aa(jh),(t=Vh)&&t.status!=chrome.cast.SessionStatus.STOPPED?(this.j=new jr,this.s=!0,Ph(this,t)):Vh=null}else e.__onGCastApiAvailable!==Gh&&(Hh=e.__onGCastApiAvailable||null,e.__onGCastApiAvailable=Gh)},i.ag=function(e){this.o=e,this.i&&Bh(this,{type:"appData",appData:this.o})},i.cast=function(){var e=this;return M((function(t){if(!e.m)throw new Me(1,8,8e3);if(!$h)throw new Me(1,8,8001);if(e.i)throw new Me(1,8,8002);return e.j=new jr,chrome.cast.requestSession((function(t){return Ph(e,t)}),(function(t){return Oh(e,t)})),S(t,e.j,0)}))},i.Mc=function(){if(this.i){if(Fh(this),Vh){Nh(this);try{Vh.stop((function(){}),(function(){}))}catch(rw){}Vh=null}Uh(this)}},i.get=function(e,t){var n=this;if("video"==e){if(kh.includes(t))return function(){return n.hh.apply(n,[e,t].concat(d(P.apply(0,arguments))))}}else if("player"==e){if(Ch.has(t)&&!this.get("player","isLive")())return function(){};if(Dh.includes(t))return function(){return n.hh.apply(n,[e,t].concat(d(P.apply(0,arguments))))};if(Rh.includes(t))return function(){return n.dj.apply(n,[e,t].concat(d(P.apply(0,arguments))))};if(xh.has(t)||Ah.has(t))return function(){return n.g[e][t]}}return this.g[e][t]},i.set=function(e,t,n){this.g[e][t]=n,Bh(this,{type:"set",targetName:e,property:t,value:n})},i.hh=function(e,t){Bh(this,{type:"call",targetName:e,methodName:t,args:P.apply(2,arguments)})},i.dj=function(e,t){var n=P.apply(2,arguments),i=new jr,r=this.H.toString();this.H++,this.h.set(r,i);try{Bh(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:r})}catch(s){i.reject(s)}return i};var jh=.02,$h=!1,Vh=null,Hh=null,qh=new Set;function Gh(t){if(Hh?e.__onGCastApiAvailable=Hh:delete e.__onGCastApiAvailable,Hh=null,t)for(var n=c(qh),i=n.next();!i.done;i=n.next())i.value.init();"function"===typeof e.__onGCastApiAvailable&&e.__onGCastApiAvailable(t)}function zh(t,n,i,r){r=void 0!==r&&r,Yr.call(this);var s=this;this.i=t,this.h=n,this.m=this.o=this.l=this.s=this.j=null,this.C=i,this.B=r,this.A=new Map,this.g=null,e.chrome?(this.g=new Mh(i,(function(){return Xh(s)}),(function(){return Yh(s)}),(function(e,t){return Zh(s,e,t)}),(function(){return Qh(s)}),(function(){return Wh(s)}),r),function(e){e.g.init(),e.m=new ee;for(var t=c(_h),n=t.next();!n.done;n=t.next())e.m.D(e.i,n.value,(function(t){e.g.pb()||(t=Wr(t),e.l.dispatchEvent(t))}));for(var i in Xr)e.m.D(e.h,Xr[i],(function(t){e.g.pb()||e.o.dispatchEvent(t)}));for(var r in e.j={},t={},e.i)(t={vd:t.vd}).vd=r,Object.defineProperty(e.j,t.vd,{configurable:!1,enumerable:!0,get:function(t){return function(){return Jh(e,t.vd)}}(t),set:function(t){return function(n){var i=t.vd;e.g.pb()?e.g.set("video",i,n):e.i[i]=n}}(t)});e.s={},Kh(e,(function(t){Object.defineProperty(e.s,t,{configurable:!1,enumerable:!0,get:function(){return function(e,t){if(e.A.has(t)&&(t=e.A.get(t)),"addEventListener"==t)return function(t,n,i){return e.o.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.o.removeEventListener(t,n,i)};if("getMediaElement"==t)return function(){return e.j};if("getSharedConfiguration"==t)return e.g.get("player","getConfiguration");if("getNetworkingEngine"==t)return function(){return e.h.xb()};if("getDrmEngine"==t)return function(){return e.h.C};if("getAdManager"==t)return function(){return e.h.Jg()};if("setVideoContainer"==t)return function(t){return e.h.uh(t)};if(e.g.pb()){if("getManifest"==t||"drmInfo"==t)return function(){return X(t+"() does not work while casting!"),null};if("attach"==t||"detach"==t)return function(){return X(t+"() does not work while casting!"),Promise.resolve()}}return e.g.pb()&&0==Object.keys(e.g.g.video).length&&(xh.has(t)||Ah.has(t))||!e.g.pb()?e.h[t].bind(e.h):e.g.get("player",t)}(e,t)}})})),function(e){var t=new Map;Kh(e,(function(n,i){t.has(i)?(i=t.get(i),n.length<i.length?e.A.set(n,i):e.A.set(i,n)):t.set(i,n)}))}(e),e.l=new Yr,e.l.ze=e.j,e.o=new Yr,e.o.ze=e.s}(this)):(this.j=this.i,this.s=this.h)}function Kh(e,t){function n(e){return"constructor"!=e&&"function"==typeof r[e]&&!s.has(e)}var i,r=e.h,s=new Set;for(i in r)n(i)&&(s.add(i),t(i,r[i]));for(e=Object.getPrototypeOf(r),i=Object.getPrototypeOf({});e&&e!=i;){for(var a=c(Object.getOwnPropertyNames(e)),o=a.next();!o.done;o=a.next())n(o=o.value)&&(s.add(o),t(o,r[o]));e=Object.getPrototypeOf(e)}}function Wh(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.Nc(),startTime:null};e.i.pause();for(var n=c(Eh),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.i[i];for(e.i.ended||(t.startTime=e.i.currentTime),i=(n=c(Ih)).next();!i.done;i=n.next()){var r=i.value;i=r[1],r=e.h[r[0]](),t.player[i]=r}for(i=(n=c(Lh)).next();!i.done;i=n.next())i=(r=i.value)[1],r=e.h[r[0]](),t.playerAfterLoad[i]=r;return t}function Xh(e){var t=new Kr("caststatuschanged");e.dispatchEvent(t)}function Yh(e){var t=new Kr(e.j.paused?"pause":"play");e.l.dispatchEvent(t)}function Qh(e){for(var t=c(Ih),n=t.next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}var r=e.g.get("player","getAssetUri")();i=e.g.get("video","ended"),t=Promise.resolve();var s,a=e.i.autoplay;n=null,i||(n=e.g.get("video","currentTime")),(i=e.g.get("player","getTextTracks")())&&i.length&&(s=i.find((function(e){return e.active})));var o=e.g.get("player","isTextTrackVisible")();r&&(e.i.autoplay=!1,t=e.h.load(r,n));var l={};for(i=(n=c(Eh)).next();!i.done;i=n.next())i=i.value,l[i]=e.g.get("video",i);t.then((function(){if(e.i){for(var t=c(Eh),n=t.next();!n.done;n=t.next())n=n.value,e.i[n]=l[n];for(n=(t=c(Lh)).next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}e.h.rh(o),s&&e.h.Zf(s.language,s.roles,s.forced),e.i.autoplay=a,r&&e.i.play()}}),(function(t){t=new Kr("error",t=(new Map).set("detail",t)),e.h.dispatchEvent(t)}))}function Jh(e,t){if("addEventListener"==t)return function(t,n,i){return e.l.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.l.removeEventListener(t,n,i)};if(e.g.pb()&&0==Object.keys(e.g.g.video).length){var n=e.i[t];if("function"!=typeof n)return n}return e.g.pb()?e.g.get("video",t):("function"==typeof(t=e.i[t])&&(t=t.bind(e.i)),t)}function Zh(e,t,n){e.g.pb()&&("video"==t?e.l.dispatchEvent(n):"player"==t&&e.o.dispatchEvent(n))}function ef(e,t,n,i){Yr.call(this);var r=this;this.g=e,this.h=t,this.j=new ee,this.H={video:e,player:t},this.F=n||function(){},this.I=i||function(e){return e},this.i=null,this.G=!1,this.o=!0,this.m=0,this.B=!1,this.A=!0,this.s=this.l=null,this.C=new Ve((function(){sf(r)})),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return tf(e)},t.onSenderDisconnected=function(){return tf(e)},t.onSystemVolumeChanged=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&uf(e,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},e.l),uf(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.s=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.s.onMessage=function(t){return function(e,t){var n=Sh(t.data);switch(n.type){case"PLAY":e.g.play(),cf(e);break;case"PAUSE":e.g.pause(),cf(e);break;case"SEEK":t=n.currentTime;var i=n.resumeState;null!=t&&(e.g.currentTime=Number(t)),i&&"PLAYBACK_START"==i?(e.g.play(),cf(e)):i&&"PLAYBACK_PAUSE"==i&&(e.g.pause(),cf(e));break;case"STOP":e.h.kc().then((function(){e.h&&cf(e)}));break;case"GET_STATUS":of(e,Number(n.requestId));break;case"VOLUME":t=(i=n.volume).level,i=i.muted;var r=e.g.volume,s=e.g.muted;null!=t&&(e.g.volume=Number(t)),null!=i&&(e.g.muted=i),r==e.g.volume&&s==e.g.muted||cf(e);break;case"LOAD":e.m=0,e.B=!1,e.A=!1,t=n.media,i=n.currentTime,r=e.I(t.contentId),s=n.autoplay||!0,e.F(t.customData),s&&(e.g.autoplay=!0),e.h.load(r,i).then((function(){e.h&&of(e)})).catch((function(t){var i="LOAD_FAILED";7==t.category&&7e3==t.code&&(i="LOAD_CANCELLED"),uf(e,{requestId:Number(n.requestId),type:i},e.s)}));break;default:uf(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.s)}}(e,t)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(t){return function(e,t){var n=Sh(t.data);switch(n.type){case"init":e.m=0,e.B=!1,e.A=!0,function(e,t,n){var i,r,s,a,o,l,u,c,d,h;M((function(f){switch(f.g){case 1:for(i in t.player)r=t.player[i],e.h[i](r);return e.F(n),s=e.g.autoplay,t.manifest?(e.g.autoplay=!1,w(f,5),S(f,e.h.load(t.manifest,t.startTime),7)):S(f,Promise.resolve(),3);case 7:k(f,3);break;case 5:return a=x(f),o=(new Map).set("detail",a),l=new Kr("error",o),e.h&&e.h.dispatchEvent(l),f.return();case 3:if(!e.h)return f.return();for(u in t.video)c=t.video[u],e.g[u]=c;for(d in t.playerAfterLoad)h=t.playerAfterLoad[d],e.h[d](h);e.g.autoplay=s,t.manifest&&(e.g.play(),cf(e)),_(f)}}))}(e,n.initState,n.appData),sf(e);break;case"appData":e.F(n.appData);break;case"set":var i=n.targetName,r=n.property;if(n=n.value,"video"==i){if(t=cast.receiver.CastReceiverManager.getInstance(),"volume"==r){t.setSystemVolumeLevel(n);break}if("muted"==r){t.setSystemVolumeMuted(n);break}}e.H[i][r]=n;break;case"call":(i=e.H[n.targetName])[n.methodName].apply(i,n.args);break;case"asyncCall":i=n.targetName,r=n.methodName,"player"==i&&"load"==r&&(e.m=0,e.B=!1);var s=n.id,a=t.senderId;n=(t=e.H[i])[r].apply(t,n.args),"player"==i&&"load"==r&&(n=n.then((function(){e.A=!0}))),n.then((function(){return lf(e,a,s,null)}),(function(t){return lf(e,a,s,t)}))}}(e,t)},t.start();for(var n=(t=c(_h)).next();!n.done;n=t.next())e.j.D(e.g,n.value,(function(t){return rf(e,"video",t)}));for(var i in Xr)e.j.D(e.h,Xr[i],(function(t){return rf(e,"player",t)}));e.j.D(e.g,"loadeddata",(function(){e.B=!0})),e.j.D(e.h,"loading",(function(){e.o=!1,nf(e)})),e.j.D(e.g,"playing",(function(){e.o=!1,nf(e)})),e.j.D(e.g,"pause",(function(){nf(e)})),e.j.D(e.h,"unloading",(function(){e.o=!0,nf(e)})),e.j.D(e.g,"ended",(function(){new Ve((function(){e.g&&e.g.ended&&(e.o=!0,nf(e))})).aa(hf)}))}(this)}function tf(e){e.m=0,e.A=!0,e.G=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,nf(e)}function nf(e){var t;M((function(n){return 1==n.g?S(n,Promise.resolve(),2):e.h?(t=new Kr("caststatuschanged"),e.dispatchEvent(t),af(e)||cf(e),void _(n)):n.return()}))}function rf(e,t,n){e.h&&(sf(e),uf(e,{type:"event",targetName:t,event:n},e.l))}function sf(e){e.C.aa(df);for(var t={video:{},player:{}},n=c(wh),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.g[i];e.h.T()&&Ch.forEach((function(n,i){0==e.m%n&&(t.player[i]=e.h[i]())})),xh.forEach((function(n,i){0==e.m%n&&(t.player[i]=e.h[i]())})),(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),uf(e,{type:"update",update:t},e.l),Ah.forEach((function(t,n){0==e.m%t&&((t={player:{}}).player[n]=e.h[n](),uf(e,{type:"update",update:t},e.l))})),e.B&&(e.m+=1),af(e)}function af(e){return!(!e.A||!e.g.duration&&!e.h.T())&&(of(e),e.A=!1,!0)}function of(e,t){var n={contentId:e.h.Nc(),streamType:e.h.T()?"LIVE":"BUFFERED",contentType:""};e.h.T()||(n.duration=e.g.duration),e.i&&(n.metadata=e.i),cf(e,void 0===t?0:t,n)}function lf(e,t,n,i){e.h&&uf(e,{type:"asyncComplete",id:n,error:i},e.l,t)}function uf(e,t,n,i){e.G&&(e=Th(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function cf(e,t,n){n=void 0===n?null:n;var i={mediaSessionId:0,playbackRate:e.g.playbackRate,playerState:e.o?ff:e.h.Ef()?gf:e.g.paused?mf:pf,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}};n&&(i.media=n),uf(e,{requestId:void 0===t?0:t,type:"MEDIA_STATUS",status:[i]},e.s)}y(zh,Yr),(i=zh.prototype).destroy=function(e){return e&&this.g.Mc(),this.m&&(this.m.release(),this.m=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.s=this.j=this.i=null,Yr.prototype.release.call(this),Promise.all(e)},i.Ai=function(){return this.j},i.yf=function(){return this.s},i.Oh=function(){return!!this.g&&(this.g.m&&$h)},i.pb=function(){return!!this.g&&this.g.pb()},i.Sf=function(){return this.g?this.g.Sf():""},i.cast=function(){var e=this;return M((function(t){return 1==t.g?e.g?S(t,e.g.cast(),2):t.return():e.h?S(t,e.h.kc(),0):t.return()}))},i.ag=function(e){this.g&&this.g.ag(e)},i.sj=function(){var e;this.g&&((e=this.g).i&&chrome.cast.requestSession((function(t){return Ph(e,t)}),(function(t){return Oh(e,t)})))},i.Mc=function(){this.g&&this.g.Mc()},i.Ph=function(e,t){t=void 0!==t&&t;var n=this;return M((function(i){if(1==i.g)return e==n.C&&t==n.B?i.return():(n.C=e,n.B=t,n.g?(n.g.Mc(),S(i,n.g.destroy(),2)):i.return());n.g=null,n.g=new Mh(e,(function(){return Xh(n)}),(function(){return Yh(n)}),(function(e,t){return Zh(n,e,t)}),(function(){return Qh(n)}),(function(){return Wh(n)}),t),n.g.init(),_(i)}))},$("shaka.cast.CastProxy",zh),zh.prototype.changeReceiverId=zh.prototype.Ph,zh.prototype.forceDisconnect=zh.prototype.Mc,zh.prototype.suggestDisconnect=zh.prototype.sj,zh.prototype.setAppData=zh.prototype.ag,zh.prototype.cast=zh.prototype.cast,zh.prototype.receiverName=zh.prototype.Sf,zh.prototype.isCasting=zh.prototype.pb,zh.prototype.canCast=zh.prototype.Oh,zh.prototype.getPlayer=zh.prototype.yf,zh.prototype.getVideo=zh.prototype.Ai,zh.prototype.destroy=zh.prototype.destroy,y(ef,Yr),(i=ef.prototype).isConnected=function(){return this.G},i.Hi=function(){return this.o},i.oj=function(e){this.i=e},i.Th=function(){this.i=null},i.pj=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},i.nj=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},i.mj=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},i.destroy=function(){var e,t=this;return M((function(n){if(1==n.g)return t.j&&(t.j.release(),t.j=null),e=[],t.h&&(e.push(t.h.destroy()),t.h=null),t.C&&(t.C.stop(),t.C=null),t.g=null,t.H=null,t.F=null,t.G=!1,t.o=!0,t.l=null,t.s=null,Yr.prototype.release.call(t),S(n,Promise.all(e),2);cast.receiver.CastReceiverManager.getInstance().stop(),_(n)}))},$("shaka.cast.CastReceiver",ef),ef.prototype.destroy=ef.prototype.destroy,ef.prototype.setContentArtist=ef.prototype.mj,ef.prototype.setContentImage=ef.prototype.nj,ef.prototype.setContentTitle=ef.prototype.pj,ef.prototype.clearContentMetadata=ef.prototype.Th,ef.prototype.setContentMetadata=ef.prototype.oj,ef.prototype.isIdle=ef.prototype.Hi,ef.prototype.isConnected=ef.prototype.isConnected;var df=.5,hf=5,ff="IDLE",pf="PLAYING",gf="BUFFERING",mf="PAUSED";function yf(e,t,n,i,r){if(i>=r)return null;for(var s=-1,a=-1,o=0;o<n.length;o++)if(n[o].some((function(e){return null!=e&&""!=e.g.trim()}))){s=o;break}for(o=n.length-1;0<=o;o--)if(n[o].some((function(e){return null!=e&&""!=e.g.trim()}))){a=o;break}if(-1===s||-1===a)return null;for(var l=o=!1,u="white",c="black",d=vf(i,r,o,l,u,c);s<=a;s++){for(var h=n[s],f=-1,p=-1,g=0;g<h.length;g++)if(null!=h[g]&&""!==h[g].g.trim()){f=g;break}for(g=h.length-1;0<=g;g--)if(null!=h[g]&&""!==h[g].g.trim()){p=g;break}if(-1===f||-1===p)h=bf(i,r),e.nestedCues.push(h);else{for(;f<=p;f++)if(g=h[f]){var m=g.l,y=g.i,v=g.j,b=g.h;m==o&&y==l&&v==u&&b==c||(d.payload&&e.nestedCues.push(d),d=vf(i,r,m,y,v,b),o=m,l=y,u=v,c=b),d.payload+=g.g}else d.payload+=" ";d.payload&&e.nestedCues.push(d),s!==a&&(d=bf(i,r),e.nestedCues.push(d)),d=vf(i,r,o,l,u,c)}}return e.nestedCues.length?{cue:e,stream:t}:null}function vf(e,t,n,i,r,s){return e=new dn(e,t,""),n&&e.textDecoration.push(On),i&&(e.fontStyle=Mn),e.color=r,e.backgroundColor=s,e}function bf(e,t){return(e=new dn(e,t,"")).lineBreak=!0,e}function Tf(e,t,n,i,r){this.g=e,this.l=t,this.i=n,this.h=i,this.j=r}function Sf(e,t){this.i=[],this.g=1,this.h=0,this.C=e,this.B=t,this.j=this.m=!1,this.l="white",this.o="black",this.s=this.A=null,wf(this)}function _f(e,t,n){var i="CC"+(1+(e.C<<1|e.B)),r=new dn(t,n,"");r.lineInterpretation=1;var s=Df.get(e.g);return s&&(r.line=s),null!=e.s&&null!=e.A&&(r.position=10+Math.min(70,10*e.s)+2.5*e.A),(t=yf(r,i,e.i,t,n))&&15<e.g+t.cue.nestedCues.length-3&&(s=Df.get(e.g+3-t.cue.nestedCues.length))&&(r.line=s),t}function wf(e){xf(e,0,15),e.g=1}function Ef(e,t,n){if(!(32>n||127<n)){var i="";switch(t){case 0:i=Af.has(n)?Af.get(n):String.fromCharCode(n);break;case 1:i=Cf.get(n);break;case 2:e.i[e.g].pop(),i=If.get(n);break;case 3:e.i[e.g].pop(),i=Lf.get(n)}i&&e.i[e.g].push(new Tf(i,e.m,e.j,e.o,e.l))}}function kf(e,t,n,i){if(!(0>n||0>t))if(t>=n)for(--i;0<=i;i--)e.i[t+i]=e.i[n+i].map((function(e){return e}));else for(var r=0;r<i;r++)e.i[t+r]=e.i[n+r].map((function(e){return e}))}function xf(e,t,n){for(var i=0;i<=n;i++)e.i[t+i]=[]}var Af=new Map([[39,"\u2019"],[42,"\xe1"],[92,"\xe9"],[92,"\xe9"],[94,"\xed"],[95,"\xf3"],[96,"\xfa"],[123,"\xe7"],[124,"\xf7"],[125,"\xd1"],[126,"\xf1"],[127,"\u2588"]]),Cf=new Map([[48,"\xae"],[49,"\xb0"],[50,"\xbd"],[51,"\xbf"],[52,"\u2122"],[53,"\xa2"],[54,"\xa3"],[55,"\u266a"],[56,"\xe0"],[57," "],[58,"\xe8"],[59,"\xe2"],[60,"\xea"],[61,"\xee"],[62,"\xf4"],[63,"\xfb"]]),If=new Map([[32,"\xc1"],[33,"\xc9"],[34,"\xd3"],[35,"\xda"],[36,"\xdc"],[37,"\xfc"],[38,"\u2018"],[39,"\xa1"],[40,"*"],[41,"'"],[42,"\u2500"],[43,"\xa9"],[44,"\u2120"],[45,"\xb7"],[46,"\u201c"],[47,"\u201d"],[48,"\xc0"],[49,"\xc2"],[50,"\xc7"],[51,"\xc8"],[52,"\xca"],[53,"\xcb"],[54,"\xeb"],[55,"\xce"],[56,"\xcf"],[57,"\xef"],[58,"\xd4"],[59,"\xd9"],[60,"\xf9"],[61,"\xdb"],[62,"\xab"],[63,"\xbb"]]),Lf=new Map([[32,"\xc3"],[33,"\xe3"],[34,"\xcd"],[35,"\xcc"],[36,"\xec"],[37,"\xd2"],[38,"\xf2"],[39,"\xd5"],[40,"\xf5"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"\xc4"],[49,"\xe4"],[50,"\xd6"],[51,"\xf6"],[52,"\xdf"],[53,"\xa5"],[54,"\xa4"],[55,"\u2502"],[56,"\xc5"],[57,"\xe5"],[58,"\xd8"],[59,"\xf8"],[60,"\u250c"],[61,"\u2510"],[62,"\u2514"],[63,"\u2518"]]),Df=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function Rf(e,t){this.h=0,this.o=new Sf(e,t),this.i=new Sf(e,t),this.g=this.j=new Sf(e,t),this.l=0,this.m=null}function Mf(e,t,n){e.g=e.i;var i=e.g,r=null;return 3!==e.h&&4!==e.h&&(r=_f(i,e.l,n),(n=e.i).g=0<n.h?n.h:0,xf(n,0,15),(n=e.j).g=0<n.h?n.h:0,xf(n,0,15),i.g=15),e.h=3,i.h=t,r}function Pf(e){e.h=1,e.g=e.j,e.g.h=0}function Of(e){Y("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=4}var Nf="black green blue cyan red yellow magenta black".split(" "),Uf="white green blue cyan red yellow magenta white_italics".split(" ");function Ff(e,t){this.I=t,this.M=e,this.K=this.l=!1,this.m=this.o=this.G=this.L=this.H=0,this.F=2,this.i=[],this.g=this.h=this.j=0,this.C=this.A=!1,this.B="white",this.s="black",Bf(this)}function Bf(e){e.i=[];for(var t=0;16>t;t++)e.i.push(jf())}function jf(){for(var e=[],t=0;42>t;t++)e.push(null);return e}function $f(e,t){Vf(e)&&(e.i[e.h][e.g]=new Tf(t,e.C,e.A,e.s,e.B),e.g++)}function Vf(e){var t=e.g<e.m&&0<=e.g;return e.h<e.o&&0<=e.h&&t}function Hf(e,t,n){var i=new dn(e.j,t,"");i.textAlign=0===e.F?"left":1===e.F?"right":bn;var r=i.region;switch(e.I&&(r.id+="svc"+e.I),r.id+="win"+e.M,r.height=e.o,r.width=e.m,r.heightUnits=2,r.widthUnits=2,r.viewportAnchorX=e.H,r.viewportAnchorY=e.L,r.viewportAnchorUnits=e.K?Ae:2,e.G){case 0:r.regionAnchorX=0,r.regionAnchorY=0;break;case 1:r.regionAnchorX=50,r.regionAnchorY=0;break;case 2:r.regionAnchorX=100,r.regionAnchorY=0;break;case 3:r.regionAnchorX=0,r.regionAnchorY=50;break;case 4:r.regionAnchorX=50,r.regionAnchorY=50;break;case 5:r.regionAnchorX=100,r.regionAnchorY=50;break;case 6:r.regionAnchorX=0,r.regionAnchorY=100;break;case 7:r.regionAnchorX=50,r.regionAnchorY=100;break;case 8:r.regionAnchorX=100,r.regionAnchorY=100}return(n=yf(i,"svc"+n,e.i,e.j,t))&&(e.j=t),n}function qf(){this.i=[],this.h=null,this.g=0}function Gf(e,t){3===t.type?(e.g=2*(63&t.value)-1,e.h=[]):e.h&&(0<e.g&&(e.h.push(t),e.g--),0===e.g&&(e.i.push(new zf(e.h)),e.h=null,e.g=0))}function zf(e){this.g=0,this.h=e}function Kf(e){if(!e.ta())throw new Me(2,2,3e3);return e.h[e.g++]}function Wf(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function Xf(e,t,n,i){if(!e.g)return[];if(24==n)return n=Kf(t).value,i=Kf(t).value,n=[n,i].map((function(e){return("0"+(255&e).toString(16)).slice(-2)})).join(""),$f(e.g,String.fromCharCode(parseInt(n,16))),[];t=e.g;var r=null;switch(n){case 8:!Vf(t)||0>=t.g&&0>=t.h||(0>=t.g?(t.g=t.m-1,t.h--):t.g--,t.i[t.h][t.g]=null);break;case 13:t.isVisible()&&(r=Hf(t,i,e.i)),t.h+1>=t.o?function(e){for(var t=0,n=1;16>n;n++,t++)e.i[t]=e.i[n];for(n=0;1>n;n++,t++)e.i[t]=jf()}(t):t.h++,t.g=0;break;case 14:t.isVisible()&&(r=Hf(t,i,e.i)),t.i[t.h]=jf(),t.g=0;break;case 12:t.isVisible()&&(r=Hf(t,i,e.i)),Bf(t),t.h=0,t.g=0}return r?[r]:[]}function Yf(e,t,n,i){if(128<=n&&135>=n)i=7&n,e.h[i]&&(e.g=e.h[i]);else{if(136===n){n=Kf(t).value,t=[];for(var r=(n=c(Qf(e,n))).next();!r.done;r=n.next()){if((r=e.h[r.value]).isVisible()){var s=Hf(r,i,e.i);s&&t.push(s)}Bf(r)}return t}if(137===n)for(n=(t=c(Qf(e,t=Kf(t).value))).next();!n.done;n=t.next())(n=e.h[n.value]).isVisible()||(n.j=i),n.display();else{if(138===n){for(n=Kf(t).value,t=null,r=(n=c(Qf(e,n))).next();!r.done;r=n.next())(r=e.h[r.value]).isVisible()&&(t=Hf(r,i,e.i)),r.l=!1;return t?[t]:[]}if(139===n){for(n=Kf(t).value,t=null,r=(n=c(Qf(e,n))).next();!r.done;r=n.next())(r=e.h[r.value]).isVisible()?t=Hf(r,i,e.i):r.j=i,r.l=!r.l;return t?[t]:[]}if(140===n)return Jf(e,t=Kf(t).value,i);if(143===n)return i=Jf(e,255,i),Zf(e),i;if(144===n)t.skip(1),i=Kf(t).value,e.g&&(e.g.A=0<(128&i),e.g.C=0<(64&i));else if(145===n)i=Kf(t).value,n=Kf(t).value,t.skip(1),e.g&&(t=ep((48&n)>>4,(12&n)>>2,3&n),e.g.B=ep((48&i)>>4,(12&i)>>2,3&i),e.g.s=t);else if(146===n)i=Kf(t).value,t=Kf(t).value,e.g&&((e=e.g).h=15&i,e.g=63&t);else if(151===n)t.skip(1),t.skip(1),i=Kf(t).value,t.skip(1),e.g&&(e.g.F=3&i);else if(152<=n&&159>=n){n=(15&n)-8,(r=null!==e.h[n])||((s=new Ff(n,e.i)).j=i,e.h[n]=s),i=Kf(t).value,s=Kf(t).value;var a=Kf(t).value,o=Kf(t).value,l=Kf(t).value;t=Kf(t).value,r&&0===(7&t)||((t=e.h[n]).h=0,t.g=0,t.C=!1,t.A=!1,t.B="white",t.s="black"),(t=e.h[n]).l=0<(32&i),t.L=127&s,t.H=a,t.G=(240&o)>>4,t.K=0<(128&s),t.o=1+(15&o),t.m=1+(63&l),e.g=e.h[n]}}}return[]}function Qf(e,t){for(var n=[],i=0;8>i;i++)1===(1&t)&&e.h[i]&&n.push(i),t>>=1;return n}function Jf(e,t,n){for(var i=[],r=(t=c(Qf(e,t))).next();!r.done;r=t.next()){r=r.value;var s=e.h[r];s.isVisible()&&(s=Hf(s,n,e.i))&&i.push(s),e.h[r]=null}return i}function Zf(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function ep(e,t,n){var i={0:0,1:0,2:1,3:1};return np[(e=i[e])<<2|(t=i[t])<<1|(n=i[n])]}Ff.prototype.isVisible=function(){return this.l},Ff.prototype.display=function(){this.l=!0},zf.prototype.ta=function(){return this.g<this.h.length},zf.prototype.ya=function(){return this.g},zf.prototype.skip=function(e){if(this.g+e>this.h.length)throw new Me(2,2,3e3);this.g+=e},zf.prototype.jh=function(e){if(0>this.g-e)throw new Me(2,2,3e3);this.g-=e};var tp=new Map([[32," "],[33,"\xa0"],[37,"\u2026"],[42,"\u0160"],[44,"\u0152"],[48,"\u2588"],[49,"\u2018"],[50,"\u2019"],[51,"\u201c"],[52,"\u201d"],[53,"\u2022"],[57,"\u2122"],[58,"\u0161"],[60,"\u0153"],[61,"\u2120"],[63,"\u0178"],[118,"\u215b"],[119,"\u215c"],[120,"\u215d"],[121,"\u215e"],[122,"\u2502"],[123,"\u2510"],[124,"\u2514"],[125,"\u2500"],[126,"\u2518"],[127,"\u250c"]]),np="black blue green cyan red magenta yellow white".split(" ");function ip(){this.h=[],this.g=[],this.i=new qf,this.l=0,this.m=new Map([["CC1",new Rf(0,0)],["CC2",new Rf(0,1)],["CC3",new Rf(1,0)],["CC4",new Rf(1,1)]]),this.s=this.o=0,this.j=new Map,this.B=!0,this.A=new Set,rp(this)}function rp(e){e.o=0,e.s=0;for(var t=c(e.m.values()),n=t.next();!n.done;n=t.next())(n=n.value).h=0,n.g=n.j,n.m=null,wf(n.i),wf(n.j),wf(n.o);e.B=!0}function sp(e,t){var n=t.type;if(16===(112&t.mb)){var i=t.mb>>3&1;0===n?e.o=i:e.s=i}if(i="CC"+(1+(n<<1|(n?e.s:e.o))),n=e.m.get(i),255===t.mb&&255===t.Kb||!t.mb&&!t.Kb||!op(t.mb)||!op(t.Kb))return 45<=++e.l&&rp(e),null;e.l=0,t.mb&=127,t.Kb&=127;var r=t.mb;if(1<=r&&15>=r||!t.mb&&!t.Kb)return null;if(r=null,16===(112&t.mb))e:{if(e.A.add(i),i=t.mb,e=t.Kb,n.m===(i<<8|e))n.m=null;else if(n.m=i<<8|e,16===(240&i)&&64===(192&e)){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&i)<<1|e>>5&1],i="white",r=!1;var s=null,a=95<e?e-96:e-64;13>=a?i=Uf[Math.floor(a/2)]:15>=a?r=!0:s=Math.floor((a-16)/2),e=1===(1&e),4!==n.h&&(a=n.g,3===n.h&&t!==a.g&&(kf(a,n=1+t-a.h,1+a.g-a.h,a.h),xf(a,0,n-1),xf(a,t+1,15-t)),a.g=t,a.m=e,a.j=r,a.l=i,a.s=s,a.o="black")}else if(17===(247&i)&&32===(240&e))n.g.m=!1,n.g.j=!1,n.g.l="white",Ef(n.g,0,32),i=!1,"white_italics"===(t=Uf[(14&e)>>1])&&(t="white",i=!0),n.g.m=1===(1&e),n.g.j=i,n.g.l=t;else if(16===(247&i)&&32===(240&e)||23===(247&i)&&45===(255&e))t="black",0===(7&i)&&(t=Nf[(14&e)>>1]),n.g.o=t;else if(17===(247&i)&&48===(240&e))Ef(n.g,1,e);else if(18===(246&i)&&32===(224&e))Ef(n.g,1&i?3:2,e);else{if(20===(246&i)&&32===(240&e)){switch(e=t.pts,i=null,t.Kb){case 32:Pf(n);break;case 33:(n=n.g).i[n.g].pop();break;case 37:i=Mf(n,2,e);break;case 38:i=Mf(n,3,e);break;case 39:i=Mf(n,4,e);break;case 40:Ef(n.g,0,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:wf(n.o),Of(n);break;case 43:Of(n);break;case 44:t=n.i,i=null,4!==n.h&&(i=_f(t,n.l,e)),xf(t,0,15);break;case 45:t=n.g,3!==n.h?i=null:(i=_f(t,n.l,e),kf(t,(r=t.g-t.h+1)-1,r,t.h),xf(t,0,r-1),xf(t,t.g,15-t.g),n.l=e);break;case 46:xf(n.j,0,15);break;case 47:t=null,4!==n.h&&(t=_f(n.i,n.l,e)),i=n.j,n.j=n.i,n.i=i,Pf(n),n.l=e,i=t}r=i;break e}(23==i||31==i)&&33<=e&&35>=e&&(n.g.A=e-32)}r=null}else e=t.Kb,Ef(n.g,0,t.mb),Ef(n.g,0,e);return r}function ap(e,t){var n=[];try{for(;t.ta();){var i=Kf(t).value,r=(224&i)>>5,s=31&i;if(7===r&&0!=s&&(r=63&Kf(t).value),0!=r){e.A.add("svc"+r),e.j.has(r)||e.j.set(r,new Wf(r));for(var a=e.j.get(r),o=t.ya();t.ya()-o<s;){r=a;var l=t,u=Kf(l),c=u.value,h=u.pts;if(16===c)c=c<<16|Kf(l).value;if(0<=c&&31>=c)var f=Xf(r,l,c,h);else if(128<=c&&159>=c)f=Yf(r,l,c,h);else{if(4096<=c&&4127>=c)r=l,8<=(l=255&c)&&15>=l?r.skip(1):16<=l&&23>=l?r.skip(2):24<=l&&31>=l&&r.skip(3);else if(4224<=c&&4255>=c)r=l,128<=(l=255&c)&&135>=l?r.skip(4):136<=l&&143>=l&&r.skip(5);else if(32<=c&&127>=c)l=c,r.g&&$f(r.g,127===l?"\u266a":String.fromCharCode(l));else if(160<=c&&255>=c)r.g&&$f(r.g,String.fromCharCode(c));else if(4128<=c&&4223>=c){if(l=255&c,r.g)if(tp.has(l)){var p=tp.get(l);$f(r.g,p)}else $f(r.g,"_")}else 4256<=c&&4351>=c&&r.g&&$f(r.g,160!=(255&c)?"_":"[CC]");f=[]}n.push.apply(n,d(f))}}}}catch(g){if(!(g instanceof Me&&3e3===g.code))throw g;Y("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return n}function op(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t}function lp(e){for(var t=[],n=e,i=e=0;i<n.length;)2==e&&3==n[i]?(e=0,(n=[].concat(d(n))).splice(i,1),n=new Uint8Array(n)):0==n[i]?e++:e=0,i++;for(e=n,i=0;i<e.length;){for(n=0;255==e[i];)n+=255,i++;n+=e[i++];for(var r=0;255==e[i];)r+=255,i++;r+=e[i++],4==n&&t.push(e.subarray(i,i+r)),i+=r}return t}function up(){this.j=new Map,this.i=this.h=0,this.g=dp}function cp(e,t,n,i,r,s,a,o,l){var u=0,h=s,f=o.map((function(e){return e.Xf}));for((f=[].concat.apply([],d(f))).length&&(h=f[0].sampleSize||s),t.skip(a+o[0].Wh);t.ta();){a=t.R();var p=t.V(),g=null;switch(g=!1,o=1,e.g){case hp:g=6==(g=31&p);break;case fp:o=2,t.skip(1),g=39==(g=p>>1&63)||40==g;break;case pp:o=2,t.skip(1),g=23==(g=p>>1&63)||24==g;break;default:return}if(g)for(p=0,u<f.length&&(p=f[u].ue||0),p=(n+p)/i,g=(o=c(lp(t.Bb(a-o)))).next();!g.done;g=o.next())l.push({packet:g.value,pts:p});else try{t.skip(a-o)}catch(m){break}0==(h-=a+4)&&(n=u<f.length?n+(f[u].Yf||r):n+r,h=++u<f.length&&f[u].sampleSize||s)}}ip.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,rp(this);for(var t=(e=c(this.j.values())).next();!t.done;t=e.next())Zf(t.value)},ip.prototype.extract=function(e,t){if(this.B){for(var n=c(this.m.values()),i=n.next();!i.done;i=n.next())i.value.l=t;this.B=!1}if(!(8>(e=new gs(e,0)).getLength())&&181===e.V()&&49===e.na()&&1195456820===e.R()&&3===e.V()&&0!==(64&(n=e.V())))for(n&=31,e.skip(1),i=0;i<n;i++){var r=e.V(),s=(4&r)>>2,a=e.V(),o=e.V();s&&(0===(r&=3)||1===r?this.h.push({pts:t,type:r,mb:a,Kb:o,order:this.h.length}):(this.g.push({pts:t,type:r,value:a,order:this.g.length}),this.g.push({pts:t,type:2,value:o,order:this.g.length})))}},ip.prototype.decode=function(){function e(e,t){return e.pts-t.pts||e.order-t.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=c(this.h),i=n.next();!i.done;i=n.next())(i=sp(this,i.value))&&t.push(i);for(i=(n=c(this.g)).next();!i.done;i=n.next())Gf(this.i,i.value);for(i=(n=c(this.i.i)).next();!i.done;i=n.next())i=ap(this,i.value),t.push.apply(t,d(i));return this.i.i=[],this.h=[],this.g=[],t},ip.prototype.getStreams=function(){return Array.from(this.A)},$("shaka.cea.CeaDecoder",ip),ke=function(){return new ip},up.prototype.init=function(e){function t(e){e=e.name,gp.has(e)&&(n.g=gp.get(e))}var n=this,i=[],r=[];if((new vs).box("moov",bs).box("mvex",bs).S("trex",(function(e){var t=e.reader;t.skip(4),t.skip(4),e=t.R(),t=t.R(),n.h=e,n.i=t})).box("trak",bs).S("tkhd",(function(e){var t=e.reader;1==(e=e.version)?(t.skip(8),t.skip(8)):(t.skip(4),t.skip(4));var n=t.R();1==e?t.skip(8):t.skip(4),t.skip(4),t.skip(8),t.skip(2),t.skip(2),t.skip(2),t.skip(2),t.skip(36),t.na(),t.na(),t.na(),t.na(),i.push(n)})).box("mdia",bs).S("mdhd",(function(e){e=za(e.reader,e.version),r.push(e.timescale)})).box("minf",bs).box("stbl",bs).S("stsd",Ts).box("avc1",t).box("avc3",t).box("dvav",t).box("dva1",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("vvc1",t).box("vvi1",t).box("dvc1",t).box("dvi1",t).box("encv",Ss).box("sinf",bs).box("frma",(function(e){e=Xa(e.reader).codec,gp.has(e)&&(n.g=gp.get(e))})).parse(e,!0),!i.length||!r.length||i.length!=r.length)throw new Me(2,2,2010);this.g==dp&&X("Unable to determine bitstream format for CEA parsing!"),i.forEach((function(e,t){n.j.set(e,r[t])}))},up.prototype.parse=function(e){var t=this;if(this.g==dp)return[];var n=[],i=0,r=[];return(new vs).box("moof",(function(e){i=e.start,r=[],bs(e)})).box("traf",(function(e){r.push({baseMediaDecodeTime:null,jd:t.h,kd:t.i,dh:[],timescale:9e4}),bs(e)})).S("trun",(function(e){var t=r[r.length-1];e=Ka(e.reader,e.version,e.flags),t.dh.push(e)})).S("tfhd",(function(e){var n=r[r.length-1];e=qa(e.reader,e.flags),n.jd=e.jd||t.h,n.kd=e.kd||t.i,e=e.trackId,t.j.has(e)&&(n.timescale=t.j.get(e))})).S("tfdt",(function(e){var t=r[r.length-1];e=Ga(e.reader,e.version),t.baseMediaDecodeTime=e.baseMediaDecodeTime})).box("mdat",(function(e){for(var s=i-e.start-8,a=e.reader.ya(),o=c(r),l=o.next();!l.done;l=o.next()){if(null===(l=l.value).baseMediaDecodeTime)throw X("Unable to find base media decode time for CEA captions!"),new Me(2,2,2010);e.reader.seek(a),cp(t,e.reader,l.baseMediaDecodeTime,l.timescale,l.jd,l.kd,s,l.dh,n)}})).parse(e,!1),n},$("shaka.cea.Mp4CeaParser",up);var dp=0,hp=1,fp=2,pp=3,gp=(new Map).set("avc1",hp).set("avc3",hp).set("dvav",hp).set("dva1",hp).set("hev1",fp).set("hvc1",fp).set("dvh1",fp).set("dvhe",fp).set("vvc1",pp).set("vvi1",pp).set("dvc1",pp).set("dvi1",pp);function mp(){this.g=null}function yp(e){return(e=function(e){var t=0,n=ve(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var r=n.getUint16(e,!0);if(e+=2,0!=(1&r)||r+e>n.byteLength){n=[];break e}var s=me(n,e,r);t.push({type:i,value:s}),e+=r}n=t}return n}(e=di(Ft(e))).filter((function(e){return e.type===bp}))[0])&&(e=Mt(e=gt(e.value,!0),"WRMHEADER"))?e:null}function vp(e){try{var t=yp(e);if(t)e:{for(var n=c(jt(t,"DATA")),i=n.next();!i.done;i=n.next()){var r=i.value;if(r.children)for(var s=c(r.children),a=s.next();!a.done;a=s.next()){var o=a.value;if("LA_URL"==o.tagName){var l=Ft(o);break e}}}l=""}else l="";return l}catch(u){return""}}_e("video/mp4",(function(){return new up})),mp.prototype.init=function(){},mp.prototype.parse=function(e){this.g?this.g.clearData():this.g=new co;var t=[];if(!go(e=me(e)))return t;var n=(e=this.g.parse(e)).ld(),i=e.Zd();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(i=(n=c(i)).next();!i.done;i=n.next())if(i=i.value,e.includes(i.type)&&null!=i.time)for(var r=c(lp(i.data)),s=r.next();!s.done;s=r.next())t.push({packet:s.value,pts:i.time});return t},$("shaka.cea.TsCeaParser",mp),_e("video/mp2t",(function(){return new mp}));var bp=1;function Tp(t,n,i){var r=function(e){for(var t=[],n=(e=c(e)).next();!n.done;n=e.next())(n=_p(n.value))&&t.push(n);return t}(t),s=null;t=[];var a=[],o=null,l=new Set(r.map((function(e){return e.keyId})));l.delete(null);var u="cenc";if(1<l.size)throw new Me(2,4,4010);if(!n){if(1<(a=r.filter((function(e){return"urn:mpeg:dash:sea:2012"==e.Zc}))).length)throw new Me(2,4,4050);a.length&&(o=function(t){if(!e.crypto||!e.crypto.subtle)throw X("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new Me(2,4,4042);var n=Vt(t.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!n)throw new Me(2,4,4051);if("urn:mpeg:dash:sea:aes128-cbc:2013"!=n.attributes.schemeIdUri)throw new Me(2,4,4051);if(n=Vt(t.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod"),!n)throw new Me(2,4,4051);if(t=n.attributes.IV,n=Tt(n.attributes.keyUriTemplate),!t||!n)throw new Me(2,4,4051);if(t=hi(t.substr(2)),16!=t.byteLength)throw new Me(2,4,4048);return{Mi:n,iv:t}}(a[0])),(a=r.find((function(e){return"urn:mpeg:dash:mp4protection:2011"==e.Zc})))&&a.encryptionScheme&&(u=a.encryptionScheme),(a=r.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"==e.Zc?(s=e.init||s,!1):"urn:mpeg:dash:sea:2012"!=e.Zc}))).length&&(t=function(e,t,n,i,r){for(var s=[],a=(n=c(n)).next();!a.done;a=n.next()){var o=i[(a=a.value).Zc];if(o){var l;if((l=Vt(a.node,"urn:microsoft:playready","pro"))&&Ft(l)){l=di(l=Ft(l));var u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);l=[{initData:Ls(l,u,new Set,0),initDataType:"cenc",keyId:a.keyId}]}else l=null;if(u=null,"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"===a.Zc){u=a;var d=r;if(0==d.size)u=null;else{var h=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]);u=[{initData:Ls(new Uint8Array([]),h,d,1),initDataType:"cenc",keyId:u.keyId}]}}l=mi(o,t,a.init||e||l||u),(o=wp.get(o))&&(l.licenseServerUri=o(a)),s.push(l)}}return s}(s,u,a,i,l),0==t.length&&(t=[mi("",u,s)]))}if(r.length&&!o&&(n||!a.length))for(t=[],i=(n=c(Object.values(i))).next();!i.done;i=n.next())"org.w3.clearkey"!=(i=i.value)&&t.push(mi(i,u,s));if(l=Array.from(l)[0]||null)for(n=(u=c(t)).next();!n.done;n=u.next())for(i=(n=c(n.value.initData)).next();!i.done;i=n.next())i.value.keyId=l;return{Dg:l,Ck:s,drmInfos:t,Te:o,Ig:!0}}function Sp(e){var t=Vt(e.node,"https://dashif.org/CPS","Laurl");if(t&&(t=Ft(t)))return t;if((t=Vt(e.node,"urn:microsoft:playready","pro"))&&Ft(t))return vp(t);if((e=Vt(e.node,"urn:mpeg:cenc:2013","pssh"))&&(e=Ft(e))){t=di(e),e=8;var n=(t=ve(t)).getUint8(e);return e+=20,0<n&&(e+=4+16*t.getUint32(e)),vp(e=Mt("<pro>"+(e=ui(e=me(t,e+4)))+"</pro>"))}return""}function _p(e){var t=e.attributes.schemeIdUri,n=qt(e,"urn:mpeg:cenc:2013","default_KID"),i=Gt(e,"urn:mpeg:cenc:2013","pssh").map(Bt),r=e.attributes.value;if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new Me(2,4,4009);var s=[];try{s=i.map((function(e){return{initDataType:"cenc",initData:di(e),keyId:null}}))}catch(a){throw new Me(2,4,4007)}return{node:e,Zc:t,keyId:n,init:0<s.length?s:null,encryptionScheme:r}}var wp=(new Map).set("com.apple.fps",(function(t){if("apple"===e.shakaMediaKeysPolyfill)throw new Me(2,4,4054);return(t=Vt(t.node,"https://dashif.org/CPS","Laurl"))&&(t=Ft(t))?t:""})).set("com.widevine.alpha",(function(e){var t=Vt(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Ft(t))?t:(e=Vt(e.node,"urn:microsoft","laurl"))&&Tt(e.attributes.licenseUrl)||""})).set("com.microsoft.playready",Sp).set("com.microsoft.playready.recommendation",Sp).set("com.microsoft.playready.software",Sp).set("com.microsoft.playready.hardware",Sp).set("org.w3.clearkey",(function(e){var t=Vt(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Ft(t))?t:(e=Vt(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&"EME-1.0"===e.attributes.Lic_type&&e&&(e=Ft(e))?e:""}));function Ep(t,n,i,r,s,a){var o=(new Map).set("RepresentationID",n).set("Number",i).set("SubNumber",r).set("Bandwidth",s).set("Time",a);return t.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(t,n,i,r){if("$$"==t)return"$";var s=o.get(n);if(null==s)return t;switch("RepresentationID"==n&&i&&(i=void 0),"Time"==n&&"bigint"!=typeof s&&(.2<=Math.abs(s-Math.round(s))&&X("Calculated $Time$ values must be close to integers"),s=Math.round(s)),r){case void 0:case"d":case"i":case"u":t=s.toString();break;case"o":t=s.toString(8);break;case"x":t=s.toString(16);break;case"X":t=s.toString(16).toUpperCase();break;default:t=s.toString()}return i=e.parseInt(i,10)||1,Array(Math.max(0,i-t.length)+1).join("0")+t}))}function kp(e,t){var n=Ap(e,t,"timescale"),i=1;n&&(i=Qt(n)||1);var r=(n=Qt((n=Ap(e,t,"duration"))||""))?n/i:null,s=Ap(e,t,"startNumber"),a=Number(Ap(e,t,"presentationTimeOffset"))||0,o=Jt(s||"");if(null!=s&&null!=o||(o=1),s=null,t=Cp(e,t,"SegmentTimeline")){t=Ut(t,"S"),s=i,e=e.ka.duration||1/0;for(var l=o,u=[],c=-a,d=0;d<t.length;++d){var h=t[d],f=t[d+1],p=Ht(h,"t",Jt),g=Ht(h,"d",Jt),m=Ht(h,"r",Yt);if(h=Ht(h,"k",Yt)||0,null!=p&&(p-=a),g){if(p=null!=p?p:c,0>(m=m||0))if(f){if(null==(f=Ht(f,"t",Jt)))break;if(p>=f)break;m=Math.ceil((f-p)/g)-1}else{if(1/0==e)break;if(p/s>=e)break;m=Math.ceil((e*s-p)/g)-1}for(0<u.length&&p!=c&&(u[u.length-1].end=p/s),f=0;f<=m;++f)c=p+g,u.push({start:p/s,end:c/s,og:p,Hb:h,kj:u.length+l}),p=c}}s=u}return{timescale:i,Ce:n,Ta:r,Id:o,hc:a/i||0,ng:a,timeline:s}}function xp(e,t){return[t(e.J),t(e.ea),t(e.qa)].filter(Wi)}function Ap(e,t,n){t=xp(e,t),e=null;for(var i=(t=c(t)).next();!i.done&&!(e=i.value.attributes[n]);i=t.next());return e}function Cp(e,t,n){t=xp(e,t),e=null;for(var i=(t=c(t)).next();!i.done&&!(e=$t(i.value,n));i=t.next());return e}function Ip(e,t,n,i,r,s){if(s=void 0===s?0:s,qt(e,"http://www.w3.org/1999/xlink","href")){var a=function(e,t,n,i,r,s){for(var a=qt(e,"http://www.w3.org/1999/xlink","href"),o=qt(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",l=c(Object.keys(e.attributes)),u=l.next();!u.done;u=l.next()){var d=(u=u.value).split(":"),h=Pt("http://www.w3.org/1999/xlink");d[0]==h&&delete e.attributes[u]}if(5<=s)return Vr(new Me(2,4,4028));if("onLoad"!=o)return Vr(new Me(2,4,4027));var f=gi([i],[a]);return r.request(0,ns(f,t)).Ea((function(i){if(!(i=Rt(i.data,e.tagName)))return Vr(new Me(2,4,4001,a));for(e.children=[];i.children.length;){var o=i.children.shift();e.children.push(o)}for(var l=(o=c(Object.keys(i.attributes))).next();!l.done;l=o.next())l=l.value,e.attributes[l]=i.attributes[l];return Ip(e,t,n,f[0],r,s+1)}))}(e,t,n,i,r,s);return n&&(a=a.Ea(void 0,(function(){return Ip(e,t,n,i,r,s)}))),a}a=[];for(var o=c(Nt(e)),l=o.next(),u={};!l.done;u={ed:void 0},l=o.next())u.ed=l.value,"urn:mpeg:dash:resolve-to-zero:2013"==qt(u.ed,"http://www.w3.org/1999/xlink","href")?e.children=e.children.filter(function(e){return function(t){return t!==e.ed}}(u)):"SegmentTimeline"!=u.ed.tagName&&a.push(Ip(u.ed,t,n,i,r,s));return zr(a).Ea((function(){return e}))}function Lp(e,t,n,i,r,s,a){var o,l=(new vs).S("sidx",(function(e){o=function(e,t,n,i,r,s,a){var o=[];a.reader.skip(4);var l=a.reader.R();if(0==l)throw new Me(2,3,3005);if(0==a.version)var u=a.reader.R(),c=a.reader.R();else u=a.reader.Yc(),c=a.reader.Yc();a.reader.skip(2);var d=a.reader.na();for(e=e+a.size+c,c=0;c<d;c++){var h=a.reader.R(),f=(2147483648&h)>>>31;h&=2147483647;var p=a.reader.R();if(a.reader.skip(4),1==f)throw new Me(2,3,3006);o.push(new ka(u/l+n,(u+p)/l+n,(function(){return s}),e,e+h-1,t,n,i,r)),u+=p,e+=h}return a.parser.stop(),o}(t,i,r,s,a,n,e)}));if(e&&l.parse(e),o)return o;throw new Me(2,3,3004)}function Dp(e){this.h=ve(e),this.g=new gs(this.h,0)}function Rp(e){var t=Mp(e);if(7<t.length)throw new Me(2,3,3002);for(var n=0,i=(t=c(t)).next();!i.done;i=t.next())n=256*n+i.value;t=Mp(e);e:{for(var r=(i=c(Pp)).next();!r.done;r=i.next())if(pe(t,new Uint8Array(r.value))){i=!0;break e}i=!1}if(i)t=e.h.byteLength-e.g.ya();else{if(8==t.length&&224&t[1])throw new Me(2,3,3001);for(r=i=0;r<t.length;r++){var s=t[r];i=0==r?s&(1<<8-t.length)-1:256*i+s}t=i}return t=e.g.ya()+t<=e.h.byteLength?t:e.h.byteLength-e.g.ya(),i=ve(e.h,e.g.ya(),t),e.g.skip(t),new Op(n,i)}function Mp(e){var t=e.g.ya(),n=e.g.V();if(0==n)throw new Me(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),me(e.h,t,n)}Dp.prototype.ta=function(){return this.g.ta()};var Pp=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function Op(e,t){this.id=e,this.g=t}function Np(e){if(8<e.g.byteLength)throw new Me(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new Me(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++){t=256*t+e.g.getUint8(n)}return t}function Up(e){var t=new Dp(e.g);if(179!=(e=Rp(t)).id)throw new Me(2,3,3013);if(e=Np(e),183!=(t=Rp(t)).id)throw new Me(2,3,3012);t=new Dp(t.g);for(var n=0;t.ta();){var i=Rp(t);if(241==i.id){n=Np(i);break}}return{xj:e,bj:n}}function Fp(e,t,n){if(!(t=Cp(e,t,"Initialization")))return null;var i=e.J.Ra(),r=t.attributes.sourceURL;r&&(i=gi(i,[Tt(r)],e.ub())),r=0;var s=null;return(t=Ht(t,"range",Xt))&&(r=t.start,s=t.end),(n=new wa((function(){return i}),r,s,qp(e),null,null,n,e.ea.encrypted)).codecs=e.J.codecs,n.mimeType=e.J.mimeType,n}function Bp(e,t,n){var i=Number(Ap(e,$p,"presentationTimeOffset"))||0,r=Ap(e,$p,"timescale"),s=1;r&&(s=Qt(r)||1);var a=i/s||0,o=Fp(e,$p,n);!function(e,t){if(Hp(e,t),!Vp(e))throw new Me(2,4,4002)}(e,o);var l=Lt(e);return{qc:function(){var e=Cp(l,$p,"RepresentationIndex"),n=l.J.Ra();return e&&(e=Tt(e.attributes.sourceURL))&&(n=gi(n,[e],l.ub())),e=Vp(l),jp(l,t,o,n,e.start,e.end,a)}}}function jp(e,t,n,i,r,s,a){var o,l,u,d,h,f,p,g,m,y,v,b,T,_,w,E,k,x;return M((function(A){if(1==A.g)return o=e.presentationTimeline,l=!e.Mb||!e.ka.Tg,u=e.ka.start,d=e.ka.duration,h=e.J.mimeType.split("/")[1],p=null,g=[(f=t)(i,r,s,!1),"webm"==h?f(n.N(),n.Na,n.wa,!0):null],f=null,S(A,Promise.all(g),2);if(m=A.h,y=m[0],v=m[1]||null,null,T=u-a,_=u,w=d?u+d:1/0,"mp4"==h)var C=Lp(y,r,i,n,T,_,w);else{C=y;var I=new Dp(v);if(440786851!=Rp(I).id)throw new Me(2,3,3008);var L=Rp(I);if(408125543!=L.id)throw new Me(2,3,3009);I=L.g.byteOffset,L=new Dp(L.g);for(var D=null;L.ta();){var R=Rp(L);if(357149030==R.id){D=R;break}}if(!D)throw new Me(2,3,3010);for(D=new Dp(D.g),R=1e6,L=null;D.ta();){var M=Rp(D);if(2807729==M.id)R=Np(M);else if(17545==M.id)if(4==M.g.byteLength)L=M.g.getFloat32(0);else{if(8!=M.g.byteLength)throw new Me(2,3,3003);L=M.g.getFloat64(0)}}if(null==L)throw new Me(2,3,3011);if(L*=D=R/1e9,475249515!=(C=Rp(new Dp(C))).id)throw new Me(2,3,3007);C=function(e,t,n,i,r,s,a,o,l){function u(){return r}var c=[];e=new Dp(e.g);for(var d=null,h=null;e.ta();){var f=Rp(e);if(187==f.id){var p=Up(f);p&&(f=n*p.xj,p=t+p.bj,null!=d&&c.push(new ka(d+a,f+a,u,h,p-1,s,a,o,l)),d=f,h=p)}}return null!=d&&c.push(new ka(d+a,i+a,u,h,null,s,a,o,l)),c}(C,I,D,L,i,n,T,_,w)}for(E=c(b=C),k=E.next();!k.done;k=E.next())(x=k.value).codecs=e.J.codecs,x.mimeType=e.J.mimeType,x.bandwidth=e.bandwidth;return o.Dd(b),p=new hl(b),l&&p.Lc(_,w,!0),A.return(p)}))}function $p(e){return e.ad}function Vp(e){var t=Cp(e,$p,"RepresentationIndex");return e=Xt((e=Ap(e,$p,"indexRange"))||""),t&&(e=Ht(t,"range",Xt,e)),e}function Hp(e,t){var n=e.J.mimeType.split("/")[1];if(e.J.contentType!=Si&&"mp4"!=n&&"webm"!=n)throw new Me(2,4,4006);if("webm"==n&&!t)throw new Me(2,4,4005)}function qp(e){var t=e.J;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.je,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null,label:e.ea.label||null,roles:e.roles||null,language:e.ea.language||null}}function Gp(e,t,n){var i=Fp(e,zp,n),r=function(e){var t=function(e){return[e.J.Wb,e.ea.Wb,e.qa.Wb].filter(Wi).map((function(e){return Ut(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.attributes.indexRange&&!e.Bf&&(e.Bf=!0),{Si:Tt(t.attributes.media),start:(t=Ht(t,"mediaRange",Xt,{start:0,end:null})).start,end:t.end}}))}(e);e=kp(e,zp);var n=e.Id;0==n&&(n=1);var i=0;return e.Ta?i=e.Ta*(n-1):e.timeline&&0<e.timeline.length&&(i=e.timeline[0].start),{Ta:e.Ta,startTime:i,Id:n,hc:e.hc,timeline:e.timeline,Uc:t}}(e);if(!r.Ta&&!r.timeline&&1<r.Uc.length)throw new Me(2,4,4002);if(!r.Ta&&!e.ka.duration&&!r.timeline&&1==r.Uc.length)throw new Me(2,4,4002);if(r.timeline&&0==r.timeline.length)throw new Me(2,4,4002);var s=null,a=null;e.qa.id&&e.J.id&&(a=t.get(e.qa.id+","+e.J.id))&&(s=a.segmentIndex);var o=function(e,t,n,i,r,s,a,o,l,u){var c=i.Uc.length;i.timeline&&i.timeline.length!=i.Uc.length&&(c=Math.min(i.timeline.length,i.Uc.length));for(var d=e-i.hc,h=t?e+t:1/0,f=[],p=i.startTime,g={},m=0;m<c;g={Ee:void 0,ve:void 0},m++){g.ve=i.Uc[m];var y=p;p=void 0,p=null!=i.Ta?y+i.Ta:i.timeline?i.timeline[m].end:y+t,g.Ee=null,(g=new ka(e+y,e+p,function(e){return function(){return null==e.Ee&&(e.Ee=gi(n(),[e.ve.Si],u())),e.Ee}}(g),g.ve.start,g.ve.end,r,d,e,h,[],"",null,null,Aa,s)).codecs=o,g.mimeType=a,g.bandwidth=l,f.push(g)}return f}(e.ka.start,e.ka.duration,e.J.Ra,r,i,n,e.J.mimeType,e.J.codecs,e.bandwidth,e.ub);return t=!s,s?s.zd(o,e.presentationTimeline.ob()):s=new hl(o),e.presentationTimeline.Dd(o),e.Mb&&e.ka.Tg||s.Lc(e.ka.start,e.ka.duration?e.ka.start+e.ka.duration:1/0,t),a&&(a.segmentIndex=s),{qc:function(){return s&&0!=s.getNumReferences()||s.fe(o),Promise.resolve(s)}}}function zp(e){return e.Wb}function Kp(t,n,i,r,s,a,o,l,u){u||t.J.ae||(t.J.ae=Ap(t,Wp,"initialization"));var d=t.J.ae?function(e,t){var n=e.J.ae;if(n||(n=Ap(e,Wp,"initialization")),!n)return null;n=Tt(n);var i=e.J.originalId,r=e.bandwidth||null,s=e.J.Ra,a=e.ub;return t=new wa((function(){var e=Ep(n,i,null,null,r,null);return gi(s(),[e],a())}),0,null,qp(e),null,null,t,e.ea.encrypted),t.codecs=e.J.codecs,t.mimeType=e.J.mimeType,t}(t,o):null,h=function(e){var t=kp(e,Wp),n=Ap(e,Wp,"media"),i=Ap(e,Wp,"index"),r=Ap(e,Wp,"k"),s=0;return r&&(s=parseInt(r,10)),{Ce:t.Ce,Ta:t.Ta,timescale:t.timescale,Id:t.Id,hc:t.hc,ng:t.ng,timeline:t.timeline,ec:n&&Tt(n),td:i,mimeType:e.J.mimeType,codecs:e.J.codecs,bandwidth:e.bandwidth,Ti:s}}(t);!function(e){var t=e.td?1:0;if(t+=e.timeline?1:0,t+=e.Ta?1:0,0==t)throw new Me(2,4,4002);if(1!=t&&(e.td&&(e.timeline=null),e.Ce=null,e.Ta=null),!e.td&&!e.ec)throw new Me(2,4,4002)}(h);var f=Lt(t);if(h.td)return Hp(t,d),{qc:function(){var e=Ep(h.td,f.J.originalId,null,null,f.bandwidth||null,null);return e=gi(f.J.Ra(),[e]),jp(f,n,d,e,0,null,h.hc)}};if(h.Ta)return r||"image"===t.ea.contentType||"text"===t.ea.contentType||(i=t.ka.start,r=t.qa.id,u=t.ka.duration,r=(r=null!=r&&a.get(r)||u)?i+r:1/0,t.presentationTimeline.Lf(h.Ta),t.presentationTimeline.ah(i,r)),{qc:function(){return function(t,n,i,r,s,a,o,l){function u(i){var s=i-v,o=s*y,u=n.Ce,c=s*u;"BigInt"in e&&c>Number.MAX_SAFE_INTEGER&&(c=BigInt(s)*BigInt(u)),s=(o+=p)+y,u=Math.min(s,h());var d=[],f=n.Ti;if(f)for(var g=(u-o)/f,m={},k=0;k<f;m={wh:void 0},k++){var x=o+g*k,A=x+g;m.wh=k+1,(m=new ka(x,A,function(e){return function(){var t=Ep(b,S,i,e.wh,T,c);return gi(_(),[t],w())}}(m),0,null,r,E,p,h(),[],"",null,null,Aa,a)).codecs=t.J.codecs,m.mimeType=t.J.mimeType,0==l?0<k&&m.Sc():0!=k%l&&m.Sc(),d.push(m)}return(o=new ka(o,u,(function(){if(f)return[];var e=Ep(b,S,i,null,T,c);return gi(_(),[e],w())}),0,null,r,E,p,h(),d,"",null,null,Aa,a,0<d.length)).codecs=t.J.codecs,o.mimeType=t.J.mimeType,o.bandwidth=t.bandwidth,o.j=s,o}function d(){var e=[Math.max(f.ob(),p),Math.min(f.ac(),h())].map((function(e){return e-p}));return e=[Math.ceil(e[0]/y),Math.ceil(e[1]/y)-1],t.J.cb&&e[1]++,e.map((function(e){return e+v}))}function h(){var e=null!=g&&s.get(g)||m;return e?p+e:1/0}var f=t.presentationTimeline,p=t.ka.start,g=t.qa.id,m=t.ka.duration,y=n.Ta,v=n.Id,b=n.ec,T=t.bandwidth||null,S=t.J.id,_=t.J.Ra,w=t.ub,E=p-n.hc,k=d();i=t.Mb?Math.max(k[0],k[1]-i+1):k[0],o=o||k[1],k=[];for(var x=i;x<=o;++x){var A=u(x);k.push(A)}var C=new hl(k);if(k=f.ac()<h(),x=f.T(),k||x){var I=Math.max(i,o+1);i=y,t.J.cb&&(i=.1),C.De(i,(function(){var e=f.ob();C.Ja(e);var t=c(d());t.next(),t=t.next().value;for(var n=[];I<=t;){var i=u(I);n.push(i),I++}return e>h()&&!n.length?null:n}))}return Promise.resolve(C)}(f,h,s,d,a,o,l,t.J.we)}};var p=null;r=r=null,t.qa.id&&t.J.id&&(r=t.qa.id+","+t.J.id,r=i.get(r))&&(p=r.segmentIndex);var g=t.ka.start,m=t.ka.duration?g+t.ka.duration:1/0;return p?(Yp(i=p,h,g,m,d),i.Ja(t.presentationTimeline.ob())):p=new Xp(h,t.J.originalId,t.bandwidth,t.J.Ra,t.ub,g,m,d,o,t.J.we),h.timeline&&"image"!==t.ea.contentType&&"text"!==t.ea.contentType&&t.presentationTimeline.bh(p.h?p.h.timeline:[],g),r&&t.Mb&&(r.segmentIndex=p),{qc:function(){return p instanceof Xp&&0==p.getNumReferences()&&Yp(p,h,g,m,d),Promise.resolve(p)}}}function Wp(e){return e.ic}function Xp(e,t,n,i,r,s,a,o,l,u){hl.call(this,[]),this.h=e,this.F=t,this.B=n,this.C=i,this.H=r,this.j=s,this.l=a,this.s=o,this.A=l,this.G=u,Qp(this)}function Yp(e,t,n,i,r){if(function(e,t){if(e.s!==t){e.s=t;for(var n=(e=c(e.g)).next();!n.done;n=e.next())(n=n.value)&&xa(n,t)}}(e,r),e.h){if(n=e.h.timeline,e.h.ec!==t.ec&&(e.h.ec=t.ec),n.length){var s=n[n.length-1];t=t.timeline.filter((function(e){return e.end>s.end}))}else t=t.timeline.slice();0<t.length&&e.h.timeline.push.apply(e.h.timeline,d(t)),e.l!==i&&(e.l=i)}else e.h=t,e.j=n,e.l=i;Qp(e)}function Qp(e){if(e.h&&!e.o){for(var t=[],n=c(e.h.timeline),i=n.next();!i.done;i=n.next())(i=i.value).start>=e.l||0>=i.end||t.push(i);e.h.timeline=t,e.Ja(e.j)}}function Jp(e,t,n,i,r,s,a,o){return e=Ep(e,t,n,s,i||null,r),gi(a(),[e],o()).map((function(e){return e.toString()}))}function Zp(e){this.o=null,this.A=e,this.G=new Qr,this.i=[],this.h=null,this.m=[],this.B=null,this.F=[],this.C=300,this.l=new Map,this.j=new Map,this.g=null,this.s="UNKNOWN"}function eg(e,t){var n,i,r,s,a,o,l;return M((function(u){return 1==u.g?(n=gi(e.i,[tg(e,t)]),i=ns(n,e.o.retryParameters),r=e.A.networkingEngine.request(8,i),Jr(e.G,r),w(u,2),S(u,r.promise,4)):2!=u.g?(s=u.h,a=pt(s.data),1==(o=JSON.parse(a)).VERSION&&function(e,t,n){null!=e.g&&(e.g.stop(),e.g=null);var i=t["RELOAD-URI"]||n;e.g=new Ve((function(){eg(e,i)})),(n=t.TTL)&&(e.C=n);e.g.aa(e.C),e.m=t["PATHWAY-PRIORITY"]||[],e.F=t["PATHWAY-CLONES"]||[]}(e,o,s.uri),k(u,0)):(l=x(u))&&7001==l.code?u.return():(null!=e.g&&(e.g.stop(),e.g=null),e.g=new Ve((function(){eg(e,t)})),e.g.aa(e.C),void _(u))}))}function tg(e,t){if(!e.m.length)return t;t=new zn(t);var n=e.B||e.m[0],i=Math.round(e.A.getBandwidthEstimate()),r=t.g;return"DASH"==e.s?(r.add("_DASH_pathway",n),r.add("_DASH_throughput",String(i))):"HLS"==e.s&&(r.add("_HLS_pathway",n),r.add("_HLS_throughput",String(i))),oi(r)&&Yn(t,r),t.toString()}function ng(e,t,n,i){var r=e.l.get(t);r||(r=new Map),r.set(n,i),e.l.set(t,r)}function ig(e,t,n){n=void 0!==n&&n,t=e.l.get(t)||new Map;for(var i=[],r=c(e.m),s=r.next(),a={};!s.done;a={Wc:void 0},s=r.next())if(a.Wc=s.value,s=t.get(a.Wc))i.push({Qf:a.Wc,location:s});else if(s=e.F.find(function(e){return function(t){return t.Rj==e.Wc}}(a))){var o=t.get(s["BASE-ID"]);o&&(s["URI-REPLACEMENT"].Gh?(Wn(o=new zn(o),s["URI-REPLACEMENT"].Gh),i.push({Qf:a.Wc,location:o.toString()})):i.push({Qf:a.Wc,location:o}))}for(r=Date.now(),s=(a=c(e.j.keys())).next();!s.done;s=a.next())s=s.value,r>(o=e.j.get(s))&&e.j.delete(s);if(i=i.filter((function(t){for(var n=c(e.j.keys()),i=n.next();!i.done;i=n.next())if(i.value.includes(new zn(t.location).wb))return!1;return!0})),i.length&&(e.B=i[0].Qf),i=i.map((function(e){return e.location})),!i.length&&e.h)for(a=(r=c(e.h.split(","))).next();!a.done;a=r.next())(a=t.get(a.value))&&(e.B=e.h,i.push(a));if(!i.length)for(r=(t=c(t.values())).next();!r.done;r=t.next())i.push(r.value);return n?i:gi(e.i,i)}function rg(){this.l=[],this.h=[],this.g=[],this.j=[],this.i=[],this.s=this.o=!1,this.m=new Set}function sg(e,t){for(var n=[],i=[],r=[],s=[],a=(e=c(e)).next();!a.done;a=e.next()){var o=a.value;a=new Map(o.audioStreams.map((function(e){return[Dg(e),e]})));var l=new Map(o.videoStreams.map((function(e){return[Lg(e),e]}))),u=new Map(o.textStreams.map((function(e){return[Rg(e),e]})));if(o=new Map(o.imageStreams.map((function(e){return[Mg(e),e]}))),t){var d=xg(Si);u.set(Rg(d),d),d=xg("image"),o.set(Mg(d),d)}n.push(a),i.push(l),r.push(u),s.push(o)}return{xg:n,Eh:i,Ah:r,Rg:s}}function ag(e){var t,n,i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,_,w,E,k,x,A,C,I,L,D;return M((function(R){switch(R.g){case 1:if(t=_i,1==e.length)return R.return(e[0]);for(n=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.U})).map((function(e){return[Dg(e),e]})))})),i=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.la})).map((function(e){return[Lg(e),e]})))})),r=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.xa})).map((function(e){return[Rg(e),e]})))})),s=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.Re})).map((function(e){return[Mg(e),e]})))})),a=c(r),o=a.next();!o.done;o=a.next())l=o.value,u=kg(t.xa),l.set(Rg(u),u);for(d=c(s),h=d.next();!h.done;h=d.next())f=h.value,p=kg(t.Re),f.set(Mg(p),p);return S(R,og(g=new rg,[],n,0,hg,pg,0),2);case 2:return m=R.h,S(R,og(g,[],i,0,hg,pg,0),3);case 3:return y=R.h,S(R,og(g,[],r,0,hg,pg,0),4);case 4:return v=R.h,S(R,og(g,[],s,0,hg,pg,0),5);case 5:if(b=R.h,T=0,y.length&&m.length)for(k=c(m),x=k.next();!x.done;x=k.next())for(A=x.value,C=c(y),I=C.next();!I.done;I=C.next())L=I.value,D=T++,L.variantIds.push(D),A.variantIds.push(D);else for(_=y.concat(m),w=c(_),E=w.next();!E.done;E=w.next())E.value.variantIds=[T++];return R.return(y.concat(m).concat(v).concat(b))}}))}function og(e,t,n,i,r,s,a){var o,l,u,d,h,f,p,g,m,y,v,b,T,_,w,E,k,x;return M((function(A){switch(A.g){case 1:for(o=[],l=0;l<n.length;l++)l>=i?o.push(new Set(n[l].values())):o.push(new Set);u=c(t),d=u.next();case 2:if(d.done){A.u(4);break}return h=d.value,S(A,function(e,t,n,i,r,s,a){return M((function(o){return 1==o.g?(gg(e,n,t,0<a),t.matchedStreams?t.segmentIndex?S(o,lg(t,i+a),2):o.u(2):o.return(!1)):(cg(t,i,r,s,a),o.return(!0))}))}(e,h,n,i,s,o,a),5);case 5:if(!A.h)throw new Me(2,4,4037);d=u.next(),A.u(2);break;case 4:for(f=c(o),p=f.next();!p.done;p=f.next())for(g=p.value,m=c(g),y=m.next();!y.done;y=m.next())v=y.value,(b=ug(e,v,n,r,s,o))&&t.push(b);for(T=c(o),_=T.next();!_.done;_=T.next())for(w=_.value,E=c(w),k=E.next(),x={};!k.done;x={fg:void 0},k=E.next())if(x.fg=k.value,!Ig(x.fg)&&t.some(function(t){return function(n){return vg(e,t.fg,n)}}(x)))throw new Me(2,4,4037);return A.return(t)}}))}function lg(e,t){var n,i,r,s,a,o;return M((function(l){if(1==l.g){for(n=[],i=e.matchedStreams,r=t;r<i.length;r++)s=i[r],n.push(s.createSegmentIndex()),s.trickModeVideo&&!s.trickModeVideo.segmentIndex&&n.push(s.trickModeVideo.createSegmentIndex());return S(l,Promise.all(n),2)}if(e.segmentIndex instanceof ml)for(a=t;a<i.length;a++)(o=i[a]).segmentIndex&&e.segmentIndex.h.push(o.segmentIndex);_(l)}))}function ug(e,t,n,i,r,s){if(Ig(t))return null;var a=i(t);return gg(e,n,a),a.createSegmentIndex&&(a.createSegmentIndex=function(){return M((function(e){return a.segmentIndex?e.u(0):(a.segmentIndex=new ml,S(e,lg(a,0),0))}))}),a.matchedStreams&&a.matchedStreams.length?(cg(a,0,r,s,0),a):null}function cg(e,t,n,i,r){var s=e.matchedStreams;for(t+=r;t<s.length;t++){var a=s[t];n(e,a);var o=!0;if("audio"==e.type&&0==tr(e.language,a.language)&&(o=!1),o&&(i[t-r].delete(a),a.fullMimeTypes))for(o=(a=c(a.fullMimeTypes.values())).next();!o.done;o=a.next())e.fullMimeTypes.add(o.value)}}function dg(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var e=c(t.matchedStreams),n=e.next();!n.done;n=e.next())(n=n.value).segmentIndex&&(n.segmentIndex.release(),n.segmentIndex=null)},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set(e.keyIds),t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t.trickModeVideo=null,t}function hg(e){var t=Object.assign({},e);return t.roles=t.roles.slice(),t.keyIds=new Set(e.keyIds),t.segments=[],t.variantIds=[],t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t}function fg(e,t){function n(e,t){e||(e=[]);for(var n=(t=c(t)).next();!n.done;n=t.next())n=n.value,e.includes(n)||e.push(n);return e}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var i=c(t.keyIds),r=i.next();!r.done;r=i.next())e.keyIds.add(r.value);if(null==e.originalId?e.originalId=t.originalId:(i=t.originalId||"")&&!e.originalId.endsWith(i)&&(e.originalId+=","+i),i=Ue(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!i.length)throw new Me(2,4,4038);if(e.drmInfos=i,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),r=(i=c(t.closedCaptions)).next();!r.done;r=i.next()){var s=c(r.value);r=s.next().value,s=s.next().value,e.closedCaptions.set(r,s)}e.bandwidth&&t.bandwidth&&(e.bandwidth=Math.max(e.bandwidth,t.bandwidth)),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=dg(t.trickModeVideo),e.trickModeVideo.matchedStreams=[],e.trickModeVideo.createSegmentIndex=function(){if(e.trickModeVideo.segmentIndex)return Promise.resolve();for(var t=new ml,n=c(e.trickModeVideo.matchedStreams),i=n.next();!i.done;i=n.next())t.h.push(i.value.segmentIndex);return e.trickModeVideo.segmentIndex=t,Promise.resolve()}),e.trickModeVideo.matchedStreams.push(t.trickModeVideo),fg(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&(e.trickModeVideo.matchedStreams.push(t),fg(e.trickModeVideo,t))}function pg(e,t){var n=e.roles;n||(n=[]);for(var i=c(t.roles),r=i.next();!r.done;r=i.next())r=r.value,n.includes(r)||n.push(r);for(e.roles=n,i=(n=c(t.keyIds)).next();!i.done;i=n.next())e.keyIds.add(i.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,d(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),n=(t=c(t.closedCaptions)).next();!n.done;n=t.next())n=(i=c(n.value)).next().value,i=i.next().value,e.closedCaptions.set(n,i)}function gg(e,t,n,i){i=void 0!==i&&i?n.matchedStreams:[];for(var r=(t=c(t)).next();!r.done;r=t.next()){if(!(r=mg(e,r.value,n)))return;i.push(r)}n.matchedStreams=i}function mg(e,t,n){var i={audio:Dg,video:Lg,text:Rg,image:Mg}[n.type],r=null,s=i(n);if(t.has(s))r=t.get(s);else{s={audio:function(t,n){return vg(e,t,n)},video:function(t,n){return vg(e,t,n)},text:bg,image:Tg}[n.type];for(var a={audio:Sg,video:_g,text:wg,image:Eg}[n.type],o=c(t.values()),l=o.next();!l.done;l=o.next())!s(n,l=l.value)||n.fastSwitching!=l.fastSwitching||r&&!a(n,r,l)||(r=l)}return e.s&&!Ig(r)&&t.delete(i(r)),r}function yg(e,t){return e.mimeType==t.mimeType&&Pg(e.codecs)===Pg(t.codecs)}function vg(e,t,n){return!(!yg(t,n)&&!e.o||t.drmInfos&&!Ne(t.drmInfos,n.drmInfos))}function bg(e,t){return!t.language||e.forced===t.forced&&0!=tr(e.language,t.language)&&t.kind==e.kind}function Tg(){return!0}function Sg(e,t,n){var i=yg(e,t),r=yg(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if(i=tr(e.language,t.language),(r=tr(e.language,n.language))>i)return!0;if(r<i)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter((function(t){return e.roles.includes(t)})),(r=n.roles.filter((function(t){return e.roles.includes(t)}))).length>i.length)return!0;if(r.length<i.length)return!1;if(n.roles.length!==t.roles.length)return n.roles.length<t.roles.length}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!(t.primary||!n.primary)||!(t.primary&&!n.primary)&&((i=Ag(e.channelsCount,t.channelsCount,n.channelsCount))==Og||i!=Ug&&((i=Ag(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate))==Og||i!=Ug&&!(!e.bandwidth||Cg(e.bandwidth,t.bandwidth,n.bandwidth)!=Og)))}function _g(e,t,n){var i=yg(e,t),r=yg(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if((i=Ag(e.width*e.height,t.width*t.height,n.width*n.height))==Og)return!0;if(i==Ug)return!1;if(e.frameRate){if((i=Ag(e.frameRate,t.frameRate,n.frameRate))==Og)return!0;if(i==Ug)return!1}return!(!e.bandwidth||Cg(e.bandwidth,t.bandwidth,n.bandwidth)!=Og)}function wg(e,t,n){var i=tr(e.language,t.language),r=tr(e.language,n.language);if(r>i)return!0;if(r<i)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter((function(t){return e.roles.includes(t)})),(r=n.roles.filter((function(t){return e.roles.includes(t)}))).length>i.length)return!0;if(r.length<i.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return n.mimeType==e.mimeType&&n.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)}function Eg(e,t,n){return Ag(e.width*e.height,t.width*t.height,n.width*n.height)==Og}function kg(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}function xg(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new hl([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1}}function Ag(e,t,n){if(t==e&&e!=n)return Ug;if(n==e&&e!=t)return Og;if(t>e){if(n<=e||n-e<t-e)return Og;if(n-e>t-e)return Ug}else{if(n>e)return Ug;if(e-n<e-t)return Og;if(e-n>e-t)return Ug}return Ng}function Cg(e,t,n){return t=Math.abs(e-t),(e=Math.abs(e-n))<t?Og:t<e?Ug:Ng}function Ig(e){switch(e.type){case Si:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function Lg(e){return JSON.stringify([e.fastSwitching,e.width,e.frameRate,Pg(e.codecs),e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth,Array.from(e.keyIds)])}function Dg(e){return JSON.stringify([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,Pg(e.codecs),e.mimeType,e.roles,e.audioSamplingRate,e.primary,Array.from(e.keyIds)])}function Rg(e){return JSON.stringify([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function Mg(e){return JSON.stringify([e.width,e.codecs,e.mimeType])}function Pg(e){if(!Fg.has(e)){var t=Di(e);Fg.set(e,t)}return Fg.get(e)}y(Xp,hl),(i=Xp.prototype).getNumReferences=function(){return this.h?this.h.timeline.length:0},i.release=function(){hl.prototype.release.call(this),this.h=null},i.Ja=function(e){if(this.h){for(var t=0,n=this.h.timeline,i=0;i<n.length&&n[i].end+this.j<=e;i+=1)t+=1;0<t&&(this.h.timeline=n.slice(t),this.g.length>=t&&(this.g=this.g.slice(t)),this.i+=t,0===this.getNumReferences()&&this.release())}},i.find=function(e){if(this.h&&this.h.timeline&&this.h.timeline.length&&e<this.h.timeline[0].start+this.j)return this.i;if(!this.h)return null;var t=this.h.timeline;if(e<this.j||e>=this.l)return null;for(var n=t.length-1,i=0;i<t.length;i++){var r=t[i],s=r.start+this.j;if(r=i<n?t[i+1].start+this.j:1/0===this.l?r.end+this.j:this.l,e>=s&&e<r)return i+this.i}return null},i.get=function(e){var t=this;if(0>(e-=this.i)||e>=this.getNumReferences()||!this.h)return null;var n=this.g[e];if(!n){var i=this.h.timeline[e],r=i.kj,s=i.og+this.h.ng;n=this.j-this.h.hc;var a=this.j+i.end,o=a;e===this.getNumReferences()-1&&1/0!==this.l&&(o=this.l);for(var l=this.h.codecs,u=this.h.mimeType,c=this.h.bandwidth,d=[],h=(i.end-i.start)/i.Hb,f={},p=0;p<i.Hb;f={Fe:void 0,xh:void 0},p++){var g=i.start+h*p,m=g+h;f.xh=p+1,f.Fe=null,(f=new ka(this.j+g,this.j+m,function(e){return function(){return t.h?(null==e.Fe&&(e.Fe=Jp(t.h.ec,t.F,r,t.B,s,e.xh,t.C,t.H)),e.Fe):[]}}(f),0,null,this.s,n,this.j,this.l,[],"",null,null,Aa,this.A)).codecs=l,f.mimeType=u,f.bandwidth=c,0==this.G?0<p&&f.Sc():0!=p%this.G&&f.Sc(),d.push(f)}(n=new ka(this.j+i.start,o,(function(){return 0<i.Hb||!t.h?[]:Jp(t.h.ec,t.F,r,t.B,s,null,t.C,t.H)}),0,null,this.s,n,this.j,this.l,d,"",null,null,Aa,this.A,0<i.Hb)).codecs=l,n.mimeType=u,n.j=a,n.bandwidth=c,this.g[e]=n}return n},i.Eb=function(e){Qp(this);for(var t=0;t<this.getNumReferences();t++){var n=this.get(t+this.i);n&&e(n)}},Zp.prototype.configure=function(e){this.o=e},Zp.prototype.destroy=function(){return this.A=this.o=null,this.i=[],this.h=null,this.m=[],this.F=[],this.l.clear(),null!=this.g&&(this.g.stop(),this.g=null),this.G.destroy()},Zp.prototype.setManifestType=function(e){this.s=e},Zp.prototype.banLocation=function(e){this.j.set(e,Date.now()+6e4)},(i=rg.prototype).release=function(){for(var e=c(this.h.concat(this.g,this.j,this.i)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.j=[],this.i=[],this.l=[],this.s=this.o=!1,this.m.clear()},i.zi=function(){return this.l},i.zf=function(){return this.j.slice()},i.fi=function(){return this.i},i.Eg=function(e,t){if(e){if("audio"==e.type)for(var n=c(this.h),i=n.next();!i.done;i=n.next())(i=i.value).matchedStreams=i.matchedStreams.filter((function(t){return t!==e}));else if("video"==e.type)for(i=(n=c(this.g)).next();!i.done;i=n.next())(i=i.value).matchedStreams=i.matchedStreams.filter((function(t){return t!==e})),i.trickModeVideo&&(i.trickModeVideo.matchedStreams=i.trickModeVideo.matchedStreams.filter((function(t){return t!==e})));else if(e.type==Si)for(i=(n=c(this.j)).next();!i.done;i=n.next())(i=i.value).matchedStreams=i.matchedStreams.filter((function(t){return t!==e}));else if("image"==e.type)for(i=(n=c(this.i)).next();!i.done;i=n.next())(i=i.value).matchedStreams=i.matchedStreams.filter((function(t){return t!==e}));e.segmentIndex&&e.closeSegmentIndex(),this.m.delete(t)}},i.Xe=function(e,t,n){n=void 0!==n&&n;var i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,w,E,k,x,A,C,I,L,D,R,P,O,N,U=this;return M((function(M){if(1==M.g){if(i=_i,!t&&1==e.length)return r=sg(e,!1),s=r.xg,a=r.Eh,o=r.Ah,l=r.Rg,U.h=Array.from(s[0].values()),U.g=Array.from(a[0].values()),U.j=Array.from(o[0].values()),U.i=Array.from(l[0].values()),M.u(2);for(u=n?U.m.size:0,d=-1,h=0;h<e.length;h++)f=e[h],U.m.has(f.id)||(U.m.add(f.id),-1==d&&(d=h));return-1==d?M.return():(p=sg(e,!0),g=p.xg,m=p.Eh,y=p.Ah,v=p.Rg,S(M,Promise.all([og(U,U.h,g,d,dg,fg,u),og(U,U.g,m,d,dg,fg,u),og(U,U.j,y,d,dg,fg,u),og(U,U.i,v,d,dg,fg,u)]),2))}if(b=0,T=[],U.g.length&&U.h.length)for(C=c(U.h),I=C.next();!I.done;I=C.next())for(L=I.value,D=c(U.g),R=D.next();!R.done;R=D.next())P=R.value,O=Ue(L.drmInfos,P.drmInfos),L.drmInfos.length&&P.drmInfos.length&&!O.length||(N=b++,T.push({id:N,language:L.language,disabledUntilTime:0,primary:L.primary,audio:L,video:P,bandwidth:(L.bandwidth||0)+(P.bandwidth||0),drmInfos:O,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(w=U.g.length?U.g:U.h,E=c(w),k=E.next();!k.done;k=E.next())x=k.value,A=b++,T.push({id:A,language:x.language,disabledUntilTime:0,primary:x.primary,audio:x.type==i.U?x:null,video:x.type==i.la?x:null,bandwidth:x.bandwidth||0,drmInfos:x.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});U.l=T,_(M)}))},i.mh=function(e){this.o=e},i.sh=function(e){this.s=e},$("shaka.util.PeriodCombiner",rg),rg.prototype.setUseStreamOnce=rg.prototype.sh,rg.prototype.setAllowMultiTypeVariants=rg.prototype.mh,rg.prototype.combinePeriods=rg.prototype.Xe,rg.prototype.deleteStream=rg.prototype.Eg,rg.prototype.getImageStreams=rg.prototype.fi,rg.prototype.getTextStreams=rg.prototype.zf,rg.prototype.getVariants=rg.prototype.zi;var Og=1,Ng=0,Ug=-1,Fg=new Map;function Bg(e,t){try{return function(e,t){var n=new DOMParser,i=jg.value()(e);e=null;try{e=n.parseFromString(i,"text/xml")}catch(r){return null}if(!(n=e.documentElement)||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}(mt(e),t)}catch(n){return null}}var jg=new Oe((function(){if("undefined"!==typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}}));function $g(){var e=this;this.j=this.g=null,this.A=[],this.i=null,this.pa=1,this.F=[],this.l={he:"",type:"",profiles:[],Tb:null,cb:0,Ra:null,Gd:0},this.s=new Map,this.o=new Map,this.B=new Map,this.ja=new Map,this.m=new rg,this.I=0,this.oa=new q(5),this.K=new Ve((function(){e.H&&!e.g.continueLoadingWhenPaused&&(e.G.bb(e.H,"timeupdate"),e.H.paused)?e.G.ma(e.H,"timeupdate",(function(){return tm(e)})):tm(e)})),this.O=new Qr,this.M=null,this.C=[],this.da=1/0,this.ia=!1,this.h=null,this.L=0,this.P=!1,this.G=new ee,this.H=null,this.W=!1,this.ba="",this.ga=function(){return!1},this.$=[]}function Vg(e){var t,n,i,r,s,a,o,l,u,h,f;return M((function(p){return 1==p.g?(t=4,n="MPD",i=function(e){var t=e.l.Gd;if(!e.l.he||!t||!e.F.length)return[];var n=Date.now()/1e3,i=e.F.filter((function(e){return!(e=Jt(e.attributes.ttl))||t+e>n})).map(Bt).filter(Wi);return i.length?gi(e.A,i):[]}(e),r=e.A,i.length?(r=i,n="Patch",t=6):1<e.A.length&&e.h&&((s=ig(e.h,"Location",!0)).length&&(r=s)),a=ns(r,e.g.retryParameters),o=Date.now(),S(p,lm(e,a,0,{type:t}),2)):3!=p.g?(l=p.h,e.j?(l.uri&&l.uri!=l.originalUri&&!e.A.includes(l.uri)&&e.A.unshift(l.uri),u=new zn(l.uri),e.ba=u.g.toString(),S(p,function(e,t,n,i){var r,s,a,o,l,u,h,f;return M((function(p){if(1==p.g){if(r=t,(s=e.g.dash.manifestPreprocessor)!=wu){if(oe("manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),!(a=Bg(r,i)))throw new Me(2,4,4001,n);s(a),r=yt(a.outerHTML)}if(!(o=Rt(r,i)))throw new Me(2,4,4001,n);return(l=e.g.dash.manifestPreprocessorTXml)!=Eu&&l(o),"Patch"===i?p.return(function(e,t){var n,i,r,s,a,o,l,u,h,f,p,g,m,y,v,b,T,w,E,k,x,A,C,I;return M((function(L){if(1==L.g){if(n=t.attributes.mpdId,i=Ht(t,"originalPublishTime",Kt),!n||n!==e.l.he||i!==e.l.Gd)throw e.F=[],new Me(1,4,4052);for(r=[],s=[],a=new Set,o=c(Nt(t)),l=o.next();!l.done;l=o.next())if(u=l.value,h=nn(u.attributes.sel||""),f=h[h.length-1],p=Bt(u)||"","MPD"===f.name)if("mediaPresentationDuration"===f.Yb){var D=Wt(Bt(u)||"");if(null!=D){e.l.Tb=D;for(var R=c(e.s.values()),M=R.next();!M.done;M=R.next())M.value.Tb=D}}else if("type"===f.Yb){for(e.i.presentationTimeline.Dc("static"==p),e.l.type=p,R=(D=c(e.s.values())).next();!R.done;R=D.next())R.value.Mb="dynamic"==p;"static"==p&&(e.I=-1)}else"publishTime"===f.Yb?e.l.Gd=Kt(p)||0:null===f.Yb&&"add"===u.tagName&&s.push(u);else if("PatchLocation"===f.name)rn(e.F,u);else if("Period"===f.name)"add"===u.tagName?s.push(u):"remove"===u.tagName&&f.id&&zg(e,f.id);else if("SegmentTemplate"===f.name){if((D=(R=nn(u.attributes.sel||""))[R.length-1]).Yb){R=Kg(e,R),M=Bt(u)||"";for(var P=c(R),O=P.next();!O.done;O=P.next())an((O=e.s.get(O.value)).J.ic,u.tagName,D.Yb,M);D=R}else D=[];for(g=c(D),m=g.next();!m.done;m=g.next())y=m.value,a.add(y)}else if("SegmentTimeline"===f.name||"S"===f.name){for(D=nn(u.attributes.sel||""),M=(R=c(D=Kg(e,D))).next();!M.done;M=R.next())rn(P=Ut(M=Cp(M=e.s.get(M.value),Wp,"SegmentTimeline"),"S"),u),M.children=P;for(v=c(D),b=v.next();!b.done;b=v.next())T=b.value,a.add(T)}for(w=c(a),E=w.next();!E.done;E=w.next())k=E.value,Wg(e,k);for(x=c(s),A=x.next();!A.done;A=x.next())C=A.value,r.push.apply(r,d(Gg(e,C)));return r.length?(e.i.periodCount+=r.length,e.i.gapCount=e.L,S(L,qg(e,r,!0),2)):L.u(2)}"static"==e.l.type&&(I=e.l.Tb,e.i.presentationTimeline.ab(I||1/0)),_(L)}))}(e,o)):e.g.dash.disableXlinkProcessing?p.return(Hg(e,o,n)):(u=e.g.dash.xlinkFailGracefully,h=Ip(o,e.g.retryParameters,u,n,e.j.networkingEngine),Jr(e.O,h),S(p,h.promise,2))}return f=p.h,p.return(Hg(e,f,n))}))}(e,l.data,l.uri,n),3)):p.return(0)):(h=Date.now(),f=(h-o)/1e3,e.oa.sample(1,f),p.return(f))}))}function Hg(e,t,n){var i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,E,A,C,I,L,D,R,P,O,N,U,F,B,j,$,V,H,q,G,z,K,W,Y,Q,J,Z,ee,te,ne,ie,re,se,ae,oe,le;return M((function(ue){switch(ue.g){case 1:for(e.h&&e.h.l.clear(),i=[n],r=[],s=new Map,a=Ut(t,"Location"),o=c(a),l=o.next();!l.done;l=o.next())u=l.value,d=u.attributes.serviceLocation,(h=Bt(u))&&(f=gi(i,[h])[0],d&&(e.h?ng(e.h,"Location",d,f):s.set(d,f)),r.push(f));if(e.h?0<(p=ig(e.h,"Location",!0)).length&&(i=e.A=p):r.length&&(i=e.A=r),e.l.he=t.attributes.id||"",e.l.Gd=Ht(t,"publishTime",Kt)||0,e.F=Ut(t,"PatchLocation"),g=Promise.resolve(),(m=$t(t,"ContentSteering"))&&e.j)for(y=m.attributes.defaultServiceLocation,e.h?(e.h.i=i,e.h.h=y):(e.h=new Zp(e.j),e.h.configure(e.g),e.h.setManifestType("DASH"),e.h.i=i,e.h.h=y,(v=Bt(m))&&(Ht(m,"queryBeforeStart",en,!1)?g=eg(e.h,v):eg(e.h,v))),b=c(s.keys()),T=b.next();!T.done;T=b.next())E=T.value,A=s.get(E),ng(e.h,"Location",E,A);if(C=Ut(t,"BaseURL"),I=!1,e.h)for(L=c(C),D=L.next();!D.done;D=L.next())R=D.value,P=R.attributes.serviceLocation,O=Bt(R),P&&O&&(ng(e.h,"BaseURL",P,O),I=!0);if(e.$=null,I&&e.h||(N=C.map(Bt),e.$=gi(i,N)),U=function(){return e.h&&I?ig(e.h,"BaseURL"):e.$?e.$:[]},e.l.Ra=U,F=0,C&&C.length&&(F=Ht(C[0],"availabilityTimeOffset",Zt)||0),e.l.cb=F,e.I=Ht(t,"minimumUpdatePeriod",Wt,-1),B=Ht(t,"availabilityStartTime",Kt),j=Ht(t,"timeShiftBufferDepth",Wt),$=e.g.dash.ignoreSuggestedPresentationDelay,V=null,$||(V=Ht(t,"suggestedPresentationDelay",Wt)),H=e.g.dash.ignoreMaxSegmentDuration,q=null,H||(q=Ht(t,"maxSegmentDuration",Wt)),G=t.attributes.type||"static",e.i&&e.i.presentationTimeline&&(e.W=e.i.presentationTimeline.T()&&"static"==G),e.l.type=G,e.i)for(z=e.i.presentationTimeline,K=z.ob(),W=c(e.o.values()),Y=W.next();!Y.done;Y=W.next())(Q=Y.value).segmentIndex&&Q.segmentIndex.Ja(K);else J=e.g.dash.ignoreMinBufferTime,Z=0,J||(Z=Ht(t,"minBufferTime",Wt)||0),0,ee=null!=V?Math.min(V,j||1/0):0<e.g.defaultPresentationDelay?e.g.defaultPresentationDelay:Math.min(1.5*Z,j||1/0),z=new zo(B,ee,e.g.dash.autoCorrectDrift);return z.Dc("static"==G),z.T()&&!isNaN(e.g.availabilityWindowOverride)&&(j=e.g.availabilityWindowOverride),null==j&&(j=1/0),z.xe(j),te=t.attributes.profiles||"",e.l.profiles=te.split(","),ne={Mb:"static"!=G,presentationTimeline:z,qa:null,ka:null,ea:null,J:null,bandwidth:0,Bf:!1,cb:F,Tb:null,profiles:te.split(","),roles:null,ub:function(){return""}},S(ue,g,2);case 2:return e.L=0,ie=Qg(e,ne,U,t,!1),re=ie.duration,se=ie.periods,("static"!=G||e.W)&&ie.Gg||z.ab(re||1/0),e.P&&e.ia&&z.nh(e.da),z.Lf(q||1),e.P&&e.ia&&(ae=null!=V?V:e.g.defaultPresentationDelay,z.bg(ae)),e.i?(e.i.periodCount=se.length,e.i.gapCount=e.L,S(ue,qg(e,se,!1),4)):S(ue,e.m.Xe(se,ne.Mb),6);case 6:if(e.i={presentationTimeline:z,variants:e.m.l,textStreams:e.m.zf(),imageStreams:e.m.i,offlineSessionIds:[],sequenceMode:e.g.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:Xg(t),nextUrl:Yg(t),periodCount:se.length,gapCount:e.L,isLowLatency:e.P,startTime:null},!z.Ch()){ue.u(7);break}return oe=Ut(t,"UTCTiming"),S(ue,function(e,t,n){var i,r,s,a,o,l,u,d;return M((function(h){switch(h.g){case 1:i=n.map((function(e){return{scheme:e.attributes.schemeIdUri,value:e.attributes.value}})),r=e.g.dash.clockSyncUri,!i.length&&r&&i.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),s=c(i),a=s.next();case 2:if(a.done){h.u(4);break}switch(o=a.value,w(h,5),l=o.scheme,u=o.value,l){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return h.u(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return h.u(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return d=Date.parse(u),h.return(isNaN(d)?0:d-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":X("NTP UTCTiming scheme is not supported");break;default:X("Unrecognized scheme in UTCTiming element",l)}h.u(9);break;case 7:return S(h,rm(e,t,u,"HEAD"),10);case 10:return h.return(h.h);case 8:return S(h,rm(e,t,u,"GET"),11);case 11:return h.return(h.h);case 9:k(h,3);break;case 5:x(h);case 3:a=s.next(),h.u(2);break;case 4:return X("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),h.return(0)}}))}(e,U,oe),8);case 8:if(le=ue.h,!e.j)return ue.return();z.oh(le);case 7:z.de();case 4:e.j.makeTextStreamsForClosedCaptions(e.i),function(e){for(var t=Array.from(e.B.keys()).filter((function(t){return!e.C.includes(t)})),n=(t=c(t)).next();!n.done;n=t.next()){n=n.value;for(var i=!0,r=c(e.B.get(n)),s=r.next();!s.done;s=r.next()){s=s.value;var a=e.o.get(s);a&&(a.segmentIndex&&0!=a.segmentIndex.getNumReferences()?i=!1:(e.m&&e.m.Eg(a,n),e.o.delete(s)))}i&&e.B.delete(n)}}(e),_(ue)}}))}function qg(e,t,n){var i;return M((function(r){if(1==r.g)return S(r,e.m.Xe(t,!0,n),2);e.i.variants=e.m.l,0<(i=e.m.zf()).length&&(e.i.textStreams=i),e.i.imageStreams=e.m.i,e.j.filter(e.i),_(r)}))}function Gg(e,t){return Qg(e,{Mb:"dynamic"==e.l.type,presentationTimeline:e.i.presentationTimeline,qa:null,ka:null,ea:null,J:null,bandwidth:0,Bf:!1,cb:e.l.cb,profiles:e.l.profiles,Tb:e.l.Tb,roles:null,ub:function(){return""}},e.l.Ra,t,!0).periods}function zg(e,t){e.i.periodCount--;for(var n=c(e.s.keys()),i=n.next();!i.done;i=n.next())if((i=i.value).startsWith(t)){Cp(e.s.get(i),Wp,"SegmentTimeline").children=[],Wg(e,i),e.s.delete(i)}e.C=e.C.filter((function(e){return e!==t}))}function Kg(e,t){for(var n="",i="",r=-1,s="",a=(t=c(t)).next();!a.done;a=t.next())"Period"===(a=a.value).name?n=a.id:"AdaptationSet"===a.name?(i=a.id,null!==a.position&&(r=a.position)):"Representation"===a.name&&(s=a.id);if(t=[],s)t.push(n+","+s);else if(i)for(r=c(e.s.values()),e=r.next();!e.done;e=r.next())(e=e.value).qa.id===n&&e.ea.id===i&&e.J.id&&t.push(n+","+e.J.id);else if(-1<r)for(i=c(e.s.values()),e=i.next();!e.done;e=i.next())(e=e.value).qa.id===n&&e.ea.position===r&&e.J.id&&t.push(n+","+e.J.id);return t}function Wg(e,t){var n=e.s.get(t),i=e.o.get(t);i.segmentIndex&&i.segmentIndex.Ja(e.i.presentationTimeline.ob());try{var r=Kp(n,(function(t,n,i,r){return am(e,t,n,i,r)}),e.o,!0,e.g.dash.initialSegmentLimit,e.ja,n.J.aesKey,null,!0);i.createSegmentIndex=function(){return M((function(e){if(1==e.g)return i.segmentIndex?e.u(0):S(e,r.qc(),3);i.segmentIndex=e.h,_(e)}))}}catch(s){if((t=n.J.contentType)!=Si&&"application"!=t&&"image"!=t||4002!=s.code)throw s}}function Xg(e){var t=$t(e,"ServiceDescription");if(!t)return null;if(e=$t(t,"Latency"),t=$t(t,"PlaybackRate"),!e&&!t)return null;var n={};return e&&("target"in e.attributes&&(n.targetLatency=parseInt(e.attributes.target,10)/1e3),"max"in e.attributes&&(n.maxLatency=parseInt(e.attributes.max,10)/1e3),"min"in e.attributes&&(n.minLatency=parseInt(e.attributes.min,10)/1e3)),t&&("max"in t.attributes&&(n.maxPlaybackRate=parseFloat(t.attributes.max)),"min"in t.attributes&&(n.minPlaybackRate=parseFloat(t.attributes.min))),n}function Yg(e){if(!(e=Ut(e,"SupplementalProperty")).length)return null;for(var t=(e=c(e)).next();!t.done;t=e.next())if("urn:mpeg:dash:chaining:2016"==(t=t.value).attributes.schemeIdUri)return t.attributes.value;return null}function Qg(e,t,n,i,r){var s=t.Tb;s||(s=Ht(i,"mediaPresentationDuration",Wt),e.l.Tb=s);var a=0;e.i&&e.i.presentationTimeline&&e.W&&(a=e.i.presentationTimeline.Gb());var o=[],l=a;i=Ut(i,"Period");for(var u=0;u<i.length;u++){var d=i[u],h=i[u+1],f=Ht(d,"start",Wt,l),p=d.attributes.id,g=Ht(d,"duration",Wt);f=0==u&&0==f&&e.W?a:f;var m=null;if(h){var y=Ht(h,"start",Wt);null!=y&&(m=y-f+a)}else null!=s&&(m=s-f+a);if(y=wi,m&&g&&Math.abs(m-g)>y&&m>g&&e.L++,null==m&&(m=g),!(null!==e.M&&null!==p&&null!==f&&f<e.M)||e.C.includes(p)||u+1==i.length){if(null!==f&&(null===e.M||f>e.M)&&(e.M=f),l=Jg(e,t,n,{start:f,duration:m,node:d,Tg:null==m||!h}),o.push(l),t.qa.id&&m&&e.ja.set(t.qa.id,m),null==m){l=null;break}l=f+m}}if(r)for(n=(t=c(o)).next();!n.done;n=t.next())n=n.value.id,e.C.includes(n)||e.C.push(n);else e.C=o.map((function(e){return e.id}));return null!=s?{periods:o,duration:s+a,Gg:!1}:{periods:o,duration:l,Gg:!0}}function Jg(t,n,i,r){n.qa=im(t,r.node,null,i),n.ka=r,n.qa.cb=n.cb,n.qa.id||(n.qa.id="__shaka_period_"+r.start);var s=Ut(r.node,"EventStream");i=n.presentationTimeline.ob();for(var a=(s=c(s)).next();!a.done;a=s.next())sm(t,r.start,r.duration,a.value,i);for(s=(i=c(i=Ut(r.node,"SupplementalProperty"))).next();!s.done;s=i.next())"urn:mpeg:dash:urlparam:2014"==(s=s.value).attributes.schemeIdUri&&(s=em(t,s))&&(n.ub=s);if(i=Ut(r.node,"AdaptationSet").map((function(i,r){return function(t,n,i,r){function s(e){var i=e.attributes["dvb:fontFamily"];e=e.attributes["dvb:url"],i&&e&&(e=gi(n.ea.Ra(),[e],n.ub()),t.j.addFont(i,e[0]))}function a(e){switch(e){case 1:case 5:case 6:case 7:return"srgb";case 9:return"rec2020";case 11:case 12:return"p3"}}function o(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}n.ea=im(t,r,n.qa,null),n.ea.position=i;var l=!1;i=Ut(r,"Role");var u=i.map((function(e){return e.attributes.value})).filter(Wi),h=void 0,f=n.ea.contentType==Si;f&&(h="subtitle");for(var p=(i=c(i)).next();!p.done;p=i.next()){var g=(p=p.value).attributes.schemeIdUri;if(null==g||"urn:mpeg:dash:role:2011"==g)switch(p=p.attributes.value,p){case"main":l=!0;break;case"caption":case"subtitle":h=p}}var m=Ut(r,"EssentialProperty");i=null;var y=!1;p=null,g=!1;for(var v=(m=c(m)).next();!v.done;v=m.next()){var b=(v=v.value).attributes.schemeIdUri;if("http://dashif.org/guidelines/trickmode"==b)i=v.attributes.value;else if("urn:mpeg:mpegB:cicp:TransferCharacteristics"==b)var T=o(parseInt(v.attributes.value,10));else if("urn:mpeg:mpegB:cicp:ColourPrimaries"==b)var w=a(parseInt(v.attributes.value,10));else"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=b&&("urn:mpeg:dash:ssr:2023"==b&&t.g.dash.enableFastSwitching?y=!0:"urn:dvb:dash:fontdownload:2014"==b?s(v):"urn:mpeg:dash:urlparam:2014"==b&&(p=em(t,v))||(g=!0))}if(g)return null;var E=null;for(g=c(g=Ut(r,"SupplementalProperty")),m=g.next();!m.done;m=g.next())m=m.value,"http://dashif.org/guidelines/last-segment-number"==(v=m.attributes.schemeIdUri)?E=parseInt(m.attributes.value,10)-1:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==v?T=o(parseInt(m.attributes.value,10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"==v?w=a(parseInt(m.attributes.value,10)):"urn:dvb:dash:fontdownload:2014"==v?s(m):"urn:mpeg:dash:urlparam:2014"==v&&(p=em(t,m));p&&(n.ub=p),p=Ut(r,"Accessibility");var k,x=new Map;for(p=c(p),g=p.next();!g.done;g=p.next())if(m=g.value,g=m.attributes.schemeIdUri,m=m.attributes.value,"urn:scte:dash:cc:cea-608:2015"!=g||t.g.disableText)if("urn:scte:dash:cc:cea-708:2015"!=g||t.g.disableText)"urn:mpeg:dash:role:2011"==g?null!=m&&(u.push(m),"captions"==m&&(h="caption")):"urn:tva:metadata:cs:AudioPurposeCS:2007"==g&&("1"==m?k="visually impaired":"2"==m&&(k="hard of hearing"));else if(g=1,null!=m)for(v=(m=c(m.split(";"))).next();!v.done;v=m.next()){b=v.value;var A=v=void 0;b.includes("=")?(v="svc"+(b=b.split("="))[0],A=b[1].split(",")[0].split(":").pop()):(v="svc"+g,g++,A=b),x.set(v,er(A))}else x.set("svc1","und");else if(g=1,null!=m)for(m=m.split(";"),v=c(m),b=v.next();!b.done;b=v.next()){A=b.value;var C=b=void 0;A.includes("=")?(b=(A=A.split("="))[0].startsWith("CC")?A[0]:"CC"+A[0],C=A[1]||"und"):(b="CC"+g,2==m.length?g+=2:g++,C=A),x.set(b,er(C))}else x.set("CC1","und");p=Ut(r,"ContentProtection");var I=Tp(p,t.g.dash.ignoreDrmInfo,t.g.dash.keySystemsByURI);n.ea.encrypted=0<I.drmInfos.length;var L=er(n.ea.language||"und"),D=n.ea.label;if(r=Ut(r,"Representation"),!t.g.dash.ignoreSupplementalCodecs){for(p=[],m=(g=c(r)).next();!m.done;m=g.next())(m=qt(v=m.value,"urn:scte:dash:scte214-extensions","supplementalCodecs"))&&((v=It(v)).attributes.codecs=m.split(" ").join(","),v.attributes.id&&(v.attributes.supplementalId=v.attributes.id+"_supplementalCodecs"),p.push(v));r.push.apply(r,d(p))}if(p=r.map((function(i){return(i=function(t,n,i,r,s,a,o,l,u,c,d,h){n.J=im(t,c,n.ea,null);var f=n.J.id;if(t.da=Math.min(t.da,n.J.cb),t.P=0<t.da,!function(e){var t=e.ad?1:0;return t+=e.Wb?1:0,t+=e.ic?1:0,0==t?e.contentType==Si||"application"==e.contentType:(1!=t&&(e.ad&&(e.Wb=null),e.ic=null),!0)}(n.J))return null;var p=n.ka.start;n.bandwidth=Ht(c,"bandwidth",Qt)||0,n.roles=l;var g,m,y=Ut(c,"SupplementalProperty"),v=Ut(c,"EssentialProperty"),b=null,T=v.find((function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri}));(T||(T=y.find((function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri}))))&&(b=em(t,T)),b&&(n.ub=b),T=n.J.contentType,b=T==Si||"application"==T,T="image"==T;try{var w=void 0;if(i.Te){var E=n.J.Ra,k=n.ub,x=ns(gi(E(),[i.Te.Mi],k()),t.g.retryParameters);w={bitsKey:128,blockCipherMode:"CBC",iv:i.Te.iv,firstMediaSequenceNumber:0,fetchKey:function(){var n,i,r;return M((function(s){if(1==s.g)return S(s,lm(t,x,6),2);if(3!=s.g){if(!(n=s.h).data||16!=n.data.byteLength)throw new Me(2,4,4049);return i={name:"AES-CBC"},r=w,S(s,e.crypto.subtle.importKey("raw",n.data,i,!0,["decrypt"]),3)}r.cryptoKey=s.h,w.fetchKey=void 0,_(s)}))}}}if(n.J.aesKey=w,E=function(e,n,i,r){return am(t,e,n,i,r)},n.J.ad)var A=Bp(n,E,w);else if(n.J.Wb)A=Gp(n,t.o,w);else if(n.J.ic)A=Kp(n,E,t.o,!!t.i,t.g.dash.initialSegmentLimit,t.ja,w,h,!1);else{var C=n.ka.duration||0,I=n.J.Ra,L=n.J.mimeType,D=n.J.codecs;A={qc:function(){var e=pl(p,C,I());return e.Eb((function(e){e.mimeType=L,e.codecs=D})),Promise.resolve(e)}}}}catch(P){if((b||T)&&4002==P.code)return null;throw P}if(c=Ut(c,"ContentProtection"),c=function(e,t,n,i){var r=Tp(e,n,i);if(t.Ig)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,n=0==r.drmInfos.length,(0==t.drmInfos.length||e&&!n)&&(t.drmInfos=r.drmInfos),t.Ig=!1;else if(0<r.drmInfos.length&&(t.drmInfos=t.drmInfos.filter((function(e){return r.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==t.drmInfos.length))throw new Me(2,4,4008);return r.Dg||t.Dg}(c,i,t.g.dash.ignoreDrmInfo,t.g.dash.keySystemsByURI),c=new Set(c?[c]:[]),h=!1,y.some((function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.attributes.schemeIdUri&&"JOC"==e.attributes.value}))&&(h=!0),y=!1,b&&(y=l.includes("forced_subtitle")||l.includes("forced-subtitle")),T&&((v=v.find((function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.attributes.schemeIdUri)})))&&(g=v.attributes.value),!g))return null;b=n.J.codecs,n.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(b.includes("hvc1.2.4.L153.B0")||b.includes("hev1.2.4.L153.B0"))&&(m="PQ"),v=n.J.id?n.qa.id+","+n.J.id:"",t.F.length&&f&&t.s.set(n.qa.id+","+f,function(e){function t(e){return e?((e=Lt(e)).ad=null,e.Wb=null,e.ic=ln(e.ic),e):null}return e=Lt(e),e.qa=t(e.qa),e.ea=t(e.ea),e.J=t(e.J),e.ka&&(e.ka=Lt(e.ka),e.ka.node=null),e}(n));var R=v&&t.o.has(v)?t.o.get(v):{id:t.pa++,originalId:n.J.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){R.segmentIndex&&(R.segmentIndex.release(),R.segmentIndex=null)},segmentIndex:null,mimeType:n.J.mimeType,codecs:b,frameRate:n.J.frameRate,pixelAspectRatio:n.J.pixelAspectRatio,bandwidth:n.bandwidth,width:n.J.width,height:n.J.height,kind:r,encrypted:0<i.drmInfos.length,drmInfos:i.drmInfos,keyIds:c,language:s,originalLanguage:n.ea.language,label:a,type:n.ea.contentType,primary:o,trickModeVideo:null,emsgSchemeIdUris:n.J.emsgSchemeIdUris,roles:l,forced:y,channelsCount:n.J.je,audioSamplingRate:n.J.audioSamplingRate,spatialAudio:h,closedCaptions:u,hdr:m,colorGamut:void 0,videoLayout:void 0,tilesLayout:g,accessibilityPurpose:d,external:!1,fastSwitching:!1,fullMimeTypes:new Set([xi(n.J.mimeType,n.J.codecs)]),isAudioMuxedInVideo:!1};return R.createSegmentIndex=function(){var e;return M((function(t){if(1==t.g)return R.segmentIndex?t.u(0):(e=R,S(t,A.qc(),3));e.segmentIndex=t.h,_(t)}))},v&&n.Mb&&!t.o.has(v)&&(n=n.qa.id||"",t.B.has(n)||t.B.set(n,[]),t.o.set(v,R),t.B.get(n).push(v)),R}(t,n,I,h,L,D,l,u,x,i,k,E))&&(i.hdr=i.hdr||T,i.colorGamut=i.colorGamut||w,i.fastSwitching=y),i})).filter((function(e){return!!e})),0==p.length){if(i="image"==n.ea.contentType,t.g.dash.ignoreEmptyAdaptationSet||f||i)return null;throw new Me(2,4,4003)}if(!n.ea.contentType||"application"==n.ea.contentType)for(n.ea.contentType=om(p[0].mimeType,p[0].codecs),f=c(p),g=f.next();!g.done;g=f.next())g.value.type=n.ea.contentType;for(f=n.ea.id||"__fake__"+t.pa++,g=c(p),m=g.next();!m.done;m=g.next()){for(m=m.value,b=(v=c(I.drmInfos)).next();!b.done;b=v.next())(b=b.value).keyIds=b.keyIds&&m.keyIds?new Set([].concat(d(b.keyIds),d(m.keyIds))):b.keyIds||m.keyIds;m.groupId=f}return r=r.map((function(e){return e.attributes.supplementalId||e.attributes.id})).filter(Wi),{id:f,contentType:n.ea.contentType,language:L,Dk:l,streams:p,drmInfos:I.drmInfos,mg:i,fj:r}}(t,n,r,i)})).filter(Wi),n.Mb){for(r=[],a=(s=c(i)).next();!a.done;a=s.next())for(var o=(a=c(a.value.fj)).next();!o.done;o=a.next())r.push(o.value);if(r.length!=new Set(r).size)throw new Me(2,4,4018)}if(r=i.filter((function(e){return!e.mg})),i=i.filter((function(e){return e.mg})),!t.g.disableIFrames)for(s=(i=c(i)).next();!s.done;s=i.next()){a=(s=s.value).mg.split(" ");for(var l=(o=c(r)).next();!l.done;l=o.next())if(l=l.value,a.includes(l.id))for(var u=(l=c(l.streams)).next();!u.done;u=l.next())Cr(u.value,s.streams)}if(i=Zg(t.g.disableAudio,r,"audio"),s=Zg(t.g.disableVideo,r,"video"),a=Zg(t.g.disableText,r,Si),r=Zg(t.g.disableThumbnails,r,"image"),0===s.length&&0===i.length)throw new Me(2,4,4004);return{id:n.qa.id,audioStreams:i,videoStreams:s,textStreams:a,imageStreams:r}}function Zg(e,t,n){return e||!t.length?[]:t.reduce((function(e,t){return t.contentType!=n||e.push.apply(e,d(t.streams)),e}),[])}function em(e,t){if((t=Vt(t,"urn:mpeg:dash:schema:urlparam:2014","UrlQueryInfo"))&&Ht(t,"useMPDUrlQuery",en,!1)){var n=t.attributes.queryTemplate;if(n)return function(){return"$querypart$"==n?e.ba:n.split("&").map((function(t){if("$querypart$"==t)return e.ba;var n=/\$query:(.*?)\$/g.exec(t);if(n&&2==n.length){n=n[1];var i=new si(e.ba).get(n);if(i.length)return n+"="+i[0]}return t})).join("&")}}return null}function tm(e){var t,n;return M((function(i){switch(i.g){case 1:return t=0,w(i,2),S(i,Vg(e),4);case 4:t=i.h,k(i,3);break;case 2:if(n=x(i),e.j){if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.j.onError(n),i.return();n.severity=1,e.j.onError(n)}case 3:if(!e.j)return i.return();e.j.onManifestUpdated(),nm(e,t),_(i)}}))}function nm(e,t){if(!(0>e.I)){var n=e.I;0<=e.g.dash.updatePeriod&&(n=e.g.dash.updatePeriod),e.K.aa(Math.max(n-t,G(e.oa)))}}function im(e,t,n,i){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,je:null,audioSamplingRate:null,cb:0,we:0,encrypted:!1},i=i||n.Ra;var r,s=t.attributes.id,a=t.attributes.supplementalId,o=Ut(t,"BaseURL"),l=!1;if(e.h)for(var u=c(o),d=u.next();!d.done;d=u.next()){var h=d.value;d=h.attributes.serviceLocation,h=Bt(h),d&&h&&(ng(e.h,s,d,h),l=!0)}l&&e.h||(r=o.map(Bt)),u=t.attributes.contentType||n.contentType,d=t.attributes.mimeType||n.mimeType,h=Fl([t.attributes.codecs||n.codecs]).join(",");var f=Ht(t,"frameRate",tn)||n.frameRate,p=t.attributes.sar||n.pixelAspectRatio,g=function(e,t){t=t.slice();for(var n=(e=c(e)).next();!n.done;n=e.next())n=n.value.attributes.schemeIdUri,t.includes(n)||t.push(n);return t}(Ut(t,"InbandEventStream"),n.emsgSchemeIdUris),m=Ut(t,"AudioChannelConfiguration");m=function(e){for(var t=(e=c(e)).next();!t.done;t=e.next()){var n=(t=t.value).attributes.schemeIdUri;if(n&&(t=t.attributes.value))switch(n){case"urn:mpeg:dash:outputChannelPositionList:2012":return t.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(t=parseInt(t,10)))continue;return t;case"tag:dolby.com,2015:dash:audio_channel_configuration:2015":if(n=[2,1,2,2,2,2,1,2,2,1,1,1,1,2,1,1,2,2],!(t=parseInt(t,16)))continue;for(var i=0,r=0;r<n.length;r++)t&1<<r&&(i+=n[r]);if(i)return i;continue;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(n=[1,1,1,1,1,2,2,1,1,2,2,2,1,2,1,1].reverse(),!(t=parseInt(t,16)))continue;for(r=i=0;r<n.length;r++)t&1<<r&&(i+=n[r]);if(i)return i;continue;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(n=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(t=parseInt(t,10))&&0<t&&t<n.length)return n[t]}}return null}(m)||n.je;var y=Ht(t,"audioSamplingRate",Jt)||n.audioSamplingRate;u||(u=om(d,h));var v=$t(t,"SegmentBase"),b=$t(t,"SegmentTemplate"),T=v&&Ht(v,"availabilityTimeOffset",Zt)||0,S=b&&Ht(b,"availabilityTimeOffset",Zt)||0,_=o&&o.length&&Ht(o[0],"availabilityTimeOffset",Zt)||0;T=n.cb+_+T+S,S=null,(_=$t(t,"SegmentSequenceProperties"))&&(_=$t(_,"SAP"))&&(S=Ht(_,"cadence",Yt)),_=t.attributes.label;var w=Ut(t,"Label");return w&&w.length&&(Ft(w=w[0])&&(_=Ft(w))),{Ra:function(){return gi(i(),o.length?e.h&&l?ig(e.h,s):r||[]:[])},ad:v||n.ad,Wb:$t(t,"SegmentList")||n.Wb,ic:b||n.ic,width:Ht(t,"width",Jt)||n.width,height:Ht(t,"height",Jt)||n.height,contentType:u,mimeType:d,codecs:h,frameRate:f,pixelAspectRatio:p,emsgSchemeIdUris:g,id:a||s,originalId:s,language:t.attributes.lang,je:m,audioSamplingRate:y,cb:T,ae:null,we:S||n.we,label:_||null,encrypted:!1}}function rm(e,t,n,i){var r,s,a,o,l,u,c;return M((function(d){if(1==d.g)return r=[Tt(n)],s=gi(t(),r),(a=ns(s,e.g.retryParameters)).method=i,o=e.j.networkingEngine.request(4,a,{isPreload:e.ga()}),Jr(e.O,o),S(d,o.promise,2);if(l=d.h,"HEAD"==i){if(!l.headers||!l.headers.date)return d.return(0);u=l.headers.date}else u=pt(l.data);return c=Date.parse(u),isNaN(c)?d.return(0):d.return(c-Date.now())}))}function sm(e,t,n,i,r){for(var s=i.attributes.schemeIdUri||"",a=i.attributes.value||"",o=Ht(i,"timescale",Jt)||1,l=Ht(i,"presentationTimeOffset",Jt)||0,u=(i=c(Ut(i,"Event"))).next();!u.done;u=i.next()){var d=Ht(u=u.value,"presentationTime",Jt)||0,h=Ht(u,"duration",Jt)||0;h=(d=Math.max((d-l)/o+t,t))+h/o,null!=n&&(d=Math.min(d,t+n),h=Math.min(h,t+n)),h<r||(u={schemeIdUri:s,value:a,startTime:d,endTime:h,id:u.attributes.id||"",eventElement:on(u),eventNode:ln(u)},e.j.onTimelineRegionAdded(u))}}function am(e,t,n,i,r){var s,a,o,l;return M((function(u){return 1==u.g?(s=os,a=r?0:1,o=jl(t,n,i,e.g.retryParameters),S(u,lm(e,o,s,{type:a}),2)):(l=u.h,u.return(l.data))}))}function om(e,t){return Vi(t=xi(e,t))?Si:e.split("/")[0]}function lm(e,t,n,i){return i||(i={}),i.isPreload=e.ga(),t=e.j.networkingEngine.request(n,t,i),Jr(e.O,t),t.promise}function um(){}(i=$g.prototype).configure=function(e,t){var n=this.j&&e.dash.updatePeriod!=this.g.dash.updatePeriod&&0<=e.dash.updatePeriod;this.g=e,t&&(this.ga=t),n&&this.i&&this.i.presentationTimeline.T()&&this.K.rb(),this.h&&this.h.configure(this.g),this.m&&(this.m.mh(this.g.dash.multiTypeVariantsAllowed&&re()),this.m.sh(this.g.dash.useStreamOnceInPeriodFlattening))},i.start=function(e,t){var n,i=this;return M((function(r){if(1==r.g)return i.ia=t.isLowLatencyMode(),i.A=[e],i.j=t,S(r,Vg(i),2);if(n=r.h,i.j&&nm(i,n),!i.j)throw new Me(2,7,7001);return r.return(i.i)}))},i.stop=function(){for(var e=c(this.o.values()),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();return this.m&&this.m.release(),this.g=this.j=null,this.A=[],this.i=null,this.o.clear(),this.B.clear(),this.s.clear(),this.l={he:"",type:"",profiles:[],Tb:null,cb:0,Ra:null,Gd:0},this.m=null,null!=this.K&&(this.K.stop(),this.K=null),this.h&&this.h.destroy(),this.G&&(this.G.release(),this.G=null),this.O.destroy()},i.update=function(){var e,t=this;return M((function(n){return 1==n.g?(w(n,2),S(n,Vg(t),4)):2!=n.g?k(n,0):(e=x(n),t.j&&e?(t.j.onError(e),void _(n)):n.return())}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(e){if(this.i&&this.i.presentationTimeline.T()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.i.presentationTimeline.ac();var n=t.segmentIndex.find(e);null!=n&&(t=t.segmentIndex.get(n))&&(this.I=t.endTime-e,nm(this,0))}}},i.banLocation=function(e){this.h&&this.h.banLocation(e)},i.setMediaElement=function(e){this.H=e},$("shaka.dash.DashParser",$g),ya("application/dash+xml",(function(){return new $g})),ya("video/vnd.mpeg.dash.mpd",(function(){return new $g})),$("shaka.dependencies",um),um.has=function(e){return hm.has(e)},um.add=function(e,t){if(!dm[e])throw Error(e+" is not supported");e==cm?oe("mux.js","mux.js is no longer used in Shaka Player."):hm.set(e,(function(){return t}))};var cm="muxjs",dm={Ek:cm,ISOBoxer:"ISOBoxer"};um.Allowed=dm;var hm=new Map([["ISOBoxer",function(){return e.ISOBoxer}]]);function fm(e,t,n){this.type=e,this.Y=t,this.segments=n||null}function pm(e,t,n,i){this.id=e,this.name=t,this.attributes=n,this.value=void 0===i?null:i}function gm(e,t){return t?e.toString():(t=(new Set).add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI"),e.toString(t))}function mm(e,t){return(e=e.attributes.filter((function(e){return e.name==t}))).length?e[0]:null}function ym(e,t,n){return(e=mm(e,t))?e.value:n||null}function vm(e,t){if(!(e=mm(e,t)))throw new Me(2,4,4023,t);return e.value}function bm(e,t,n){n=void 0===n?[]:n,this.Y=t,this.g=e,this.Hb=n}function Tm(e,t){this.name=e,this.value=t}function Sm(e,t){return e.filter((function(e){return e.name==t}))}function _m(e,t){return e.filter((function(e){return vm(e,"TYPE")==t}))}function wm(e,t){for(var n=(e=c(e)).next();!n.done;n=e.next())if((n=n.value).name===t)return n;return null}function Em(e,t,n){return n=void 0===n?0:n,(e=wm(e,t))?Number(e.value):n}function km(e,t,n){return t?xm(e,[t],n):[]}function xm(e,t,n){if(!t.length)return[];t=gi(e,t),e=[];for(var i=(t=c(t)).next();!i.done;i=t.next())e.push(Am(i.value,n));return e}function Am(e,t){if(!t||!t.size)return e;var n=(e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}")).match(/{\$\w*}/g);if(n)for(var i=(n=c(n)).next();!i.done;i=n.next()){var r=(i=i.value).slice(2,i.length-1),s=t.get(r);if(!s)throw new Me(2,4,4039,r);e=e.replace(i,s)}return e}function Cm(){this.g=0}function Im(e,t){var n=(t=(t=pt(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new Me(2,4,4015);t=0;for(var i=!0,r=c(n),s=r.next();!s.done;s=r.next())if(s=s.value,/^#(?!EXT)/m.test(s)||i)i=!1;else{if(s=Lm(e,s),--e.g,Dm.includes(s.name)){t=1;break}"EXT-X-STREAM-INF"==s.name&&(i=!0)}for(r=[],i=!0,s=0;s<n.length;s++){var a=n[s],o=n[s+1];if(/^#(?!EXT)/m.test(a)||i)i=!1;else{if(a=Lm(e,a),Rm.includes(a.name)){if(1!=t)throw new Me(2,4,4017);a=n.splice(s,n.length-s),n=[],i=[],s=[],o=null;for(var l=(a=c(a)).next();!l.done;l=a.next())l=l.value,/^(#EXT)/.test(l)?(l=Lm(e,l),Dm.includes(l.name)?r.push(l):"EXT-X-MAP"==l.name?o=l:"EXT-X-PART"==l.name?s.push(l):"EXT-X-PRELOAD-HINT"==l.name?"PART"==ym(l,"TYPE")?s.push(l):"MAP"==ym(l,"TYPE")&&(l.name="EXT-X-MAP",o=l):i.push(l)):/^#(?!EXT)/m.test(l)||(l=l.trim(),o&&i.push(o),n.push(new bm(l,i,s)),i=[],s=[]);return s.length&&(o&&i.push(o),n.push(new bm("",i,s))),new fm(t,r,n)}r.push(a),"EXT-X-STREAM-INF"==a.name&&(a.attributes.push(new Tm("URI",o)),i=!0)}}return new fm(t,r)}function Lm(e,t){e=e.g++;var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new Me(2,4,4016,t);t=n[1];var i,r=n[2];if(n=[],r){var s;(s=Et(r=new _t(r),/^([^,=]+)(?:,|$)/g))&&(i=s[1]);for(var a=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;s=Et(r,a);)n.push(new Tm(s[1],s[2]||s[3])),wt(r)}return new pm(e,t,n,i)}pm.prototype.toString=function(e){var t="#"+this.name,n=this.attributes?this.attributes.filter((function(t){return!e||!e.has(t.name)})).map((function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)})):[];return this.value&&n.unshift(this.value),0<n.length&&(t+=":"+n.join(",")),t};var Dm="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(" "),Rm="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP EXT-X-TILES".split(" ");function Mm(){}function Pm(e,t){try{var n=Om(e);return qr({uri:e,originalUri:e,data:n.data,headers:{"content-type":n.contentType},originalRequest:t})}catch(i){return Vr(i)}}function Om(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw new Me(2,1,1004,t);if(2>(n=n.slice(1).join(":").split(",")).length)throw new Me(2,1,1004,t);var i=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=i.split(";"),i=n[0];var r=!1;return 1<n.length&&"base64"==n[n.length-1]&&(r=!0,n.pop()),{data:r?di(t):yt(t),contentType:i}}function Nm(){var e=this;this.g=this.h=null,this.C=1,this.A=new Map,this.H=new Map,this.M=new Map,this.M.set("video",new Map),this.M.set("audio",new Map),this.M.set(Si,new Map),this.M.set("image",new Map),this.Db=new Set,this.i=new Map,this.l=null,this.L="",this.Ia=new Cm,this.I=-1,this.ga=1/0,this.da=this.dc=this.Qa=!1,this.B=new Ve((function(){e.$&&!e.g.continueLoadingWhenPaused&&(e.W.bb(e.$,"timeupdate"),e.$.paused)?e.W.ma(e.$,"timeupdate",(function(){return vy(e)})):vy(e)})),this.Ca=Ry,this.m=null,this.Oa=0,this.o=1/0,this.Da=this.Aa=this.P=0,this.ba=new Qr,this.F=new Map,this.G=new Map,this.sa=new Map,this.ja=new Map,this.K=new Map,this.oa=new Map,this.pa=new Map,this.Rb=this.ia=!1,this.Nb=new q(5),this.j=null,this.O=!0,this.Ba=new Set,this.W=new ee,this.s=this.$=null,this.Ob=function(){return!1}}function Um(e,t){return by(e)?e.M.get(t.type):t.ee}function Fm(e,t){var n,i,r,s,a,o,l,u,h,f,p,g,m,y,v,b,T,E,A,C,I,L,D,R,P,O,N,U,F,B,j,$,V,H,q;return M((function(M){switch(M.g){case 1:if(t.stream.isAudioMuxedInVideo)return M.return();for(n=[],i=c(t.N()),r=i.next();!r.done;r=i.next())s=r.value,a=new zn(s),o=a.g,t.Qd&&(0<=t.zb&&o.add("_HLS_msn",String(t.zb)),0<=t.Ab&&o.add("_HLS_part",String(t.Ab))),t.Rd&&o.add("_HLS_skip","YES"),oi(o)&&Yn(a,o),n.push(a.toString());return w(M,2),S(M,yy(e,n,!0).promise,4);case 4:l=M.h,k(M,3);break;case 2:throw u=x(M),e.h&&e.h.disableStream(t.stream),u;case 3:if(!t.stream.segmentIndex)return M.return();if(1!=(h=Im(e.Ia,l.data)).type)throw new Me(2,4,4017);return(f=l.uri)==l.originalUri||t.N().includes(f)||t.re.push(f),p=Sm(h.Y,"EXT-X-DEFINE"),g=Vm(e,p,f),m=t.stream,y=Um(e,t),S(M,iy(e,h,m.mimeType,t.N,g),5);case 5:for(v=M.h,b=v.keyIds,T=v.drmInfos,E=v.encrypted,A=v.vg,m.encrypted||!E||A||(m.encrypted=!0),function(e,t){return e.size===t.size&&[].concat(d(e)).every((function(e){return t.has(e)}))}(m.keyIds,b)||(m.keyIds=b,m.drmInfos=T,e.h.newDrmInfo(m)),C=hy(e,h,y,g,t.N,t.type),I=C.segments,(L=C.bandwidth)&&(m.bandwidth=L),D=wl(m),R=c(I),P=R.next();!P.done;P=R.next())(O=P.value).ca&&(O.ca.Tc=D);m.segmentIndex.zd(I,e.l.ob()),I.length&&(N=Em(h.Y,"EXT-X-MEDIA-SEQUENCE",0),F=(U=wm(h.Y,"EXT-X-SKIP"))?Number(ym(U,"SKIPPED-SEGMENTS")):0,B=ty(N,I),j=B.zb,$=B.Ab,t.zb=j+F,t.Ab=$,V=y.get(N),m.segmentIndex.Ja(V)),(H=fl(m.segmentIndex))&&(t.zc=H.startTime,q=I[I.length-1],t.Sb=q.endTime),wm(h.Y,"EXT-X-ENDLIST")&&(t.pd=!0),ay(e,h),dy(e,h.Y,m.type,g,t.N),_(M)}}))}function Bm(e,t,n){n=void 0!==n&&n;for(var i=-1==e.I,r=c(t),s=r.next();!s.done;s=r.next()){var a=(s=s.value).stream.segmentIndex,o=Um(e,s);if(a=fl(a))for(var l=(o=c(o)).next();!l.done;l=o.next()){var u=(l=c(l.value)).next().value;if(l.next().value==a.startTime){i&&(e.I=Math.max(e.I,u)),s.df=u;break}}}if(!(0>e.I))for(i=(t=c(t)).next();!i.done;i=t.next())(Zm(e,(i=i.value).type)||n)&&(r=i.stream.segmentIndex)&&(0<(s=e.I-i.df)&&(r.g.splice(0,s),r=fl(r))&&(r=-r.startTime,i.stream.segmentIndex.offset(r),jm(e,i,r)))}function jm(e,t,n){t.zc+=n,t.Sb+=n;for(var i=c(e=Um(e,t)),r=i.next();!r.done;r=i.next()){var s=c(r.value);r=s.next().value,s=s.next().value,e.set(r,s+n)}t.N()}function $m(e){if(by(e)){if(e.Ca==Py){for(var t=1/0,n=1/0,i=c(e.i.values()),r=i.next();!r.done;r=i.next())(r=r.value).stream.segmentIndex&&"text"!=r.stream.type&&!r.stream.isAudioMuxedInVideo&&(t=Math.min(t,r.Sb),n=Math.min(n,r.zc));t=t-n||0,isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.l.xe(t)}}else e.l.ab(Ym(e));if(!e.l.s)for(n=(t=c(e.i.values())).next();!n.done;n=t.next())!(n=n.value).stream.segmentIndex||"audio"!=n.type&&"video"!=n.type||(n=fl(n.stream.segmentIndex))&&n.h&&e.l.ph(n.h);e.l.de()}function Vm(e,t,n){n=new zn(n).g;for(var i=new Map,r=(t=c(t)).next();!r.done;r=t.next()){var s=r.value,a=ym(s,"NAME"),o=ym(s,"VALUE");r=ym(s,"QUERYPARAM"),s=ym(s,"IMPORT"),a&&o&&(i.has(a)||i.set(a,o)),r&&(a=n.get(r)[0])&&!i.has(a)&&i.set(r,a),s&&(r=e.A.get(s))&&i.set(s,r)}return i}function Hm(e){var t=new Set([xi(e.mimeType,e.codecs)]);e.segmentIndex&&e.segmentIndex.Eb((function(n){n.mimeType&&t.add(xi(n.mimeType,e.codecs))})),e.fullMimeTypes=t}function qm(e,t,n){for(var i={audio:[],video:[]},r=new Map,s=[],a=!1,o=!1,l=c(t),u=l.next();!u.done;u=l.next()){var h=u.value;u=ym(h,"AUDIO");var f=ym(h,"VIDEO"),p=u||f;p&&(s.includes(p)||s.push(p),(h=ym(h,"PATHWAY-ID"))&&r.set(p,h),u?a=!0:f&&(o=!0))}s.length&&n.length&&function(e,t,n){t=t.filter((function(e){var t=ym(e,"URI")||"";return"SUBTITLES"!=(e=ym(e,"TYPE"))&&(""!=t||"AUDIO"==e)}));for(var i={},r=(t=c(t)).next();!r.done;r=t.next()){var s=gm(r=r.value,!e.j);i[s]?i[s].push(r):i[s]=[r]}for(var a in i)Km(e,i[a],n,!1)}(e,n=n.filter((function(e){return s.includes(vm(e,"GROUP-ID"))})),r),n=(r=s.sort().join(","))&&e.H.has(r)?e.H.get(r):[],a?i.audio.push.apply(i.audio,d(n)):o&&i.video.push.apply(i.video,d(n)),a=!1;var g=t.map((function(e){return vm(e,"URI")}));return u=i.audio.find((function(e){return e&&e.N().find((function(e){return g.includes(e)}))})),n=bi("video",o=Gm(e,t[0])),(l=bi("audio",o))&&!n?(u="audio",a=0<i.audio.length):!i.audio.length&&!i.video.length&&l&&n?(u="video",o=[[n,l].join()]):i.audio.length&&u?(u="audio",a=!0):u=i.video.length&&!i.audio.length?"audio":"video",a||(e=function(e,t,n,i){for(var r=e.C++,s=[],a=c(t),o=a.next();!o.done;o=a.next()){var l=o.value;o=vm(l,"URI"),l=ym(l,"PATHWAY-ID"),e.j&&l&&ng(e.j,r,l,o),s.push(o)}if(a=s.sort().join(",")+n.sort().join(","),e.i.has(a))return e.i.get(a);o=s.join(",");e:{if(t=ym(t[0],"CLOSED-CAPTIONS"),"video"==i){if(e.g.disableText){e.O=!1,t=null;break e}if(t){if("NONE"!=t){t=e.F.get(t);break e}e.O=!1}else if(!t&&e.F.size)for(t=c(e.F.keys()).next();!t.done;){t=e.F.get(t.value);break e}}t=null}return n=vi(i,n),i=Xm(e,r,s,n,i,null,!1,o,null,t,null,!1,null,!1),e.i.set(a,i),i}(e,t,o,u),r&&(e.stream.groupId=r),i[e.stream.type]=[e]),i}function Gm(e,t){return t=ym(t,"CODECS")||"",e.da=0<t.length,e.da||e.g.hls.disableCodecGuessing||(t=[],e.g.disableVideo||t.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||t.push(e.g.hls.defaultAudioCodec),t=t.join(",")),Fl(t.split(/\s*,\s*/))}function zm(e,t,n,i,r,s,a,o,l,u,d,h){for(var f=c(n),p=f.next();!p.done;p=f.next())my(p.value.stream,r,s,a,o,l,null);for(r=e.g.disableAudio,t.length&&!r||(t=[null]),r=e.g.disableVideo,n.length&&!r||(n=[null]),r=[],s=(t=c(t)).next();!s.done;s=t.next())for(s=s.value,o=(a=c(n)).next();!o.done;o=a.next()){var g=o.value;(o=s?s.stream:null)&&(o.drmInfos=u,o.keyIds=d),(l=g?g.stream:null)&&(l.drmInfos=u,l.keyIds=d,e.g.disableIFrames||Cr(l,h)),l&&!o&&(l.bandwidth=i),!l&&o&&(o.bandwidth=i),f=s?s.stream.drmInfos:null,p=g?g.stream.drmInfos:null,g=g?g.N().sort().join(","):"";var m=s?s.N().sort().join(","):"",y=[];o&&o.codecs&&y.push(o.codecs),l&&l.codecs&&y.push(l.codecs),g=[g,m,y.sort()].join("-"),o&&l&&!Ne(f,p)||e.Db.has(g)||(o={id:e.C++,language:o?o.language:"und",disabledUntilTime:0,primary:!!o&&o.primary||!!l&&l.primary,audio:o,video:l,bandwidth:i,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},r.push(o),e.Db.add(g))}return r}function Km(e,t,n,i){i=void 0===i||i;for(var r=[],s=[],a=new Map,o=c(t),l=o.next();!l.done;l=o.next()){var u=l.value;l=i?vm(u,"URI"):ym(u,"URI")||"shaka://hls-muxed",u=vm(u,"GROUP-ID"),r.push(l),s.push(u),a.set(u,l)}if(i=s.sort().join(","),l=t[0],t="","subtitles"==(o=vm(l,"TYPE").toLowerCase())&&(o=Si),o==Si)t=ym(l,"CODECS")||"";else for(u=(s=c(s)).next();!u.done;u=s.next())if(u=u.value,e.G.has(u)){t=e.G.get(u);break}if(s=r.sort().join(","),e.i.has(s))return e.i.get(s);if(u=e.C++,e.j)for(var d=(a=c(a)).next();!d.done;d=a.next()){var h=c(d.value);d=h.next().value,h=h.next().value,(d=n.get(d))&&ng(e.j,u,d,h)}n=ym(l,"LANGUAGE"),a=ym(l,"NAME"),d="YES"==ym(l,"DEFAULT"),h="audio"==o&&(h=ym(l,"CHANNELS"))?parseInt(h.split("/")[0],10):null;var f="audio"==o&&(!!(f=ym(l,"CHANNELS"))&&f.includes("/JOC"));return(r=Xm(e,u,r,t,o,n,d,a,h,null,ym(l,"CHARACTERISTICS"),"YES"==ym(l,"FORCED"),l="audio"==o&&(l=ym(l,"SAMPLE-RATE"))?parseInt(l,10):null,f)).stream&&(r.stream.groupId=i),e.H.has(i)?e.H.get(i).push(r):e.H.set(i,[r]),e.i.set(s,r),r}function Wm(e,t){var n="video",i=vm(t,"URI"),r=ym(t,"CODECS")||"";if("mjpg"==r&&(n="image"),e.i.has(i))return e.i.get(i);var s=ym(t,"LANGUAGE"),a=ym(t,"NAME"),o=ym(t,"CHARACTERISTICS");return n=Xm(e,e.C++,[i],r,n,s,!1,a,null,null,o,!1,null,!1),s=c((r=ym(t,"RESOLUTION"))?r.split("x"):[null,null]),r=s.next().value,s=s.next().value,n.stream.width=Number(r)||void 0,n.stream.height=Number(s)||void 0,(t=ym(t,"BANDWIDTH"))&&(n.stream.bandwidth=Number(t)),e.i.set(i,n),n}function Xm(e,t,n,i,r,s,a,o,l,u,d,h,f,p){function g(t){var n,g,v,T,E,A,C,I,L,D,R,P,O,N,U,F,B,j,$,V,H;return M((function(M){switch(M.g){case 1:return n=_i,w(M,2),S(M,t.promise,4);case 4:if(g=M.h,t.aborted)return M.return();if((v=g.uri)!=g.originalUri&&(b.N().includes(v)||b.re.push(v)),1!=(T=Im(e.Ia,g.data)).type)throw new Me(2,4,4017);return E=Sm(T.Y,"EXT-X-DEFINE"),A=Vm(e,E,v),C=!1,(!e.da&&e.g.hls.disableCodecGuessing||e.O&&r==n.la&&!e.g.hls.disableClosedCaptionsDetection)&&0<T.segments.length&&(e.O=!1,C=!0),I=!e.da&&e.g.hls.disableCodecGuessing,L=by(e),S(M,ey(e,0,A,T,m,i,r,s,a,o,l,u,d,h,f,p,void 0,C,I),5);case 5:if(D=M.h,t.aborted)return M.return();if(R=D.stream,sy(e,T),by(e)&&!L&&oy(e,T),b.zc=D.zc,b.Sb=D.Sb,b.Rd=D.Rd,b.Qd=D.Qd,b.pd=D.pd,b.ee=D.ee,b.zb=D.zb,b.Ab=D.Ab,b.Jf=!0,y.segmentIndex=R.segmentIndex,y.encrypted=R.encrypted,y.drmInfos=R.drmInfos,y.keyIds=R.keyIds,y.mimeType=R.mimeType,y.bandwidth=y.bandwidth||R.bandwidth,y.codecs=y.codecs||R.codecs,y.closedCaptions=y.closedCaptions||R.closedCaptions,y.width=y.width||R.width,y.height=y.height||R.height,y.hdr=y.hdr||R.hdr,y.colorGamut=y.colorGamut||R.colorGamut,y.frameRate=y.frameRate||R.frameRate,"und"==y.language&&"und"!=R.language&&(y.language=R.language),y.language=y.language||R.language,y.channelsCount=y.channelsCount||R.channelsCount,y.audioSamplingRate=y.audioSamplingRate||R.audioSamplingRate,Hm(y),y.drmInfos.length&&e.h.newDrmInfo(y),P=!1,(!u&&y.closedCaptions||u&&y.closedCaptions&&u.size!=y.closedCaptions.size)&&(P=!0),e.m&&P&&e.h.makeTextStreamsForClosedCaptions(e.m),r==n.la||r==n.U)for(O=c(e.i.values()),N=O.next();!N.done;N=O.next())(U=N.value).Jf||U.type!=r||(U.stream.mimeType=R.mimeType,Hm(U.stream));r==n.xa&&(F=fl(R.segmentIndex))&&F.ca&&(y.mimeType="application/mp4",Hm(y)),B=wl(y),y.segmentIndex.Eb((function(e){e.ca&&(e.ca.Tc=B)})),function(e){if(!e.m)return!1;for(var t=[],n=[],i=(e=c(e.m.variants)).next();!i.done;i=e.next())(i=i.value).video&&t.push(i.video),i.audio&&n.push(i.audio);return!(0<t.length&&!t.some((function(e){return e.segmentIndex}))||0<n.length&&!n.some((function(e){return e.segmentIndex})))}(e)&&(e.dc?Jm(e,[b]):(e.dc=!0,j=Array.from(e.i.values()),$=j.filter((function(e){return e.stream.segmentIndex})),Jm(e,$),$m(e),0<(V=e.o)&&e.B.aa(V))),dy(e,T.Y,y.type,A,m),e.m&&(e.m.startTime=e.s),k(M,0);break;case 2:if(H=x(M),y.closeSegmentIndex(),7001===H.code)return M.return();if(!e.h.disableStream(y))throw H;_(M)}}))}function m(){return e.j&&1<n.length?ig(e.j,t):b.re.concat(xm([e.L],n,e.A))}var y=ny(e,i,r,s,a,o,l,u,d,h,f,p);n.includes("shaka://hls-muxed")&&(y.isAudioMuxedInVideo=!0,y.mimeType="video/mp2t",Hm(y));var v,b={stream:y,type:r,re:[],zc:0,Sb:0,ee:new Map,Rd:!1,Qd:!1,pd:!1,df:-1,zb:-1,Ab:-1,Jf:!1,N:m},T=null;return y.createSegmentIndex=function(){return T||(y.isAudioMuxedInVideo?(y.segmentIndex=new hl([]),Promise.resolve()):(v=yy(e,b.N(),!0),T=new Promise((function(e){e(g(v))}))))},y.closeSegmentIndex=function(){T&&!y.segmentIndex&&v.abort(),y.segmentIndex&&(y.segmentIndex.release(),y.segmentIndex=null),T=null},b}function Ym(e){for(var t=1/0,n=(e=c(e.i.values())).next();!n.done;n=e.next())(n=n.value).stream.segmentIndex&&"text"!=n.stream.type&&!n.stream.isAudioMuxedInVideo&&(t=Math.min(t,n.Sb));return t}function Qm(e,t){for(var n=[],i=(t=c(t)).next();!i.done;i=t.next())(i=i.value).segmentIndex&&i.segmentIndex.Eb((function(e){n.push(e)}));e.l.Dd(n)}function Jm(e,t){if(!by(e))for(var n=Ym(e),i=c(t),r=i.next();!r.done;r=i.next())r.value.stream.segmentIndex.Lc(0,n);Qm(e,t.map((function(e){return e.stream}))),n=(i=Array.from(e.i.values()).filter((function(e){return e.stream.segmentIndex}))).some((function(e){return"audio"==e.stream.type})),r=i.some((function(e){return"video"==e.stream.type})),i=by(e)&&!e.Qa,n=!by(e)&&e.Qa&&!(n&&r),e.g.hls.ignoreManifestProgramDateTime||i||n?Bm(e,t,i):(function(e,t){if(1/0==e.ga)for(var n=(t=c(t)).next();!n.done;n=t.next())null!=(n=fl(n.value.stream.segmentIndex))&&null!=n.h&&(e.ga=Math.min(e.ga,n.h));if(1/0!=(t=e.ga))for(var i=(n=c(e.i.values())).next();!i.done;i=n.next())if(!Zm(e,(i=i.value).type)){var r=i.stream.segmentIndex;if(null!=r){var s=fl(r);if(s)if(null==s.h)W("Missing EXT-X-PROGRAM-DATE-TIME for stream",i.N(),"Expect AV sync issues!");else for(jm(e,i,s.h-t-s.startTime),r=(i=c(r)).next();!r.done;r=i.next())r.value.hg(t)}}}(e,t),0<e.g.hls.ignoreManifestProgramDateTimeForTypes.length&&Bm(e,t))}function Zm(e,t){return!!e.g.hls.ignoreManifestProgramDateTime||e.g.hls.ignoreManifestProgramDateTimeForTypes.includes(t)}function ey(e,t,n,i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b){var T,_,E,A,C,I,L,D,R,P,O,N,U,F,B,j,$,V,H,q,G,z,K,W,X,Y,Q,J,Z;return v=void 0===v||v,b=void 0===b||b,M((function(t){switch(t.g){case 1:if(T=i.segments||[],_=T.every((function(e){return!!wm(e.Y,"EXT-X-GAP")})),!T.length||_)throw new Me(2,4,4053);if(function(e,t){var n=wm(t.Y,"EXT-X-PLAYLIST-TYPE");t=wm(t.Y,"EXT-X-ENDLIST"),t=n&&"VOD"==n.value||t,n=n&&"EVENT"==n.value&&!t,n=!t&&!n,Ty(e,t?Ry:n?Py:My)}(e,i),by(e)&&ay(e,i),E=by(e)?e.M.get(a):new Map,A=hy(e,i,E,n,r,a),C=A.segments,I=A.bandwidth,O=P=R=D=L=null,!(0<C.length&&v)){t.u(2);break}return S(t,function(e,t){var n,i,r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,_,w,E,k,x;return M((function(A){switch(A.g){case 1:if(n=Nl(e.g.hls.mediaPlaylistFullMimeType),!t.length)return A.return(n);if(i=gy(e,t),r=i.segment,s=i.segmentIndex,a=r.N(),o=a[0],l=new zn(o),u=l.Za.split(".").pop(),d=Ey.get(u))return A.return(Nl(d));if(h=os,p=f=null,!(g=r.ca)){A.u(2);break}return m=jl(g.N(),g.bc(),g.$b(),e.g.retryParameters),S(A,Sy(e,m,h,{type:0}).promise,3);case 3:if(y=A.h,f=y.data,!g.aesKey){A.u(4);break}return S(A,Bl(f,g.aesKey,0),5);case 5:f=A.h;case 4:(p=y.headers["content-type"])&&(p=p.split(";")[0].toLowerCase());case 2:return v=jl(r.N(),r.bc(),r.$b(),e.g.retryParameters),S(A,Sy(e,v,h,{type:1}).promise,6);case 6:if(b=A.h,T=b.data,!r.aesKey){A.u(7);break}return S(A,Bl(T,r.aesKey,s),8);case 8:T=A.h;case 7:if((_=b.headers["content-type"])&&(_=_.split(";")[0].toLowerCase()),w="mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" "),E=["audio/mp4","video/mp4","video/iso.segment"],go(me(T))){var C=T,I=e.g.disableAudio,L=e.g.disableVideo,D=e.g.disableText,R=me(C),M=(new co).parse(R),P=M.ld();R=M.Af();var O=[],N=!1,U=!1;if(!I)switch(P.audio){case"aac":case"aac-loas":M.fb().length&&(O.push("mp4a.40.2"),N=!0);break;case"mp3":M.fb().length&&(O.push("mp4a.40.34"),N=!0);break;case"ac3":M.fb().length&&(O.push("ac-3"),N=!0);break;case"ec3":M.fb().length&&(O.push("ec-3"),N=!0);break;case"opus":M.fb().length&&(O.push("opus"),N=!0)}if(!L)switch(P.video){case"avc":R.codec?O.push(R.codec):O.push("avc1.42E01E"),U=!0;break;case"hvc":R.codec?O.push(R.codec):O.push("hvc1.1.6.L93.90"),U=!0;break;case"av1":O.push("av01.0.01M.08"),U=!0}if(O.length){if(I=N&&!U,L=new Map,U&&!D){for((D=new Se("video/mp2t")).i(C),U=(C=c(D.j())).next();!U.done;U=C.next())U=U.value,L.set(U,U);D.g()}R={type:I?"audio":"video",mimeType:"video/mp2t",codecs:O.join(", "),language:null,height:R.height,width:R.width,channelCount:null,sampleRate:null,closedCaptions:L,Kd:null,colorGamut:null,frameRate:R.frameRate}}else R=null;if(k=R)return A.return(k)}else if((w.includes(u)||E.includes(_)||p&&E.includes(p))&&(x=Ul(f,T,e.g.disableText)))return A.return(x);return _?A.return(Nl(_)):p?A.return(Nl(p)):A.return(n)}}))}(e,C),3);case 3:N=t.h,a=N.type,o=N.language,d=N.channelCount,g=N.sampleRate,e.g.disableText||(h=N.closedCaptions),D=N.height,L=N.width,R=N.Kd,P=N.colorGamut,O=N.frameRate,b&&(y=N.mimeType,s=N.codecs);case 2:if(y){t.u(4);break}return S(t,function(e,t,n,i){var r,s,a,o,l,u,c,d,h,f,p,g,m,y;return M((function(v){switch(v.g){case 1:return r=os,s=gy(e,i),2==(a=s.segment).status?v.return(py(t)):(o=a.N(),l=new zn(o[0]),u=l.Za.split(".").pop(),c=Iy.get(t),(d=c.get(u))||(d=Ey.get(u))||(d=fy(t,n))?v.return(d):(f=1,p=ns(o,e.g.retryParameters),w(v,2),p.method="HEAD",S(v,Sy(e,p,r,{type:f}).promise,4)));case 4:g=v.h,h=g.headers["content-type"],k(v,3);break;case 2:if(!(m=x(v))||1002!=m.code&&1001!=m.code){v.u(3);break}return p.method="GET",S(v,Sy(e,p,r,{type:f}).promise,6);case 6:y=v.h,h=y.headers["content-type"];case 3:return h?v.return(h.toLowerCase().split(";")[0]):v.return(py(t))}}))}(e,a,s,C),5);case 5:y=t.h,a!=Si||s||"application/mp4"!=y||!C[0]||C[0].ca||(y="text/vtt");case 4:return S(t,iy(e,i,y,r,n),6);case 6:if(U=t.h,F=U.drmInfos,B=U.keyIds,j=U.encrypted,$=U.vg,j&&!F.length&&!$)throw new Me(2,4,4026);return(V=ny(e,s,a,o,l,u,d,h,f,p,g,m)).encrypted=j&&!$,V.drmInfos=F,V.keyIds=B,V.mimeType=y,I&&(V.bandwidth=I),Hm(V),"video"==a&&(L||D||R||P)&&my(V,L,D,O,R,null,P),by(e)&&ay(e,i),H=C[0].startTime,q=C[C.length-1],G=q.endTime,z=new hl(C),V.segmentIndex=z,W=!!(K=wm(i.Y,"EXT-X-SERVER-CONTROL"))&&null!=mm(K,"CAN-SKIP-UNTIL"),X=!!K&&null!=mm(K,"CAN-BLOCK-RELOAD"),Y=Em(i.Y,"EXT-X-MEDIA-SEQUENCE",0),Q=ty(Y,C),J=Q.zb,Z=Q.Ab,t.return({stream:V,type:a,re:[],N:r,zc:H,Sb:G,Rd:W,Qd:X,pd:!1,df:-1,zb:J,Ab:Z,ee:E,Jf:!1})}}))}function ty(e,t){e=e+t.length-1;var n=-1;if(!t.length)return{zb:++e,Ab:n};var i=(t=t[t.length-1]).g;return t.g.length?(n=i.length-1,i[i.length-1].isPreload()||(e++,n=0),{zb:e,Ab:n}):(e++,t.m&&(n=0),{zb:e,Ab:n})}function ny(e,t,n,i,r,s,a,o,l,u,d,h){var f=fy(n,t)||py(n),p=[];if(l)for(var g=(l=c(l.split(","))).next();!g.done;g=l.next())p.push(g.value);return l=void 0,g=null,n==Si?l=p.includes("public.accessibility.transcribes-spoken-dialog")&&p.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":p.includes("public.accessibility.describes-video")&&(g="visually impaired"),p.length||"subtitle"!==l||p.push("subtitle"),Hm(e={id:e.C++,originalId:s,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:f,codecs:t,kind:n==Si?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:er(i||"und"),originalLanguage:i,label:s,type:n,primary:r,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:p,forced:u,channelsCount:a,audioSamplingRate:d,spatialAudio:h,closedCaptions:o,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:g,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1}),e}function iy(e,t,n,i,r){var s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,_,w,E,k,x,A,C,I,L,D,R,P,O;return M((function(M){switch(M.g){case 1:if(s=new Map,t.segments)for(a=c(t.segments),o=a.next();!o.done;o=a.next())if(l=o.value,u=Sm(l.Y,"EXT-X-KEY"),d=null,u.length)for(d=ly(e,t,l.Y,i,r),h=c(u),f=h.next();!f.done;f=h.next())p=f.value,s.set(p,d);m=g=!1,y=[],v=new Set,b=c(s),T=b.next();case 2:if(T.done){M.u(4);break}if(_=T.value,w=c(_),E=w.next().value,k=w.next().value,A=k,"NONE"==(C=vm(x=E,"METHOD"))){M.u(3);break}if(g=!0,I=ym(x,"KEYFORMAT")||"identity",L=null,_y(C)){m=!0,M.u(3);break}if("identity"!=I){L=(D=Dy.get(I))?D(x,n):null,M.u(6);break}return S(M,wy(e,x,n,i,A,r),8);case 8:L=M.h;case 6:if(L){if(L.keyIds)for(R=c(L.keyIds),P=R.next();!P.done;P=R.next())O=P.value,v.add(O);y.push(L)}case 3:T=b.next(),M.u(2);break;case 4:return M.return({drmInfos:y,keyIds:v,encrypted:g,vg:m})}}))}function ry(t,n,i,r,s){if(!e.crypto||!e.crypto.subtle)throw X("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new Me(2,4,4042);var a=0,o=ym(n,"IV","");if(o){var l=hi(o.substr(2));if(16!=l.byteLength)throw new Me(2,4,4048)}else a=Em(i.Y,"EXT-X-MEDIA-SEQUENCE",0);var u=km(r(),vm(n,"URI"),s),c=u.sort().join("");if(i=n.toString()+"-"+a+"-"+c,!t.ja.has(i)){var d={bitsKey:128,blockCipherMode:"CBC",iv:l,firstMediaSequenceNumber:a};switch(vm(n,"METHOD")){case"AES-256":d.bitsKey=256;break;case"AES-256-CTR":d.bitsKey=256,d.blockCipherMode="CTR"}d.fetchKey=function(){var n,i,r,s;return M((function(a){if(1==a.g)return t.K.has(c)||(n=ns(u,t.g.retryParameters),i=Sy(t,n,6).promise,t.K.set(c,i)),S(a,t.K.get(c),2);if(3!=a.g){if(!(r=a.h).data||r.data.byteLength!=d.bitsKey/8)throw new Me(2,4,4049);return s={name:"CTR"==d.blockCipherMode?"AES-CTR":"AES-CBC",length:d.bitsKey},S(a,e.crypto.subtle.importKey("raw",r.data,s,!0,["decrypt"]),3)}d.cryptoKey=a.h,d.fetchKey=void 0,_(a)}))},t.ja.set(i,d)}return t.ja.get(i)}function sy(e,t){null==e.s&&(t=wm(t.Y,"EXT-X-START"))&&(e.s=Number(vm(t,"TIME-OFFSET")))}function ay(e,t){var n=1/0,i=t.segments;if(i.length)for(var r=i.length-1;0<=r;){var s=wm(i[r].Y,"EXTINF");if(s){n=Number(s.value.split(",")[0]);break}r--}if(!(i=wm(t.Y,"EXT-X-TARGETDURATION")))throw new Me(2,4,4024,"EXT-X-TARGETDURATION");i=Number(i.value),(r=wm(t.Y,"EXT-X-PART-INF"))&&(e.P=Number(vm(r,"PART-TARGET"))),t=wm(t.Y,"EXT-X-SERVER-CONTROL"),e.ia&&e.P?(e.o=e.Rb?5*e.P<=n?Math.min(e.P,e.o):Math.min(n,e.o):Math.min(e.P,e.o),e.Da=t?Number(vm(t,"PART-HOLD-BACK")):0):(e.o=Math.min(n,e.o),n=t?mm(t,"HOLD-BACK"):null,e.Aa=n?Number(n.value):0),e.Oa=Math.max(i,e.Oa)}function oy(e,t){var n=0;if(e.g.defaultPresentationDelay)n=e.g.defaultPresentationDelay;else if(e.Da)n=e.Da;else if(e.Aa)n=e.Aa;else{var i=t.segments.length,r=e.g.hls.liveSegmentsDelay;for(r>i-2&&(r=Math.max(1,i-2)),r=i-r;r<i;r++){var s=wm(t.segments[r].Y,"EXTINF");n=s?n+Math.ceil(Number(s.value.split(",")[0])):n+e.Oa}}e.s&&0>e.s&&(n=Math.min(-e.s,n),e.s+=n),e.l.qh(0),e.l.bg(n),e.l.Dc(!1)}function ly(e,t,n,i,r){var s=wm(n,"EXT-X-MAP");if(!s)return null;var a=vm(s,"URI"),o=km(i(),a,r);if(a=[o.toString(),ym(s,"BYTERANGE","")].join("-"),!e.sa.has(a)){for(var l=void 0,u=null,d=!1,h=(n=c(n)).next();!h.done;h=n.next())"EXT-X-KEY"==(h=h.value).name?_y(d=vm(h,"METHOD"))&&h.id<s.id?(d=!1,l=ry(e,h,t,i,r)):d="NONE"!=d:"EXT-X-BYTERANGE"==h.name&&h.id<s.id&&(u=h);t=function(e,t,n,i,r){var s=0,a=null;return t=ym(t,"BYTERANGE"),!t&&n&&(t=n.value),t&&(s=t.split("@"),a=Number(s[0]),s=Number(s[1]),a=s+a-1,i&&(n=a+1-s,n%16&&(a+=16-n%16))),new wa((function(){return e}),s,a,null,null,null,i,r)}(o,s,u,l,d),e.sa.set(a,t)}return e.sa.get(a)}function uy(t,n,i,r,s,a,o,l,u){function d(e){e=new zn(e).Za.split(".").pop();var t=Iy.get(o).get(e);return t||(t=Ey.get(e)),t}var h=r.Y,f=wm(h,"EXTINF"),p=0,g=0,m=null;r.Hb.length&&(t.m.isLowLatency=!0);var y=null;if(!t.g.hls.ignoreManifestProgramDateTime){var v=wm(h,"EXT-X-PROGRAM-DATE-TIME");v&&v.value&&(y=Kt(v.value),t.Qa=!0)}var b=Aa;if(wm(h,"EXT-X-GAP")&&(t.m.gapCount++,b=2),!f){if(0==r.Hb.length)throw new Me(2,4,4024,"EXTINF");if(!t.ia)return null}var T=[];v=!1;var S=null,_=!1,w=!1;if(t.ia&&r.Hb.length){p=n&&e.ReadableStream&&t.g.hls.allowLowLatencyByteRangeOptimization;for(var E=y,k={},x=0;x<r.Hb.length;k={Ge:void 0,me:void 0},x++){var A=r.Hb[x],C=0==x?i:T[T.length-1],I=0==x?s:C.endTime,L=Number(ym(A,"DURATION"))||t.P;if(L){var D=I+L,R=0,M=null;if("EXT-X-PRELOAD-HINT"==A.name?(R=(R=ym(A,"BYTERANGE-START"))?Number(R):0,(C=ym(A,"BYTERANGE-LENGTH"))?M=R+Number(C)-1:R&&(M=Number.MAX_SAFE_INTEGER)):(R=(M=c(cy(C,R=ym(A,"BYTERANGE")))).next().value,M=M.next().value),k.me=ym(A,"URI"),k.me){C=Aa,"YES"==ym(A,"GAP")&&(t.m.gapCount++,C=2,_=!0),k.Ge=null;var P=function(e){return function(){return null==e.Ge&&(e.Ge=km(l(),e.me,a)),e.Ge}}(k);p&&0<=R&&null!=M&&(S=P,v=!0),I=new ka(I,D,P,R,M,n,0,0,1/0,[],"",null,E,C,u),"EXT-X-PRELOAD-HINT"==A.name&&(I.Kf(),w=!0),"YES"!=ym(A,"INDEPENDENT")&&0<x&&I.Sc(),(k=d(k.me))&&(I.mimeType=k,Ly.has(k)&&(I.ca=null)),T.push(I),E&&(E+=L)}}}}if(f){if(0==(f=Number(f.value.split(",")[0])))return null;p=s+f}else{if(!T.length)return null;p=T[T.length-1].endTime}v&&(_||0!=T[0].Na?(v=!1,S=null):T=[]),(f=wm(h,"EXT-X-BYTERANGE"))?(g=(m=c(cy(i,f.value))).next().value,m=m.next().value):T.length&&(g=T[0].Na,m=T[T.length-1].wa),i="",f=null,"image"==o&&(i="1x1",h=wm(h,"EXT-X-TILES"))&&(i=vm(h,"LAYOUT"),(h=ym(h,"DURATION"))&&(f=Number(h)));var O=null;return n=new ka(s,p,(function(){return S?S():(null==O&&(O=km(l(),r.g,a)),O||[])}),g,m,n,0,0,1/0,T,i,f,y,b,u,0<T.length&&!!r.g),(s=d(r.g))&&(n.mimeType=s,Ly.has(s)&&(n.ca=null)),v&&(t.Rb=!0,n.Wg(),w&&n.Kf()),n}function cy(e,t){var n=0,i=null;return t&&(n=t.split("@"),t=Number(n[0]),i=(n=n[1]?Number(n[1]):e.wa+1)+t-1),[n,i]}function dy(e,t,n,i,r){if("video"==n||"audio"==n){var s=e.l.m;if(s&&!Zm(e,n))for(t=(t=Sm(t,"EXT-X-DATERANGE")).filter((function(e){return null!=mm(e,"START-DATE")})).sort((function(e,t){return(e=vm(e,"START-DATE"))<(t=vm(t,"START-DATE"))?-1:e>t?1:0})),n=0;n<t.length;n++){var a=t[n];try{var o=vm(a,"ID");if(!e.Ba.has(o)){var l=Kt(vm(a,"START-DATE"));if(!isNaN(l)){var u=Math.max(0,l-s),d=null,h=ym(a,"END-DATE");if(h){var f=Kt(h);if(!isNaN(f)&&0>(d=f-s))continue}if(null==d){var p=ym(a,"DURATION")||ym(a,"PLANNED-DURATION");if(p){var g=parseFloat(p);if(isNaN(g)||(d=u+g),0>l-s+g)continue}}var m=ym(a,"CLASS")||"com.apple.quicktime.HLS",y="YES"==ym(a,"END-ON-NEXT");if(null==d&&y){for(var v=n+1;v<t.length;v++){if(m==(ym(t[v],"CLASS")||"com.apple.quicktime.HLS")){var b=Kt(vm(t[v],"START-DATE"));if(!isNaN(b)&&b&&b>l){d=Math.max(0,b-s);break}}}if(null==d)continue}v=["CLASS","START-DATE","END-DATE","DURATION","END-ON-NEXT"];for(var T=[],S=c(a.attributes),_=S.next();!_.done;_=S.next()){var w=_.value;if(!v.includes(w.name)){var E=Am(w.value,i);"X-ASSET-URI"!=w.name&&"X-ASSET-LIST"!=w.name||(E=km(r(),w.value,i)[0]),T.push({key:w.name,description:"",data:E,mimeType:null,pictureType:null})}}1<T.length&&e.h.onMetadata(m,u,d,T),e.Ba.add(o)}}}catch(k){}}}}function hy(e,t,n,i,r,s){var a=t.segments,o=void 0,l=Em(t.Y,"EXT-X-DISCONTINUITY-SEQUENCE",-1),u=Em(t.Y,"EXT-X-MEDIA-SEQUENCE",0),d=wm(t.Y,"EXT-X-SKIP"),h=d?Number(ym(d,"SKIPPED-SEGMENTS")):0,f=u+h,p=0;by(e)&&n.has(f)&&(p=n.get(f)),0===p&&e.Ca==Py&&0<n.size&&!n.has(f)&&null!=e.l.i&&(p=e.l.ob());var g=[],m=null;d=[];for(var y=0;y<a.length;y++){var v=a[y],b=0==y?p:m.endTime;f=u+h+y,wm(v.Y,"EXT-X-DISCONTINUITY")&&l++;for(var T=c(v.Y),S=T.next();!S.done;S=T.next())"EXT-X-KEY"==(S=S.value).name&&(o=_y(vm(S,"METHOD"))?ry(e,S,t,r,i):void 0);n.set(f,b),(b=uy(e,T=ly(e,t,v.Y,r,i),m,v,b,i,s,r,o))&&((m=Em(v.Y,"EXT-X-BITRATE"))?d.push({bitrate:m,duration:b.endTime-b.startTime}):d.length&&((m=d.pop()).duration+=b.endTime-b.startTime,d.push(m)),m=b,b.i=l,Zm(e,s)&&null!=e.I&&f<e.I||g.push(b))}if(t=void 0,d.length&&(t=d.reduce((function(e,t){return e+t.duration}),0),t=Math.round(d.reduce((function(e,t){return e+t.bitrate*t.duration}),0)/t*1e3)),d=g.some((function(e){return null!=e.h})))for(n={},i=0;i<g.length;n={Ud:void 0,Td:void 0,Nd:void 0,Bc:void 0,Md:void 0},i++)if(n.Bc=g[i],null==n.Bc.h)for(n.Td=0,n.Ud=i,r=function(e){return function(){var t=g[e.Ud];if(t){if(null!=t.h)return t.h+e.Td;e.Td-=t.endTime-t.startTime,e.Ud+=1}return null}}(n),n.Md=0,n.Nd=i,a=function(e){return function(){var t=g[e.Nd];if(t){if(t!=e.Bc&&(e.Md+=t.endTime-t.startTime),null!=t.h)return t.h+e.Md;--e.Nd}return null}}(n);null==n.Bc.h;)n.Bc.h=a(),null==n.Bc.h&&(n.Bc.h=r());if(d)for(i=(n=c(g)).next();!i.done;i=n.next())for(i=(r=i.value).h,a=(r=c(r.g)).next();!a.done;a=r.next())(a=a.value).h=i,i+=a.endTime-a.startTime;if(n=e.ga,d&&1/0!=n&&!Zm(e,s))for(s=(e=c(g)).next();!s.done;s=e.next())s.value.hg(n);return{segments:g,bandwidth:t}}function fy(e,t){if(e==Si){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return"image"!=e||t&&"jpeg"!=t?"audio"==e&&"mp4a.40.34"==t?"audio/mpeg":"mjpg"==t?"application/mp4":null:"image/jpeg"}function py(e){return e==Si?"text/vtt":Iy.get(e).get("mp4")}function gy(e,t){for(var n=t[e=by(e)?Math.trunc((t.length-1)/2):0];2==n.cc()&&e+1<t.length;)n=t[++e];return{segment:n,segmentIndex:e}}function my(e,t,n,i,r,s,a){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(i)||void 0,e.hdr=r||void 0,e.videoLayout=s||void 0,e.colorGamut=a||void 0)}function yy(e,t,n){return Sy(e,ns(t,e.g.retryParameters),0,{type:n?2:3})}function vy(e){var t,n,i,r,s,a;return M((function(o){switch(o.g){case 1:return e.h?(w(o,2),t=Date.now(),S(o,e.update(),4)):o.return();case 4:n=Date.now(),by(e)&&(i=(n-t)/1e3,e.Nb.sample(1,i),r=0<e.g.hls.updatePeriod?e.g.hls.updatePeriod:e.o,s=Math.max(0,r-G(e.Nb)),e.B.aa(s)),k(o,3);break;case 2:if(a=x(o),!e.h)return o.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.h.onError(a),o.return();a.severity=1,e.h.onError(a),e.B.aa(.1);case 3:if(!e.h)return o.return();e.h.onManifestUpdated(),_(o)}}))}function by(e){return e.Ca!=Ry}function Ty(e,t){e.Ca=t,e.l&&e.l.Dc(!by(e)),by(e)||e.B.stop()}function Sy(e,t,n,i){if(!e.ba)throw new Me(2,7,7001);return i||(i={}),i.isPreload=e.Ob(),t=e.h.networkingEngine.request(n,t,i),Jr(e.ba,t),t}function _y(e){return"AES-128"==e||"AES-256"==e||"AES-256-CTR"==e}function wy(t,n,i,r,s,a){var o,l,u,c,d,h,f,p,g,m,y,v,b;return M((function(T){switch(T.g){case 1:if("video/mp2t"==i)throw new Me(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new Me(2,4,4041);if(o=vm(n,"METHOD"),!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(o))return T.return(null);if((l=km(r(),vm(n,"URI"),a))[0].startsWith("data:text/plain;base64,")){u=fi(di(l[0].split("data:text/plain;base64,").pop())),T.u(2);break}return c=l.sort().join(""),t.oa.has(c)||(d=ns(l,t.g.retryParameters),h=Sy(t,d,6).promise,t.oa.set(c,h)),S(T,t.oa.get(c),3);case 3:f=T.h,u=fi(f.data);case 2:if(p="00000000000000000000000000000000",!s){T.u(4);break}if(t.pa.has(s)){g=t.pa.get(s),T.u(5);break}return m=jl(s.N(),s.bc(),s.$b(),t.g.retryParameters),S(T,Sy(t,m,os,{type:0}).promise,6);case 6:y=T.h,g=function(e){var t=null;return(new vs).box("moov",bs).box("trak",bs).box("mdia",bs).box("minf",bs).box("stbl",bs).S("stsd",Ts).box("encv",Ss).box("enca",_s).box("sinf",bs).box("schi",bs).S("tenc",(function(e){(e=e.reader).V(),e.V(),e.V(),e.V(),t=fi(e.Bb(16))})).parse(e,!0),t}(y.data),t.pa.set(s,g);case 5:g&&(p=g);case 4:return(v=new Map).set(p,u),b="cenc","SAMPLE-AES"==o&&(b="cbcs"),T.return(yi(v,b))}}))}$("shaka.net.DataUriPlugin",Mm),Mm.parse=Pm,es("data",Pm),(i=Nm.prototype).configure=function(e,t){var n=this.h&&e.hls.updatePeriod!=this.g.hls.updatePeriod&&0<=e.hls.updatePeriod;this.g=e,t&&(this.Ob=t),this.j&&this.j.configure(this.g),n&&this.m&&this.m.presentationTimeline.T()&&this.B.rb()},i.start=function(e,t){var n,i=this;return M((function(r){return 1==r.g?(i.h=t,i.ia=t.isLowLatencyMode(),S(r,yy(i,[e]).promise,2)):3!=r.g?(n=r.h,i.L=n.uri,S(r,function(e,t,n){var i,r,s,a,o,l,u,h,f,p,g,m,y,v,b,T,E,k,A,C,I,L,D,R,P,O,N,U,F,B,j,$,V,H,q,G,z,K,W,X,Y,Q;return M((function(J){switch(J.g){case 1:return i=_i,r=Im(e.Ia,t),s=Sm(r.Y,"EXT-X-DEFINE"),a=[],o=[],l=[],e.l=new zo(null,0),e.l.Dc(!0),u=function(){return[n]},h=null,f=new Map,1==r.type?(e.O=!1,$=Sm(r.Y,"EXT-X-DEFINE"),f=Vm(e,$,e.L),h=i.la,V="",H=new Map,S(J,ey(e,e.C++,f,r,u,"",h,V,!0,"Media Playlist",null,H,null,!1,null,!1),7)):(function(e,t){for(var n=new zn(e.L).g,i=(t=c(t)).next();!i.done;i=t.next()){var r=i.value;i=ym(r,"NAME");var s=ym(r,"VALUE");r=ym(r,"QUERYPARAM"),i&&s&&(e.A.has(i)||e.A.set(i,s)),r&&(i=n.get(r)[0])&&!e.A.has(i)&&e.A.set(r,i)}}(e,s),p=Sm(r.Y,"EXT-X-MEDIA"),g=Sm(r.Y,"EXT-X-STREAM-INF"),m=Sm(r.Y,"EXT-X-IMAGE-STREAM-INF"),y=Sm(r.Y,"EXT-X-I-FRAME-STREAM-INF"),v=Sm(r.Y,"EXT-X-SESSION-KEY"),b=Sm(r.Y,"EXT-X-SESSION-DATA"),T=Sm(r.Y,"EXT-X-CONTENT-STEERING"),function(e,t){for(var n=(t=c(t)).next();!n.done;n=t.next()){var i=n.value,r=ym(i,"DATA-ID");n=ym(i,"URI");var s=ym(i,"LANGUAGE");i=ym(i,"VALUE"),r=(new Map).set("id",r),n&&r.set("uri",km([e.L],n,e.A)[0]),s&&r.set("language",s),i&&r.set("value",i),n=new Kr("sessiondata",r),e.h&&e.h.onEvent(n)}}(e,b),S(J,function(e,t){var n,i,r,s,a,o;return M((function(l){if(!e.h||!e.g)return l.return();for(i=c(t),r=i.next();!r.done;r=i.next())if(s=r.value,a=ym(s,"PATHWAY-ID"),o=ym(s,"SERVER-URI"),a&&o){e.j=new Zp(e.h),e.j.configure(e.g),e.j.i=[e.L],e.j.setManifestType("HLS"),e.j.h=a,n=eg(e.j,o);break}return S(l,n,0)}))}(e,T),4));case 4:if(!e.g.hls.ignoreSupplementalCodecs){for(E=[],k=c(g),A=k.next(),C={};!A.done;C={yh:void 0},A=k.next())I=A.value,(L=ym(I,"SUPPLEMENTAL-CODECS"))&&(C.yh=L.split(/\s*,\s*/).map((function(e){return e.split("/")[0]})),D=I.attributes.map(function(e){return function(t){var n=t.name;return t=t.value,"CODECS"==n&&(t=e.yh.join(",")),new Tm(n,t)}}(C)),E.push(new pm(I.id,I.name,D,null)));for(g.push.apply(g,d(E)),R=[],P=c(y),O=P.next(),N={};!O.done;N={zh:void 0},O=P.next())U=O.value,(F=ym(U,"SUPPLEMENTAL-CODECS"))&&(N.zh=F.split(/\s*,\s*/).map((function(e){return e.split("/")[0]})),B=U.attributes.map(function(e){return function(t){var n=t.name;return t=t.value,"CODECS"==n&&(t=e.zh.join(",")),new Tm(n,t)}}(N)),R.push(new pm(U.id,U.name,B,null)));y.push.apply(y,d(R))}return function(e,t){for(var n=(t=c(t)).next();!n.done;n=t.next()){var i=n.value,r=ym(i,"AUDIO");n=ym(i,"VIDEO");var s=ym(i,"SUBTITLES");if(i=Gm(e,i),s){var a=bi(Si,i);e.G.set(s,a),Le(i,a)}r&&((s=bi("audio",i))||(s=e.g.hls.defaultAudioCodec),e.G.set(r,s)),n&&((r=bi("video",i))||(r=e.g.hls.defaultVideoCodec),e.G.set(n,r))}}(e,g),function(e,t){t=_m(t,"CLOSED-CAPTIONS"),e.O=0==t.length;for(var n=(t=c(t)).next();!n.done;n=t.next()){var i=n.value,r=ym(i,"LANGUAGE");n=er(r||"und"),r||(r=ym(i,"NAME"))&&(n=r),r=vm(i,"GROUP-ID"),i=vm(i,"INSTREAM-ID").replace("SERVICE","svc"),e.F.get(r)||e.F.set(r,new Map),e.F.get(r).set(i,n)}}(e,p),j=function(e,t){return t.map((function(t){return"video"!==(t=Wm(e,t)).stream.type?null:t.stream})).filter((function(e){return e}))}(e,y),S(J,function(e,t,n,i,r,s,a){var o,l,u,h,f,p,g,m,y,v,b,T,_,w,E,k,x,A,C,I,L,D,R,P,O,N,U,F,B,j,$,V,H,q,G;return M((function(M){switch(M.g){case 1:if(o=[],l=new Set,!(0<n.length)){M.u(2);break}u=c(n),h=u.next();case 3:if(h.done){M.u(2);break}if(f=h.value,p=vm(f,"METHOD"),g=ym(f,"KEYFORMAT")||"identity",m=null,"NONE"==p){M.u(4);break}if(_y(p)){y=km(r(),vm(f,"URI"),s),v=y.sort().join(""),e.K.has(v)||(b=ns(y,e.g.retryParameters),T=Sy(e,b,6).promise,e.K.set(v,T)),M.u(4);break}if("identity"!=g){m=(_=Dy.get(g))?_(f,""):null,M.u(6);break}return S(M,wy(e,f,"",r,null,s),9);case 9:m=M.h;case 6:if(m){if(m.keyIds)for(w=c(m.keyIds),E=w.next();!E.done;E=w.next())k=E.value,l.add(k);o.push(m)}case 4:h=u.next(),M.u(3);break;case 2:for(x={},A=c(t),C=A.next();!C.done;C=A.next())I=C.value,L=gm(I,!e.j),x[L]?x[L].push(I):x[L]=[I];for(R in D=[],x)P=x[R],O=P[0],N=ym(O,"FRAME-RATE"),U=Number(ym(O,"AVERAGE-BANDWIDTH"))||Number(vm(O,"BANDWIDTH")),F=ym(O,"RESOLUTION"),B=c(F?F.split("x"):[null,null]),j=B.next().value,$=B.next().value,V=ym(O,"VIDEO-RANGE"),(H=ym(O,"REQ-VIDEO-LAYOUT"))&&H.includes(",")&&(q=H.split(",").filter((function(e){return"CH-STEREO"==e||"CH-MONO"==e})),H=q[0]),H=H||"CH-MONO",G=qm(e,P,i),D.push.apply(D,d(zm(e,G.audio,G.video,U,j,$,N,V,H,o,l,a)));return M.return(D.filter((function(e){return null!=e})))}}))}(e,g,v,p,u,e.A,j),5);case 5:return a=J.h,o=function(e,t){var n=_m(t,"SUBTITLES");t=n.map((function(t){if(e.g.disableText)return null;try{return Km(e,[t],new Map).stream}catch(o){if(e.g.hls.ignoreTextStreamFailures)return null;throw o}}));for(var i=(n=c(n)).next();!i.done;i=n.next()){var r=vm(i.value,"GROUP-ID");if((i=e.G.get(r))&&(r=e.H.get(r)))for(var s=(r=c(r)).next();!s.done;s=r.next())(s=s.value).stream.codecs=i,s.stream.mimeType=fy(Si,i)||py(Si),Hm(s.stream)}return t.filter((function(e){return e}))}(e,p),S(J,function(e,t,n){var i,r;return M((function(s){return 1==s.g?(i=t.map((function(t){var n,i;return M((function(r){if(1==r.g)return e.g.disableThumbnails?r.return(null):(w(r,2),S(r,function(e,t){var n,i,r,s,a,o,l,u,c,d;return M((function(h){return 1==h.g?(n=vm(t,"URI"),i=ym(t,"CODECS","jpeg")||"",e.i.has(n)?h.return(e.i.get(n)):(r=ym(t,"LANGUAGE"),s=ym(t,"NAME"),a=ym(t,"CHARACTERISTICS"),o=Xm(e,e.C++,[n],i,"image",r,!1,s,null,null,a,!1,null,!1),(l=ym(t,"RESOLUTION"))?S(h,o.stream.createSegmentIndex(),3):h.u(2))):(2!=h.g&&(u=fl(o.stream.segmentIndex),c=u.tilesLayout)&&(o.stream.width=Number(l.split("x")[0])*Number(c.split("x")[0]),o.stream.height=Number(l.split("x")[1])*Number(c.split("x")[1])),(d=ym(t,"BANDWIDTH"))&&(o.stream.bandwidth=Number(d)),e.i.set(n,o),h.return(o))}))}(e,t),4));if(2!=r.g)return n=r.h,r.return(n.stream);if(i=x(r),e.g.hls.ignoreImageStreamFailures)return r.return(null);throw i}))})).concat(n.map((function(t){if(e.g.disableThumbnails)return null;try{var n=Wm(e,t);return"image"!==n.stream.type?null:n.stream}catch(l){if(e.g.hls.ignoreImageStreamFailures)return null;throw l}}))),S(s,Promise.all(i),2)):(r=s.h,s.return(r.filter((function(e){return e}))))}))}(e,m,y),6);case 6:l=J.h,J.u(3);break;case 7:q=J.h,e.i.set(n,q),q.stream&&(G=wl(q.stream),q.stream.segmentIndex.Eb((function(e){e.ca&&(e.ca.Tc=G)}))),h=q.stream.type,a.push({id:0,language:er(V||"und"),disabledUntilTime:0,primary:!0,audio:"audio"==h?q.stream:null,video:"video"==h?q.stream:null,bandwidth:q.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.h)throw new Me(2,7,7001);if(sy(e,r),1==r.type&&(by(e)&&(oy(e,r),z=e.o,e.B.aa(z)),K=Array.from(e.i.values()),Jm(e,K),$m(e),dy(e,r.Y,h,f,u)),e.m={presentationTimeline:e.l,variants:a,textStreams:o,imageStreams:l,offlineSessionIds:[],sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:e.s},e.da||!e.g.hls.disableCodecGuessing){J.u(8);break}for(W=[],X=c(e.m.variants),Y=X.next();!Y.done;Y=X.next())(Q=Y.value).audio&&""===Q.audio.codecs&&W.push(Q.audio.createSegmentIndex()),Q.video&&""===Q.video.codecs&&W.push(Q.video.createSegmentIndex());return S(J,Promise.all(W),8);case 8:e.h.makeTextStreamsForClosedCaptions(e.m),_(J)}}))}(i,n.data,e),3)):r.return(i.m)}))},i.stop=function(){this.B&&(this.B.stop(),this.B=null);var e=[];return this.ba&&(e.push(this.ba.destroy()),this.ba=null),this.g=this.h=null,this.Db.clear(),this.m=null,this.i.clear(),this.H.clear(),this.G.clear(),this.A.clear(),this.sa.clear(),this.ja.clear(),this.K.clear(),this.oa.clear(),this.pa.clear(),this.Ba.clear(),this.j&&this.j.destroy(),this.W&&(this.W.release(),this.W=null),Promise.all(e)},i.update=function(){var e,t,n,i,r,s,a,o,l,u,h,f=this;return M((function(p){if(1==p.g){if(!by(f))return p.return();for(e=[],t=Array.from(f.i.values()),f.o=1/0,f.m.gapCount=0,n=t.filter((function(e){return e.stream.segmentIndex})),i=c(n),r=i.next();!r.done;r=i.next())s=r.value,e.push(Fm(f,s));return S(p,Promise.all(e),2)}for(Qm(f,n.map((function(e){return e.stream}))),a=n.some((function(e){return 0==e.pd})),n.length&&!a&&(Ty(f,Oy.Hh),o=n.map((function(e){return e.Sb})),f.l.ab(Math.min.apply(Math,d(o))),f.h.updateDuration()),a&&$m(f),l=c(n),u=l.next();!u.done;u=l.next())(h=u.value).stream.isAudioMuxedInVideo||!h.stream.segmentIndex||fl(h.stream.segmentIndex)||f.h.disableStream(h.stream);_(p)}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(e){this.j&&this.j.banLocation(e)},i.setMediaElement=function(e){this.$=e},$("shaka.hls.HlsParser",Nm);var Ey=(new Map).set("aac","audio/aac").set("ac3","audio/ac3").set("ec3","audio/ec3").set("mp3","audio/mpeg"),ky=(new Map).set("mp4","audio/mp4").set("mp4a","audio/mp4").set("m4s","audio/mp4").set("m4i","audio/mp4").set("m4a","audio/mp4").set("m4f","audio/mp4").set("cmfa","audio/mp4").set("ts","video/mp2t").set("tsa","video/mp2t"),xy=(new Map).set("mp4","video/mp4").set("mp4v","video/mp4").set("m4s","video/mp4").set("m4i","video/mp4").set("m4v","video/mp4").set("m4f","video/mp4").set("cmfv","video/mp4").set("ts","video/mp2t").set("tsv","video/mp2t"),Ay=(new Map).set("mp4","application/mp4").set("m4s","application/mp4").set("m4i","application/mp4").set("m4f","application/mp4").set("cmft","application/mp4").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml"),Cy=(new Map).set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif"),Iy=(new Map).set("audio",ky).set("video",xy).set("text",Ay).set("image",Cy),Ly=new Set(["video/mp2t"].concat(d(Fi))),Dy=(new Map).set("com.apple.streamingkeydelivery",(function(t,n){if("video/mp2t"==n)throw new Me(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new Me(2,4,4041);if(n=vm(t,"METHOD"),!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(n))return null;var i="cenc";return"SAMPLE-AES"==n&&(i="cbcs"),mi("com.apple.fps",i,[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}],vm(t,"URI"))})).set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",(function(e){var t=vm(e,"METHOD");if(!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t))return null;var n="cenc";return"SAMPLE-AES"==t&&(n="cbcs"),n=mi("com.widevine.alpha",n,[{initDataType:"cenc",initData:t=me((t=Om((t=vm(e,"URI")).split("?")[0])).data)}]),(e=ym(e,"KEYID"))&&(n.keyIds=new Set([e.toLowerCase().substr(2)])),n})).set("com.microsoft.playready",(function(e){var t=vm(e,"METHOD");if(!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t))return null;var n="cenc";return"SAMPLE-AES"==t&&(n="cbcs"),n=mi("com.microsoft.playready",n,[{initDataType:"cenc",initData:t=Ls(e=me((e=Om((e=vm(e,"URI")).split("?")[0])).data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),new Set,0)}]),(e=Mt(["<PLAYREADY>",ci(e),"</PLAYREADY>"].join("\n")))&&(n.licenseServerUri=vp(e)),n})).set("urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c",(function(e){var t=vm(e,"METHOD");if(!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t))return null;var n="cenc";return"SAMPLE-AES"==t&&(n="cbcs"),n=mi("com.huawei.wiseplay",n,[{initDataType:"cenc",initData:t=me((t=Om((t=vm(e,"URI")).split("?")[0])).data)}]),(e=ym(e,"KEYID"))&&(n.keyIds=new Set([e.toLowerCase().substr(2)])),n})),Ry="VOD",My="EVENT",Py="LIVE",Oy={Hh:Ry,Lj:My,Tj:Py};function Ny(e){return vp(e)}ya("application/x-mpegurl",(function(){return new Nm})),ya("application/vnd.apple.mpegurl",(function(){return new Nm}));var Uy=(new Map).set("com.microsoft.playready",Ny).set("com.microsoft.playready.recommendation",Ny).set("com.microsoft.playready.software",Ny).set("com.microsoft.playready.hardware",Ny);function Fy(e){if(!Xy){Xy=!0;var t=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]),i=new Uint8Array([0,0,0,1]);ov=Wy("ftyp",t,i,t,n),t=Wy("dref",lv),uv=Wy("dinf",t)}this.g=e}function By(e){for(var t=[],n=c(e.g),i=n.next();!i.done;i=n.next()){var r=t,s=r.push,a=i.value;i=Wy;var o=a.id+1,l=a.stream.width||0,u=a.stream.height||0;"audio"==a.type&&(u=l=0);var h=a.duration*a.timescale,f=Math.floor(h/(Yy+1));switch(h=Math.floor(h%(Yy+1)),o=Wy("tkhd",o=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(d(zy(o,4)),[0,0,0,0],d(zy(f,4)),d(zy(h,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],d(zy(l,2)),[0,0],d(zy(u,2)),[0,0]))),l=Wy,f=a.duration*a.timescale,u=Math.floor(f/(Yy+1)),f=Math.floor(f%(Yy+1)),h=(h=a.stream.language).charCodeAt(0)-96<<10|h.charCodeAt(1)-96<<5|h.charCodeAt(2)-96,u=Wy("mdhd",u=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(d(zy(a.timescale,4)),d(zy(u,4)),d(zy(f,4)),d(zy(h,2)),[0,0]))),f=a,h=new Uint8Array([]),f.type){case"video":h=Jy;break;case"audio":h=Zy}f=Wy("hdlr",h);e:{switch(a.type){case"video":a=Wy("minf",Wy("vmhd",rv),uv,jy(a));break e;case"audio":a=Wy("minf",Wy("smhd",sv),uv,jy(a));break e}a=new Uint8Array([])}i=i("trak",o,a=l("mdia",u,f,a)),s.call(r,i)}for(t=pi.apply(li,d(t)),n=Wy,i=(s=e.g[0]).duration*s.timescale,r=Math.floor(i/(Yy+1)),i=Math.floor(i%(Yy+1)),r=Wy("mvhd",r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(d(zy(s.timescale,4)),d(zy(r,4)),d(zy(i,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))),i=[],l=(e=c(e.g)).next();!l.done;l=e.next())o=(a=i).push,l=Wy("trex",l=new Uint8Array([0,0,0,0].concat(d(zy(l.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]))),o.call(a,l);if(e=Wy("mvex",e=pi.apply(li,d(i))),i=[],s.encrypted){for(a=(s=c(s.stream.drmInfos)).next();!a.done;a=s.next())if((a=a.value).initData)for(o=(a=c(a.initData)).next();!o.done;o=a.next())i.push(o.value.initData);s=pi.apply(li,d(i))}else s=new Uint8Array([]);return e=n("moov",r,t,e,s),(t=new Uint8Array(ov.byteLength+e.byteLength)).set(ov),t.set(e,ov.byteLength),t}function jy(e){var t=Wy,n="aac";e.codecs.includes("mp3")?n="mp3":e.codecs.includes("ac-3")?n=We()?"ec-3":"ac-3":e.codecs.includes("ec-3")?n="ec-3":e.codecs.includes("opus")&&(n="opus");var i=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){if(n=e.stream.width||0,i=e.stream.height||0,0<e.za.byteLength)var r=Wy("avcC",e.za);else{r=Wy;for(var s=7,a=[],o=[],l=0,u=0,c=0,h=0;h<e.lb.length;h++){var f=Ky(e.lb[h]);switch(31&f[0]){case 7:a.push(f),s+=f.length+2;break;case 8:o.push(f),s+=f.length+2}}for(0<a.length&&(l=a[0][1],c=a[0][2],u=a[0][3]),h=0,(s=new Uint8Array(s))[h++]=1,s[h++]=l,s[h++]=c,s[h++]=u,s[h++]=255,s[h++]=224|a.length,l=0;l<a.length;l++)s[h++]=(65280&a[l].length)>>8,s[h++]=255&a[l].length,s.set(a[l],h),h+=a[l].length;for(s[h++]=o.length,a=0;a<o.length;a++)s[h++]=(65280&o[a].length)>>8,s[h++]=255&o[a].length,s.set(o[a],h),h+=o[a].length;r=r("avcC",s)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(d(zy(n,2)),d(zy(i,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),i="avc1",o=$y(e),a=new Uint8Array([]),e.encrypted&&(a=Hy(e),i="encv"),i=Wy(i,n,r,o,a)}else e.codecs.includes("hvc1")&&(i=e.stream.width||0,r=e.stream.height||0,n=new Uint8Array([]),0<e.za.byteLength&&(n=Wy("hvcC",e.za)),i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(d(zy(i,2)),d(zy(r,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),r="hvc1",o=$y(e),a=new Uint8Array([]),e.encrypted&&(a=Hy(e),r="encv"),i=Wy(r,i,n,o,a));break;case"audio":"mp3"==n?e=Wy(".mp3",Vy(e)):"ac-3"==n?(n=Wy("dac3",e.ra),i="ac-3",r=new Uint8Array([]),e.encrypted&&(r=Hy(e),i="enca"),e=Wy(i,Vy(e),n,r)):"ec-3"==n?(n=Wy("dec3",e.ra),i="ec-3",r=new Uint8Array([]),e.encrypted&&(r=Hy(e),i="enca"),e=Wy(i,Vy(e),n,r)):"opus"==n?(n=Wy("dOps",e.ra),i="Opus",r=new Uint8Array([]),e.encrypted&&(r=Hy(e),i="enca"),e=Wy(i,Vy(e),n,r)):(0<e.ra.byteLength?n=Wy("esds",e.ra):(n=Wy,i=e.id+1,r=e.stream.channelsCount||2,a=e.stream.audioSamplingRate||44100,l=vi("audio",e.codecs.split(",")),o=(u={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12})[a],"mp4a.40.5"!==l&&"mp4a.40.29"!==l||(o=u[2*a]),a=parseInt(l.split(".").pop(),10),n=n("esds",i=new Uint8Array([0,0,0,0,3,25].concat(d(zy(i,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,a<<3|o>>>1,o<<7|r<<3,6,1,2])))),i="mp4a",r=new Uint8Array([]),e.encrypted&&(r=Hy(e),i="enca"),e=Wy(i,Vy(e),n,r)),i=e}return t("stbl",e=Wy("stsd",av,i),Wy("stts",ev),Wy("stsc",tv),Wy("stsz",iv),Wy("stco",nv))}function $y(e){if(!e.Fa&&!e.Ha)return new Uint8Array([]);var t=e.Ha;return Wy("pasp",e=new Uint8Array([].concat(d(zy(e.Fa,4)),d(zy(t,4)))))}function Vy(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(d(zy(e.stream.audioSamplingRate||44100,2)),[0,0]))}function Hy(e){for(var t=Wy,n=e.codecs.substring(0,e.codecs.indexOf(".")),i=0,r=0;r<n.length;r+=1)i|=n.charCodeAt(r)<<8*(n.length-r-1);n=Wy("frma",n=new Uint8Array([].concat(d(zy(i,4))))),i=Wy("schm",i=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0])),r=Wy;for(var s=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),a=(e=c(e.stream.drmInfos)).next();!a.done;a=e.next())if((a=a.value)&&a.keyIds&&a.keyIds.size)for(var o=(a=c(a.keyIds)).next();!o.done;o=a.next())s=Ky(o.value);return t("sinf",n,i,r("schi",s=Wy("tenc",e=new Uint8Array([0,0,0,0,0,0,1,8]),s)))}function qy(e){for(var t=[],n=(e=c(e.g)).next();!n.done;n=e.next()){n=n.value;var i,r=t.push,s=r.apply,a=Wy,o=new Uint8Array([0,0,0,0].concat(d(zy(n.data?n.data.Cb:0,4))));o=Wy("mfhd",o);var l=n.data?n.data.jb:[],u=new Uint8Array(4+l.length);for(i=0;i<l.length;i++){var h=l[i].flags;u[i+4]=h.Va<<4|h.Xa<<2|h.Wa}var f=(l=Wy("sdtp",u)).length+92;u=Wy,i=Wy("tfhd",i=new Uint8Array([0,0,0,58].concat(d(zy(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]))),h=n.data?n.data.baseMediaDecodeTime:0;var p=Math.floor(h%(Yy+1));h=Wy("tfdt",h=new Uint8Array([1,0,0,0].concat(d(zy(Math.floor(h/(Yy+1)),4)),d(zy(p,4)))));var g=f,m=12+16*(p=(f=n.data?n.data.jb:[]).length),y=new Uint8Array(m);for(g+=8+m,y.set(["video"===n.type?1:0,0,15,1].concat(d(zy(p,4)),d(zy(g,4))),0),g=0;g<p;g++){var v=f[g];m=zy(v.duration,4);var b=zy(v.size,4),T=v.flags;v=zy(v.eb,4),y.set([].concat(d(m),d(b),[T.hb<<2|T.Va,T.Xa<<6|T.Wa<<4|T.ib,61440&T.Ua,15&T.Ua],d(v)),12+16*g)}a=a("moof",o,l=u("traf",i,h,f=Wy("trun",y),l)),s.call(r,t,[a,Gy(n)])}return pi.apply(li,d(t))}function Gy(e){return e=(e.data?e.data.jb:[]).map((function(e){return e.data})),Wy("mdat",e=pi.apply(li,d(e)))}function zy(e,t){var n=[];for(--t;0<=t;t--)n.push(e>>8*t&255);return n}function Ky(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[2*n]+e[2*n+1]),16);return t}function Wy(e){var t=P.apply(1,arguments),n=Qy.get(e);n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],Qy.set(e,n));for(var i=8,r=t.length-1;0<=r;r--)i+=t[r].byteLength;for((r=new Uint8Array(i))[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=255&i,r.set(n,4),n=0,i=8;n<t.length;n++)r.set(t[n],i),i+=t[n].byteLength;return r}var Xy=!1,Yy=Math.pow(2,32)-1,Qy=new Map,Jy=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Zy=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),ev=new Uint8Array([0,0,0,0,0,0,0,0]),tv=new Uint8Array([0,0,0,0,0,0,0,0]),nv=new Uint8Array([0,0,0,0,0,0,0,0]),iv=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),rv=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),sv=new Uint8Array([0,0,0,0,0,0,0,0]),av=new Uint8Array([0,0,0,0,0,0,0,1]),ov=new Uint8Array([]),lv=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),uv=new Uint8Array([]);function cv(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.s=1,this.i=null,this.C=new q(5),this.o=new Ve((function(){!function(e){var t;M((function(n){switch(n.g){case 1:return w(n,2),S(n,dv(e),4);case 4:k(n,3);break;case 2:t=x(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();_(n)}}))}(e)})),this.B=new Qr,this.m=new Map,this.A=function(){return!1}}function dv(e){var t,n,i,r,s,a,o;return M((function(l){if(1==l.g)return t=ns(e.l,e.g.retryParameters),n=e.h.networkingEngine,i=Date.now(),r=n.request(0,t,{type:5,isPreload:e.A()}),Jr(e.B,r),S(l,r.promise,2);if(s=l.h,!e.h)return l.return();s.uri&&!e.l.includes(s.uri)&&e.l.unshift(s.uri);var u=s.uri,h=s.data,f=e.g.mss.manifestPreprocessor;if(f!=wu){if(oe("manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),!(h=Bg(h,"SmoothStreamingMedia")))throw new Me(2,4,4046,u);f(h),h=yt(h.outerHTML)}var p=Rt(h,"SmoothStreamingMedia");if(!p)throw new Me(2,4,4046,u);if((u=e.g.mss.manifestPreprocessorTXml)!=Eu&&u(p),e.i||(e.i=new zo(null,0)),u=Ht(p,"IsLive",en,!1))throw new Me(2,4,4047);e.i.Dc(!u),f=Ht(p,"TimeScale",Jt,1e7),h=Ht(p,"DVRWindowLength",Jt),u&&(0===h||isNaN(h))&&(h=1/0);var g,m=Ht(p,"CanSeek",en,!1);for(0===h&&m&&(h=1/0),m=null,h&&0<h&&(m=h/f),u&&!isNaN(e.g.availabilityWindowOverride)&&(m=e.g.availabilityWindowOverride),null==m&&(m=1/0),e.i.xe(m),h=Ht(p,"Duration",Jt,1/0),u||e.i.ab(h/f),u={variants:[],textStreams:[],timescale:f,duration:h/f},m=Ut(p,"Protection"),f=e.g.mss.keySystemsBySystemId,h=[],g=(m=c(m)).next();!g.done;g=m.next())h=h.concat(Ut(g.value,"ProtectionHeader"));if(h.length){for(m=[],g=0;g<h.length;g++){var y=h[g],v=y.attributes.SystemID.toLowerCase(),b=f[v];if(b){var T;e:{if(T=yp(y))for(var w=(T=c(jt(T,"DATA"))).next();!w.done;w=T.next())if(w=$t(w.value,"KID")){T=di(Ft(w)),T=fi(T=new Uint8Array([T[3],T[2],T[1],T[0],T[5],T[4],T[7],T[6]].concat(d(T.slice(8)))));break e}T=null}v=mi(b,"cenc",v=[{initData:Ls(w=di(Ft(y)),v=hi(v.replace(/-/g,"")),new Set,0),initDataType:"cenc",keyId:T}]),T&&v.keyIds.add(T),(b=Uy.get(b))&&(v.licenseServerUri=b(y)),m.push(v)}}f=m}else f=[];for(g=f,m=[],f=[],h=[],y=(p=c(p=Ut(p,"StreamIndex"))).next();!y.done;y=p.next()){b=Ut(y=y.value,"QualityLevel"),v=u.timescale,T=u.duration,w=Ut(y,"c");for(var E=[],k=0,x=0;x<w.length;++x){var A=w[x],C=w[x+1],I=Ht(A,"t",Jt),L=Ht(A,"d",Jt);if(A=Ht(A,"r",Yt),!L)break;if(I=null!=I?I:k,(A=A||0)&&A--,0>A)if(C){if(null==(C=Ht(C,"t",Jt)))break;if(I>=C)break;A=Math.ceil((C-I)/L)-1}else{if(1/0==T)break;if(I/v>=T)break;A=Math.ceil((T*v-I)/L)-1}for(C=0;C<=A;++C)k=I+L,E.push({start:I/v,end:k/v,og:I}),I=k}for(v=E,T=(b=c(b)).next();!T.done;T=b.next())(T=hv(e,y,T.value,v,g,u))&&("audio"!=T.type||e.g.disableAudio?"video"!=T.type||e.g.disableVideo?T.type!=Si||e.g.disableText||h.push(T):f.push(T):m.push(T))}for(p=[],g=(m=c(0<m.length?m:[null])).next();!g.done;g=m.next())for(g=g.value,E=(y=c(0<f.length?f:[null])).next();!E.done;E=y.next())v=(b=p).push,T=e,w=g,E=E.value,x=0,w&&w.bandwidth&&0<w.bandwidth&&(x+=w.bandwidth),E&&E.bandwidth&&0<E.bandwidth&&(x+=E.bandwidth),T={id:T.s++,language:w?w.language:"und",disabledUntilTime:0,primary:!!w&&w.primary||!!E&&E.primary,audio:w,video:E,bandwidth:x,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},v.call(b,T);u.variants=p,u.textStreams=h,e.j?(e.j.variants=u.variants,e.j.textStreams=u.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:u.variants,textStreams:u.textStreams,imageStreams:[],offlineSessionIds:[],sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null},e.i.de()),Promise.resolve(),a=Date.now(),o=(a-i)/1e3,e.C.sample(1,o),_(l)}))}function hv(e,t,n,i,r,s){var a=t.attributes.Type;if("audio"!==a&&"video"!==a&&"text"!==a)return X("Ignoring unrecognized type:",a),null;var o=t.attributes.Language,l=e.s++,u=Ht(n,"Bitrate",Qt),d=Ht(n,"MaxWidth",Qt),h=Ht(n,"MaxHeight",Qt),f=Ht(n,"Channels",Qt),p=Ht(n,"SamplingRate",Qt),g=s.duration;i.length&&(g=i[i.length-1].end-i[0].start);var m=e.i.getDuration();e.i.ab(Math.min(g,m));var y={id:l,originalId:t.attributes.Name||String(l),groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:u||0,width:d||void 0,height:h||void 0,kind:"",encrypted:0<r.length,drmInfos:r,keyIds:new Set,language:er(o||"und"),originalLanguage:o,label:"",type:"",primary:!1,trickModeVideo:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:f,audioSamplingRate:p,spatialAudio:!1,closedCaptions:null,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:g,timescale:s.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1};if((r=t.attributes.Subtype)&&((r=pv.get(r))&&y.roles.push(r),"main"===r&&(y.primary=!0)),null!==(r=n.attributes.FourCC)&&""!==r||(r=t.attributes.FourCC),!r)if("audio"===a)r="AAC";else if("video"===a)return X('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!fv.includes(r.toUpperCase()))return X("Codec not supported:",r),null;switch(n=function(e,t,n,i){if(e=e.attributes.CodecPrivateData)return e;if("audio"!==t)return null;t=i.channelsCount||2,e=i.audioSamplingRate||44100;var r={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return i=r[e],"AACH"===n?(n=new Uint8Array(4),e=r[2*e],n[0]=40|i>>1,n[1]=i<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,t=new Uint16Array(2),t[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):(n=new Uint8Array(2),n[0]=16|i>>1,n[1]=i<<7|t<<3,t=new Uint16Array(1),t[0]=(n[0]<<8)+n[1],t[0].toString(16))}(n,a,r,y),y.mssPrivateData.codecPrivateData=n,a){case"audio":if(!n)return X("Quality unsupported without CodecPrivateData",a),null;y.type="audio",y.mimeType="mss/audio/mp4",y.codecs=function(e,t){var n=0;return"AACH"===e&&(n=5),t?0===n&&(n=(248&parseInt(t.substr(0,2),16))>>3):(n=2,"AACH"===e&&(n=5)),"mp4a.40."+n}(r,n);break;case"video":if(!n)return X("Quality unsupported without CodecPrivateData",a),null;y.type="video",y.mimeType="mss/video/mp4",y.codecs=function(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}(n);break;case"text":y.type=Si,y.mimeType="application/mp4",("TTML"===r||"DFXP"===r)&&(y.codecs="stpp")}return y.fullMimeTypes.add(xi(y.mimeType,y.codecs)),y.createSegmentIndex=function(){if(y.segmentIndex)return Promise.resolve();if(e.m.has(y.id))var n=e.m.get(y.id);else n=[],"video"==y.type&&(n=y.mssPrivateData.codecPrivateData.split("00000001").slice(1)),n=By(new Fy([n={id:y.id,type:y.type,codecs:y.codecs,encrypted:y.encrypted,timescale:y.mssPrivateData.timescale,duration:y.mssPrivateData.duration,lb:n,ra:new Uint8Array([]),za:new Uint8Array([]),Fa:0,Ha:0,data:null,stream:y}])),e.m.set(y.id,n);return n=function(e,t,n,i,r){var s=i.attributes.Url.replace("{bitrate}",String(n.bandwidth));i=[];for(var a=(r=c(r)).next(),o={};!a.done;o={Ae:void 0},a=r.next())o.Ae=a.value,i.push(new ka(o.Ae.start,o.Ae.end,function(t){return function(){return gi(e.l,[s.replace("{start time}",String(t.Ae.og))])}}(o),0,null,t,0,0,n.mssPrivateData.duration));return i}(e,new wa((function(){return[]}),0,null,wl(y),y.mssPrivateData.timescale,n,null,y.encrypted),y,t,i),y.segmentIndex=new hl(n),Promise.resolve()},y.closeSegmentIndex=function(){y.segmentIndex&&(y.segmentIndex.release(),y.segmentIndex=null)},y}(i=cv.prototype).configure=function(e,t){this.g=e,t&&(this.A=t)},i.start=function(e,t){var n=this;return M((function(i){if(1==i.g)return n.l=[e],n.h=t,S(i,dv(n),2);if(!n.h)throw new Me(2,7,7001);return i.return(n.j)}))},i.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,null!=this.o&&(this.o.stop(),this.o=null),this.m.clear(),this.B.destroy()},i.update=function(){var e,t=this;return M((function(n){return 1==n.g?(w(n,2),S(n,dv(t),4)):2!=n.g?k(n,0):(e=x(n),t.h&&e?(t.h.onError(e),void _(n)):n.return())}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},$("shaka.mss.MssParser",cv);var fv="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),pv=(new Map).set("CAPT","main").set("SUBT","alternate").set("DESC","main");function gv(e,t,n,i,r,s,a){if(200<=n&&299>=n&&202!=n||304==n)return{uri:r||i,originalUri:i,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"],originalRequest:s};s=null;try{s=mt(t)}catch(o){}throw new Me(401==n||403==n?2:1,1,1001,i,n,s,e,a,r||i)}function mv(){}function yv(e,t,n,i,r,s){var a=new wv;fs(t.headers).forEach((function(e,t){a.append(t,e)}));var o=new Sv,l={Ag:!1,Bh:!1};if(e=function(e,t,n,i,r,s,a,o,l){var u,c,d,h,f,p,g,m,y,v,b,T;return M((function(E){switch(E.g){case 1:return u=Tv,c=_v,h=new ArrayBuffer(0),p=f=0,g=Date.now(),w(E,2),S(E,u(e,i),4);case 4:if(d=E.h,a(vv(d.headers)),"HEAD"==i.method){E.u(5);break}return m=d.clone().body.getReader(),v=(y=d.headers.get("Content-Length"))?parseInt(y,10):0,new c({start:function(e){function t(){var n,i,r,a;return M((function(u){switch(u.g){case 1:return w(u,2),S(u,m.read(),4);case 4:n=u.h,k(u,3);break;case 2:return x(u),u.return();case 3:if(n.done){u.u(5);break}if(f+=n.value.byteLength,!o){u.u(5);break}return S(u,o(n.value),5);case 5:i=Date.now(),r=f-p,(100<i-g&&r>=l||n.done)&&(a=n.done?0:v-f,s(i-g,r,a),p=f,g=i),n.done?e.close():(e.enqueue(n.value),t()),_(u)}}))}t()}}),S(E,d.arrayBuffer(),6);case 6:h=E.h;case 5:k(E,3);break;case 2:if(b=x(E),r.Ag)throw new Me(1,1,7001,e,n);if(r.Bh)throw new Me(1,1,1003,e,n);throw new Me(1,1,1002,e,b,n);case 3:return T=vv(d.headers),E.return(gv(T,h,d.status,e,d.url,t,n))}}))}(e,t,n,{body:t.body||void 0,headers:a,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},l,i,r,t.streamDataCallback,s.minBytesForProgressEvents||0),e=new $r(e,(function(){return l.Ag=!0,o.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var u=new Ve((function(){l.Bh=!0,o.abort()}));u.aa(t/1e3),e.finally((function(){u.stop()}))}return e}function vv(e){var t={};return e.forEach((function(e,n){t[n.trim()]=e})),t}function bv(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(rw){return!1}return!!e.Response&&(!!new Response("").body&&!(!e.fetch||"polyfill"in e.fetch||!e.AbortController))}ya("application/vnd.ms-sstr+xml",(function(){return new cv})),$("shaka.net.HttpFetchPlugin",mv),mv.isSupported=bv,mv.parse=yv;var Tv=e.fetch,Sv=e.AbortController,_v=e.ReadableStream,wv=e.Headers;function Ev(){}function kv(e,t,n,i,r,s){var a=new Av,o=Date.now(),l=0;return new $r(new Promise((function(u,c){a.open(t.method,e,!0),a.responseType="arraybuffer",a.timeout=t.retryParameters.timeout,a.withCredentials=t.allowCrossSiteCredentials,a.onabort=function(){c(new Me(1,1,7001,e,n))};var d=!1;for(var h in a.onreadystatechange=function(){if(2==a.readyState&&!d){var e=xv(a);r(e),d=!0}},a.onload=function(r){var s=xv(a),d=a.response;try{i(Date.now()-o,r.loaded-l,0);var h=gv(s,d,a.status,e,a.responseURL,t,n);u(h)}catch(f){c(f)}},a.onerror=function(t){c(new Me(1,1,1002,e,t,n))},a.ontimeout=function(){c(new Me(1,1,1003,e,n))},a.onprogress=function(e){var t=Date.now(),n=s.minBytesForProgressEvents||0,r=e.loaded-l;(100<t-o&&r>=n||e.lengthComputable&&e.loaded==e.total)&&(i(t-o,r,4==a.readyState?0:e.total-e.loaded),l=e.loaded,o=t)},t.headers)a.setRequestHeader(h.toLowerCase(),t.headers[h]);a.send(t.body)})),(function(){return a.abort(),Promise.resolve()}))}function xv(e){var t=e.getAllResponseHeaders().trim().split("\r\n");e={};for(var n=(t=c(t)).next();!n.done;n=t.next())e[(n=n.value.split(": "))[0].toLowerCase()]=n.slice(1).join(": ");return e}bv()&&(es("http",yv,2,!0),es("https",yv,2,!0),es("blob",yv,2,!0)),$("shaka.net.HttpXHRPlugin",Ev),Ev.parse=kv;var Av=e.XMLHttpRequest;function Cv(e,t,n,i,r){this.g=e,this.i=t,this.groupId=n,this.h=i,this.j=r}function Iv(e){var t=e.Qb();return t?ci(t):e.N().map((function(e){return"{"+encodeURI(e.split("#xywh=")[0])+"}"})).join("")+":"+e.Na+":"+e.wa}function Lv(e,t){return jl(e.g.N(),e.g.Na,e.g.wa,t.streaming.retryParameters)}function Dv(){this.g=this.j=this.i=0,this.h=new Map,this.l=0}function Rv(e,t){e.i+=t;var n=e.l;return e.l++,e.h.set(n,t),n}function Mv(e){return 0==e.i?0:e.j/e.i}function Pv(e){var t=this;this.s=e,this.i=new Map,this.h=new cs((function(){return Ov(t).catch((function(){}))})),this.j=[],this.o=function(){},this.m=function(){},this.g=new Dv,this.l=!1}function Ov(e){e.l=!0;var t=e.j.map((function(e){return e()}));return e.j=[],Promise.all(t)}function Nv(e,t,n,i,r,s){ds(e.h);var a=(e.i.get(t)||Promise.resolve()).then((function(){var t,a,o,l,u,c,d;return M((function(h){if(1==h.g)return S(h,function(e,t){var n,i,r,s;return M((function(a){return 1==a.g?(n=os,i=e.s.request(n,t),r=function(){return i.abort()},e.j.push(r),S(a,i.promise,2)):(s=a.h,Le(e.j,r),a.return(s.data))}))}(e,n),2);if(t=h.h,e.h.g)throw new Me(2,9,7001);if(r)for(l in a=me(t),(o=new Is(a)).data)u=Number(l),c=o.data[u],d=o.g[u],e.m(c,d);return e.g.close(i,t.byteLength),e.o(Mv(e.g),e.g.g),h.return(s(t))}))}));e.i.set(t,a)}function Uv(e,t,n,i,r,s){ds(e.h);var a=(e.i.get(t)||Promise.resolve()).then((function(){if(e.h.g)throw new Me(2,9,7001);if(r){var t=me(n);for(var a in(t=new Is(t)).data){var o=Number(a);e.m(t.data[o],t.g[o])}}return e.g.close(i,n.byteLength),e.o(Mv(e.g),e.g.g),s(n)}));e.i.set(t,a)}function Fv(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new jr,e.onabort=function(e){e.preventDefault(),n.g.reject()},e.onerror=function(e){e.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}function Bv(e,t){return new Promise((function(n,i){var r=e.h.openCursor();r.onerror=i,r.onsuccess=function(){var e;return M((function(i){if(1==i.g)return null==r.result?(n(),i.return()):(e=r.result,S(i,t(e.key,e.value,e),2));e.continue(),_(i)}))}}))}function jv(e){this.h=e,this.g=[]}function $v(e,t){return Vv(e,t,"readwrite")}function Vv(e,t,n){var i=new Fv(n=e.h.transaction([t],n),t);return e.g.push(i),i.promise().then((function(){Le(e.g,i)}),(function(){Le(e.g,i)})),i}function Hv(e,t,n){this.h=new jv(e),this.i=t,this.g=n}function qv(e){return Promise.reject(new Me(2,9,9011,"Cannot add new value to "+e))}function Gv(e,t,n,i){t=(e=$v(e.h,t)).store();for(var r=(n=c(n)).next(),s={};!r.done;s={Gf:void 0},r=n.next())s.Gf=r.value,t.delete(s.Gf).onsuccess=function(e){return function(){return i(e.Gf)}}(s);return e.promise()}function zv(e,t,n){var i,r,s,a,o,l,u;return M((function(d){if(1==d.g){for(i=Vv(e.h,t,"readonly"),r=i.store(),s={},a=[],o=c(n),l=o.next(),u={};!l.done;u={se:void 0,be:void 0},l=o.next())u.be=l.value,u.se=r.get(u.be),u.se.onsuccess=function(e){return function(){void 0==e.se.result&&a.push(e.be),s[e.be]=e.se.result}}(u);return S(d,i.promise(),2)}if(a.length)throw new Me(2,9,9012,"Could not find values for "+a);return d.return(n.map((function(e){return s[e]})))}))}function Kv(e){this.g=new jv(e)}function Wv(){this.g=new Map}function Xv(e){var t=null;if(e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){e.hasFixedKeySpace()||t||(t={path:{yb:n,Pa:i},Pa:e})}))})),t)return t;throw new Me(2,9,9013,"Could not find a cell that supports add-operations")}function Yv(e,t,n){if(!(e=e.g.get(t)))throw new Me(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new Me(2,9,9013,"Could not find cell with name "+n);return t}function Qv(e,t){Jv.set(e,t)}es("http",kv,1,!0),es("https",kv,1,!0),es("blob",kv,1,!0),Dv.prototype.close=function(e,t){if(this.h.has(e)){var n=this.h.get(e);this.h.delete(e),this.j+=n,this.g+=t}},Pv.prototype.destroy=function(){return this.h.destroy()},Fv.prototype.abort=function(){var e=this;return M((function(t){if(1==t.g){try{e.i.abort()}catch(n){}return w(t,2),S(t,e.g,4)}if(2!=t.g)return k(t,0);x(t),_(t)}))},Fv.prototype.store=function(){return this.h},Fv.prototype.promise=function(){return this.g},jv.prototype.destroy=function(){return Promise.all(this.g.map((function(e){return e.abort()})))},(i=Hv.prototype).destroy=function(){return this.h.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return qv(this.i)},i.removeSegments=function(e,t){return Gv(this,this.i,e,t)},i.getSegments=function(e){var t,n=this;return M((function(i){return 1==i.g?S(i,zv(n,n.i,e),2):(t=i.h,i.return(t.map((function(e){return n.Cg(e)}))))}))},i.addManifests=function(){return qv(this.g)},i.updateManifest=function(){return Promise.reject(new Me(2,9,9016,"Cannot modify values in "+this.g))},i.updateManifestExpiration=function(e,t){var n=$v(this.h,this.g),i=n.store();return i.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,i.put(n,e))},n.promise()},i.removeManifests=function(e,t){return Gv(this,this.g,e,t)},i.getManifests=function(e){var t,n=this;return M((function(i){return 1==i.g?S(i,zv(n,n.g,e),2):(t=i.h,i.return(Promise.all(t.map((function(e){return n.gd(e)})))))}))},i.getAllManifests=function(){var e,t,n=this;return M((function(i){return 1==i.g?(e=Vv(n.h,n.g,"readonly"),t=new Map,S(i,Bv(e,(function(e,i){var r;return M((function(s){if(1==s.g)return S(s,n.gd(i),2);r=s.h,t.set(e,r),_(s)}))})),2)):3!=i.g?S(i,e.promise(),3):i.return(t)}))},i.Cg=function(e){return e},i.gd=function(e){return Promise.resolve(e)},i.add=function(e,t){var n,i,r,s,a,o,l,u=this;return M((function(d){if(1==d.g){for(n=$v(u.h,e),i=n.store(),r=[],s=c(t),a=s.next(),o={};!a.done;o={Uf:void 0},a=s.next())l=a.value,o.Uf=i.add(l),o.Uf.onsuccess=function(e){return function(){r.push(e.Uf.result)}}(o);return S(d,n.promise(),2)}return d.return(r)}))},Kv.prototype.destroy=function(){return this.g.destroy()},Kv.prototype.getAll=function(){var e,t,n=this;return M((function(i){return 1==i.g?(e=Vv(n.g,"session-ids","readonly"),t=[],S(i,Bv(e,(function(e,n){t.push(n)})),2)):3!=i.g?S(i,e.promise(),3):i.return(t)}))},Kv.prototype.add=function(e){for(var t=$v(this.g,"session-ids"),n=t.store(),i=(e=c(e)).next();!i.done;i=e.next())n.add(i.value);return t.promise()},Kv.prototype.remove=function(e){var t,n=this;return M((function(i){return 1==i.g?S(i,Bv(t=$v(n.g,"session-ids"),(function(t,n,i){e.includes(n.sessionId)&&i.delete()})),2):S(i,t.promise(),0)}))},Wv.prototype.destroy=function(){for(var e=[],t=c(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},Wv.prototype.init=function(){var e=this;Jv.forEach((function(t,n){(t=t())&&e.g.set(n,t)}));for(var t=[],n=c(this.g.values()),i=n.next();!i.done;i=n.next())t.push(i.value.init());return Promise.all(t)},$("shaka.offline.StorageMuxer",Wv),Wv.unregister=function(e){Jv.delete(e)},Wv.register=Qv,Wv.prototype.destroy=Wv.prototype.destroy;var Jv=new Map;function Zv(){Hv.apply(this,arguments)}function eb(e,t){!function(e){var t=e.streams.filter((function(e){return"audio"==e.contentType}));if(e=e.streams.filter((function(e){return"video"==e.contentType})),!t.every((function(e){return e.variantIds}))||!e.every((function(e){return e.variantIds}))){for(var n=c(t),i=n.next();!i.done;i=n.next())i.value.variantIds=[];for(i=(n=c(e)).next();!i.done;i=n.next())i.value.variantIds=[];if(n=0,e.length&&!t.length){i=n++;for(var r=c(e),s=r.next();!s.done;s=r.next())s.value.variantIds.push(i)}if(!e.length&&t.length)for(i=n++,s=(r=c(t)).next();!s.done;s=r.next())s.value.variantIds.push(i);if(e.length&&t.length)for(i=(t=c(t)).next();!i.done;i=t.next())for(i=i.value,s=(r=c(e)).next();!s.done;s=r.next()){s=s.value;var a=n++;i.variantIds.push(a),s.variantIds.push(a)}}}(e);for(var n=c(e.streams),i=n.next();!i.done;i=n.next());return e.streams.map((function(n){return function(e,t,n){var i=e.initSegmentUri?tb(e.initSegmentUri):null,r=t+e.presentationTimeOffset,s=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:i,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(e){var n=tb(e.uri);return{startTime:t+e.startTime,endTime:t+e.endTime,dataKey:n,initSegmentKey:i,appendWindowStart:t,appendWindowEnd:s,timestampOffset:r,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}(n,e.startTime,t)}))}function tb(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new Me(2,9,9004,"Could not parse uri "+e)}function nb(){Hv.apply(this,arguments)}function ib(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(i){return{startTime:t+i.startTime,endTime:t+i.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:i.dataKey,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}function rb(){Hv.apply(this,arguments)}function sb(){this.m=this.j=this.i=this.h=this.g=this.l=null}function ab(e,t,n,i){this.g=e,this.i=t,this.h=n,this.l=i,this.j=["offline:",e,"/",t,"/",n,"/",i].join("")}function ob(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new ab(t,n,i,Number(e[4])):null}function lb(e,t){this.h=e,this.g=t}function ub(e,t){var n=new zo(null,0);n.ab(t.duration);var i=t.streams.filter((function(e){return"audio"==e.type})),r=t.streams.filter((function(e){return"video"==e.type}));i=function(e,t,n,i){for(var r=new Set,s=c(t),a=s.next();!a.done;a=s.next())for(var o=(a=c(a.value.variantIds)).next();!o.done;o=a.next())r.add(o.value);for(s=c(n),a=s.next();!a.done;a=s.next())for(a=c(a.value.variantIds),o=a.next();!o.done;o=a.next())r.add(o.value);for(s=new Map,r=c(r),a=r.next();!a.done;a=r.next())a=a.value,s.set(a,{id:a,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(t=c(t),r=t.next();!r.done;r=t.next())for(a=r.value,r=cb(e,a,i),a=c(a.variantIds),o=a.next();!o.done;o=a.next())(o=s.get(o.value)).language=r.language,o.primary=o.primary||r.primary,o.audio=r;for(n=c(n),t=n.next();!t.done;t=n.next())for(r=t.value,t=cb(e,r,i),r=c(r.variantIds),a=r.next();!a.done;a=r.next())(a=s.get(a.value)).primary=a.primary||t.primary,a.video=t;return s}(e,i,r,n),r=t.streams.filter((function(e){return e.type==Si})).map((function(t){return cb(e,t,n)}));var s=t.streams.filter((function(e){return"image"==e.type})).map((function(t){return cb(e,t,n)})),a=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var o=c(i.values()),l=o.next();!l.done;l=o.next())(l=l.value).audio&&l.audio.encrypted&&(l.audio.drmInfos=a),l.video&&l.video.encrypted&&(l.video.drmInfos=a);return{presentationTimeline:n,offlineSessionIds:t.sessionIds,variants:Array.from(i.values()),textStreams:r,imageStreams:s,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null}}function cb(e,t,n){var i=t.segments.map((function(n){return function(e,t,n){var i=new ab("segment",e.h,e.g,t.dataKey);return e=new ka(t.startTime,t.endTime,(function(){return[i.toString()]}),0,null,null!=t.initSegmentKey?function(e,t){var n=new ab("segment",e.h,e.g,t);return new wa((function(){return[n.toString()]}),0,null)}(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||""),e.mimeType=t.mimeType||n.mimeType||"",e.codecs=t.codecs||n.codecs||"",t.thumbnailSprite&&e.ye(t.thumbnailSprite),e}(e,n,t)}));return n.Dd(i),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new hl(i),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,colorGamut:t.colorGamut,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,mssPrivateData:t.mssPrivateData,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching,fullMimeTypes:new Set([xi(t.mimeType,t.codecs)]),isAudioMuxedInVideo:!1}}function db(){this.g=null}function hb(){}function fb(e,t){var n=ob(e);return n&&"manifest"==n.g?e=qr(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"},originalRequest:t}):e=n&&"segment"==n.g?function(e,t,n){var i=new Wv;return qr(void 0).Ea((function(){return i.init()})).Ea((function(){return Yv(i,t.yb(),t.Pa())})).Ea((function(e){return e.getSegments([t.key()])})).Ea((function(e){return{uri:t,data:e[0].data,headers:{},originalRequest:n}})).finally((function(){return i.destroy()}))}(n.key(),n,t):Vr(new Me(2,1,9004,e)),e}function pb(e,t,n){var i,r,s,a,o,l;return M((function(u){switch(u.g){case 1:i=[];for(var d=[],h=c(n),f=h.next();!f.done;f=h.next()){f=f.value;for(var p=!1,g=c(d),m=g.next();!m.done;m=g.next())if(gb((m=m.value).info,f)){m.sessionIds.push(f.sessionId),p=!0;break}p||d.push({info:f,sessionIds:[f.sessionId]})}r=c(d),s=r.next();case 2:if(s.done){u.u(4);break}return a=s.value,o=function(e,t,n){var i,r;return M((function(s){switch(s.g){case 1:return i=new Ds({Ub:t,onError:function(){},ke:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),w(s,2),i.configure(e),S(s,function(e,t,n,i,r,s){var a=new Map;return(r={audioCapabilities:r,videoCapabilities:s,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t}).drmInfos=[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:i,serverCertificateUri:"",initData:null,keyIds:null}],a.set(t,r),Fs(e,a,[])}(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:k(s,3);break;case 2:return x(s),S(s,i.destroy(),5);case 5:return s.return([]);case 3:return r=[],S(s,Promise.all(n.sessionIds.map((function(e){return M((function(t){return 1==t.g?(w(t,2),S(t,function(e,t){var n,i,r;return M((function(s){return 1==s.g?S(s,$s(e,t,{initData:null,initDataType:null}),2):3!=s.g?(n=s.h)?(i=[],(r=e.i.get(n))&&(r.sb=new jr,i.push(r.sb)),i.push(n.remove()),S(s,Promise.all(i),3)):s.return():(e.i.delete(n),void _(s))}))}(i,e),4)):2!=t.g?(r.push(e),k(t,0)):(x(t),void _(t))}))}))),6);case 6:return S(s,i.destroy(),7);case 7:return s.return(r)}}))}(e,t,a),S(u,o,5);case 5:l=u.h,i=i.concat(l),s=r.next(),u.u(2);break;case 4:return u.return(i)}}))}function gb(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&De(e.audioCapabilities,t.audioCapabilities,n)&&De(e.videoCapabilities,t.videoCapabilities,n)}function mb(e,t){var n=ub(new lb(e.yb(),e.Pa()),t),i=t.appMetadata||{};return n=yb(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i,isIncomplete:t.isIncomplete||!1}}function yb(e){for(var t=[],n=kr(e.variants),i=(n=c(n)).next();!i.done;i=n.next())t.push(yr(i.value));for(n=(e=c(e.textStreams)).next();!n.done;n=e.next())t.push(vr(n.value));return t}function vb(){this.g=new Map}function bb(e,t){var n=t.audio,i=t.video;if(n&&!i&&e.g.set(n.id,n.bandwidth||t.bandwidth),!n&&i&&e.g.set(i.id,i.bandwidth||t.bandwidth),n&&i){var r=n.bandwidth||393216,s=i.bandwidth||t.bandwidth-r;0>=s&&(s=t.bandwidth),e.g.set(n.id,r),e.g.set(i.id,s)}}function Tb(e,t){e.g.set(t.id,t.bandwidth||2048)}function Sb(e,t){return null==(e=e.g.get(t))&&(e=0),e}function _b(e){var t=this;if(e&&e.constructor!=Mc)throw new Me(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.xb()):(this.h=Tu(),this.g=new Zr),this.i=[],this.l=[];var n=!e;this.j=new cs((function(){var e,i,r,s,a;return M((function(o){switch(o.g){case 1:return S(o,Promise.all(t.l.map((function(e){return Ov(e)}))),2);case 2:for(e=function(){},i=[],r=c(t.i),s=r.next();!s.done;s=r.next())a=s.value,i.push(a.then(e,e));return S(o,Promise.all(i),3);case 3:if(!n){o.u(4);break}return S(o,t.g.destroy(),4);case 4:t.h=null,t.g=null,_(o)}}))})),this.m=1e9}function wb(){if(He())e:{for(var e=c(Jv.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Eb(e){var t,n,i;return M((function(r){switch(r.g){case 1:return S(r,(t=new Wv).init(),2);case 2:return S(r,Xv(t),3);case 3:return n=r.h,i=new ab("manifest",n.path.yb,n.path.Pa,e),S(r,t.destroy(),4);case 4:return S(r,(new _b).remove(i.toString()),0)}}))}function kb(e,t,n,i,r,s){var a,o,l,u,d,h,f,p,g,m,y;return M((function(v){switch(v.g){case 1:for(a=!1,w(v,2),o=!0,l=c(n.streams),u=l.next();!u.done;u=l.next())for(d=u.value,h=c(d.segments),f=h.next();!f.done;f=h.next())p=f.value,null!=(g=p.pendingSegmentRefId?i[p.pendingSegmentRefId]:null)&&(p.dataKey=g,p.pendingSegmentRefId=void 0),null!=(g=p.pendingInitSegmentRefId?i[p.pendingInitSegmentRefId]:null)&&(p.initSegmentKey=g,p.pendingInitSegmentRefId=void 0),p.pendingSegmentRefId&&(o=!1),p.pendingInitSegmentRefId&&(o=!1);return n.size+=r,o&&(n.isIncomplete=!1),S(v,e.updateManifest(t,n),4);case 4:a=!0,s(),k(v,0);break;case 2:return m=x(v),S(v,Eb(t),5);case 5:if(a){v.u(6);break}return y=Object.values(i),S(v,e.removeSegments(y,(function(){})),6);case 6:throw m}}))}function xb(e){return e.variants.some((function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t}))}function Ab(e){return e.variants.some((function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some((function(e){return e.initData&&e.initData.length}))}))}function Cb(e,t,n,i){if(t.expiration=n.md(),n=Us(n),t.sessionIds=i?n:[],xb(e)&&i&&!n.length)throw new Me(2,9,9007)}function Ib(e,t){for(var n=[],i=c(e.streams),r=i.next();!r.done;r=i.next())r=r.value,t&&"video"==r.type?n.push({contentType:xi(r.mimeType,r.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=r.type||n.push({contentType:xi(r.mimeType,r.codecs),robustness:e.drmInfo.audioRobustness});return n}function Lb(e,t,n){return M((function(i){return S(i,function(e,t,n,i){var r,s,a;return M((function(o){return 1==o.g?i.drmInfo?(r=function(e){var t=Array.from(e.g.keys());if(!t.length)throw new Me(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}(n),s=i.sessionIds.map((function(e){return{sessionId:e,keySystem:i.drmInfo.keySystem,licenseUri:i.drmInfo.licenseServerUri,serverCertificate:i.drmInfo.serverCertificate,audioCapabilities:Ib(i,!1),videoCapabilities:Ib(i,!0)}})),S(o,pb(t,e,s),2)):o.return():3!=o.g?(a=o.h,S(o,r.remove(a),3)):S(o,r.add(s.filter((function(e){return!a.includes(e.sessionId)}))),0)}))}(e.g,e.h.drm,n,t),0)}))}function Db(e,t,n){function i(){}var r=function(e){for(var t=new Set,n=(e=c(e.streams)).next();!n.done;n=e.next())for(var i=(n=c(n.value.segments)).next();!i.done;i=n.next())null!=(i=i.value).initSegmentKey&&t.add(i.initSegmentKey),t.add(i.dataKey);return Array.from(t)}(n);return mb(t,n),Promise.all([e.removeSegments(r,i),e.removeManifests([t.key()],i)])}function Rb(e,t){var n;return M((function(i){switch(i.g){case 1:return w(i,2),S(i,Vu(t,e.g,e.h.streaming.retryParameters),4);case 4:n=i.h,k(i,3);break;case 2:x(i);case 3:if(n)return i.return(n);throw new Me(1,2,2011,t)}}))}function Mb(e,t,n,i,r,s){var a={id:i.id,originalId:i.originalId,groupId:i.groupId,primary:i.primary,type:i.type,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,colorGamut:i.colorGamut,videoLayout:i.videoLayout,kind:i.kind,language:i.language,originalLanguage:i.originalLanguage,label:i.label,width:i.width||null,height:i.height||null,encrypted:i.encrypted,keyIds:i.keyIds,segments:[],variantIds:[],roles:i.roles,forced:i.forced,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,closedCaptions:i.closedCaptions,tilesLayout:i.tilesLayout,mssPrivateData:i.mssPrivateData,external:i.external,fastSwitching:i.fastSwitching,isAudioMuxedInVideo:i.isAudioMuxedInVideo},o=r.offline.numberOfParallelDownloads,l=0===o?i.id:0;return function(e,t,n){if(t=e.segmentIndex.find(t),null!=t)for(var i=e.segmentIndex.get(t);i;)n(i,t),i=e.segmentIndex.get(++t)}(i,n.presentationTimeline.ob(),(function(n,r){var u=Iv(n),c=void 0;if(!s.has(u)){var d=n.endTime-n.startTime;d=Sb(t,i.id)*d,d=Rv(e.g,d),s.set(u,new Cv(n,d,l,!1,r))}n.ca&&(c=Iv(n.ca),s.has(c)||(d=.5*Sb(t,i.id),d=Rv(e.g,d),s.set(c,new Cv(n.ca,d,l,!0,r)))),a.segments.push({pendingInitSegmentRefId:c,initSegmentKey:c?0:null,startTime:n.startTime,endTime:n.endTime,appendWindowStart:n.appendWindowStart,appendWindowEnd:n.appendWindowEnd,timestampOffset:n.timestampOffset,tilesLayout:n.tilesLayout,pendingSegmentRefId:u,dataKey:0,mimeType:n.mimeType,codecs:n.codecs,thumbnailSprite:n.thumbnailSprite}),0!==o&&(l=(l+1)%o)})),a}function Pb(e){if(e.j.g)throw new Me(2,9,7001)}function Ob(){if(!wb())throw new Me(2,9,9e3)}function Nb(e,t){return M((function(n){return 1==n.g?(e.i.push(t),E(n,2),S(n,t,4)):2!=n.g?n.return(n.h):(A(n),Le(e.i,t),C(n,0))}))}function Ub(e){for(var t=new Set,n=c(e.variants),i=n.next();!i.done;i=n.next())(i=i.value).audio&&t.add(i.audio),i.video&&t.add(i.video);for(i=(n=c(e.textStreams)).next();!i.done;i=n.next())t.add(i.value);for(n=(e=c(e.imageStreams)).next();!n.done;n=e.next())t.add(n.value);return t}y(Zv,Hv),Zv.prototype.updateManifestExpiration=function(e,t){var n,i,r,s=this;return M((function(a){return n=$v(s.h,s.g),i=n.store(),r=new jr,i.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,i.put(n),r.resolve()):r.reject(new Me(2,9,9012,"Could not find values for "+e))},S(a,Promise.all([n.promise(),r]),0)}))},Zv.prototype.gd=function(e){var t,n,i,r,s,a;return M((function(o){if(1==o.g){for(t=[],n=0;n<e.periods.length;++n)i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime,s=eb(e.periods[n],r),t.push(s);return S(o,ag(t),2)}return a=o.h,o.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:a,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})}))},Zv.prototype.Cg=function(e){return{data:e.data}},y(nb,Hv),nb.prototype.gd=function(e){var t,n,i,r,s,a;return M((function(o){if(1==o.g){for(t=[],n=0;n<e.periods.length;++n){i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime;for(var l=e.periods[n],u=[],d=c(l.streams),h=d.next();!h.done;h=d.next())0!=(h=h.value).variantIds.length&&u.push(ib(h,l.startTime,l.startTime+r));s=u,t.push(s)}return S(o,ag(t),2)}return a=o.h,o.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:a,sequenceMode:!1})}))},y(rb,Hv),(i=rb.prototype).hasFixedKeySpace=function(){return!1},i.addSegments=function(e){return this.add(this.i,e)},i.addManifests=function(e){return this.add(this.g,e)},i.updateManifest=function(e,t){return function(e,t,n){var i=(e=$v(e.h,e.g)).store();return i.get(t).onsuccess=function(){i.put(n,t)},e.promise()}(this,e,t)},i.gd=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},(i=sb.prototype).init=function(){var t=this,n=new jr,i=!1,r=new Ve((function(){i=!0,n.reject(new Me(2,9,9017))}));r.aa(5);var s=e.indexedDB.open("shaka_offline_db",5);return s.onsuccess=function(){if(!i){var e=s.result;t.l=e;var a=e.objectStoreNames;a=a.contains("manifest")&&a.contains("segment")?new Zv(e,"segment","manifest"):null,t.g=a,a=(a=e.objectStoreNames).contains("manifest-v2")&&a.contains("segment-v2")?new nb(e,"segment-v2","manifest-v2"):null,t.h=a,a=(a=e.objectStoreNames).contains("manifest-v3")&&a.contains("segment-v3")?new nb(e,"segment-v3","manifest-v3"):null,t.i=a,a=(a=e.objectStoreNames).contains("manifest-v5")&&a.contains("segment-v5")?new rb(e,"segment-v5","manifest-v5"):null,t.j=a,e=e.objectStoreNames.contains("session-ids")?new Kv(e):null,t.m=e,r.stop(),n.resolve()}},s.onupgradeneeded=function(){for(var e=s.result,t=c(["segment-v5","manifest-v5","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},s.onerror=function(e){i||(n.reject(new Me(2,9,9001,s.error)),r.stop(),e.preventDefault())},n},i.destroy=function(){var e=this;return M((function(t){switch(t.g){case 1:if(!e.g){t.u(2);break}return S(t,e.g.destroy(),2);case 2:if(!e.h){t.u(4);break}return S(t,e.h.destroy(),4);case 4:if(!e.i){t.u(6);break}return S(t,e.i.destroy(),6);case 6:if(!e.j){t.u(8);break}return S(t,e.j.destroy(),8);case 8:if(!e.m){t.u(10);break}return S(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),_(t)}}))},i.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},i.getEmeSessionCell=function(){return this.m},i.erase=function(){var t=this;return M((function(n){switch(n.g){case 1:if(!t.g){n.u(2);break}return S(n,t.g.destroy(),2);case 2:if(!t.h){n.u(4);break}return S(n,t.h.destroy(),4);case 4:if(!t.i){n.u(6);break}return S(n,t.i.destroy(),6);case 6:if(!t.j){n.u(8);break}return S(n,t.j.destroy(),8);case 8:return t.l&&t.l.close(),S(n,function(){var t=new jr,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new Me(2,9,9001,n.error)),e.preventDefault()},t}(),10);case 10:return t.l=null,t.g=null,t.h=null,t.i=null,t.j=null,S(n,t.init(),0)}}))},Qv("idb",(function(){return(!Ye()||Ye()&&rt())&&!ze()&&e.indexedDB?new sb:null})),ab.prototype.yb=function(){return this.i},ab.prototype.Pa=function(){return this.h},ab.prototype.key=function(){return this.l},ab.prototype.toString=function(){return this.j},(i=db.prototype).configure=function(){},i.start=function(e,t){var n,i,r,s,a,o,l=this;return M((function(u){switch(u.g){case 1:if(n=ob(e),l.g=n,null==n||"manifest"!=n.g)throw new Me(2,1,9004,e);return i=new Wv,E(u,2),S(u,i.init(),4);case 4:return S(u,Yv(i,n.yb(),n.Pa()),5);case 5:return S(u,u.h.getManifests([n.key()]),6);case 6:return r=u.h,s=r[0],a=new lb(n.yb(),n.Pa()),o=ub(a,s),t.makeTextStreamsForClosedCaptions(o),u.return(o);case 2:return A(u),S(u,i.destroy(),7);case 7:C(u,0)}}))},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var n,i,r,s,a,o,l,u=this;return M((function(c){switch(c.g){case 1:return n=u.g,i=new Wv,w(c,2,3),S(c,i.init(),5);case 5:return S(c,Yv(i,n.yb(),n.Pa()),6);case 6:return S(c,(r=c.h).getManifests([n.key()]),7);case 7:if(s=c.h,a=s[0],o=a.sessionIds.includes(e),l=void 0==a.expiration||a.expiration>t,!o||!l){c.u(3);break}return S(c,r.updateManifestExpiration(n.key(),t),3);case 3:return A(c),S(c,i.destroy(),10);case 10:C(c,0);break;case 2:x(c),c.u(3)}}))},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},ya("application/x-offline-manifest",(function(){return new db})),$("shaka.offline.OfflineScheme",hb),hb.plugin=fb,es("offline",fb),(i=_b.prototype).destroy=function(){return this.j.destroy()},i.configure=function(e,t){return 2==arguments.length&&"string"==typeof e&&(e=cu(e,t)),_u(this.h,e)},i.getConfiguration=function(){var e=Tu();return _u(e,this.h,Tu()),e},i.xb=function(){return this.g},i.store=function(e,t,n,i,r){var s=this,a=this.getConfiguration(),o=new Pv(this.g);return this.l.push(o),t=function(e,t,n,i,r,s,a,o){var l,u,d,h,f,p,g,m,y,v,b,T,E,I,L,D,R,P,O,N,U,F,B;return M((function(j){switch(j.g){case 1:return Ob(),u=l=null,d=new Wv,p=f=h=null,w(j,2,3),S(j,s(),5);case 5:return l=j.h,S(j,function(e,t,n,i){var r,s,a,o,l;return M((function(u){if(1==u.g)return r=null,s=e.g,a={networkingEngine:s,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){r=e},isLowLatencyMode:function(){return!1},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return i.abr.defaultBandwidthEstimate},onMetadata:function(){},disableStream:function(){},addFont:function(){}},n.configure(i.manifest),Pb(e),S(u,n.start(t,a),2);if(3!=u.g)return o=u.h,Pb(e),l=Ub(o),S(u,Promise.all(hs(l,(function(e){return e.createSegmentIndex()}))),3);if(Pb(e),r)throw r;return u.return(o)}))}(e,t,l,a),6);case 6:if(g=j.h,Pb(e),!(!g.presentationTimeline.T()&&!g.presentationTimeline.wc()))throw new Me(2,9,9005,t);m=c(i),y=m.next();case 7:if(y.done){j.u(9);break}return v=y.value,S(j,function(e,t,n){var i,r,s,a,o,l,u,d,h,f,p,g,m,y,v;return M((function(b){switch(b.g){case 1:return S(b,Rb(e,t),2);case 2:if("text/vtt"!=(i=b.h))throw new Me(1,2,2017,t);return S(b,function(e,t,n){var i,r,s;return M((function(a){return 1==a.g?(i=os,(r=ns([e],n)).method="GET",S(a,t.request(i,r).promise,2)):(s=a.h,a.return(s.data))}))}(t,e.g,e.h.streaming.retryParameters),3);case 3:if(r=b.h,!(s=$i(i)))throw new Me(2,2,2014,i);for(a=s(),o={periodStart:0,segmentStart:0,segmentEnd:n.presentationTimeline.getDuration(),vttOffset:0},l=me(r),u=a.parseMedia(l,o,t,[]),d=[],h=c(u),f=h.next(),p={};!f.done;p={He:void 0,Kc:void 0},f=h.next())p.Kc=f.value,p.He=null,g=function(e){return function(){return null==e.He&&(e.He=gi([t],[e.Kc.payload])),e.He||[]}}(p),m=new ka(p.Kc.startTime,p.Kc.endTime,g,0,null,null,0,0,1/0),p.Kc.payload.includes("#xywh")&&(4===(y=p.Kc.payload.split("#xywh=")[1].split(",")).length&&m.ye({height:parseInt(y[3],10),positionX:parseInt(y[0],10),positionY:parseInt(y[1],10),width:parseInt(y[2],10)})),d.push(m);if(v=i,!d.length){b.u(4);break}return S(b,Vu(d[0].N()[0],e.g,e.h.manifest.retryParameters),5);case 5:v=b.h;case 4:return b.return({id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new hl(d),mimeType:v||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:"image",primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([xi(v||"","")]),isAudioMuxedInVideo:!1})}}))}(e,v,g),10);case 10:b=j.h,g.imageStreams.push(b),Pb(e),y=m.next(),j.u(7);break;case 9:T=c(r),E=T.next();case 11:return E.done?(Ys(a.drm.clearKeys,g.variants),D=g.variants.some((function(e){if(e.audio)for(var t=c(e.audio.drmInfos),n=t.next();!n.done;n=t.next())if(n.value.licenseServerUri.startsWith("data:"))return!0;if(e.video)for(t=(e=c(e.video.drmInfos)).next();!t.done;t=e.next())if(t.value.licenseServerUri.startsWith("data:"))return!0;return!1})),R=a.offline.usePersistentLicense,D&&(R=!1),S(j,e.Ic(g,(function(e){p=p||e}),a,R),15)):(I=E.value,S(j,function(e,t,n,i,r,s,a){var o,l;return M((function(u){if(1==u.g)return s?u.u(2):S(u,Rb(e,n),3);if(2!=u.g&&(s=u.h),o={id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:pl(0,t.presentationTimeline.getDuration(),[n]),mimeType:s||"",codecs:a||"",kind:r,encrypted:!1,drmInfos:[],keyIds:new Set,language:i,originalLanguage:i,label:null,type:Si,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([xi(s||"",a||"")]),isAudioMuxedInVideo:!1},l=xi(o.mimeType,o.codecs),!Vi(l))throw new Me(2,2,2014,s);return u.return(o)}))}(e,g,I.uri,I.language,I.kind,I.mime,I.codecs),14));case 14:L=j.h,g.textStreams.push(L),Pb(e),E=T.next(),j.u(11);break;case 15:if(u=j.h,Pb(e),p)throw p;return S(j,function(e,t,n,i){var r,s,a,o,l,u,d,h,f,p,g,m,y,v,b,T,E,A,C,I,L,D,R,P,O,N,U,F,B;return M((function(M){switch(M.g){case 1:return r={width:1/0,height:1/0},function(e,t,n){e.variants=e.variants.filter((function(e){return lr(e,t,n)}))}(e,n.restrictions,r),S(M,cr(t,e,i,n.drm.preferredKeySystems,n.drm.keySystemsMapping),2);case 2:for(s=[],a=n.preferredDecodingAttributes,o=n.preferredVideoCodecs,l=n.preferredAudioCodecs,u=n.preferredTextFormats,or(e,o,l,a,u),d=c(e.variants),h=d.next();!h.done;h=d.next())f=h.value,s.push(yr(f));for(p=c(e.textStreams),g=p.next();!g.done;g=p.next())m=g.value,s.push(vr(m));for(y=c(e.imageStreams),v=y.next();!v.done;v=y.next())b=v.value,s.push(br(b));return S(M,n.offline.trackSelectionCallback(s),3);case 3:for(T=M.h,E=e.presentationTimeline.getDuration(),A=0,C=c(T),I=C.next();!I.done;I=C.next())L=I.value,D=L.bandwidth*E/8,A+=D;return w(M,4),S(M,n.offline.downloadSizeCallback(A),6);case 6:if(!M.h)throw new Me(2,9,9014);k(M,5);break;case 4:if((R=x(M))instanceof Me)throw R;throw new Me(2,9,9015);case 5:for(P=new Set,O=new Set,N=new Set,U=c(T),F=U.next();!F.done;F=U.next())"variant"==(B=F.value).type&&P.add(B.id),"text"==B.type&&O.add(B.id),"image"==B.type&&N.add(B.id);e.variants=e.variants.filter((function(e){return P.has(e.id)})),e.textStreams=e.textStreams.filter((function(e){return O.has(e.id)})),e.imageStreams=e.imageStreams.filter((function(e){return N.has(e.id)})),function(e){e.variants.map((function(e){return e.video}));var t=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams;for(var n=c(t),i=n.next();!i.done;i=n.next())for(var r=(i=c(t)).next();!r.done;r=i.next());for(t=c(e),n=t.next();!n.done;n=t.next())for(n=c(e),i=n.next();!i.done;i=n.next());}(e),_(M)}}))}(g,u,a,R),16);case 16:return S(j,d.init(),17);case 17:return Pb(e),S(j,Xv(d),18);case 18:return h=j.h,Pb(e),P=function(e,t,n,i,r,s,a){var o=function(e,t,n){return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.getDuration(),size:0,expiration:1/0,tracks:t=yb(t),appMetadata:n,isIncomplete:!1}}(n,t,i),l=r.offline.progressCallback;!function(e,t,n){e.o=t,e.m=n}(s,(function(e,t){o.size=t,l(o,e)}),(function(t,n){u&&a&&d==n&&Ns(e,"cenc",t)}));var u=xb(t)&&!Ab(t),d=null;u&&(d=Fb.get(e.h.keySystem));for(var h=new vb,f=c(t.textStreams),p=f.next();!p.done;p=f.next())h.g.set(p.value.id,52);for(f=c(t.imageStreams),p=f.next();!p.done;p=f.next())Tb(h,p.value);for(f=c(t.variants),p=f.next();!p.done;p=f.next())bb(h,p.value);return s=function(e,t,n,i){for(var r=new Map,s=Ub(n),a=new Map,o=(s=c(s)).next();!o.done;o=s.next()){var l=Mb(e,t,n,o=o.value,i,r);a.set(o.id,l)}for(e=c(n.variants),t=e.next();!t.done;t=e.next())(t=t.value).audio&&a.get(t.audio.id).variantIds.push(t.id),t.video&&a.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(a.values()),kg:Array.from(r.values())}}(s,h,t,r),r=s.streams,s=s.kg,(h=e.h)&&a&&(h.initData=[]),{Ni:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.md(),streams:r,sessionIds:a?Us(e):[],drmInfo:h,appMetadata:i,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},kg:s}}(u,g,t,n,a,o,R),O=P.Ni,N=P.kg,S(j,h.Pa.addManifests([O]),19);case 19:if(U=j.h,Pb(e),f=U[0],Pb(e),p)throw p;return S(j,function(e,t,n,i,r,s,a,o,l,u){var d,h,f,p,g,m,y,v,b,T,E;return M((function(A){switch(A.g){case 1:if(d={},h=0,f=function(){if(e.j.g||r.l)throw new Me(2,9,7001)},p=function(e,t){var p,g,m,y,v,b,T,w,E;return M((function(k){if(1==k.g){for(p=c(e),g=p.next(),m={};!g.done;m={Lb:void 0},g=p.next())m.Lb=g.value,f(),y=Lv(m.Lb,s),v=m.Lb.i,b=m.Lb.h,T=function(e){return function(t){var n,i,r;return M((function(s){switch(s.g){case 1:if(n=e.Lb.g,i=Iv(n),!n.aesKey){s.u(2);break}return S(s,Bl(t,n.aesKey,e.Lb.j),3);case 3:t=s.h;case 2:return S(s,a.addSegments([{data:t}]),4);case 4:r=s.h,f(),d[i]=r[0],h+=t.byteLength,_(s)}}))}}(m),w=m.Lb.g,(E=w.Qb())?Uv(r,m.Lb.groupId,E,v,b,T):Nv(r,m.Lb.groupId,y,v,b,T);return S(k,function(e){return M((function(t){return 1==t.g?S(t,Promise.all(e.i.values()),2):t.return(e.g.g)}))}(r),2)}return f(),!t||r.l?k.u(0):(Cb(o,i,l,u),S(k,a.updateManifest(n,i),0))}))},g=!1,w(A,2),!xb(o)||!g||Ab(o)){A.u(4);break}return S(A,p(t.filter((function(e){return e.h})),!0),5);case 5:return f(),t=t.filter((function(e){return!e.h})),m=d,y=h,d={},h=0,S(A,kb(a,n,i,m,y,(function(){return Pb(e)})),6);case 6:f();case 4:if(g){A.u(7);break}return S(A,p(t,!1),8);case 8:return f(),v=d,b=h,d={},h=0,S(A,kb(a,n,i,v,b,(function(){return f()})),9);case 9:f();case 7:k(A,0);break;case 2:return T=x(A),E=Object.values(d),S(A,a.removeSegments(E,(function(){})),10);case 10:throw T}}))}(e,N,f,O,o,a,h.Pa,g,u,R),20);case 20:return Pb(e),Cb(g,O,u,R),S(j,h.Pa.updateManifest(f,O),21);case 21:return Pb(e),F=new ab("manifest",h.path.yb,h.path.Pa,f),j.return(mb(F,O));case 3:return A(j),S(j,d.destroy(),22);case 22:if(!l){j.u(23);break}return S(j,l.stop(),23);case 23:if(!u){j.u(25);break}return S(j,u.destroy(),25);case 25:C(j,0);break;case 2:if(B=x(j),null==f){j.u(27);break}return S(j,Eb(f),27);case 27:throw p||B}}))}(this,e,t||{},i||[],r||[],(function(){var t;return M((function(i){return 1==i.g?n?i.u(2):S(i,Vu(e,s.g,a.manifest.retryParameters),3):(2!=i.g&&(n=i.h),t=va(e,n||null),i.return(t()))}))}),a,o),(t=new $r(t,(function(){return Ov(o)}))).finally((function(){Le(s.l,o)})),function(e,t){var n=t.promise;return e.i.push(n),t.finally((function(){Le(e.i,n)}))}(this,t)},i.remove=function(e){return Nb(this,function(e,t){var n,i,r,s,a,o;return M((function(l){switch(l.g){case 1:if(Ob(),null==(n=ob(t))||"manifest"!=n.g)throw new Me(2,9,9004,t);return i=n,r=new Wv,E(l,2),S(l,r.init(),4);case 4:return S(l,Yv(r,i.yb(),i.Pa()),5);case 5:return S(l,(s=l.h).getManifests([i.key()]),6);case 6:return a=l.h,o=a[0],S(l,Promise.all([Lb(e,o,r),Db(s,i,o)]),2);case 2:return A(l),S(l,r.destroy(),8);case 8:C(l,0)}}))}(this,e))},i.ej=function(){return Nb(this,function(e){var t,n,i,r,s,a,o,l,u,d;return M((function(h){switch(h.g){case 1:return Ob(),t=e.g,n=e.h.drm,i=new Wv,r=!1,E(h,2),S(h,i.init(),4);case 4:s=[],function(e,t){e.g.forEach((function(e){t(e.getEmeSessionCell())}))}(i,(function(e){return s.push(e)})),a=c(s),o=a.next();case 5:if(o.done){h.u(2);break}return S(h,(l=o.value).getAll(),8);case 8:return u=h.h,S(h,pb(n,t,u),9);case 9:return d=h.h,S(h,l.remove(d),10);case 10:d.length!=u.length&&(r=!0),o=a.next(),h.u(5);break;case 2:return A(h),S(h,i.destroy(),11);case 11:C(h,3);break;case 3:return h.return(!r)}}))}(this))},i.list=function(){return Nb(this,function(){var e,t,n;return M((function(i){switch(i.g){case 1:return Ob(),e=[],t=new Wv,E(i,2),S(i,t.init(),4);case 4:return n=Promise.resolve(),function(e,t){e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){t({yb:n,Pa:i},e)}))}))}(t,(function(t,i){n=n.then((function(){return M((function(n){if(1==n.g)return S(n,i.getAllManifests(),2);n.h.forEach((function(n,i){n=mb(new ab("manifest",t.yb,t.Pa,i),n),e.push(n)})),_(n)}))}))})),S(i,n,2);case 2:return A(i),S(i,t.destroy(),6);case 6:C(i,3);break;case 3:return i.return(e)}}))}())},i.Ic=function(e,t,n,i){var r,s=this;return M((function(a){return 1==a.g?((r=new Ds({Ub:s.g,onError:t,ke:function(){},onExpirationUpdated:function(){},onEvent:function(){}})).configure(n.drm),S(a,function(e,t,n){return e.ja=!0,e.B=new Map,e.O=n,Ms(e,t,!1)}(r,e.variants,i),2)):3!=a.g?S(a,Os(r),3):a.return(r)}))},$("shaka.offline.Storage",_b),_b.deleteAll=function(){var e;return M((function(t){return 1==t.g?(e=new Wv,E(t,2),S(t,function(e){var t,n;return M((function(i){return 1==i.g?(t=Array.from(e.g.values()),(n=0<t.length)||Jv.forEach((function(e){(e=e())&&t.push(e)})),S(i,Promise.all(t.map((function(e){return e.erase()}))),2)):n?i.u(0):S(i,Promise.all(t.map((function(e){return e.destroy()}))),0)}))}(e),2)):5!=t.g?(A(t),S(t,e.destroy(),5)):C(t,0)}))},_b.prototype.list=_b.prototype.list,_b.prototype.removeEmeSessions=_b.prototype.ej,_b.prototype.remove=_b.prototype.remove,_b.prototype.store=_b.prototype.store,_b.prototype.getNetworkingEngine=_b.prototype.xb,_b.prototype.getConfiguration=_b.prototype.getConfiguration,_b.prototype.configure=_b.prototype.configure,_b.prototype.destroy=_b.prototype.destroy,_b.support=wb;var Fb=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.huawei.wiseplay","3d5e6d359b9a41e8b843dd3c6e72c42c");function Bb(){}function jb(e,t){for(e={priority:t||0,callback:e},t=0;t<$b.length;t++)if($b[t].priority<e.priority)return void $b.splice(t,0,e);$b.push(e)}Nc("offline",wb),$("shaka.polyfill",Bb),Bb.register=jb,Bb.installAll=function(){for(var e=c($b),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(n){X("Error installing polyfill!",n)}}};var $b=[];function Vb(){}function Hb(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=c(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())qb(t.value)}function qb(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||void 0==e?this.removeAttribute(t):this.setAttribute(t,e)}})}function Gb(){}function zb(){et()||ot("Sky_STB")||Q_()}function Kb(){}function Wb(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Xb),document.addEventListener("webkitfullscreenerror",Xb),document.addEventListener("mozfullscreenchange",Xb),document.addEventListener("mozfullscreenerror",Xb),document.addEventListener("MSFullscreenChange",Xb),document.addEventListener("MSFullscreenError",Xb)}}function Xb(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}function Yb(){}function Qb(){var e=!0;(Ye()&&!rt()&&!st()||Je()||Ze()||et()||Xe()||Ke()||tt()||lt()&&!Je())&&(e=!1),e&&navigator.mediaCapabilities||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),Zb=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=Jb)}function Jb(t){var n,i,r,s,a,o,l;return M((function(u){switch(u.g){case 1:if(n={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:t},i=t.video,r=t.audio,"media-source"!=t.type){if("file"!=t.type)return u.return(n);if(i&&(s=i.contentType,!qe(s))||r&&(a=r.contentType,!qe(a)))return u.return(n);u.u(2);break}if(!He())return u.return(n);if(!i){u.u(3);break}return S(u,function(t){var n,i;return M((function(r){return 1==r.g?Ye()?S(r,function(t){var n,i,r,s;return M((function(a){if(1==a.g){if(!(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType))return a.return(ie(t.contentType));switch(n=t.contentType,t.width&&t.height&&1280<t.width&&720<t.height&&(n+="; width="+t.width+"; height="+t.height),t.framerate&&(24>(i=Math.round(t.framerate))||30<i)&&(n+="; framerate="+t.framerate),t.transferFunction||""){case"":case"srgb":break;case"pq":n+="; eotf=smpte2084";break;case"hlg":n+="; eotf=arib-std-b67";break;default:return a.return(!1)}return r=!1,(s=aT).has(n)?(r=s.get(n),a.u(2)):S(a,cast.__platform__.canDisplayType(n),3)}return 2!=a.g&&(r=a.h,s.set(n,r)),a.return(r)}))}(t),3):Ke()?(n=t.contentType,t.width&&t.height&&(n+="; width="+t.width,n+="; height="+t.height),t.framerate&&(n+="; framerate="+t.framerate),t.bitrate&&(n+="; bitrate="+t.bitrate),r.return(ie(n))):r.u(2):2!=r.g?(i=r.h,r.return(i)):r.return(ie(t.contentType))}))}(i),4);case 4:if(!u.h)return u.return(n);case 3:if(r){var c=r.contentType;if(Ye()&&r.spatialRendering&&(c+="; spatialRendering=true"),!ie(c))return u.return(n)}case 2:return t.keySystemConfiguration?(o=t.keySystemConfiguration,S(u,function(e,t,n){var i,r,s,a,o,l,u,c,d,h,f;return M((function(p){switch(p.g){case 1:if(i=[],r=[],n.audio&&(s={robustness:n.audio.robustness||"",contentType:t.contentType},Ke()&&t.contentType.includes('codecs="ac-3"')&&(s.contentType='audio/mp4; codecs="ec-3"'),n.audio.encryptionScheme&&(s.encryptionScheme=n.audio.encryptionScheme),i.push(s)),n.video&&(a={robustness:n.video.robustness||"",contentType:e.contentType},n.video.encryptionScheme&&(a.encryptionScheme=n.video.encryptionScheme),r.push(a)),o={initDataTypes:[n.initDataType],distinctiveIdentifier:n.distinctiveIdentifier,persistentState:n.persistentState,sessionTypes:n.sessionTypes},i.length&&(o.audioCapabilities=i),r.length&&(o.videoCapabilities=r),l=e?e.contentType:"",u=t?t.contentType:"",c=Mi(l)+";"+Ri(l),d=Mi(u)+";"+Ri(u),h=n.keySystem,f=null,w(p,2),je.has(c+"#"+d+"#"+h)){f=je.get(c+"#"+d+"#"+h)||null,p.u(4);break}return S(p,navigator.requestMediaKeySystemAccess(n.keySystem,[o]),5);case 5:f=p.h,je.set(c+"#"+d+"#"+h,f);case 4:k(p,3);break;case 2:x(p);case 3:return p.return(f)}}))}(i,r,o),6)):(n.supported=!0,u.return(n));case 6:(l=u.h)&&(n.supported=!0,n.keySystemAccess=l);case 5:return u.return(n)}}))}Bb.Aria=Vb,Vb.install=Hb,jb(Hb),Bb.EncryptionScheme=Gb,Gb.install=zb,jb(zb,-2),Bb.Fullscreen=Kb,Kb.install=Wb,jb(Wb),Bb.MediaCapabilities=Yb,Yb.install=Qb;var Zb=null;Yb.originalMcap=Zb;var eT,tT,nT,iT,rT,sT,aT=new Map;function oT(){}function lT(){var t=function(){if(!Je()&&(!lt()||Je()))return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}();(e.MediaSource||e.ManagedMediaSource)&&(t&&e.MediaSource?12>=t?(uT(),cT()):15>=t&&uT():ot("DT_STB_BCM")?(uT(),cT()):(ot("Tizen 2")||We()||ot("Tizen 4"))&&function(){var t=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(e){return"opus"!=Ri(e)&&t(e)},e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return"opus"!=Ri(e)&&n(e)}}}()),(e.MediaSource||e.ManagedMediaSource)&&function(){if(e.MediaSource){var t=MediaSource.isTypeSupported.bind(MediaSource);MediaSource.isTypeSupported=function(e){return"mp2t"!=Li(e)&&t(e)}}if(e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return"mp2t"!=Li(e)&&n(e)}}}(),e.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&function(){var e=MediaSource.isTypeSupported;Xe()||(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),i=n.findIndex((function(e){return e.startsWith("codecs=")}));if(0>i)return e(t);var r=n[i].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),s=r.findIndex((function(e){return e.startsWith("vp09")}));return 0<=s&&(r[s]="vp9",n[i]='codecs="'+r.join(",")+'"',t=n.join("; ")),e(t)})}()}function uT(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,P.apply(0,arguments));return t.abort=function(){},t}}function cT(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}function dT(){}function hT(){screen.orientation&&screen.orientation.unlock||(void 0!=screen.orientation?(void 0===screen.orientation.lock&&(screen.orientation.lock=function(){return Promise.resolve()}),void 0===screen.orientation.unlock&&(screen.orientation.unlock=function(){})):void 0!=e.orientation&&function(){function t(){switch(e.orientation){case-90:n.type="landscape-secondary",n.angle=270;break;case 0:n.type="portrait-primary",n.angle=0;break;case 90:n.type="landscape-primary",n.angle=90;break;case 180:n.type="portrait-secondary",n.angle=180}}var n=new fT;screen.orientation=n,t(),e.addEventListener("orientationchange",(function(){t();var e=new Kr("change");n.dispatchEvent(e)}))}())}function fT(){Yr.call(this),this.type="",this.angle=0}function pT(){}function gT(t){e.HTMLVideoElement&&e.WebKitMediaKeys&&(void 0!==t&&t&&(eT=!0,tT=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),nT=HTMLMediaElement.prototype.setMediaKeys,iT=e.MediaKeys,rT=e.MediaKeySystemAccess,sT=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=yT,e.MediaKeys=TT,e.MediaKeySystemAccess=bT,navigator.requestMediaKeySystemAccess=mT,e.shakaMediaKeysPolyfill=kT,Lr.clear(),je.clear())}function mT(e,t){try{var n=new bT(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function yT(e){var t=this.mediaKeys;return t&&t!=e&&ST(t,null),delete this.mediaKeys,(this.mediaKeys=e)?ST(e,this):Promise.resolve()}function vT(e){if(ve(e=me(e.initData)).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=yt(e=gt(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=ge(e),this.dispatchEvent(t)}function bT(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(t=(e=c(t)).next();!t.done;t=e.next()){var n=t.value;if("required"==n.persistentState)t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var i=!1,r=!1;if(n.audioCapabilities)for(var s=c(n.audioCapabilities),a=s.next();!a.done;a=s.next())(a=a.value).contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,a.contentType.split(";")[0])&&(t.audioCapabilities.push(a),r=!0));if(n.videoCapabilities)for(s=(n=c(n.videoCapabilities)).next();!s.done;s=n.next())(s=s.value).contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,s.contentType.split(";")[0])&&(t.videoCapabilities.push(s),r=!0));i||(r=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=r?t:null}if(t)return void(this.g=t)}throw(e=Error("Unsupported keySystem")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function TT(e){this.h=new WebKitMediaKeys(e),this.g=new ee}function ST(e,t){if(e.g.Ma(),!t)return Promise.resolve();e.g.D(t,"webkitneedkey",vT);try{return Jo(t,HTMLMediaElement.HAVE_METADATA,e.g,(function(){t.webkitSetMediaKeys(e.h)})),Promise.resolve()}catch(n){return Promise.reject(n)}}function _T(e){Yr.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new ee,this.sessionId="",this.expiration=NaN,this.closed=new jr,this.keyStatuses=new ET}function wT(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.g=t,t=new Kr("keystatuseschange"),e.dispatchEvent(t)}function ET(){this.size=0,this.g=void 0}jb(Qb,-1),Bb.MediaSource=oT,oT.install=lT,jb(lT),Bb.Orientation=dT,dT.install=hT,y(fT,Yr),fT.prototype.lock=function(e){function t(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():((e=Error("screen.orientation.lock() is not available on this device")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},fT.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},jb(hT),Bb.PatchedMediaKeysApple=pT,pT.uninstall=function(){eT&&(eT=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",tT),HTMLMediaElement.prototype.setMediaKeys=nT,e.MediaKeys=iT,e.MediaKeySystemAccess=rT,navigator.requestMediaKeySystemAccess=sT,tT=sT=nT=rT=iT=null,e.shakaMediaKeysPolyfill="",Lr.clear(),je.clear())},pT.install=gT,bT.prototype.createMediaKeys=function(){var e=new TT(this.keySystem);return Promise.resolve(e)},bT.prototype.getConfiguration=function(){return this.g},TT.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new _T(this.h,e)},TT.prototype.setServerCertificate=function(){return Promise.resolve(!1)},TT.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},y(_T,Yr),(i=_T.prototype).generateRequest=function(e,t){var n=this;this.h=new jr;try{var i=this.l.createSession("video/mp4",me(t));this.i=i,this.sessionId=i.sessionId||"",this.j.D(this.i,"webkitkeymessage",(function(e){n.h&&(n.h.resolve(),n.h=null),e=new Kr("message",e=(new Map).set("messageType",void 0==n.keyStatuses.cc()?"license-request":"license-renewal").set("message",ge(e.message))),n.dispatchEvent(e)})),this.j.D(i,"webkitkeyadded",(function(){n.g&&(wT(n,"usable"),n.g.resolve(),n.g=null)})),this.j.D(i,"webkitkeyerror",(function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=n.i.error,null!=n.h)n.h.reject(e),n.h=null;else if(null!=n.g)n.g.reject(e),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:wT(n,"output-not-allowed");break;default:wT(n,"internal-error")}})),wT(this,"status-pending")}catch(r){this.h.reject(r)}return this.h},i.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){this.g=new jr;try{this.i.update(me(e))}catch(t){this.g.reject(t)}return this.g},i.close=function(){try{this.i.close(),this.closed.resolve(),this.j.Ma()}catch(rw){this.closed.reject(rw)}return this.closed},i.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},(i=ET.prototype).cc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,Be.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Be.value();return!(!this.g||!pe(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var kT="apple";function xT(){}function AT(){e.MediaKeys&&(!MediaKeys.prototype.setServerCertificate||We()||ot("Tizen 4")||ot("Tizen 5.0")||Xe()&&38===Qe())&&(MediaKeys.prototype.setServerCertificate=CT)}function CT(){return Promise.resolve(!1)}function IT(){}function LT(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)HT="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=RT,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=MT,e.MediaKeys=OT,e.MediaKeySystemAccess=PT,e.shakaMediaKeysPolyfill=qT}}function DT(e){return HT?HT+e.charAt(0).toUpperCase()+e.slice(1):e}function RT(e,t){try{var n=new PT(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function MT(e){var t=this.mediaKeys;return t&&t!=e&&NT(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&NT(e,this),Promise.resolve()}function PT(e,t){this.g=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",n=!1);var i=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video");for(var s=(t=c(t)).next();!s.done;s=t.next()){var a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(s=s.value).initDataTypes,sessionTypes:["temporary"],label:s.label},o=!1;if(s.audioCapabilities)for(var l=c(s.audioCapabilities),u=l.next();!u.done;u=l.next())(u=u.value).contentType&&(o=!0,r.canPlayType(u.contentType.split(";")[0],this.g)&&(a.audioCapabilities.push(u),i=!0));if(s.videoCapabilities)for(u=(l=c(s.videoCapabilities)).next();!u.done;u=l.next())(u=u.value).contentType&&(o=!0,r.canPlayType(u.contentType,this.g)&&(a.videoCapabilities.push(u),i=!0));if(o||(i=r.canPlayType("video/mp4",this.g)||r.canPlayType("video/webm",this.g)),"required"==s.persistentState&&(n?(a.persistentState="required",a.sessionTypes=["persistent-license"]):i=!1),i)return void(this.h=a)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(e=Error(n)).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function OT(e){this.l=e,this.h=null,this.g=new ee,this.i=[],this.j=new Map}function NT(e,t){e.h=t,e.g.Ma();var n=HT;t&&(e.g.D(t,n+"needkey",(function(t){var n=new CustomEvent("encrypted");n.initDataType="cenc",n.initData=ge(t.initData),e.h.dispatchEvent(n)})),e.g.D(t,n+"keymessage",(function(t){var n=UT(e,t.sessionId);n&&(t=new Kr("message",t=(new Map).set("messageType",void 0==n.keyStatuses.cc()?"licenserequest":"licenserenewal").set("message",t.message)),n.h&&(n.h.resolve(),n.h=null),n.dispatchEvent(t))})),e.g.D(t,n+"keyadded",(function(t){(t=UT(e,t.sessionId))&&t.ready()})),e.g.D(t,n+"keyerror",(function(t){var n=UT(e,t.sessionId);if(n){var i=Error("EME v0.1b key error"),r=t.errorCode;r.systemCode=t.systemCode,i.errorCode=r,!t.sessionId&&n.h?(45==t.systemCode&&(i.message="Unsupported session type."),n.h.reject(i),n.h=null):t.sessionId&&n.g?(n.g.reject(i),n.g=null):(i=t.systemCode,t.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?$T(n,"output-restricted"):$T(n,1==i?"expired":"internal-error"))}})))}function UT(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function FT(e,t,n){Yr.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new jr,this.keyStatuses=new VT}function BT(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(n)var i=me(yt("LOAD_SESSION|"+n));else{var r=yt("PERSISTENT|");i=pi(r,t)}else i=me(t)}catch(a){return Promise.reject(a)}e.h=new jr;var s=DT("generateKeyRequest");try{e.j[s](e.i,i)}catch(a){if("InvalidStateError"!=a.name)return e.h=null,Promise.reject(a);new Ve((function(){try{e.j[s](e.i,i)}catch(t){e.h.reject(t),e.h=null}})).aa(.01)}return e.h}function jT(e,t,n){if(e.g)e.g.then((function(){return jT(e,t,n)})).catch((function(){return jT(e,t,n)}));else{if(e.g=t,"webkit-org.w3.clearkey"==e.i){var i=pt(n),r=JSON.parse(i);"oct"!=r.keys[0].kty&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),i=di(r.keys[0].k),r=di(r.keys[0].kid)}else i=me(n),r=null;var s=DT("addKey");try{e.j[s](e.i,i,r,e.sessionId)}catch(a){e.g.reject(a),e.g=null}}}function $T(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.g=t,t=new Kr("keystatuseschange"),e.dispatchEvent(t)}function VT(){this.size=0,this.g=void 0}jb((function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||gT())})),Bb.PatchedMediaKeysCert=xT,xT.install=AT,jb(AT),Bb.PatchedMediaKeysWebkit=IT,IT.install=LT,PT.prototype.createMediaKeys=function(){var e=new OT(this.g);return Promise.resolve(e)},PT.prototype.getConfiguration=function(){return this.h},OT.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new FT(t,this.l,e),this.i.push(e),e},OT.prototype.setServerCertificate=function(){return Promise.resolve(!1)},OT.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},y(FT,Yr),(i=FT.prototype).ready=function(){$T(this,"usable"),this.g&&this.g.resolve(),this.g=null},i.generateRequest=function(e,t){return BT(this,t,null)},i.load=function(e){return"persistent-license"==this.l?BT(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){var t=new jr;return jT(this,t,e),t},i.close=function(){if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=DT("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(t){}}return this.closed.resolve(),this.closed},i.remove=function(){return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},(i=VT.prototype).cc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,Be.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Be.value();return!(!this.g||!pe(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var HT="",qT="webkit";function GT(){}function zT(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=WT,Object.defineProperty(t,"disablePictureInPicture",{get:YT,set:QT,enumerable:!0,configurable:!0}),document.exitPictureInPicture=XT,document.addEventListener("webkitpresentationmodechanged",KT,!0))}}function KT(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function WT(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function XT(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function YT(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function QT(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function JT(){}function ZT(){e.crypto&&("randomUUID"in e.crypto||(e.crypto.randomUUID=eS))}function eS(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function tS(){}function nS(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:iS})}function iS(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}function rS(){}function sS(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch((function(){})),e}}}function aS(){}function oS(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in t||Xe()&&38===Qe())&&(t.getVideoPlaybackQuality=lS)}}function lS(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function uS(){}function cS(){if(!e.VTTCue&&e.TextTrackCue){var t=null,n=TextTrackCue.length;if(3==n)t=dS;else if(6==n)t=hS;else{try{var i=!!dS(1,2,"")}catch(r){i=!1}i&&(t=dS)}t&&(e.VTTCue=function(e,n,i){return t(e,n,i)})}}function dS(t,n,i){return new e.TextTrackCue(t,n,i)}function hS(t,n,i){return new e.TextTrackCue(t+"-"+n+"-"+i,t,n,i)}function fS(){}jb(LT),Bb.PiPWebkit=GT,GT.install=zT,jb(zT),Bb.RandomUUID=JT,JT.install=ZT,jb(ZT),Bb.Symbol=tS,tS.install=nS,jb(nS),Bb.VideoPlayPromise=rS,rS.install=sS,jb(sS),Bb.VideoPlaybackQuality=aS,aS.install=oS,jb(oS),Bb.VTTCue=uS,uS.install=cS,jb(cS),fS.prototype.parseInit=function(){},fS.prototype.setSequenceMode=function(){},fS.prototype.setManifestType=function(){},fS.prototype.parseMedia=function(e,t){for(var n=null,i=[],r=(e=c(e=pt(e).split(/\r?\n/))).next();!r.done;r=e.next())if((r=r.value)&&!/^\s+$/.test(r)&&(r=pS.exec(r))){var s=gS.exec(r[1]);r=new dn(s=60*parseInt(s[1],10)+parseFloat(s[2].replace(",",".")),t.segmentEnd?t.segmentEnd:s+2,r[2]),n&&(n.endTime=s,i.push(n)),n=r}return n&&i.push(n),i},$("shaka.text.LrcTextParser",fS),fS.prototype.parseMedia=fS.prototype.parseMedia,fS.prototype.setManifestType=fS.prototype.setManifestType,fS.prototype.setSequenceMode=fS.prototype.setSequenceMode,fS.prototype.parseInit=fS.prototype.parseInit;var pS=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,gS=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function mS(){}function yS(e,t,n,i,r,s,a,o,l,u,d,h,f){var p=u;if(Ot(e)){if(!d)return null;var g={tagName:"span",children:[Ft(e)],attributes:{},parent:null}}else g=e;for(var m=null,y=c(GS),v=y.next();!v.done&&!(m=kS(g,"backgroundImage",i,"#",v.value)[0]);v=y.next());y=null;var b=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/;if((v=zt(g,GS,"backgroundImage"))&&b.test(v)){if((y=parseInt(v.split(":").pop(),10)-1)>=f.length)return null;y=f[y]}else h&&v&&!v.startsWith("#")&&(b=new zn(h),v=new zn(v),(v=b.resolve(v).toString())&&(y=v));if(("p"==e.tagName||m||y)&&(d=!0),e=d,v="default"==(g.attributes["xml:space"]||(o?"default":"preserve")),o=[],!(b=g.children.every(Ot)))for(var T=c(g.children),S=T.next();!S.done;S=T.next())(S=yS(S.value,t,n,i,r,s,a,v,l,g,d,h,f))&&o.push(S);if(i=null!=u,h=Ft(g),h=g.children.length&&h&&/\S/.test(h),!((T=g.attributes.begin||g.attributes.end||g.attributes.dur)||h||"br"==g.tagName||0!=o.length||i&&!v))return null;for(h=(f=AS(g,n)).start,f=f.end;p&&p.tagName&&"tt"!=p.tagName;)h=(f=xS(p,n,h,f)).start,f=f.end,p=p.parent;if(null==h&&(h=0),h+=t.periodStart,f=null==f?1/0:f+t.periodStart,h=Math.max(h,t.segmentStart),f=Math.min(f,t.segmentEnd),!T&&0<o.length)for(h=1/0,f=0,n=(t=c(o)).next();!n.done;n=t.next())n=n.value,h=Math.min(h,n.startTime),f=Math.max(f,n.endTime);if("br"==g.tagName)return(r=new dn(h,f,"")).lineBreak=!0,r;if(t="",b&&(t=Tt(Ft(g)||""),v&&(t=t.replace(/\s+/g," "))),(t=new dn(h,f,t)).nestedCues=o,d||(t.isContainer=!0),l&&(t.cellResolution=l),l=kS(g,"region",s,"")[0],g.attributes.region&&l&&l.attributes["xml:id"]){var _=l.attributes["xml:id"];t.region=a.filter((function(e){return e.id==_}))[0]}return a=l,u&&i&&!g.attributes.region&&!g.attributes.style&&(a=kS(u,"region",s,"")[0]),function(e,t,n,i,r,s,a,o){a=a||o,"rtl"==SS(t,n,s,"direction",a)&&(e.direction="rtl"),o=SS(t,n,s,"writingMode",a),"tb"==o||"tblr"==o?e.writingMode="vertical-lr":"tbrl"==o?e.writingMode="vertical-rl":"rltb"==o||"rl"==o?e.direction="rtl":o&&(e.direction=wn),(o=SS(t,n,s,"textAlign",!0))?(e.positionAlign=VS.get(o),e.lineAlign=$S.get(o),e.textAlign=Tn[o.toUpperCase()]):e.textAlign=bn,(o=SS(t,n,s,"displayAlign",!0))&&(e.displayAlign=_n[o.toUpperCase()]);(o=SS(t,n,s,"color",a))&&(e.color=bS(o));(o=SS(t,n,s,"backgroundColor",a))&&(e.backgroundColor=bS(o));(o=SS(t,n,s,"border",a))&&(e.border=o);if(o=SS(t,n,s,"fontFamily",a))switch(o){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=o.split(",").filter((function(e){return"default"!=e})).join(",")}(o=SS(t,n,s,"fontWeight",a))&&"bold"==o&&(e.fontWeight=Dn),o=SS(t,n,s,"wrapOption",a),e.wrapLine=!o||"noWrap"!=o,(o=SS(t,n,s,"lineHeight",a))&&o.match(MS)&&(e.lineHeight=o),(o=SS(t,n,s,"fontSize",a))&&(o.match(MS)||o.match(RS))&&(e.fontSize=o),(o=SS(t,n,s,"fontStyle",a))&&(e.fontStyle=Pn[o.toUpperCase()]);i?(r=i.attributes.imageType||i.attributes.imagetype,o=i.attributes.encoding,i=Ft(i).trim(),"PNG"==r&&"Base64"==o&&i&&(e.backgroundImage="data:image/png;base64,"+i)):r&&(e.backgroundImage=r),(i=SS(t,n,s,"textOutline",a))&&(i=i.split(" "),i[0].match(MS)?e.textStrokeColor=e.color:(e.textStrokeColor=bS(i[0]),i.shift()),i[0]&&i[0].match(MS)?e.textStrokeWidth=i[0]:e.textStrokeColor="");(i=SS(t,n,s,"letterSpacing",a))&&i.match(MS)&&(e.letterSpacing=i),(i=SS(t,n,s,"linePadding",a))&&i.match(MS)&&(e.linePadding=i),(i=SS(t,n,s,"opacity",a))&&(e.opacity=parseFloat(i));(i=_S(n,s,"textDecoration"))&&TS(e,i),(i=wS(t,s,"textDecoration"))&&TS(e,i),(i=SS(t,n,s,"textCombine",a))&&(e.textCombineUpright=i);switch(SS(t,n,s,"ruby",a)){case"container":e.rubyTag="ruby";break;case"text":e.rubyTag="rt"}}(t,g,a,m,y,r,e,0==o.length),t}function vS(e,t,n){var i=new xe,r=e.attributes["xml:id"];if(!r)return null;i.id=r,r=null,n&&(r=DS.exec(n)||PS.exec(n)),n=r?Number(r[1]):null,r=r?Number(r[2]):null;var s,a=_S(e,t,"extent");if(a){var o=(s=DS.exec(a))||PS.exec(a);null!=o&&(i.width=Number(o[1]),i.height=Number(o[2]),s||(null!=n&&(i.width=100*i.width/n),null!=r&&(i.height=100*i.height/r)),i.widthUnits=s||null!=n?Ae:0,i.heightUnits=s||null!=r?Ae:0)}return(e=_S(e,t,"origin"))&&(null!=(o=(s=DS.exec(e))||PS.exec(e))&&(i.viewportAnchorX=Number(o[1]),i.viewportAnchorY=Number(o[2]),s?a||(i.width=100-i.viewportAnchorX,i.widthUnits=Ae,i.height=100-i.viewportAnchorY,i.heightUnits=Ae):(null!=r&&(i.viewportAnchorY=100*i.viewportAnchorY/r),null!=n&&(i.viewportAnchorX=100*i.viewportAnchorX/n)),i.viewportAnchorUnits=s||null!=n?Ae:0)),i}function bS(e){var t=e.match(/rgba\(([^)]+)\)/);return t&&4==(t=t[1].split(",")).length?(t[3]=String(Number(t[3])/255),"rgba("+t.join(",")+")"):e}function TS(e,t){for(var n=(t=c(t.split(" "))).next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes(On)||e.textDecoration.push(On);break;case"noUnderline":e.textDecoration.includes(On)&&Le(e.textDecoration,On);break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Le(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Le(e.textDecoration,"overline")}}function SS(e,t,n,i,r){return r=void 0===r||r,(e=wS(e,n,i))?e:r?_S(t,n,i):null}function _S(e,t,n){if(!e)return null;var i=zt(e,qS,n);return i||ES(e,t,n)}function wS(e,t,n){var i=zt(e,qS,n);return i||ES(e,t,n)}function ES(e,t,n){e=kS(e,"style",t,"");for(var i=null,r=0;r<e.length;r++){var s=qt(e[r],"urn:ebu:tt:style",n);s||(s=zt(e[r],qS,n)),s||(s=wS(e[r],t,n)),s&&(i=s)}return i}function kS(e,t,n,i,r){var s=[];if(!e||1>n.length)return s;var a=e;for(e=null;!e&&!(e=r?qt(a,r,t):a.attributes[t])&&(a=a.parent););if(t=e)for(r=(t=c(t.split(" "))).next();!r.done;r=t.next())for(r=r.value,a=(e=c(n)).next();!a.done;a=e.next())if(i+(a=a.value).attributes["xml:id"]==r){s.push(a);break}return s}function xS(e,t,n,i){return e=AS(e,t),null==n?n=e.start:null!=e.start&&(n+=e.start),null==i?i=e.end:null!=e.start&&(i+=e.start),{start:n,end:i}}function AS(e,t){var n=CS(e.attributes.begin,t),i=CS(e.attributes.end,t);return e=CS(e.attributes.dur,t),null==i&&null!=e&&(i=n+e),{start:n,end:i}}function CS(e,t){var n=null;if(OS.test(e)){e=OS.exec(e),n=Number(e[1]);var i=Number(e[2]),r=Number(e[3]),s=Number(e[4]);n=(r+=(s+=(Number(e[5])||0)/t.h)/t.frameRate)+60*i+3600*n}else if(NS.test(e))n=IS(NS,e);else if(US.test(e))n=IS(US,e);else if(FS.test(e))e=FS.exec(e),n=Number(e[1])/t.frameRate;else if(BS.test(e))e=BS.exec(e),n=Number(e[1])/t.g;else if(jS.test(e))n=IS(jS,e);else if(e)throw new Me(2,2,2001,"Could not parse cue time range in TTML");return n}function IS(e,t){return null==(e=e.exec(t))||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}function LS(e,t,n,i){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(i),0==this.g&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}ji("application/x-subtitle-lrc",(function(){return new fS})),mS.prototype.parseInit=function(){},mS.prototype.setSequenceMode=function(){},mS.prototype.setManifestType=function(){},mS.prototype.parseMedia=function(e,t,n,i){var r=pt(e);if(e=[],""==r)return e;var s=Mt(r,"tt",!0);if(!s)throw new Me(2,2,2005,"Failed to parse TTML.");if(!(r=jt(s,"body")[0]))return[];var a=zt(s,HS,"frameRate"),o=zt(s,HS,"subFrameRate"),l=zt(s,HS,"frameRateMultiplier"),u=zt(s,HS,"tickRate"),d=zt(s,HS,"cellResolution"),h=s.attributes["xml:space"]||"default",f=zt(s,qS,"extent");if("default"!=h&&"preserve"!=h)throw new Me(2,2,2005,"Invalid xml:space value: "+h);h="default"==h,a=new LS(a,o,l,u),d=function(e){return e&&(e=/^(\d+) (\d+)$/.exec(e))?{nc:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}(d),o=((o=jt(s,"metadata")[0])?o.children:[]).filter((function(e){return"\n"!=e})),l=jt(s,"style"),u=[];for(var p=c(s=jt(s,"region")),g=p.next();!g.done;g=p.next())(g=vS(g.value,l,f))&&u.push(g);if(Ut(r,"p").length)throw new Me(2,2,2001,"<p> can only be inside <div> in TTML");for(p=(f=c(Ut(r,"div"))).next();!p.done;p=f.next())if(Ut(p.value,"span").length)throw new Me(2,2,2001,"<span> can only be inside <p> in TTML");return(t=yS(r,t,a,o,l,s,u,h,d,null,!1,n,i))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},$("shaka.text.TtmlTextParser",mS),mS.prototype.parseMedia=mS.prototype.parseMedia,mS.prototype.setManifestType=mS.prototype.setManifestType,mS.prototype.setSequenceMode=mS.prototype.setSequenceMode,mS.prototype.parseInit=mS.prototype.parseInit;var DS=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,RS=/^(\d{1,4}(?:\.\d+)?|100)%$/,MS=/^(\d+px|\d+em|\d*\.?\d+c)$/,PS=/^(\d+)px (\d+)px$/,OS=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,NS=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,US=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,FS=/^(\d*(?:\.\d*)?)f$/,BS=/^(\d*(?:\.\d*)?)t$/,jS=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),$S=(new Map).set("left",xn).set("center","center").set("right","end").set("start",xn).set("end","end"),VS=(new Map).set("left","line-left").set("center","center").set("right","line-right"),HS=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],qS=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],GS=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function zS(){this.g=new mS}function KS(){this.g="UNKNOWN"}function WS(e,t,n){var i;(i=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=i[1],e.textAlign="middle"==t?bn:Tn[t.toUpperCase()]):(i=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl":(i=/^size:([\d.]+)%$/.exec(t))?e.size=Number(i[1]):(i=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center"==t||"middle"==t?"center":vn)):(i=/^region:(.*)$/.exec(t))?(t=function(e,t){return e=e.filter((function(e){return e.id==t})),e.length?e[0]:null}(n,i[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=An[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=kn,e.line=Number(n[1]),n[2]&&(e.lineAlign=An[n[2].toUpperCase()]))}function XS(){this.g=null}function YS(e,t,n){var i,r,s;return(new vs).box("payl",ws((function(e){i=pt(e)}))).box("iden",ws((function(e){r=pt(e)}))).box("sttg",ws((function(e){s=pt(e)}))).parse(e),i?function(e,t,n,i,r){if(e=new dn(i,r,e),pn(e),t&&(e.id=t),n)for(t=new _t(n),n=kt(t);n;)WS(e,n,[]),wt(t),n=kt(t);return e}(i,r,s,t,n):null}function QS(){}function JS(){this.g=new KS}function ZS(e){var t="WEBVTT\n\n";if(""==e)return t;for(var n=(e=c((e=(e=e.replace(/\r+/g,"")).trim()).split("\n\n"))).next();!n.done;n=e.next())(n=n.value.split(/\n/))[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n";return t}function e_(){}function t_(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=n_(n))&&(e.color=n),(n=t.BackColour)&&(n=n_(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=Dn),t.Italic&&(e.fontStyle=Mn),t.Underline&&e.textDecoration.push(On),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=Sn,e.textAlign="start";break;case 2:e.displayAlign=Sn,e.textAlign=bn;break;case 3:e.displayAlign=Sn,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=bn;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=bn;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function n_(e){return 0<=(e=parseInt(e.replace("&H",""),16))?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function i_(e){return 3600*((e=o_.exec(e))[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}ji("application/ttml+xml",(function(){return new mS})),zS.prototype.parseInit=function(e){var t=!1;if((new vs).box("moov",bs).box("trak",bs).box("mdia",bs).box("minf",bs).box("stbl",bs).S("stsd",Ts).box("stpp",(function(e){t=!0,e.parser.stop()})).parse(e),!t)throw new Me(2,2,2007)},zS.prototype.setSequenceMode=function(){},zS.prototype.setManifestType=function(){},zS.prototype.parseMedia=function(e,t,n){var i=[],r=null,s=[],a=new Map,o=[];if((new vs).box("moof",bs).box("traf",bs).S("tfhd",(function(e){r=qa(e.reader,e.flags).kd})).S("trun",(function(e){for(var t=(e=c((e=Ka(e.reader,e.version,e.flags)).Xf)).next();!t.done;t=e.next())o.push(t.value.sampleSize||r||0)})).S("subs",(function(e){for(var t=e.reader,n=t.R(),i=-1,r=0;r<n;r++){var s=t.R();i+=s,s=t.na();for(var o=[],l=0;l<s;l++)1==e.version?o.push(t.R()):o.push(t.na()),t.V(),t.V(),t.R();a.set(i,o)}})).box("mdat",ws((function(e){s.push(e)}))).parse(e,!1),0==s.length)throw new Me(2,2,2007);for(var l=pi.apply(li,d(s)),u=0,h=0;h<o.length;h++){var f=me(l,u,o[h]);u+=o[h];var p=a.get(h);if(p&&p.length){f=me(f,0,p[0]);for(var g=[],m=p[0],y=1;y<p.length;y++){var v=me(e,m,p[y]);v=ui(v),g.push("data:image/png;base64,"+v),m+=p[y]}i=i.concat(this.g.parseMedia(f,t,n,g))}else i=i.concat(this.g.parseMedia(f,t,n,[]))}return i},$("shaka.text.Mp4TtmlParser",zS),zS.prototype.parseMedia=zS.prototype.parseMedia,zS.prototype.setManifestType=zS.prototype.setManifestType,zS.prototype.setSequenceMode=zS.prototype.setSequenceMode,zS.prototype.parseInit=zS.prototype.parseInit,ji('application/mp4; codecs="stpp"',(function(){return new zS})),ji('application/mp4; codecs="stpp.ttml"',(function(){return new zS})),ji('application/mp4; codecs="stpp.ttml.im1i"',(function(){return new zS})),ji('application/mp4; codecs="stpp.ttml.im1t"',(function(){return new zS})),ji('application/mp4; codecs="stpp.ttml.im2i"',(function(){return new zS})),ji('application/mp4; codecs="stpp.ttml.im2t"',(function(){return new zS})),ji('application/mp4; codecs="stpp.ttml.etd1"',(function(){return new zS})),ji('application/mp4; codecs="stpp.ttml.etd1|im1t"',(function(){return new zS})),ji('application/mp4; codecs="stpp.ttml.im1t|etd1"',(function(){return new zS})),ji('application/mp4; codecs="stpp.TTML.im1t"',(function(){return new zS})),KS.prototype.parseInit=function(){},KS.prototype.setSequenceMode=function(){},KS.prototype.setManifestType=function(e){this.g=e},KS.prototype.parseMedia=function(e,t){var n=(e=(e=pt(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new Me(2,2,2e3);if(e=t.vttOffset,"HLS"==this.g)if(n[0].includes("X-TIMESTAMP-MAP")){var i=n[0];if(e=i.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),i=i.match(/MPEGTS:(\d+)/m),!e||!i)throw new Me(2,2,2e3);if(null==(e=At(e[1])))throw new Me(2,2,2e3);i=Number(i[1]);for(var r=t.segmentStart-t.periodStart;95443.7176888889<=r;)r-=95443.7176888889,i+=8589934592;e=t.periodStart+i/9e4-e}else t.periodStart&&t.vttOffset==t.periodStart&&(e=0);for(t=[],r=(i=c(n[0].split("\n"))).next();!r.done;r=i.next())if(r=r.value,/^Region:/.test(r)){r=new _t(r);var s=new xe;kt(r),wt(r);for(var a=kt(r);a;){var o=s,l=a;(a=/^id=(.*)$/.exec(l))?o.id=a[1]:(a=/^width=(\d{1,2}|100)%$/.exec(l))?o.width=Number(a[1]):(a=/^lines=(\d+)$/.exec(l))?(o.height=Number(a[1]),o.heightUnits=2):(a=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(l))?(o.regionAnchorX=Number(a[1]),o.regionAnchorY=Number(a[2])):(a=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(l))?(o.viewportAnchorX=Number(a[1]),o.viewportAnchorY=Number(a[2])):/^scroll=up$/.exec(l)&&(o.scroll="up"),wt(r),a=kt(r)}t.push(s)}for(gn(i=new Map),r=[],s=(n=c(n.slice(1))).next();!s.done;s=n.next()){if((1!=(s=s.value.split("\n")).length||s[0])&&!/^NOTE($|[ \t])/.test(s[0])&&"STYLE"==s[0]){for(o=[],a=-1,l=1;l<s.length;l++)s[l].includes("::cue")&&(o.push([]),a=o.length-1),-1!=a&&(o[a].push(s[l]),s[l].includes("}")&&(a=-1));for(a=(o=c(o)).next();!a.done;a=o.next()){var u=a.value;a="global",(l=u[0].match(/\((.*)\)/))&&(a=l.pop()),l=u.slice(1,-1),u[0].includes("}")&&(u=/\{(.*?)\}/.exec(u[0]))&&(l=u[1].split(";")),(u=i.get(a))||(u=new dn(0,0,""));for(var d=!1,h=0;h<l.length;h++){var f=/^\s*([^:]+):\s*(.*)/.exec(l[h]);if(f){var p=f[2].trim().replace(";","");switch(f[1].trim()){case"background-color":case"background":d=!0,u.backgroundColor=p;break;case"color":d=!0,u.color=p;break;case"font-family":d=!0,u.fontFamily=p;break;case"font-size":d=!0,u.fontSize=p;break;case"font-weight":(700<=parseInt(p,10)||"bold"==p)&&(d=!0,u.fontWeight=Dn);break;case"font-style":switch(p){case"normal":d=!0,u.fontStyle=Rn;break;case"italic":d=!0,u.fontStyle=Mn;break;case"oblique":d=!0,u.fontStyle="oblique"}break;case"opacity":d=!0,u.opacity=parseFloat(p);break;case"text-combine-upright":d=!0,u.textCombineUpright=p;break;case"text-shadow":d=!0,u.textShadow=p;break;case"white-space":d=!0,u.wrapLine="noWrap"!=p}}}d&&i.set(a,u)}}if(d=e,1==(u=s).length&&!u[0]||/^NOTE($|[ \t])/.test(u[0])||"STYLE"==u[0]||"REGION"==u[0])s=null;else if(s=null,u[0].includes("--\x3e")||(s=u[0],u.splice(0,1)),a=xt(o=new _t(u[0])),h=Et(o,/[ \t]+--\x3e[ \t]+/g),l=xt(o),null==a||null==h||null==l)X("Failed to parse VTT time code. Cue skipped:",s,u),s=null;else{for(a+=d,l+=d,d=u.slice(1).join("\n").trim(),i.has("global")?((u=i.get("global").clone()).startTime=a,u.endTime=l,u.payload=d):u=new dn(a,l,d),wt(o),a=kt(o);a;)WS(u,a,t),wt(o),a=kt(o);pn(u,i),null!=s&&(u.id=s),s=u}s&&r.push(s)}return r},$("shaka.text.VttTextParser",KS),KS.prototype.parseMedia=KS.prototype.parseMedia,KS.prototype.setManifestType=KS.prototype.setManifestType,KS.prototype.setSequenceMode=KS.prototype.setSequenceMode,KS.prototype.parseInit=KS.prototype.parseInit,ji("text/vtt",(function(){return new KS})),ji('text/vtt; codecs="vtt"',(function(){return new KS})),ji('text/vtt; codecs="wvtt"',(function(){return new KS})),XS.prototype.parseInit=function(e){var t=this,n=!1;if((new vs).box("moov",bs).box("trak",bs).box("mdia",bs).S("mdhd",(function(e){e=za(e.reader,e.version),t.g=e.timescale})).box("minf",bs).box("stbl",bs).S("stsd",Ts).box("wvtt",(function(){n=!0})).parse(e),!this.g)throw new Me(2,2,2008);if(!n)throw new Me(2,2,2008)},XS.prototype.setSequenceMode=function(){},XS.prototype.setManifestType=function(){},XS.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new Me(2,2,2008);var n,i=0,r=[],s=[],a=!1,o=!1,l=!1,u=null;if((new vs).box("moof",bs).box("traf",bs).S("tfdt",(function(e){a=!0,i=Ga(e.reader,e.version).baseMediaDecodeTime})).S("tfhd",(function(e){u=qa(e.reader,e.flags).jd})).S("trun",(function(e){o=!0,r=Ka(e.reader,e.version,e.flags).Xf})).box("mdat",ws((function(e){l=!0,n=e}))).parse(e,!1),!l&&!a&&!o)throw new Me(2,2,2008);e=i;for(var d=new gs(n,0),h=c(r),f=h.next();!f.done;f=h.next()){var p=(f=f.value).Yf||u,g=f.ue?i+f.ue:e;e=g+(p||0);var m=0;do{var y=d.R();m+=y;var v=null;"vttc"==ks(d.R())?8<y&&(v=d.Bb(y-8)):d.skip(y-8),p&&v&&(y=YS(v,t.periodStart+g/this.g,t.periodStart+e/this.g),s.push(y))}while(f.sampleSize&&m<f.sampleSize)}return s.filter(Wi)},$("shaka.text.Mp4VttParser",XS),XS.prototype.parseMedia=XS.prototype.parseMedia,XS.prototype.setManifestType=XS.prototype.setManifestType,XS.prototype.setSequenceMode=XS.prototype.setSequenceMode,XS.prototype.parseInit=XS.prototype.parseInit,ji('application/mp4; codecs="wvtt"',(function(){return new XS})),QS.prototype.parseInit=function(){},QS.prototype.setSequenceMode=function(){},QS.prototype.setManifestType=function(){},QS.prototype.parseMedia=function(e){var t=pt(e).replace(/\r+/g,"");if(e=[],""==(t=t.trim()))return e;for(var n=(t=c(t.split("\n\n"))).next();!n.done;n=t.next()){var i=new _t((n=n.value.split("\n"))[0]),r=xt(i),s=Et(i,/,/g);if(i=xt(i),null==r||null==s||null==i)throw new Me(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new dn(r,i,n.slice(1).join("\n").trim()))}return e},$("shaka.text.SbvTextParser",QS),QS.prototype.parseMedia=QS.prototype.parseMedia,QS.prototype.setManifestType=QS.prototype.setManifestType,QS.prototype.setSequenceMode=QS.prototype.setSequenceMode,QS.prototype.parseInit=QS.prototype.parseInit,ji("text/x-subviewer",(function(){return new QS})),JS.prototype.parseInit=function(){},JS.prototype.setSequenceMode=function(){},JS.prototype.setManifestType=function(){},JS.prototype.parseMedia=function(e,t,n){return e=me(yt(e=ZS(e=pt(e)))),this.g.parseMedia(e,t,n,[])},$("shaka.text.SrtTextParser",JS),JS.srt2webvtt=ZS,JS.prototype.parseMedia=JS.prototype.parseMedia,JS.prototype.setManifestType=JS.prototype.setManifestType,JS.prototype.setSequenceMode=JS.prototype.setSequenceMode,JS.prototype.parseInit=JS.prototype.parseInit,ji("text/srt",(function(){return new JS})),e_.prototype.parseInit=function(){},e_.prototype.setSequenceMode=function(){},e_.prototype.setManifestType=function(){},e_.prototype.parseMedia=function(e){var t="",n="",i=null,r=null;for(r=(e=c(r=pt(e).split(/\r?\n\s*\r?\n/))).next();!r.done;r=e.next()){var s=r.value;r=s,(s=r_.exec(s))&&(i=s[1],r=s[2]),"V4 Styles"==i||"V4+ Styles"==i?(t=r,t=n?t+"\n"+r:r):"Events"==i&&(n=n?n+"\n"+r:r)}for(i=[],r=null,e=(t=c(t.split(/\r?\n/))).next();!e.done;e=t.next())if(e=e.value,!/^\s*;/.test(e)&&(s=s_.exec(e)))if(e=s[1].trim(),s=s[2].trim(),"Format"==e)r=s.split(a_);else if("Style"==e){e=s.split(a_),s={};for(var a=0;a<r.length&&a<e.length;a++)s[r[a]]=e[a];i.push(s)}for(r=[],t=null,s=(n=c(n.split(/\r?\n/))).next(),e={};!s.done;e={vh:void 0},s=n.next())if(s=s.value,!/^\s*;/.test(s)&&(a=s_.exec(s)))if(s=a[1].trim(),a=a[2].trim(),"Format"==s)t=a.split(a_);else if("Dialogue"==s){a=a.split(a_),s={};for(var o=0;o<t.length&&o<a.length;o++)s[t[o]]=a[o];a=new dn(o=i_(s.Start),i_(s.End),a.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),e.vh=s.Style,(e=i.find(function(e){return function(t){return t.Name==e.vh}}(e)))&&t_(a,e),r.push(a)}return r},$("shaka.text.SsaTextParser",e_),e_.prototype.parseMedia=e_.prototype.parseMedia,e_.prototype.setManifestType=e_.prototype.setManifestType,e_.prototype.setSequenceMode=e_.prototype.setSequenceMode,e_.prototype.parseInit=e_.prototype.parseInit;var r_=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,s_=/^\s*([^:]+):\s*(.*)/,a_=/\s*,\s*/,o_=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;function l_(e,t){var n=1&e[t+1]?7:9;return t+n<=e.length&&0<(e=((3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5)-n)?{sd:n,fa:e}:null}function u_(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=(60&e[t+2])>>>2;if(i>n.length-1)return null;var r=1+((192&e[t+2])>>>6),s=(1&e[t+2])<<2;return s|=(192&e[t+3])>>>6,{sampleRate:n[i],channelCount:s,codec:"mp4a.40."+r}}function c_(e,t){if(t+1<e.length&&255===e[t]&&240===(246&e[t+1])){var n=1&e[t+1]?7:9;if(t+n>=e.length)return!1;var i=(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5;return!(i<=n)&&((t+=i)===e.length||t+1<e.length&&255===e[t]&&240===(246&e[t+1]))}return!1}function d_(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function h_(e,t){if(t+8>e.length||11!==e[t]||119!==e[t+1])return null;var n=e[t+4]>>6;if(3<=n)return null;var i=63&e[t+4],r=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*i+n];if(t+r>e.length)return null;var s=e[t+6]>>5,a=0;2===s?a+=2:(1&s&&1!==s&&(a+=2),4&s&&(a+=2)),a=(e[t+6]<<8|e[t+7])>>12-a&1;var o=7&e[t+5];return e=new Uint8Array([n<<6|e[t+5]>>3<<1|o>>2,(3&o)<<6|s<<3|a<<2|i>>4,i<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][s]+a,ra:e,fa:r}}function f_(e,t){if(11===e[t]&&119===e[t+1]){var n,i,r=0,s=5;for(t+=s;0<s;){i=e[t];var a=Math.min(s,8),o=8-a;n=(i&(n=4278190080>>>24+o<<o))>>o,r=r?r<<a|n:n,t+=1,s-=a}if(16>r)return!0}return!1}function p_(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function g_(e,t){if(t+8>e.length||2935!==(e[t]<<8|e[t+1]))return null;var n=new Ja(e.subarray(t+2));eo(n,2),eo(n,3);var i=to(n,11)+1<<1,r=to(n,2);if(3==r){r=[24e3,22060,16e3][r=to(n,2)];var s=3}else r=[48e3,44100,32e3][r],s=to(n,2);var a=to(n,3),o=to(n,1);return n=to(n,5),t+i>e.byteLength?null:(e=Math.floor(i*r/(16*[1,2,3,6][s])),e=new Uint8Array([(8160&e)>>5,(31&e)<<3,r<<6|n<<1,a<<1|o,0]),{sampleRate:r,channelCount:[2,1,2,3,3,4,4,5][a]+o,ra:e,fa:i})}function m_(e){this.j=e,this.h=0,this.g=new Map,this.i=null}ji("text/x-ssa",(function(){return new e_})),(i=d_.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]&&ie(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/aac"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="'+(Pi(t)||"mp4a.40.2")+'"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=me(e),s=Ha(r),a=s.length;a<r.length&&!c_(r,a);a++);if(e=1e3*n.endTime,(s=Va(s)).length&&n&&(s=s.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(e=s.data),!(s=u_(r,a)))return Promise.reject(new Me(2,3,3018,n?n.N()[0]:null));t.audioSamplingRate=s.sampleRate,t.channelsCount=s.channelCount;for(var o=[];a<r.length;){var l=l_(r,a);if(!l)return Promise.reject(new Me(2,3,3018,n?n.N()[0]:null));var u=l.sd+l.fa;a+u<=r.length&&o.push({data:r.subarray(a+l.sd,a+u),size:l.fa,duration:1024,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),a+=u}return r=s.sampleRate,e=Math.floor(e*r/1e3),i=new Fy([i={id:t.id,type:"audio",codecs:s.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,lb:[],ra:new Uint8Array([]),za:new Uint8Array([]),Fa:0,Ha:0,data:{Cb:this.h,baseMediaDecodeTime:e,jb:o},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=By(i),this.g.set(n,t)),n=this.i!==t,i=qy(i),this.i=t,this.h++,n?(t=pi(t,i),Promise.resolve(t)):Promise.resolve(i)},$("shaka.transmuxer.AacTransmuxer",d_),d_.prototype.transmux=d_.prototype.transmux,d_.prototype.getOriginalMimeType=d_.prototype.getOriginalMimeType,d_.prototype.convertCodecs=d_.prototype.convertCodecs,d_.prototype.isSupported=d_.prototype.isSupported,d_.prototype.destroy=d_.prototype.destroy,Fn("audio/aac",(function(){return new d_("audio/aac")}),$n),(i=p_.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ac3"==e.toLowerCase().split(";")[0]&&ie(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ac3"==t.toLowerCase().split(";")[0]?We()?'audio/mp4; codecs="ec-3"':'audio/mp4; codecs="ac-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=Ha(e=me(e)),s=r.length;s<e.length&&!f_(e,s);s++);var a=1e3*n.endTime;(r=Va(r)).length&&n&&(r=r.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(a=r.data),r=0;for(var o=new Uint8Array([]),l=[];s<e.length;){var u=h_(e,s);if(!u)return Promise.reject(new Me(2,3,3018,n?n.N()[0]:null));t.audioSamplingRate=u.sampleRate,t.channelsCount=u.channelCount,r=u.sampleRate,o=u.ra,l.push({data:e.subarray(s,s+u.fa),size:u.fa,duration:1536,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),s+=u.fa}return e=Math.floor(a*r/1e3),i=new Fy([i={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,lb:[],ra:o,za:new Uint8Array([]),Fa:0,Ha:0,data:{Cb:this.h,baseMediaDecodeTime:e,jb:l},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=By(i),this.g.set(n,t)),n=this.i!==t,i=qy(i),this.i=t,this.h++,n?(t=pi(t,i),Promise.resolve(t)):Promise.resolve(i)},$("shaka.transmuxer.Ac3Transmuxer",p_),p_.prototype.transmux=p_.prototype.transmux,p_.prototype.getOriginalMimeType=p_.prototype.getOriginalMimeType,p_.prototype.convertCodecs=p_.prototype.convertCodecs,p_.prototype.isSupported=p_.prototype.isSupported,p_.prototype.destroy=p_.prototype.destroy,Fn("audio/ac3",(function(){return new p_("audio/ac3")}),$n),(i=m_.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ec3"==e.toLowerCase().split(";")[0]&&ie(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ec3"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="ec-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=Ha(e=me(e)),s=r.length;s<e.length&&2935!==(e[s]<<8|e[s+1]);s++);var a=1e3*n.endTime;(r=Va(r)).length&&n&&(r=r.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(a=r.data),r=0;for(var o=new Uint8Array([]),l=[];s<e.length;){var u=g_(e,s);if(!u)return Promise.reject(new Me(2,3,3018,n?n.N()[0]:null));t.audioSamplingRate=u.sampleRate,t.channelsCount=u.channelCount,r=u.sampleRate,o=u.ra,l.push({data:e.subarray(s,s+u.fa),size:u.fa,duration:1536,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),s+=u.fa}return e=Math.floor(a*r/1e3),i=new Fy([i={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,lb:[],ra:o,za:new Uint8Array([]),Fa:0,Ha:0,data:{Cb:this.h,baseMediaDecodeTime:e,jb:l},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=By(i),this.g.set(n,t)),n=this.i!==t,i=qy(i),this.i=t,this.h++,n?(t=pi(t,i),Promise.resolve(t)):Promise.resolve(i)},$("shaka.transmuxer.Ec3Transmuxer",m_),m_.prototype.transmux=m_.prototype.transmux,m_.prototype.getOriginalMimeType=m_.prototype.getOriginalMimeType,m_.prototype.convertCodecs=m_.prototype.convertCodecs,m_.prototype.isSupported=m_.prototype.isSupported,m_.prototype.destroy=m_.prototype.destroy,Fn("audio/ec3",(function(){return new m_("audio/ec3")}),$n);var y_=[100,110,122,244,44,83,86,118,128,138,139,134];function v_(e){if(!e.length)return null;var t=e.find((function(e){return 32==e.type})),n=e.find((function(e){return 33==e.type})),i=e.find((function(e){return 34==e.type}));if(!t||!n||!i)return null;var r=function(e){var t=new Ja(e,!0);return oo(t),oo(t),to(t,4),to(t,2),to(t,6),e=to(t,3),t=ao(t),{Mf:e+1,ig:t}}(t.fullData);e=function(e){e=new Ja(e,!0),oo(e),oo(e);var t=0,n=0,i=0,r=0;to(e,4);var s=to(e,3);ao(e);for(var a=to(e,2),o=to(e,1),l=to(e,5),u=oo(e),c=oo(e),d=oo(e),h=oo(e),f=oo(e),p=oo(e),g=oo(e),m=oo(e),y=oo(e),v=oo(e),b=oo(e),T=[],S=[],_=0;_<s;_++)T.push(ao(e)),S.push(ao(e));if(0<s)for(_=s;8>_;_++)to(e,2);for(_=0;_<s;_++)T[_]&&to(e,88),S[_]&&oo(e);ro(e),T=ro(e),3==T&&to(e,1),S=ro(e),_=ro(e),ao(e)&&(t+=ro(e),n+=ro(e),i+=ro(e),r+=ro(e));var w=ro(e),E=ro(e),k=ro(e);if(ao(e))for(var x=0;x<=s;x++)ro(e),ro(e),ro(e);else ro(e),ro(e),ro(e);if(ro(e),ro(e),ro(e),ro(e),ro(e),ro(e),ao(e)&&ao(e))for(x=0;4>x;x++)for(var A=0;A<(3===x?2:6);A++)if(ao(e)){var C=Math.min(64,1<<4+(x<<1));1<x&&so(e);for(var I=0;I<C;I++)so(e)}else ro(e);for(ao(e),ao(e),ao(e)&&(oo(e),ro(e),ro(e),ao(e)),x=ro(e),C=A=0;C<x;C++)if(I=!1,0!==C&&(I=ao(e)),I){C===x&&ro(e),ao(e),ro(e);for(var L=I=0;L<=A;L++){var D=ao(e),R=!1;D||(R=ao(e)),(D||R)&&I++}A=I}else{for(A=(L=ro(e))+(I=ro(e)),D=0;D<L;D++)ro(e),ao(e);for(L=0;L<I;L++)ro(e),ao(e)}if(ao(e))for(x=ro(e),A=0;A<x;A++){for(C=0;C<k+4;C++)to(e,1);to(e,1)}if(x=k=1,A=0,ao(e),ao(e),ao(e)){if(ao(e)&&(I=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],L=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1],0<(C=oo(e))&&16>=C?(k=I[C-1],x=L[C-1]):255===C&&(k=to(e,16),x=to(e,16))),ao(e)&&ao(e),ao(e)&&(to(e,3),ao(e),ao(e)&&(oo(e),oo(e),oo(e))),ao(e)&&(ro(e),ro(e)),ao(e),ao(e),ao(e),(C=ao(e))&&(ro(e),ro(e),ro(e),ro(e)),ao(e)&&(to(e,32),to(e,32),ao(e)&&ro(e),ao(e)))for(L=!1,C=ao(e),I=ao(e),(C||I)&&((L=ao(e))&&(oo(e),to(e,5),ao(e),to(e,5)),to(e,4),to(e,4),L&&to(e,4),to(e,5),to(e,5),to(e,5)),D=0;D<=s;D++){var M=!0;R=1,ao(e)||(M=ao(e));var P=!1;if(M?ro(e):P=ao(e),P||(R=ro(e)+1),C){for(M=0;M<R;M++)ro(e),ro(e),L&&(ro(e),ro(e));ao(e)}if(I){for(M=0;M<R;M++)ro(e),ro(e),L&&(ro(e),ro(e));ao(e)}}ao(e)&&(ao(e),ao(e),ao(e),A=ro(e),ro(e),ro(e),ro(e),ro(e))}return{lf:b,tf:a,uf:o,rf:l,mf:u,nf:c,pf:d,qf:h,ef:f,ff:p,gf:g,hf:m,jf:y,kf:v,ge:A,Ye:0,We:T,Ve:w,Ue:E,width:S-(t+n)*(1===T||2===T?2:1),height:_-(i+r)*(1===T?2:1),jj:k,ij:x}}(n.fullData);var s=function(e){var t=new Ja(e,!0);oo(t),oo(t),ro(t),ro(t),ao(t),ao(t),to(t,3),ao(t),ao(t),ro(t),ro(t),so(t),ao(t),ao(t),ao(t)&&ro(t),so(t),so(t),ao(t),ao(t),ao(t),ao(t),e=ao(t),t=ao(t);var n=1;return t&&e?n=0:t?n=3:e&&(n=2),{Of:n}}(i.fullData);return t=function(e,t,n,i){var r=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));return r[0]=1,r[1]=(3&i.tf)<<6|(i.uf?1:0)<<5|31&i.rf,r[2]=i.mf,r[3]=i.nf,r[4]=i.pf,r[5]=i.qf,r[6]=i.ef,r[7]=i.ff,r[8]=i.gf,r[9]=i.hf,r[10]=i.jf,r[11]=i.kf,r[12]=i.lf,r[13]=240|(3840&i.ge)>>8,r[14]=255&i.ge,r[15]=252|3&i.Of,r[16]=252|3&i.We,r[17]=248|7&i.Ve,r[18]=248|7&i.Ue,r[19]=0,r[20]=0,r[21]=(3&i.Ye)<<6|(7&i.Mf)<<3|(i.ig?1:0)<<2|3,r[22]=3,r[23]=160,r[24]=0,r[25]=1,r[26]=(65280&e.byteLength)>>8,r[27]=255&e.byteLength,r.set(e,28),r[23+(5+e.byteLength)]=161,r[e.byteLength+29]=0,r[e.byteLength+30]=1,r[e.byteLength+31]=(65280&t.byteLength)>>8,r[e.byteLength+32]=255&t.byteLength,r.set(t,e.byteLength+33),r[23+(e.byteLength+10+t.byteLength)]=162,r[e.byteLength+10+t.byteLength+24]=0,r[e.byteLength+10+t.byteLength+25]=1,r[e.byteLength+10+t.byteLength+26]=(65280&n.byteLength)>>8,r[e.byteLength+10+t.byteLength+27]=255&n.byteLength,r.set(n,e.byteLength+10+t.byteLength+28),r}(t.fullData,n.fullData,i.fullData,{Mf:r.Mf,ig:r.ig,tf:e.tf,uf:e.uf,lf:e.lf,rf:e.rf,mf:e.mf,nf:e.nf,pf:e.pf,qf:e.qf,ef:e.ef,ff:e.ff,gf:e.gf,hf:e.hf,jf:e.jf,kf:e.kf,Ye:e.Ye,ge:e.ge,We:e.We,Ve:e.Ve,Ue:e.Ue,Of:s.Of}),{height:e.height,width:e.width,za:t,Fa:e.jj,Ha:e.ij}}function b_(e,t){var n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){var a=e[t+3]>>6;r=1e3*__[14*(3===n?3-i:3===i?3:4)+r-1],s=w_[3*(3===n?0:2===n?1:2)+s],n=E_[n][i];var o=k_[i],l=Math.floor(n*r/s+(e[t+2]>>1&1))*o,u=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(u=u?parseInt(u[1],10):0)&&87>=u&&2===i&&224e3<=r&&0===a&&(e[t+3]|=128),{sampleRate:s,channelCount:3===a?1:2,fa:l,hj:8*n*o}}return null}function T_(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function S_(e,t){if(t+1<e.length&&T_(e,t)){var n=b_(e,t),i=4;return n&&n.fa&&(i=n.fa),(t+=i)===e.length||t+1<e.length&&T_(e,t)}return!1}var __=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],w_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],E_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],k_=[0,1,1,4];function x_(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function A_(e){this.h=e,this.g=null}function C_(e){this.h=e,(this.g=hm.get("ISOBoxer")())&&function(e){function t(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,(function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,(function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32)})))}))}e.g.addBoxProcessor("saio",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)})),e.g.addBoxProcessor("saiz",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)})),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",(function(){for(var e=!0,n=0;16>n;n++)this.usertype[n]!==L_[n]&&(e=!1);e&&(this._parsing&&(this.type="sepiff"),t.call(this))}))}(this)}function I_(e,t){for(var n=8,i=0;i<e.boxes.length&&e.boxes[i].type!==t;i++)n+=e.boxes[i].size;return n}(i=x_.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/mpeg"==e.toLowerCase().split(";")[0]&&ie(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/mpeg"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="mp3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=me(e),s=Ha(r).length;s<r.length&&!S_(r,s);s++);var a;for(e=[];s<r.length;){var o=b_(r,s);if(!o)return Promise.reject(new Me(2,3,3018,n?n.N()[0]:null));a||(a=o),s+o.fa<=r.length&&e.push({data:r.subarray(s,s+o.fa),size:o.fa,duration:1152,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),s+=o.fa}return a?(r=9e4*a.hj/a.sampleRate*this.h,i=new Fy([i={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:a.sampleRate,duration:i,lb:[],ra:new Uint8Array([]),za:new Uint8Array([]),Fa:0,Ha:0,data:{Cb:this.h,baseMediaDecodeTime:r,jb:e},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=By(i),this.g.set(n,t)),n=this.i!==t,i=qy(i),this.i=t,this.h++,n?(t=pi(t,i),Promise.resolve(t)):Promise.resolve(i)):Promise.reject(new Me(2,3,3018,n?n.N()[0]:null))},$("shaka.transmuxer.Mp3Transmuxer",x_),x_.prototype.transmux=x_.prototype.transmux,x_.prototype.getOriginalMimeType=x_.prototype.getOriginalMimeType,x_.prototype.convertCodecs=x_.prototype.convertCodecs,x_.prototype.isSupported=x_.prototype.isSupported,x_.prototype.destroy=x_.prototype.destroy,Fn("audio/mpeg",(function(){return new x_("audio/mpeg")}),$n),(i=A_.prototype).destroy=function(){},i.isSupported=function(e){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var t=Pi(e).split(","),n=bi("audio",t);return t=bi("video",t),!(!n||t||"mp3"!=Di(n))&&ie(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?"audio/mpeg":t},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n,i,r){if(this.g?this.g.clearData():this.g=new co,e=me(e),"mp3"!=(e=this.g.parse(e)).ld().audio||"audio"!=r)return Promise.reject(new Me(2,3,3018,n?n.N()[0]:null));for(n=new Uint8Array([]),r=c(e.fb()),e=r.next();!e.done;e=r.next())if(e=e.value.data)for(t=0;t<e.length;)(i=b_(e,t))?(t+i.fa<=e.length&&(n=pi(n,e.subarray(t,t+i.fa))),t+=i.fa):t++;return Promise.resolve(n)},$("shaka.transmuxer.MpegTsTransmuxer",A_),A_.prototype.transmux=A_.prototype.transmux,A_.prototype.getOriginalMimeType=A_.prototype.getOriginalMimeType,A_.prototype.convertCodecs=A_.prototype.convertCodecs,A_.prototype.isSupported=A_.prototype.isSupported,A_.prototype.destroy=A_.prototype.destroy,Fn("video/mp2t",(function(){return new A_("video/mp2t")}),Vn),(i=C_.prototype).destroy=function(){},i.isSupported=function(e,t){var n=e.startsWith("mss/");return!(!this.g||!n)&&(t?ie(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),ie(t)||ie(e)))},i.convertCodecs=function(e,t){return t.replace("mss/","")},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n){if(!n)return Promise.resolve(me(e));if(!t.mssPrivateData)return Promise.reject(new Me(2,3,3020,n?n.N()[0]:null));try{var i,r=this.g.parseBuffer(e),s=r.fetch("tfhd");s.track_ID=t.id+1;var a=r.fetch("tfdt"),o=r.fetch("traf");null===a&&((a=this.g.createFullBox("tfdt",o,s)).version=1,a.flags=0,a.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var l=r.fetch("trun"),u=r.fetch("tfxd");u&&u._parent.boxes.splice(u._parent.boxes.indexOf(u),1);var c=r.fetch("tfrf");c&&c._parent.boxes.splice(c._parent.boxes.indexOf(c),1);var d=r.fetch("sepiff");if(null!==d){d.type="senc",d.usertype=void 0;var h=r.fetch("saio");if(null===h){(h=this.g.createFullBox("saio",o)).version=0,h.flags=0,h.entry_count=1,h.offset=[0];var f=this.g.createFullBox("saiz",o);if(f.version=0,f.flags=0,f.sample_count=d.sample_count,f.default_sample_info_size=0,f.sample_info_size=[],2&d.flags)for(i=0;i<d.sample_count;i+=1)f.sample_info_size[i]=10+6*d.entry[i].NumberOfEntries;else f.default_sample_info_size=8}}s.flags&=16777214,s.flags|=131072,l.flags|=1;var p=r.fetch("moof");l.data_offset=p.getLength()+8;var g=r.fetch("saio");null!==g&&(g.offset[0]=I_(p,"traf")+I_(o,"senc")+16);var m=me(r.write());return Promise.resolve(m)}catch(y){return y instanceof Me?Promise.reject(y):Promise.reject(new Me(2,3,3022,n?n.N()[0]:null))}},$("shaka.transmuxer.MssTransmuxer",C_),C_.prototype.transmux=C_.prototype.transmux,C_.prototype.getOriginalMimeType=C_.prototype.getOriginalMimeType,C_.prototype.convertCodecs=C_.prototype.convertCodecs,C_.prototype.isSupported=C_.prototype.isSupported,C_.prototype.destroy=C_.prototype.destroy;var L_=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);function D_(e){this.m=e,this.g=0,this.i=new Map,this.l=this.h=this.j=null}Fn("mss/audio/mp4",(function(){return new C_("mss/audio/mp4")}),$n),Fn("mss/video/mp4",(function(){return new C_("mss/video/mp4")}),$n),(i=D_.prototype).destroy=function(){this.i.clear(),this.h&&this.h.destroy()},i.isSupported=function(e,t){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var n=e;t&&(n=this.convertCodecs(t,e));var i=Pi(n).split(",");return n=bi("audio",i),i=bi("video",i),!(n&&(n=Di(n),!P_.includes(n))||i&&(n=Di(i),!O_.includes(n)))&&(t?ie(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),ie(t)||ie(e)))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?(t=Pi(t).replace("mp4a.40.34","mp3").split(",").map((function(e){return gr(e,"audio/mp4")})).map(mr).join(","),"audio"==e?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},i.getOriginalMimeType=function(){return this.m},i.transmux=function(e,t,n,i,r){var s=me(e);if("audio"==r&&!go(s)){for(var a=Ha(s),o=a.length;o<s.length;o++)if(S_(s,o))return Promise.reject(new Me(2,3,3018,n?n.N()[0]:null));for(o=a.length;o<s.length;o++)if(c_(s,o))return this.h||(this.h=new d_("audio/aac")),this.h.transmux(e,t,n,i,r);return Promise.reject(new Me(2,3,3018,n?n.N()[0]:null))}this.j?this.j.clearData():this.j=new co;var l=this.j.parse(s),u=[],h=l.ld();try{var f=null;if("video"==r){switch(h.video){case"avc":var p=[],g=null,m=l.uc(),y=function(e){function t(e){r={data:new Uint8Array([]),frame:!1,isKeyframe:!1,pts:e.pts,dts:e.dts,nalus:[]}}function n(){if(r&&r.nalus.length&&r.frame){for(var e=[],t=c(r.nalus),n=t.next();!n.done;n=t.next()){var s=(n=n.value).fullData.byteLength,a=new Uint8Array(4);a[0]=s>>24&255,a[1]=s>>16&255,a[2]=s>>8&255,a[3]=255&s,e.push(a),e.push(n.fullData)}r.data=pi.apply(li,d(e)),i.push(r)}}for(var i=[],r=null,s=!1,a=0;a<e.length;a++){var o=e[a],l=o.nalus,u=!1;r&&l.length&&!s&&(n(),t(o));for(var h=(l=c(o.nalus)).next();!h.done;h=l.next()){var f=!1;switch((h=h.value).type){case 1:var p=!1;f=!0;var g=h.data;u&&4<g.length&&(2===(g=uo(new Ja(g)))||4===g||7===g||9===g)&&(p=!0),p&&r&&r.frame&&!r.isKeyframe&&(n(),r=null),r||t(o),r.frame=!0,r.isKeyframe=p;break;case 5:f=!0,r&&r.frame&&!r.isKeyframe&&(n(),r=null),r||t(o),r.frame=!0,r.isKeyframe=!0;break;case 6:case 8:case 12:f=!0;break;case 7:u=f=!0;break;case 9:s=f=!0,r&&r.frame&&(n(),r=null),r||t(o);break;default:f=!1}r&&f&&r.nalus.push(h)}}return n(),i}(m);if(!y.length)throw new Me(2,3,3023,n?n.N()[0]:null);for(var v=0;v<y.length;v++){var b=y[v];null==g&&(g=b.dts);var T;T=v+1<y.length?(y[v+1].dts||0)-(b.dts||0):1<y.length?(b.dts||0)-(y[v-1].dts||0):9e4*(n.endTime-n.startTime),p.push({data:b.data,size:b.data.byteLength,duration:T,eb:Math.round((b.pts||0)-(b.dts||0)),flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:b.isKeyframe?2:1,ib:b.isKeyframe?0:1}})}for(var S=[],_=c(m),w=_.next();!w.done;w=_.next())S.push.apply(S,d(w.value.nalus));var E=function(e){if(!e.length)return null;var t=e.find((function(e){return 7==e.type}));if(e=e.find((function(e){return 8==e.type})),!t||!e)return null;var n=new Ja(t.data),i=oo(n);if(oo(n),oo(n),io(n),y_.includes(i)&&(3===(i=ro(n))&&eo(n,1),io(n),io(n),eo(n,1),ao(n))){i=3!==i?8:12;for(var r=0;r<i;r++)ao(n)&&lo(n,6>r?16:64)}if(io(n),0===(i=ro(n)))ro(n);else if(1===i)for(eo(n,1),io(n),io(n),i=ro(n),r=0;r<i;r++)io(n);io(n),eo(n,1);var s=ro(n),a=ro(n),o=to(n,1);0===o&&eo(n,1),eo(n,1);var l=0,u=0,c=0,h=0;if(ao(n)&&(l=ro(n),u=ro(n),c=ro(n),h=ro(n)),r=i=1,ao(n)&&ao(n)){var f=oo(n);0<f&&16>=f?(i=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][f-1],r=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][f-1]):255===f&&(i=to(n,16),r=to(n,16))}return n=(2-o)*(a+1)*16-2*c-2*h,s=16*(s+1)-2*l-2*u,l=[],t=t.fullData,l.push(t.byteLength>>>8&255),l.push(255&t.byteLength),l=l.concat.apply(l,d(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(255&e.byteLength),t=t.concat.apply(t,d(e)),{height:n,width:s,za:e=new Uint8Array([1,l[3],l[4],l[5],255,225].concat(l,[1],t)),Fa:i,Ha:r}}(S);if(!E||null==g)throw new Me(2,3,3018,n?n.N()[0]:null);t.height=E.height,t.width=E.width,f={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,lb:[],ra:new Uint8Array([]),za:E.za,Fa:E.Fa,Ha:E.Ha,data:{Cb:this.g,baseMediaDecodeTime:g,jb:p},stream:t};break;case"hvc":var k=[],x=null,A=[],C=l.uc();if(!C.length)throw new Me(2,3,3023,n?n.N()[0]:null);for(var I=0;I<C.length;I++){var L=C[I],D=L.nalus;A.push.apply(A,d(D));for(var R=!1,M=[],P=!1,O=c(D),N=O.next();!N.done;N=O.next()){var U=N.value;switch(U.type){case 1:case 0:var F=P=!0;break;case 19:case 20:case 21:R=F=P=!0;break;case 32:case 33:case 34:case 39:case 40:F=!0;break;case 35:P=F=!0;break;default:F=!1}if(P&&F){var B=U.fullData.byteLength,j=new Uint8Array(4);j[0]=B>>24&255,j[1]=B>>16&255,j[2]=B>>8&255,j[3]=255&B,M.push(j),M.push(U.fullData)}}var $=M.length?{data:pi.apply(li,d(M)),isKeyframe:R}:null;if($){null==x&&null!=L.dts&&(x=L.dts);var V;V=I+1<C.length?(C[I+1].dts||0)-(L.dts||0):1<C.length?(L.dts||0)-(C[I-1].dts||0):9e4*(n.endTime-n.startTime),k.push({data:$.data,size:$.data.byteLength,duration:V,eb:Math.round((L.pts||0)-(L.dts||0)),flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:$.isKeyframe?2:1,ib:$.isKeyframe?0:1}})}}var H=v_(A);if(!H||null==x)throw new Me(2,3,3018,n?n.N()[0]:null);t.height=H.height,t.width=H.width,f={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,lb:[],ra:new Uint8Array([]),za:H.za,Fa:H.Fa,Ha:H.Ha,data:{Cb:this.g,baseMediaDecodeTime:x,jb:k},stream:t}}f&&(u.push(f),f=null)}if("audio"==r){switch(h.audio){case"aac":for(var q,G=[],z=null,K=null,W=null,X=c(l.fb()),Y=X.next();!Y.done;Y=X.next()){var Q=Y.value,J=Q.data;if(J){var Z=0;if(-1==K&&W)J=pi(W,Q.data),K=null;else if(null!=K&&W){Z=Math.max(0,K);var ee=pi(W,J.subarray(0,Z));G.push({data:ee,size:ee.byteLength,duration:1024,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),K=W=null}if(!(q=u_(J,Z)))throw new Me(2,3,3018,n?n.N()[0]:null);for(t.audioSamplingRate=q.sampleRate,t.channelsCount=q.channelCount,null==z&&null!==Q.pts&&(z=Q.pts);Z<J.length;){var te=l_(J,Z);if(!te){W=J.subarray(Z,J.length),K=-1;break}var ne=te.sd+te.fa;0!=(K=Math.max(0,Z+ne-J.length))?W=J.subarray(Z+te.sd,Z+ne):Z+ne<=J.length&&G.push({data:J.subarray(Z+te.sd,Z+ne),size:te.fa,duration:1024,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),Z+=ne}}}if(!q||null==z){if(!l.uc().length)throw new Me(2,3,3018,n?n.N()[0]:null);z=9e4*n.startTime;var ie=bi("audio",t.codecs.split(","));if(!ie||!t.channelsCount||!t.audioSamplingRate)throw new Me(2,3,3018,n?n.N()[0]:null);q={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,codec:ie};var re=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}(ie,t.channelsCount);if(!re)throw new Me(2,3,3018,n?n.N()[0]:null);for(var se=z+9e4*(n.endTime-n.startTime),ae=z;ae<se;)G.push({data:re,size:re.byteLength,duration:1024,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),ae+=1024/q.sampleRate*9e4}var oe=q.sampleRate,le=z/9e4*oe;f={id:t.id,type:"audio",codecs:q.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:oe,duration:i,lb:[],ra:new Uint8Array([]),za:new Uint8Array([]),Fa:0,Ha:0,data:{Cb:this.g,baseMediaDecodeTime:le,jb:G},stream:t};break;case"ac3":for(var ue=[],ce=0,de=new Uint8Array([]),he=null,fe=c(l.fb()),pe=fe.next();!pe.done;pe=fe.next()){var ge=pe.value,ye=ge.data;null==he&&null!==ge.pts&&(he=ge.pts);for(var ve=0;ve<ye.length;){var be=h_(ye,ve);be?(t.audioSamplingRate=be.sampleRate,t.channelsCount=be.channelCount,ce=be.sampleRate,de=be.ra,ue.push({data:ye.subarray(ve,ve+be.fa),size:be.fa,duration:1536,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),ve+=be.fa):ve++}}if(0==ce||0==de.byteLength||null==he)throw new Me(2,3,3018,n?n.N()[0]:null);var Te=he/9e4*ce;f={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:ce,duration:i,lb:[],ra:de,za:new Uint8Array([]),Fa:0,Ha:0,data:{Cb:this.g,baseMediaDecodeTime:Te,jb:ue},stream:t};break;case"ec3":for(var Se=[],_e=0,we=new Uint8Array([]),Ee=null,ke=c(l.fb()),xe=ke.next();!xe.done;xe=ke.next()){var Ae=xe.value,Ce=Ae.data;null==Ee&&null!==Ae.pts&&(Ee=Ae.pts);for(var Ie=0;Ie<Ce.length;){var Le=g_(Ce,Ie);Le?(t.audioSamplingRate=Le.sampleRate,t.channelsCount=Le.channelCount,_e=Le.sampleRate,we=Le.ra,Se.push({data:Ce.subarray(Ie,Ie+Le.fa),size:Le.fa,duration:1536,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),Ie+=Le.fa):Ie++}}if(0==_e||0==we.byteLength||null==Ee)throw new Me(2,3,3018,n?n.N()[0]:null);var De=Ee/9e4*_e;f={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:_e,duration:i,lb:[],ra:we,za:new Uint8Array([]),Fa:0,Ha:0,data:{Cb:this.g,baseMediaDecodeTime:De,jb:Se},stream:t};break;case"mp3":for(var Re,Pe=[],Oe=null,Ne=c(l.fb()),Ue=Ne.next();!Ue.done;Ue=Ne.next()){var Fe=Ue.value,Be=Fe.data;if(Be){null==Oe&&null!==Fe.pts&&(Oe=Fe.pts);for(var je=0;je<Be.length;){var $e=b_(Be,je);$e?(Re||(Re=$e),je+$e.fa<=Be.length&&Pe.push({data:Be.subarray(je,je+$e.fa),size:$e.fa,duration:1152,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),je+=$e.fa):je++}}}if(!Re||null==Oe)throw new Me(2,3,3018,n?n.N()[0]:null);var Ve=Re.sampleRate,He=Oe/9e4*Ve;f={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Ve,duration:i,lb:[],ra:new Uint8Array([]),za:new Uint8Array([]),Fa:0,Ha:0,data:{Cb:this.g,baseMediaDecodeTime:He,jb:Pe},stream:t};break;case"opus":var qe=[],Ge=null,ze=l.F;if(!ze)throw new Me(2,3,3018,n?n.N()[0]:null);var Ke=[];switch(ze.Qh){case 1:case 2:Ke=[0];break;case 0:Ke=[255,1,1,0,1];break;case 128:Ke=[255,2,0,0,1];break;case 3:Ke=[1,2,1,0,2,1];break;case 4:Ke=[1,2,2,0,1,2,3];break;case 5:Ke=[1,3,2,0,4,1,2,3];break;case 6:Ke=[1,4,2,0,4,1,2,3,5];break;case 7:Ke=[1,4,2,0,4,1,2,3,5,6];break;case 8:Ke=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:Ke=[1,1,2,0,1];break;case 131:Ke=[1,1,3,0,1,2];break;case 132:Ke=[1,1,4,0,1,2,3];break;case 133:Ke=[1,1,5,0,1,2,3,4];break;case 134:Ke=[1,1,6,0,1,2,3,4,5];break;case 135:Ke=[1,1,7,0,1,2,3,4,5,6];break;case 136:Ke=[1,1,8,0,1,2,3,4,5,6,7]}for(var We=new Uint8Array([0,ze.channelCount,0,0,ze.sampleRate>>>24&255,ze.sampleRate>>>17&255,ze.sampleRate>>>8&255,ze.sampleRate>>>0&255,0,0].concat(d(Ke))),Xe=ze.sampleRate,Ye=c(l.fb()),Qe=Ye.next();!Qe.done;Qe=Ye.next()){var Je=Qe.value,Ze=Je.data;null==Ge&&null!==Je.pts&&(Ge=Je.pts);for(var et=0;et<Ze.length;){for(var tt=0!==(16&Ze[et+1]),nt=0!==(8&Ze[et+1]),it=et+2,rt=0;255===Ze[it];)rt+=255,it+=1;rt+=Ze[it],it+=1,it+=tt?2:0,it+=nt?2:0;var st=Ze.slice(it,it+rt);qe.push({data:st,size:st.byteLength,duration:960,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),et=it+rt}}if(0==We.byteLength||null==Ge)throw new Me(2,3,3018,n?n.N()[0]:null);t.audioSamplingRate=ze.sampleRate,t.channelsCount=ze.channelCount;var at=Ge/9e4*Xe;f={id:t.id,type:"audio",codecs:"opus",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Xe,duration:i,lb:[],ra:We,za:new Uint8Array([]),Fa:0,Ha:0,data:{Cb:this.g,baseMediaDecodeTime:at,jb:qe},stream:t}}f&&(u.push(f),f=null)}}catch(ft){return ft&&3023==ft.code?Promise.resolve(new Uint8Array([])):Promise.reject(ft)}if(!u.length)return Promise.reject(new Me(2,3,3018,n?n.N()[0]:null));var ot=new Fy(u),lt=t.id+"_"+n.i;if(this.i.has(lt))var ut=this.i.get(lt);else ut=By(ot),this.i.set(lt,ut);var ct=this.l!==ut,dt=qy(ot);if(this.l=ut,this.g++,ct){var ht=pi(ut,dt);return Promise.resolve(ht)}return Promise.resolve(dt)},$("shaka.transmuxer.TsTransmuxer",D_),D_.prototype.transmux=D_.prototype.transmux,D_.prototype.getOriginalMimeType=D_.prototype.getOriginalMimeType,D_.prototype.convertCodecs=D_.prototype.convertCodecs,D_.prototype.isSupported=D_.prototype.isSupported,D_.prototype.destroy=D_.prototype.destroy;var R_,M_,P_=["aac","ac-3","ec-3","mp3","opus"],O_=["avc","hevc"];function N_(){}function U_(){R_||navigator.emeEncryptionSchemePolyfilled?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(R_=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=F_,navigator.emeEncryptionSchemePolyfilled=!0):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function F_(e,t){var n,i=this;return M((function(r){return 1==r.g?(console.assert(i==navigator,'bad "this" for requestMediaKeySystemAccess'),S(r,R_.call(i,e,t),2)):W_(n=r.h)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=R_,r.return(n)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=B_,r.return(B_.call(i,e,t)))}))}function B_(e,t){var n,i,r,s,a,o,l,u,d,h,f,p,g=this;return M((function(m){if(1==m.g){for(console.assert(g==navigator,'bad "this" for requestMediaKeySystemAccess'),n=K_(e),i=[],r=c(t),s=r.next();!s.done;s=r.next())a=s.value,o=j_(a.videoCapabilities,n),l=j_(a.audioCapabilities,n),a.videoCapabilities&&a.videoCapabilities.length&&!o.length||a.audioCapabilities&&a.audioCapabilities.length&&!l.length||((u=Object.assign({},a)).videoCapabilities=o,u.audioCapabilities=l,i.push(u));if(!i.length)throw(d=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",d.code=DOMException.NOT_SUPPORTED_ERR,d;return S(m,R_.call(g,e,i),2)}return h=m.h,p=f=null,i[0]&&(i[0].videoCapabilities&&(f=i[0].videoCapabilities[0].encryptionScheme),i[0].audioCapabilities&&(p=i[0].audioCapabilities[0].encryptionScheme)),m.return(new z_(h,f,p))}))}function j_(e,t){return e?e.filter((function(e){return X_(e.encryptionScheme,t)})):e}function $_(){}function V_(){M_||navigator.mediaCapabilitiesEncryptionSchemePolyfilled?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(M_=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=H_,navigator.mediaCapabilitiesEncryptionSchemePolyfilled=!0):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function H_(e){var t,n,i=this;return M((function(r){switch(r.g){case 1:return console.assert(i==navigator.mediaCapabilities,'bad "this" for decodingInfo'),S(r,M_.call(i,e),2);case 2:if(!(t=r.h).supported||!e.keySystemConfiguration)return r.return(t);if((n=t.keySystemAccess)&&W_(n))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=M_,r.return(t);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=q_,n){r.u(3);break}return S(r,G_(e),4);case 4:return t.keySystemAccess=r.h,r.return(t);case 3:return r.return(q_.call(i,e))}}))}function q_(e){var t,n,i,r,s,a,o,l=this;return M((function(u){switch(u.g){case 1:return console.assert(l==navigator.mediaCapabilities,'bad "this" for decodingInfo'),n=t=null,!e.keySystemConfiguration||(i=e.keySystemConfiguration,r=i.keySystem,n=i.audio&&i.audio.encryptionScheme,t=i.video&&i.video.encryptionScheme,s=K_(r),a={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},X_(n,s)&&X_(t,s))?S(u,M_.call(l,e),2):u.return(a);case 2:if((o=u.h).keySystemAccess){o.keySystemAccess=new z_(o.keySystemAccess,t,n),u.u(3);break}if(!e.keySystemConfiguration){u.u(3);break}return S(u,G_(e),5);case 5:o.keySystemAccess=u.h;case 3:return u.return(o)}}))}function G_(e){var t,n;return M((function(i){if(1==i.g){var r=e.keySystemConfiguration,s=[],a=[];return r.audio&&s.push({robustness:r.audio.robustness||"",contentType:e.audio.contentType,encryptionScheme:r.audio.encryptionScheme}),r.video&&a.push({robustness:r.video.robustness||"",contentType:e.video.contentType,encryptionScheme:r.video.encryptionScheme}),r={initDataTypes:r.initDataType?[r.initDataType]:[],distinctiveIdentifier:r.distinctiveIdentifier,persistentState:r.persistentState,sessionTypes:r.sessionTypes},s.length&&(r.audioCapabilities=s),a.length&&(r.videoCapabilities=a),t=r,S(i,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=i.h,i.return(n)}))}function z_(e,t,n){this.g=e,this.i=t||null,this.h=n||null,this.keySystem=e.keySystem}function K_(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs":e.startsWith("com.huawei")?"cenc":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function W_(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function X_(e,t){return!e||e==t||!("cbcs"!=e&&"cbcs-1-9"!=e||!(ew||iw||Z_))}function Y_(){}function Q_(){U_(),V_()}Fn("video/mp2t",(function(){return new D_("video/mp2t")}),Hn),$("EmeEncryptionSchemePolyfill",N_),N_.install=U_,$("McEncryptionSchemePolyfill",$_),$_.install=V_,z_.prototype.getConfiguration=function(){var e=this.g.getConfiguration();if(e.videoCapabilities)for(var t=c(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.i;if(e.audioCapabilities)for(n=(t=c(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.h;return e},z_.prototype.createMediaKeys=function(){return this.g.createMediaKeys()},$("EncryptionSchemePolyfills",Y_),Y_.install=Q_;var J_,Z_=navigator.userAgent.includes("CrKey"),ew=100<=parseInt(navigator.userAgent.split("Firefox/").pop(),10),tw=navigator.userAgent||"";if(tw.includes("Web0S")){var nw=tw.match(/Chrome\/(\d+)/);J_=!!nw&&79<=parseInt(nw[1],10)}else J_=!1;var iw=J_;"undefined"!==typeof n&&n.exports&&(n.exports=Y_)}.call(i,e,e,void 0),i.shaka)t[r]=i.shaka[r]}()},579:(e,t,n)=>{"use strict";e.exports=n(153)},634:e=>{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},699:(e,t,n)=>{var i=n(923),r=i.find,s=i.NAMESPACE;function a(e){return""!==e}function o(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function l(e){if(!e)return[];var t=function(e){return e?e.split(/[\t\n\f\r ]+/).filter(a):[]}(e);return Object.keys(t.reduce(o,{}))}function u(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function c(e,t){var n=e.prototype;if(!(n instanceof t)){function i(){}i.prototype=t.prototype,u(n,i=new i),e.prototype=n=i}n.constructor!=e&&("function"!=typeof e&&console.error("unknown Class:"+e),n.constructor=e)}var d={},h=d.ELEMENT_NODE=1,f=d.ATTRIBUTE_NODE=2,p=d.TEXT_NODE=3,g=d.CDATA_SECTION_NODE=4,m=d.ENTITY_REFERENCE_NODE=5,y=d.ENTITY_NODE=6,v=d.PROCESSING_INSTRUCTION_NODE=7,b=d.COMMENT_NODE=8,T=d.DOCUMENT_NODE=9,S=d.DOCUMENT_TYPE_NODE=10,_=d.DOCUMENT_FRAGMENT_NODE=11,w=d.NOTATION_NODE=12,E={},k={},x=(E.INDEX_SIZE_ERR=(k[1]="Index size error",1),E.DOMSTRING_SIZE_ERR=(k[2]="DOMString size error",2),E.HIERARCHY_REQUEST_ERR=(k[3]="Hierarchy request error",3)),A=(E.WRONG_DOCUMENT_ERR=(k[4]="Wrong document",4),E.INVALID_CHARACTER_ERR=(k[5]="Invalid character",5),E.NO_DATA_ALLOWED_ERR=(k[6]="No data allowed",6),E.NO_MODIFICATION_ALLOWED_ERR=(k[7]="No modification allowed",7),E.NOT_FOUND_ERR=(k[8]="Not found",8)),C=(E.NOT_SUPPORTED_ERR=(k[9]="Not supported",9),E.INUSE_ATTRIBUTE_ERR=(k[10]="Attribute in use",10));E.INVALID_STATE_ERR=(k[11]="Invalid state",11),E.SYNTAX_ERR=(k[12]="Syntax error",12),E.INVALID_MODIFICATION_ERR=(k[13]="Invalid modification",13),E.NAMESPACE_ERR=(k[14]="Invalid namespace",14),E.INVALID_ACCESS_ERR=(k[15]="Invalid access",15);function I(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,k[e]),this.message=k[e],Error.captureStackTrace&&Error.captureStackTrace(this,I);return n.code=e,t&&(this.message=this.message+": "+t),n}function L(){}function D(e,t){this._node=e,this._refresh=t,R(this)}function R(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var n=e._refresh(e._node);if(be(e,"length",n.length),!e.$$length||n.length<e.$$length)for(var i=n.length;i in e;i++)Object.prototype.hasOwnProperty.call(e,i)&&delete e[i];u(n,e),e._inc=t}}function M(){}function P(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function O(e,t,n,i){if(i?t[P(t,i)]=n:t[t.length++]=n,e){n.ownerElement=e;var r=e.ownerDocument;r&&(i&&V(r,e,i),function(e,t,n){e&&e._inc++;var i=n.namespaceURI;i===s.XMLNS&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(r,e,n))}}function N(e,t,n){var i=P(t,n);if(!(i>=0))throw new I(A,new Error(e.tagName+"@"+n));for(var r=t.length-1;i<r;)t[i]=t[++i];if(t.length=r,e){var s=e.ownerDocument;s&&(V(s,e,n),n.ownerElement=null)}}function U(){}function F(){}function B(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function j(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(j(e,t))return!0}while(e=e.nextSibling)}function $(){this.ownerDocument=this}function V(e,t,n,i){e&&e._inc++,n.namespaceURI===s.XMLNS&&delete t._nsMap[n.prefix?n.localName:""]}function H(e,t,n){if(e&&e._inc){e._inc++;var i=t.childNodes;if(n)i[i.length++]=n;else{for(var r=t.firstChild,s=0;r;)i[s++]=r,r=r.nextSibling;i.length=s,delete i[i.length]}}}function q(e,t){var n=t.previousSibling,i=t.nextSibling;return n?n.nextSibling=i:e.firstChild=i,i?i.previousSibling=n:e.lastChild=n,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,H(e.ownerDocument,e),t}function G(e){return e&&e.nodeType===F.DOCUMENT_TYPE_NODE}function z(e){return e&&e.nodeType===F.ELEMENT_NODE}function K(e){return e&&e.nodeType===F.TEXT_NODE}function W(e,t){var n=e.childNodes||[];if(r(n,z)||G(t))return!1;var i=r(n,G);return!(t&&i&&n.indexOf(i)>n.indexOf(t))}function X(e,t){var n=e.childNodes||[];if(r(n,(function(e){return z(e)&&e!==t})))return!1;var i=r(n,G);return!(t&&i&&n.indexOf(i)>n.indexOf(t))}function Y(e,t,n){if(!function(e){return e&&(e.nodeType===F.DOCUMENT_NODE||e.nodeType===F.DOCUMENT_FRAGMENT_NODE||e.nodeType===F.ELEMENT_NODE)}(e))throw new I(x,"Unexpected parent node type "+e.nodeType);if(n&&n.parentNode!==e)throw new I(A,"child not in parent");if(!function(e){return e&&(z(e)||K(e)||G(e)||e.nodeType===F.DOCUMENT_FRAGMENT_NODE||e.nodeType===F.COMMENT_NODE||e.nodeType===F.PROCESSING_INSTRUCTION_NODE)}(t)||G(t)&&e.nodeType!==F.DOCUMENT_NODE)throw new I(x,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)}function Q(e,t,n){var i=e.childNodes||[],s=t.childNodes||[];if(t.nodeType===F.DOCUMENT_FRAGMENT_NODE){var a=s.filter(z);if(a.length>1||r(s,K))throw new I(x,"More than one element or text in fragment");if(1===a.length&&!W(e,n))throw new I(x,"Element in fragment can not be inserted before doctype")}if(z(t)&&!W(e,n))throw new I(x,"Only one element can be added and only after doctype");if(G(t)){if(r(i,G))throw new I(x,"Only one doctype is allowed");var o=r(i,z);if(n&&i.indexOf(o)<i.indexOf(n))throw new I(x,"Doctype can only be inserted before an element");if(!n&&o)throw new I(x,"Doctype can not be appended since element is present")}}function J(e,t,n){var i=e.childNodes||[],s=t.childNodes||[];if(t.nodeType===F.DOCUMENT_FRAGMENT_NODE){var a=s.filter(z);if(a.length>1||r(s,K))throw new I(x,"More than one element or text in fragment");if(1===a.length&&!X(e,n))throw new I(x,"Element in fragment can not be inserted before doctype")}if(z(t)&&!X(e,n))throw new I(x,"Only one element can be added and only after doctype");if(G(t)){if(r(i,(function(e){return G(e)&&e!==n})))throw new I(x,"Only one doctype is allowed");var o=r(i,z);if(n&&i.indexOf(o)<i.indexOf(n))throw new I(x,"Doctype can only be inserted before an element")}}function Z(e,t,n,i){Y(e,t,n),e.nodeType===F.DOCUMENT_NODE&&(i||Q)(e,t,n);var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===_){var s=t.firstChild;if(null==s)return t;var a=t.lastChild}else s=a=t;var o=n?n.previousSibling:e.lastChild;s.previousSibling=o,a.nextSibling=n,o?o.nextSibling=s:e.firstChild=s,null==n?e.lastChild=a:n.previousSibling=a;do{s.parentNode=e}while(s!==a&&(s=s.nextSibling));return H(e.ownerDocument||e,e),t.nodeType==_&&(t.firstChild=t.lastChild=null),t}function ee(){this._nsMap={}}function te(){}function ne(){}function ie(){}function re(){}function se(){}function ae(){}function oe(){}function le(){}function ue(){}function ce(){}function de(){}function he(){}function fe(e,t){var n=[],i=9==this.nodeType&&this.documentElement||this,r=i.prefix,s=i.namespaceURI;if(s&&null==r&&null==(r=i.lookupPrefix(s)))var a=[{namespace:s,prefix:null}];return me(this,n,e,t,a),n.join("")}function pe(e,t,n){var i=e.prefix||"",r=e.namespaceURI;if(!r)return!1;if("xml"===i&&r===s.XML||r===s.XMLNS)return!1;for(var a=n.length;a--;){var o=n[a];if(o.prefix===i)return o.namespace!==r}return!0}function ge(e,t,n){e.push(" ",t,'="',n.replace(/[<>&"\t\n\r]/g,B),'"')}function me(e,t,n,i,r){if(r||(r=[]),i){if(!(e=i(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case h:var a=e.attributes,o=a.length,l=e.firstChild,u=e.tagName,c=u;if(!(n=s.isHTML(e.namespaceURI)||n)&&!e.prefix&&e.namespaceURI){for(var d,y=0;y<a.length;y++)if("xmlns"===a.item(y).name){d=a.item(y).value;break}if(!d)for(var w=r.length-1;w>=0;w--){if(""===(E=r[w]).prefix&&E.namespace===e.namespaceURI){d=E.namespace;break}}if(d!==e.namespaceURI)for(w=r.length-1;w>=0;w--){var E;if((E=r[w]).namespace===e.namespaceURI){E.prefix&&(c=E.prefix+":"+u);break}}}t.push("<",c);for(var k=0;k<o;k++){"xmlns"==(x=a.item(k)).prefix?r.push({prefix:x.localName,namespace:x.value}):"xmlns"==x.nodeName&&r.push({prefix:"",namespace:x.value})}for(k=0;k<o;k++){var x,A,C;if(pe(x=a.item(k),0,r))ge(t,(A=x.prefix||"")?"xmlns:"+A:"xmlns",C=x.namespaceURI),r.push({prefix:A,namespace:C});me(x,t,n,i,r)}if(u===c&&pe(e,0,r))ge(t,(A=e.prefix||"")?"xmlns:"+A:"xmlns",C=e.namespaceURI),r.push({prefix:A,namespace:C});if(l||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(t.push(">"),n&&/^script$/i.test(u))for(;l;)l.data?t.push(l.data):me(l,t,n,i,r.slice()),l=l.nextSibling;else for(;l;)me(l,t,n,i,r.slice()),l=l.nextSibling;t.push("</",c,">")}else t.push("/>");return;case T:case _:for(l=e.firstChild;l;)me(l,t,n,i,r.slice()),l=l.nextSibling;return;case f:return ge(t,e.name,e.value);case p:return t.push(e.data.replace(/[<&>]/g,B));case g:return t.push("<![CDATA[",e.data,"]]>");case b:return t.push("\x3c!--",e.data,"--\x3e");case S:var I=e.publicId,L=e.systemId;if(t.push("<!DOCTYPE ",e.name),I)t.push(" PUBLIC ",I),L&&"."!=L&&t.push(" ",L),t.push(">");else if(L&&"."!=L)t.push(" SYSTEM ",L,">");else{var D=e.internalSubset;D&&t.push(" [",D,"]"),t.push(">")}return;case v:return t.push("<?",e.target," ",e.data,"?>");case m:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ye(e,t,n){var i;switch(t.nodeType){case h:(i=t.cloneNode(!1)).ownerDocument=e;case _:break;case f:n=!0}if(i||(i=t.cloneNode(!1)),i.ownerDocument=e,i.parentNode=null,n)for(var r=t.firstChild;r;)i.appendChild(ye(e,r,n)),r=r.nextSibling;return i}function ve(e,t,n){var i=new t.constructor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var s=t[r];"object"!=typeof s&&s!=i[r]&&(i[r]=s)}switch(t.childNodes&&(i.childNodes=new L),i.ownerDocument=e,i.nodeType){case h:var a=t.attributes,o=i.attributes=new M,l=a.length;o._ownerElement=i;for(var u=0;u<l;u++)i.setAttributeNode(ve(e,a.item(u),!0));break;case f:n=!0}if(n)for(var c=t.firstChild;c;)i.appendChild(ve(e,c,n)),c=c.nextSibling;return i}function be(e,t,n){e[t]=n}I.prototype=Error.prototype,u(E,I),L.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e,t){for(var n=[],i=0;i<this.length;i++)me(this[i],n,e,t);return n.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},D.prototype.item=function(e){return R(this),this[e]||null},c(D,L),M.prototype={length:0,item:L.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new I(C);var n=this.getNamedItem(e.nodeName);return O(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new I(C);return t=this.getNamedItemNS(e.namespaceURI,e.localName),O(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return N(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return N(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var i=this[n];if(i.localName==t&&i.namespaceURI==e)return i}return null}},U.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,n){var i=new $;if(i.implementation=this,i.childNodes=new L,i.doctype=n||null,n&&i.appendChild(n),t){var r=i.createElementNS(e,t);i.appendChild(r)}return i},createDocumentType:function(e,t,n){var i=new ae;return i.name=e,i.nodeName=e,i.publicId=t||"",i.systemId=n||"",i}},F.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return Z(this,e,t)},replaceChild:function(e,t){Z(this,e,t,J),t&&this.removeChild(t)},removeChild:function(e){return q(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return ve(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==p&&e.nodeType==p?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)&&n[i]===e)return i;t=t.nodeType==f?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&Object.prototype.hasOwnProperty.call(n,e))return n[e];t=t.nodeType==f?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},u(d,F),u(d,F.prototype),$.prototype={nodeName:"#document",nodeType:T,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==_){for(var n=e.firstChild;n;){var i=n.nextSibling;this.insertBefore(n,t),n=i}return e}return Z(this,e,t),e.ownerDocument=this,null===this.documentElement&&e.nodeType===h&&(this.documentElement=e),e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),q(this,e)},replaceChild:function(e,t){Z(this,e,t,J),e.ownerDocument=this,t&&this.removeChild(t),z(e)&&(this.documentElement=e)},importNode:function(e,t){return ye(this,e,t)},getElementById:function(e){var t=null;return j(this.documentElement,(function(n){if(n.nodeType==h&&n.getAttribute("id")==e)return t=n,!0})),t},getElementsByClassName:function(e){var t=l(e);return new D(this,(function(n){var i=[];return t.length>0&&j(n.documentElement,(function(r){if(r!==n&&r.nodeType===h){var s=r.getAttribute("class");if(s){var a=e===s;if(!a){var o=l(s);a=t.every((u=o,function(e){return u&&-1!==u.indexOf(e)}))}a&&i.push(r)}}var u})),i}))},createElement:function(e){var t=new ee;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new L,(t.attributes=new M)._ownerElement=t,t},createDocumentFragment:function(){var e=new ce;return e.ownerDocument=this,e.childNodes=new L,e},createTextNode:function(e){var t=new ie;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new re;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new se;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new de;return n.ownerDocument=this,n.tagName=n.nodeName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new te;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new ue;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new ee,i=t.split(":"),r=n.attributes=new M;return n.childNodes=new L,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,r._ownerElement=n,n},createAttributeNS:function(e,t){var n=new te,i=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,n}},c($,F),ee.prototype={nodeType:h,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===_?this.insertBefore(e,null):function(e,t){return t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,H(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var i=this.ownerDocument.createAttributeNS(e,t);i.value=i.nodeValue=""+n,this.setAttributeNode(i)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new D(this,(function(t){var n=[];return j(t,(function(i){i===t||i.nodeType!=h||"*"!==e&&i.tagName!=e||n.push(i)})),n}))},getElementsByTagNameNS:function(e,t){return new D(this,(function(n){var i=[];return j(n,(function(r){r===n||r.nodeType!==h||"*"!==e&&r.namespaceURI!==e||"*"!==t&&r.localName!=t||i.push(r)})),i}))}},$.prototype.getElementsByTagName=ee.prototype.getElementsByTagName,$.prototype.getElementsByTagNameNS=ee.prototype.getElementsByTagNameNS,c(ee,F),te.prototype.nodeType=f,c(te,F),ne.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(k[x])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},c(ne,F),ie.prototype={nodeName:"#text",nodeType:p,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var i=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}},c(ie,ne),re.prototype={nodeName:"#comment",nodeType:b},c(re,ne),se.prototype={nodeName:"#cdata-section",nodeType:g},c(se,ne),ae.prototype.nodeType=S,c(ae,F),oe.prototype.nodeType=w,c(oe,F),le.prototype.nodeType=y,c(le,F),ue.prototype.nodeType=m,c(ue,F),ce.prototype.nodeName="#document-fragment",ce.prototype.nodeType=_,c(ce,F),de.prototype.nodeType=v,c(de,F),he.prototype.serializeToString=function(e,t,n){return fe.call(e,t,n)},F.prototype.toString=fe;try{if(Object.defineProperty){function Te(e){switch(e.nodeType){case h:case _:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(Te(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}Object.defineProperty(D.prototype,"length",{get:function(){return R(this),this.$$length}}),Object.defineProperty(F.prototype,"textContent",{get:function(){return Te(this)},set:function(e){switch(this.nodeType){case h:case _:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),be=function(e,t,n){e["$$"+t]=n}}}catch(Se){}t.DocumentType=ae,t.DOMException=I,t.DOMImplementation=U,t.Element=ee,t.Node=F,t.NodeList=L,t.XMLSerializer=he},730:(e,t,n)=>{"use strict";var i=n(43),r=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,i,r,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,i){var r=m.hasOwnProperty(t)?m[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var T=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),A=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var N,U=Object.assign;function F(e){if(void 0===N)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var B=!1;function j(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var i=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){i=u}e.call(t.prototype)}else{try{throw Error()}catch(u){i=u}e()}}catch(u){if(u&&i&&"string"===typeof u.stack){for(var r=u.stack.split("\n"),s=i.stack.split("\n"),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||r[a]!==s[o]){var l="\n"+r[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function $(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case w:return"Fragment";case _:return"Portal";case k:return"Profiler";case E:return"StrictMode";case I:return"Suspense";case L:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case x:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function z(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=G(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function W(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=q(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&W(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function se(e,t){var n=q(t.value),i=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=ge(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ye=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Te=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,we=null,Ee=null;function ke(e){if(e=br(e)){if("function"!==typeof _e)throw Error(s(280));var t=e.stateNode;t&&(t=Sr(t),_e(e.stateNode,e.type,t))}}function xe(e){we?Ee?Ee.push(e):Ee=[e]:we=e}function Ae(){if(we){var e=we,t=Ee;if(Ee=we=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ce(e,t){return e(t)}function Ie(){}var Le=!1;function De(e,t,n){if(Le)return e(t,n);Le=!0;try{return Ce(e,t,n)}finally{Le=!1,(null!==we||null!==Ee)&&(Ie(),Ae())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var i=Sr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Me=!1;if(c)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ce){Me=!1}function Oe(e,t,n,i,r,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Ne=!1,Ue=null,Fe=!1,Be=null,je={onError:function(e){Ne=!0,Ue=e}};function $e(e,t,n,i,r,s,a,o,l){Ne=!1,Ue=null,Oe.apply(je,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Ve(e)!==e)throw Error(s(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return qe(r),e;if(a===i)return qe(r),t;a=a.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=a;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,i=a;break}if(l===i){o=!0,i=r,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,i=r;break}if(l===i){o=!0,i=a,n=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?ze(e):null}function ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=ze(e);if(null!==t)return t;e=e.sibling}return null}var Ke=r.unstable_scheduleCallback,We=r.unstable_cancelCallback,Xe=r.unstable_shouldYield,Ye=r.unstable_requestPaint,Qe=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~r;0!==o?i=dt(o):0!==(s&=a)&&(i=dt(s))}else 0!==(a=n&~r)?i=dt(a):0!==s&&(i=dt(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-at(t)),i|=e[n],t&=~r;return i}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-at(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var bt=0;function Tt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var St,_t,wt,Et,kt,xt=!1,At=[],Ct=null,It=null,Lt=null,Dt=new Map,Rt=new Map,Mt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Lt=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Nt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&_t(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ut(e){var t=vr(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void kt(e.priority,(function(){wt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&_t(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Te=i,n.target.dispatchEvent(i),Te=null,t.shift()}return!0}function Bt(e,t,n){Ft(e)&&n.delete(t)}function jt(){xt=!1,null!==Ct&&Ft(Ct)&&(Ct=null),null!==It&&Ft(It)&&(It=null),null!==Lt&&Ft(Lt)&&(Lt=null),Dt.forEach(Bt),Rt.forEach(Bt)}function $t(e,t){e.blockedOn===t&&(e.blockedOn=null,xt||(xt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,jt)))}function Vt(e){function t(t){return $t(t,e)}if(0<At.length){$t(At[0],e);for(var n=1;n<At.length;n++){var i=At[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Ct&&$t(Ct,e),null!==It&&$t(It,e),null!==Lt&&$t(Lt,e),Dt.forEach(t),Rt.forEach(t),n=0;n<Mt.length;n++)(i=Mt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Mt.length&&null===(n=Mt[0]).blockedOn;)Ut(n),null===n.blockedOn&&Mt.shift()}var Ht=T.ReactCurrentBatchConfig,qt=!0;function Gt(e,t,n,i){var r=bt,s=Ht.transition;Ht.transition=null;try{bt=1,Kt(e,t,n,i)}finally{bt=r,Ht.transition=s}}function zt(e,t,n,i){var r=bt,s=Ht.transition;Ht.transition=null;try{bt=4,Kt(e,t,n,i)}finally{bt=r,Ht.transition=s}}function Kt(e,t,n,i){if(qt){var r=Xt(e,t,n,i);if(null===r)qi(e,t,i,Wt,n),Ot(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Ct=Nt(Ct,e,t,n,i,r),!0;case"dragenter":return It=Nt(It,e,t,n,i,r),!0;case"mouseover":return Lt=Nt(Lt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Dt.set(s,Nt(Dt.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Rt.set(s,Nt(Rt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Ot(e,i),4&t&&-1<Pt.indexOf(e)){for(;null!==r;){var s=br(r);if(null!==s&&St(s),null===(s=Xt(e,t,n,i))&&qi(e,t,i,Wt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else qi(e,t,i,null,n)}}var Wt=null;function Xt(e,t,n,i){if(Wt=null,null!==(e=vr(e=Se(i))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,i=n.length,r="value"in Qt?Qt.value:Qt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[s-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=sn(un),dn=U({},un,{view:0,detail:0}),hn=sn(dn),fn=U({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=sn(fn),gn=sn(U({},fn,{dataTransfer:0})),mn=sn(U({},dn,{relatedTarget:0})),yn=sn(U({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=U({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(vn),Tn=sn(U({},un,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function kn(){return En}var xn=U({},dn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=sn(xn),Cn=sn(U({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=sn(U({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Ln=sn(U({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=U({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(Dn),Mn=[9,13,27,32],Pn=c&&"CompositionEvent"in window,On=null;c&&"documentMode"in document&&(On=document.documentMode);var Nn=c&&"TextEvent"in window&&!On,Un=c&&(!Pn||On&&8<On&&11>=On),Fn=String.fromCharCode(32),Bn=!1;function jn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $n(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Gn(e,t,n,i){xe(i),0<(t=zi(t,"onChange")).length&&(n=new cn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var zn=null,Kn=null;function Wn(e){Fi(e,0)}function Xn(e){if(K(Tr(e)))return e}function Yn(e,t){if("change"===e)return t}var Qn=!1;if(c){var Jn;if(c){var Zn="oninput"in document;if(!Zn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Zn="function"===typeof ei.oninput}Jn=Zn}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function ti(){zn&&(zn.detachEvent("onpropertychange",ni),Kn=zn=null)}function ni(e){if("value"===e.propertyName&&Xn(Kn)){var t=[];Gn(t,Kn,e,Se(e)),De(Wn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Kn=n,(zn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Kn)}function si(e,t){if("click"===e)return Xn(t)}function ai(e,t){if("input"===e||"change"===e)return Xn(t)}var oi="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(oi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!d.call(t,r)||!oi(e[r],t[r]))return!1}return!0}function ui(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ci(e,t){var n,i=ui(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ui(i)}}function di(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?di(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=W();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=W((e=t.contentWindow).document)}return t}function fi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pi(e){var t=hi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&di(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ci(n,s);var a=ci(n,i);r&&a&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gi=c&&"documentMode"in document&&11>=document.documentMode,mi=null,yi=null,vi=null,bi=!1;function Ti(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==mi||mi!==W(i)||("selectionStart"in(i=mi)&&fi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},vi&&li(vi,i)||(vi=i,0<(i=zi(yi,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=mi)))}function Si(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _i={animationend:Si("Animation","AnimationEnd"),animationiteration:Si("Animation","AnimationIteration"),animationstart:Si("Animation","AnimationStart"),transitionend:Si("Transition","TransitionEnd")},wi={},Ei={};function ki(e){if(wi[e])return wi[e];if(!_i[e])return e;var t,n=_i[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ei)return wi[e]=n[t];return e}c&&(Ei=document.createElement("div").style,"AnimationEvent"in window||(delete _i.animationend.animation,delete _i.animationiteration.animation,delete _i.animationstart.animation),"TransitionEvent"in window||delete _i.transitionend.transition);var xi=ki("animationend"),Ai=ki("animationiteration"),Ci=ki("animationstart"),Ii=ki("transitionend"),Li=new Map,Di="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ri(e,t){Li.set(e,t),l(t,[e])}for(var Mi=0;Mi<Di.length;Mi++){var Pi=Di[Mi];Ri(Pi.toLowerCase(),"on"+(Pi[0].toUpperCase()+Pi.slice(1)))}Ri(xi,"onAnimationEnd"),Ri(Ai,"onAnimationIteration"),Ri(Ci,"onAnimationStart"),Ri("dblclick","onDoubleClick"),Ri("focusin","onFocus"),Ri("focusout","onBlur"),Ri(Ii,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ni=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oi));function Ui(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,a,o,l,u){if($e.apply(this,arguments),Ne){if(!Ne)throw Error(s(198));var c=Ue;Ne=!1,Ue=null,Fe||(Fe=!0,Be=c)}}(i,t,void 0,e),e.currentTarget=null}function Fi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;Ui(r,o,u),s=l}else for(a=0;a<i.length;a++){if(l=(o=i[a]).instance,u=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;Ui(r,o,u),s=l}}}if(Fe)throw e=Be,Fe=!1,Be=null,e}function Bi(e,t){var n=t[gr];void 0===n&&(n=t[gr]=new Set);var i=e+"__bubble";n.has(i)||(Hi(t,e,2,!1),n.add(i))}function ji(e,t,n){var i=0;t&&(i|=4),Hi(n,e,i,t)}var $i="_reactListening"+Math.random().toString(36).slice(2);function Vi(e){if(!e[$i]){e[$i]=!0,a.forEach((function(t){"selectionchange"!==t&&(Ni.has(t)||ji(t,!1,e),ji(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[$i]||(t[$i]=!0,ji("selectionchange",!1,t))}}function Hi(e,t,n,i){switch(Yt(t)){case 1:var r=Gt;break;case 4:r=zt;break;default:r=Kt}n=r.bind(null,t,n,e),r=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function qi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var o=i.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==o;){if(null===(a=vr(o)))return;if(5===(l=a.tag)||6===l){i=s=a;continue e}o=o.parentNode}}i=i.return}De((function(){var i=s,r=Se(n),a=[];e:{var o=Li.get(e);if(void 0!==o){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=An;break;case"focusin":u="focus",l=mn;break;case"focusout":u="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case xi:case Ai:case Ci:l=yn;break;case Ii:l=Ln;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var c=0!==(4&t),d=!c&&"scroll"===e,h=c?null!==o?o+"Capture":null:o;c=[];for(var f,p=i;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&(null!=(g=Re(p,h))&&c.push(Gi(p,g,f)))),d)break;p=p.return}0<c.length&&(o=new l(o,u,null,n,r),a.push({event:o,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Te||!(u=n.relatedTarget||n.fromElement)||!vr(u)&&!u[pr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?vr(u):null)&&(u!==(d=Ve(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=i),l!==u)){if(c=pn,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=Cn,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?o:Tr(l),f=null==u?o:Tr(u),(o=new c(g,p+"leave",l,n,r)).target=d,o.relatedTarget=f,g=null,vr(r)===i&&((c=new c(h,p+"enter",u,n,r)).target=f,c.relatedTarget=d,g=c),d=g,l&&u)e:{for(h=u,p=0,f=c=l;f;f=Ki(f))p++;for(f=0,g=h;g;g=Ki(g))f++;for(;0<p-f;)c=Ki(c),p--;for(;0<f-p;)h=Ki(h),f--;for(;p--;){if(c===h||null!==h&&c===h.alternate)break e;c=Ki(c),h=Ki(h)}c=null}else c=null;null!==l&&Wi(a,o,l,c,!1),null!==u&&null!==d&&Wi(a,d,u,c,!0)}if("select"===(l=(o=i?Tr(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var m=Yn;else if(qn(o))if(Qn)m=ai;else{m=ri;var y=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=si);switch(m&&(m=m(e,i))?Gn(a,m,n,r):(y&&y(e,o,i),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=i?Tr(i):window,e){case"focusin":(qn(y)||"true"===y.contentEditable)&&(mi=y,yi=i,vi=null);break;case"focusout":vi=yi=mi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,Ti(a,n,r);break;case"selectionchange":if(gi)break;case"keydown":case"keyup":Ti(a,n,r)}var v;if(Pn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?jn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(v=en()):(Jt="value"in(Qt=r)?Qt.value:Qt.textContent,Vn=!0)),0<(y=zi(i,b)).length&&(b=new Tn(b,e,null,n,r),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=$n(n))&&(b.data=v))),(v=Nn?function(e,t){switch(e){case"compositionend":return $n(t);case"keypress":return 32!==t.which?null:(Bn=!0,Fn);case"textInput":return(e=t.data)===Fn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Pn&&jn(e,t)?(e=en(),Zt=Jt=Qt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=zi(i,"onBeforeInput")).length&&(r=new Tn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=v))}Fi(a,t)}))}function Gi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function zi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Re(e,n))&&i.unshift(Gi(e,s,r)),null!=(s=Re(e,t))&&i.push(Gi(e,s,r))),e=e.return}return i}function Ki(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Wi(e,t,n,i,r){for(var s=t._reactName,a=[];null!==n&&n!==i;){var o=n,l=o.alternate,u=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==u&&(o=u,r?null!=(l=Re(n,s))&&a.unshift(Gi(n,l,o)):r||null!=(l=Re(n,s))&&a.push(Gi(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Xi=/\r\n?/g,Yi=/\u0000|\uFFFD/g;function Qi(e){return("string"===typeof e?e:""+e).replace(Xi,"\n").replace(Yi,"")}function Ji(e,t,n){if(t=Qi(t),Qi(e)!==t&&n)throw Error(s(425))}function Zi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(or)}:ir;function or(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Vt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Vt(t)}function ur(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function cr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var dr=Math.random().toString(36).slice(2),hr="__reactFiber$"+dr,fr="__reactProps$"+dr,pr="__reactContainer$"+dr,gr="__reactEvents$"+dr,mr="__reactListeners$"+dr,yr="__reactHandles$"+dr;function vr(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pr]||n[hr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=cr(e);null!==e;){if(n=e[hr])return n;e=cr(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[hr]||e[pr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Tr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Sr(e){return e[fr]||null}var _r=[],wr=-1;function Er(e){return{current:e}}function kr(e){0>wr||(e.current=_r[wr],_r[wr]=null,wr--)}function xr(e,t){wr++,_r[wr]=e.current,e.current=t}var Ar={},Cr=Er(Ar),Ir=Er(!1),Lr=Ar;function Dr(e,t){var n=e.type.contextTypes;if(!n)return Ar;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Rr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Mr(){kr(Ir),kr(Cr)}function Pr(e,t,n){if(Cr.current!==Ar)throw Error(s(168));xr(Cr,t),xr(Ir,n)}function Or(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,H(e)||"Unknown",r));return U({},n,i)}function Nr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ar,Lr=Cr.current,xr(Cr,e),xr(Ir,Ir.current),!0}function Ur(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Or(e,t,Lr),i.__reactInternalMemoizedMergedChildContext=e,kr(Ir),kr(Cr),xr(Cr,e)):kr(Ir),xr(Ir,n)}var Fr=null,Br=!1,jr=!1;function $r(e){null===Fr?Fr=[e]:Fr.push(e)}function Vr(){if(!jr&&null!==Fr){jr=!0;var e=0,t=bt;try{var n=Fr;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Fr=null,Br=!1}catch(r){throw null!==Fr&&(Fr=Fr.slice(e+1)),Ke(Ze,Vr),r}finally{bt=t,jr=!1}}return null}var Hr=[],qr=0,Gr=null,zr=0,Kr=[],Wr=0,Xr=null,Yr=1,Qr="";function Jr(e,t){Hr[qr++]=zr,Hr[qr++]=Gr,Gr=e,zr=t}function Zr(e,t,n){Kr[Wr++]=Yr,Kr[Wr++]=Qr,Kr[Wr++]=Xr,Xr=e;var i=Yr;e=Qr;var r=32-at(i)-1;i&=~(1<<r),n+=1;var s=32-at(t)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Yr=1<<32-at(t)+r|n<<r|i,Qr=s+e}else Yr=1<<s|n<<r|i,Qr=e}function es(e){null!==e.return&&(Jr(e,1),Zr(e,1,0))}function ts(e){for(;e===Gr;)Gr=Hr[--qr],Hr[qr]=null,zr=Hr[--qr],Hr[qr]=null;for(;e===Xr;)Xr=Kr[--Wr],Kr[Wr]=null,Qr=Kr[--Wr],Kr[Wr]=null,Yr=Kr[--Wr],Kr[Wr]=null}var ns=null,is=null,rs=!1,ss=null;function as(e,t){var n=Du(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=ur(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xr?{id:Yr,overflow:Qr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Du(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(rs){var t=is;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ur(n.nextSibling);var i=ns;t&&os(e,t)?as(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function cs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!rs)return cs(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw hs(),Error(s(418));for(;t;)as(e,t),t=ur(t.nextSibling)}if(cs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=ur(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?ur(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=is;e;)e=ur(e.nextSibling)}function fs(){is=ns=null,rs=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var gs=T.ReactCurrentBatchConfig;function ms(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function ys(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Mu(e,t)).index=0,e.sibling=null,e}function a(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Uu(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function u(e,t,n,i){var s=n.type;return s===w?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===R&&vs(s)===t.type)?((i=r(t,n.props)).ref=ms(e,t,n),i.return=e,i):((i=Pu(n.type,n.key,n.props,null,e.mode,i)).ref=ms(e,t,n),i.return=e,i)}function c(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fu(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,i,s){return null===t||7!==t.tag?((t=Ou(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Pu(t.type,t.key,t.props,null,e.mode,n)).ref=ms(e,null,t),n.return=e,n;case _:return(t=Fu(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Ou(t,e.mode,n,null)).return=e,t;ys(e,t)}return null}function f(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===r?u(e,t,n,i):null;case _:return n.key===r?c(e,t,n,i):null;case R:return f(e,t,(r=n._init)(n._payload),i)}if(te(n)||O(n))return null!==r?null:d(e,t,n,i,null);ys(e,n)}return null}function p(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case S:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case _:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case R:return p(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||O(i))return d(t,e=e.get(n)||null,i,r,null);ys(t,i)}return null}function g(r,s,o,l){for(var u=null,c=null,d=s,g=s=0,m=null;null!==d&&g<o.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var y=f(r,d,o[g],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(r,d),s=a(y,s,g),null===c?u=y:c.sibling=y,c=y,d=m}if(g===o.length)return n(r,d),rs&&Jr(r,g),u;if(null===d){for(;g<o.length;g++)null!==(d=h(r,o[g],l))&&(s=a(d,s,g),null===c?u=d:c.sibling=d,c=d);return rs&&Jr(r,g),u}for(d=i(r,d);g<o.length;g++)null!==(m=p(d,r,g,o[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),s=a(m,s,g),null===c?u=m:c.sibling=m,c=m);return e&&d.forEach((function(e){return t(r,e)})),rs&&Jr(r,g),u}function m(r,o,l,u){var c=O(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var d=c=null,g=o,m=o=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=f(r,g,v.value,u);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(r,g),o=a(b,o,m),null===d?c=b:d.sibling=b,d=b,g=y}if(v.done)return n(r,g),rs&&Jr(r,m),c;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=h(r,v.value,u))&&(o=a(v,o,m),null===d?c=v:d.sibling=v,d=v);return rs&&Jr(r,m),c}for(g=i(r,g);!v.done;m++,v=l.next())null!==(v=p(g,r,m,v.value,u))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),o=a(v,o,m),null===d?c=v:d.sibling=v,d=v);return e&&g.forEach((function(e){return t(r,e)})),rs&&Jr(r,m),c}return function e(i,s,a,l){if("object"===typeof a&&null!==a&&a.type===w&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case S:e:{for(var u=a.key,c=s;null!==c;){if(c.key===u){if((u=a.type)===w){if(7===c.tag){n(i,c.sibling),(s=r(c,a.props.children)).return=i,i=s;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===R&&vs(u)===c.type){n(i,c.sibling),(s=r(c,a.props)).ref=ms(i,c,a),s.return=i,i=s;break e}n(i,c);break}t(i,c),c=c.sibling}a.type===w?((s=Ou(a.props.children,i.mode,l,a.key)).return=i,i=s):((l=Pu(a.type,a.key,a.props,null,i.mode,l)).ref=ms(i,s,a),l.return=i,i=l)}return o(i);case _:e:{for(c=a.key;null!==s;){if(s.key===c){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(i,s.sibling),(s=r(s,a.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Fu(a,i.mode,l)).return=i,i=s}return o(i);case R:return e(i,s,(c=a._init)(a._payload),l)}if(te(a))return g(i,s,a,l);if(O(a))return m(i,s,a,l);ys(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,a)).return=i,i=s):(n(i,s),(s=Uu(a,i.mode,l)).return=i,i=s),o(i)):n(i,s)}}var Ts=bs(!0),Ss=bs(!1),_s=Er(null),ws=null,Es=null,ks=null;function xs(){ks=Es=ws=null}function As(e){var t=_s.current;kr(_s),e._currentValue=t}function Cs(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Is(e,t){ws=e,ks=Es=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function Ls(e){var t=e._currentValue;if(ks!==e)if(e={context:e,memoizedValue:t,next:null},null===Es){if(null===ws)throw Error(s(308));Es=e,ws.dependencies={lanes:0,firstContext:e}}else Es=Es.next=e;return t}var Ds=null;function Rs(e){null===Ds?Ds=[e]:Ds.push(e)}function Ms(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Rs(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ps(e,i)}function Ps(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Os=!1;function Ns(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Us(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bs(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Cl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Ps(e,n)}return null===(r=i.interleaved)?(t.next=t,Rs(i)):(t.next=r.next,r.next=t),i.interleaved=t,Ps(e,n)}function js(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}function $s(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vs(e,t,n,i){var r=e.updateQueue;Os=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,u=l.next;l.next=null,null===a?s=u:a.next=u,a=l;var c=e.alternate;null!==c&&((o=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===o?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(null!==s){var d=r.baseState;for(a=0,c=u=l=null,o=s;;){var h=o.lane,f=o.eventTime;if((i&h)===h){null!==c&&(c=c.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,g=o;switch(h=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(f,d,h):p)||void 0===h)break e;d=U({},d,h);break e;case 2:Os=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(u=c=f,l=d):c=c.next=f,a|=h;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(h=o).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===c&&(l=d),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Nl|=a,e.lanes=a,e.memoizedState=d}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var qs={},Gs=Er(qs),zs=Er(qs),Ks=Er(qs);function Ws(e){if(e===qs)throw Error(s(174));return e}function Xs(e,t){switch(xr(Ks,t),xr(zs,e),xr(Gs,qs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}kr(Gs),xr(Gs,t)}function Ys(){kr(Gs),kr(zs),kr(Ks)}function Qs(e){Ws(Ks.current);var t=Ws(Gs.current),n=le(t,e.type);t!==n&&(xr(zs,e),xr(Gs,n))}function Js(e){zs.current===e&&(kr(Gs),kr(zs))}var Zs=Er(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ia=T.ReactCurrentDispatcher,ra=T.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ua=!1,ca=!1,da=0,ha=0;function fa(){throw Error(s(321))}function pa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oi(e[n],t[n]))return!1;return!0}function ga(e,t,n,i,r,a){if(sa=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Ja:Za,e=n(i,r),ca){a=0;do{if(ca=!1,da=0,25<=a)throw Error(s(301));a+=1,la=oa=null,t.updateQueue=null,ia.current=eo,e=n(i,r)}while(ca)}if(ia.current=Qa,t=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ua=!1,t)throw Error(s(300));return e}function ma(){var e=0!==da;return da=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function va(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function ba(e,t){return"function"===typeof t?t(e):t}function Ta(e){var t=va(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=oa,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var o=r.next;r.next=a.next,a.next=o}i.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,i=i.baseState;var l=o=null,u=null,c=a;do{var d=c.lane;if((sa&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=h,o=i):u=u.next=h,aa.lanes|=d,Nl|=d}c=c.next}while(null!==c&&c!==a);null===u?o=i:u.next=l,oi(i,t.memoizedState)||(bo=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=u,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{a=r.lane,aa.lanes|=a,Nl|=a,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Sa(e){var t=va(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,a=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{a=e(a,o.action),o=o.next}while(o!==r);oi(a,t.memoizedState)||(bo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,i]}function _a(){}function wa(e,t){var n=aa,i=va(),r=t(),a=!oi(i.memoizedState,r);if(a&&(i.memoizedState=r,bo=!0),i=i.queue,Oa(xa.bind(null,n,i,e),[e]),i.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,La(9,ka.bind(null,n,i,r,t),void 0,null),null===Il)throw Error(s(349));0!==(30&sa)||Ea(n,t,r)}return r}function Ea(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ka(e,t,n,i){t.value=n,t.getSnapshot=i,Aa(t)&&Ca(e)}function xa(e,t,n){return n((function(){Aa(t)&&Ca(e)}))}function Aa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oi(e,n)}catch(i){return!0}}function Ca(e){var t=Ps(e,1);null!==t&&nu(t,e,1,-1)}function Ia(e){var t=ya();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:e},t.queue=e,e=e.dispatch=Ka.bind(null,aa,e),[t.memoizedState,e]}function La(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Da(){return va().memoizedState}function Ra(e,t,n,i){var r=ya();aa.flags|=e,r.memoizedState=La(1|t,n,void 0,void 0===i?null:i)}function Ma(e,t,n,i){var r=va();i=void 0===i?null:i;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==i&&pa(i,a.deps))return void(r.memoizedState=La(t,n,s,i))}aa.flags|=e,r.memoizedState=La(1|t,n,s,i)}function Pa(e,t){return Ra(8390656,8,e,t)}function Oa(e,t){return Ma(2048,8,e,t)}function Na(e,t){return Ma(4,2,e,t)}function Ua(e,t){return Ma(4,4,e,t)}function Fa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ba(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ma(4,4,Fa.bind(null,t,e),n)}function ja(){}function $a(e,t){var n=va();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&pa(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Va(e,t){var n=va();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&pa(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ha(e,t,n){return 0===(21&sa)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(oi(n,t)||(n=gt(),aa.lanes|=n,Nl|=n,e.baseState=!0),t)}function qa(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=ra.transition;ra.transition={};try{e(!1),t()}finally{bt=n,ra.transition=i}}function Ga(){return va().memoizedState}function za(e,t,n){var i=tu(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Wa(e))Xa(t,n);else if(null!==(n=Ms(e,t,n,i))){nu(n,e,i,eu()),Ya(n,t,i)}}function Ka(e,t,n){var i=tu(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Wa(e))Xa(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,oi(o,a)){var l=t.interleaved;return null===l?(r.next=r,Rs(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(u){}null!==(n=Ms(e,t,r,i))&&(nu(n,e,i,r=eu()),Ya(n,t,i))}}function Wa(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Xa(e,t){ca=ua=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ya(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Qa={readContext:Ls,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Ja={readContext:Ls,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:Ls,useEffect:Pa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ra(4194308,4,Fa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ra(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ra(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=ya();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=za.bind(null,aa,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Ia,useDebugValue:ja,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Ia(!1),t=e[0];return e=qa.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=aa,r=ya();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Il)throw Error(s(349));0!==(30&sa)||Ea(i,t,n)}r.memoizedState=n;var a={value:n,getSnapshot:t};return r.queue=a,Pa(xa.bind(null,i,a,e),[e]),i.flags|=2048,La(9,ka.bind(null,i,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Il.identifierPrefix;if(rs){var n=Qr;t=":"+t+"R"+(n=(Yr&~(1<<32-at(Yr)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ha++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Za={readContext:Ls,useCallback:$a,useContext:Ls,useEffect:Oa,useImperativeHandle:Ba,useInsertionEffect:Na,useLayoutEffect:Ua,useMemo:Va,useReducer:Ta,useRef:Da,useState:function(){return Ta(ba)},useDebugValue:ja,useDeferredValue:function(e){return Ha(va(),oa.memoizedState,e)},useTransition:function(){return[Ta(ba)[0],va().memoizedState]},useMutableSource:_a,useSyncExternalStore:wa,useId:Ga,unstable_isNewReconciler:!1},eo={readContext:Ls,useCallback:$a,useContext:Ls,useEffect:Oa,useImperativeHandle:Ba,useInsertionEffect:Na,useLayoutEffect:Ua,useMemo:Va,useReducer:Sa,useRef:Da,useState:function(){return Sa(ba)},useDebugValue:ja,useDeferredValue:function(e){var t=va();return null===oa?t.memoizedState=e:Ha(t,oa.memoizedState,e)},useTransition:function(){return[Sa(ba)[0],va().memoizedState]},useMutableSource:_a,useSyncExternalStore:wa,useId:Ga,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=eu(),r=tu(e),s=Fs(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Bs(e,s,r))&&(nu(t,e,r,i),js(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=eu(),r=tu(e),s=Fs(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Bs(e,s,r))&&(nu(t,e,r,i),js(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=eu(),i=tu(e),r=Fs(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Bs(e,r,i))&&(nu(t,e,i,n),js(t,e,i))}};function ro(e,t,n,i,r,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function so(e,t,n){var i=!1,r=Ar,s=t.contextType;return"object"===typeof s&&null!==s?s=Ls(s):(r=Rr(t)?Lr:Cr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Dr(e,r):Ar),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function ao(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Ns(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Ls(s):(s=Rr(t)?Lr:Cr.current,r.context=Dr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(no(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&io.enqueueReplaceState(r,r.state,null),Vs(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",i=t;do{n+=$(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function co(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=Fs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){ql||(ql=!0,Gl=i),co(0,t)},n}function po(e,t,n){(n=Fs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){co(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){co(0,t),"function"!==typeof i&&(null===zl?zl=new Set([this]):zl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function go(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ho;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=ku.bind(null,e,t,n),t.then(e,e))}function mo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fs(-1,1)).tag=2,Bs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var vo=T.ReactCurrentOwner,bo=!1;function To(e,t,n,i){t.child=null===e?Ss(t,null,n,i):Ts(t,e.child,n,i)}function So(e,t,n,i,r){n=n.render;var s=t.ref;return Is(t,r),i=ga(e,t,n,i,s,r),n=ma(),null===e||bo?(rs&&n&&es(t),t.flags|=1,To(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qo(e,t,r))}function _o(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Ru(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pu(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,wo(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(a,i)&&e.ref===t.ref)return qo(e,t,r)}return t.flags|=1,(e=Mu(s,i)).ref=t.ref,e.return=t,t.child=e}function wo(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(bo=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,qo(e,t,r);0!==(131072&e.flags)&&(bo=!0)}}return xo(e,t,n,i,r)}function Eo(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(Ml,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xr(Ml,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,xr(Ml,Rl),Rl|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,xr(Ml,Rl),Rl|=i;return To(e,t,r,n),t.child}function ko(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function xo(e,t,n,i,r){var s=Rr(n)?Lr:Cr.current;return s=Dr(t,s),Is(t,r),n=ga(e,t,n,i,s,r),i=ma(),null===e||bo?(rs&&i&&es(t),t.flags|=1,To(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qo(e,t,r))}function Ao(e,t,n,i,r){if(Rr(n)){var s=!0;Nr(t)}else s=!1;if(Is(t,r),null===t.stateNode)Ho(e,t),so(t,n,i),oo(t,n,i,r),i=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=Ls(u):u=Dr(t,u=Rr(n)?Lr:Cr.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==i||l!==u)&&ao(t,a,i,u),Os=!1;var h=t.memoizedState;a.state=h,Vs(t,i,a,r),l=t.memoizedState,o!==i||h!==l||Ir.current||Os?("function"===typeof c&&(no(t,n,c,i),l=t.memoizedState),(o=Os||ro(t,n,o,i,h,l,u))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=u,i=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,Us(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:to(t.type,o),a.props=u,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ls(l):l=Dr(t,l=Rr(n)?Lr:Cr.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&ao(t,a,i,l),Os=!1,h=t.memoizedState,a.state=h,Vs(t,i,a,r);var p=t.memoizedState;o!==d||h!==p||Ir.current||Os?("function"===typeof f&&(no(t,n,f,i),p=t.memoizedState),(u=Os||ro(t,n,u,i,h,p,l)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),a.props=i,a.state=p,a.context=l,i=u):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return Co(e,t,n,i,s,r)}function Co(e,t,n,i,r,s){ko(e,t);var a=0!==(128&t.flags);if(!i&&!a)return r&&Ur(t,n,!1),qo(e,t,s);i=t.stateNode,vo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&a?(t.child=Ts(t,e.child,null,s),t.child=Ts(t,null,o,s)):To(e,t,o,s),t.memoizedState=i.state,r&&Ur(t,n,!0),t.child}function Io(e){var t=e.stateNode;t.pendingContext?Pr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pr(0,t.context,!1),Xs(e,t.containerInfo)}function Lo(e,t,n,i,r){return fs(),ps(r),t.flags|=256,To(e,t,n,i),t.child}var Do,Ro,Mo,Po,Oo={dehydrated:null,treeContext:null,retryLane:0};function No(e){return{baseLanes:e,cachePool:null,transitions:null}}function Uo(e,t,n){var i,r=t.pendingProps,a=Zs.current,o=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&a)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),xr(Zs,1&a),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Nu(l,r,0,null),e=Ou(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=No(n),t.memoizedState=Oo,e):Fo(t,l));if(null!==(a=e.memoizedState)&&null!==(i=a.dehydrated))return function(e,t,n,i,r,a,o){if(n)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,i=uo(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=i.fallback,r=t.mode,i=Nu({mode:"visible",children:i.children},r,0,null),(a=Ou(a,r,o,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,0!==(1&t.mode)&&Ts(t,e.child,null,o),t.child.memoizedState=No(o),t.memoizedState=Oo,a);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Bo(e,t,o,i=uo(a=Error(s(419)),i,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(i=Il)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|o))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Ps(e,r),nu(i,e,r,-1))}return gu(),Bo(e,t,o,i=uo(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Au.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,is=ur(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Kr[Wr++]=Yr,Kr[Wr++]=Qr,Kr[Wr++]=Xr,Yr=e.id,Qr=e.overflow,Xr=t),t=Fo(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,a,n);if(o){o=r.fallback,l=t.mode,i=(a=e.child).sibling;var u={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==a?((r=t.child).childLanes=0,r.pendingProps=u,t.deletions=null):(r=Mu(a,u)).subtreeFlags=14680064&a.subtreeFlags,null!==i?o=Mu(i,o):(o=Ou(o,l,n,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?No(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Oo,r}return e=(o=e.child).sibling,r=Mu(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fo(e,t){return(t=Nu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,n,i){return null!==i&&ps(i),Ts(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function jo(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Cs(e.return,t,n)}function $o(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Vo(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(To(e,t,i.children,n),0!==(2&(i=Zs.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&jo(e,n,t);else if(19===e.tag)jo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(xr(Zs,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),$o(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ea(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}$o(t,!0,n,null,s);break;case"together":$o(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Mu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function zo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ko(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zo(t),null;case 1:case 17:return Rr(t.type)&&Mr(),zo(t),null;case 3:return i=t.stateNode,Ys(),kr(Ir),kr(Cr),na(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(au(ss),ss=null))),Ro(e,t),zo(t),null;case 5:Js(t);var r=Ws(Ks.current);if(n=t.type,null!==e&&null!=t.stateNode)Mo(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return zo(t),null}if(e=Ws(Gs.current),ds(t)){i=t.stateNode,n=t.type;var a=t.memoizedProps;switch(i[hr]=t,i[fr]=a,e=0!==(1&t.mode),n){case"dialog":Bi("cancel",i),Bi("close",i);break;case"iframe":case"object":case"embed":Bi("load",i);break;case"video":case"audio":for(r=0;r<Oi.length;r++)Bi(Oi[r],i);break;case"source":Bi("error",i);break;case"img":case"image":case"link":Bi("error",i),Bi("load",i);break;case"details":Bi("toggle",i);break;case"input":Y(i,a),Bi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Bi("invalid",i);break;case"textarea":re(i,a),Bi("invalid",i)}for(var l in ve(n,a),r=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?i.textContent!==u&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,u,e),r=["children",u]):"number"===typeof u&&i.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,u,e),r=["children",""+u]):o.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Bi("scroll",i)}switch(n){case"input":z(i),Z(i,a,!0);break;case"textarea":z(i),ae(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=Zi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[hr]=t,e[fr]=i,Do(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":Bi("cancel",e),Bi("close",e),r=i;break;case"iframe":case"object":case"embed":Bi("load",e),r=i;break;case"video":case"audio":for(r=0;r<Oi.length;r++)Bi(Oi[r],e);r=i;break;case"source":Bi("error",e),r=i;break;case"img":case"image":case"link":Bi("error",e),Bi("load",e),r=i;break;case"details":Bi("toggle",e),r=i;break;case"input":Y(e,i),r=X(e,i),Bi("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=U({},i,{value:void 0}),Bi("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Bi("invalid",e)}for(a in ve(n,r),u=r)if(u.hasOwnProperty(a)){var c=u[a];"style"===a?me(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&he(e,c):"number"===typeof c&&he(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=c&&"onScroll"===a&&Bi("scroll",e):null!=c&&b(e,a,c,l))}switch(n){case"input":z(e),Z(e,i,!1);break;case"textarea":z(e),ae(e);break;case"option":null!=i.value&&e.setAttribute("value",""+q(i.value));break;case"select":e.multiple=!!i.multiple,null!=(a=i.value)?ne(e,!!i.multiple,a,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return zo(t),null;case 6:if(e&&null!=t.stateNode)Po(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=Ws(Ks.current),Ws(Gs.current),ds(t)){if(i=t.stateNode,n=t.memoizedProps,i[hr]=t,(a=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Ji(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[hr]=t,t.stateNode=i}return zo(t),null;case 13:if(kr(Zs),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))hs(),fs(),t.flags|=98560,a=!1;else if(a=ds(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[hr]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;zo(t),a=!1}else null!==ss&&(au(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Pl&&(Pl=3):gu())),null!==t.updateQueue&&(t.flags|=4),zo(t),null);case 4:return Ys(),Ro(e,t),null===e&&Vi(t.stateNode.containerInfo),zo(t),null;case 10:return As(t.type._context),zo(t),null;case 19:if(kr(Zs),null===(a=t.memoizedState))return zo(t),null;if(i=0!==(128&t.flags),null===(l=a.rendering))if(i)Go(a,!1);else{if(0!==Pl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,Go(a,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return xr(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==a.tail&&Qe()>Vl&&(t.flags|=128,i=!0,Go(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ea(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!rs)return zo(t),null}else 2*Qe()-a.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,i=!0,Go(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Qe(),t.sibling=null,n=Zs.current,xr(Zs,i?1&n|2:1&n),t):(zo(t),null);case 22:case 23:return du(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(zo(t),6&t.subtreeFlags&&(t.flags|=8192)):zo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Wo(e,t){switch(ts(t),t.tag){case 1:return Rr(t.type)&&Mr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),kr(Ir),kr(Cr),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Js(t),null;case 13:if(kr(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return kr(Zs),null;case 4:return Ys(),null;case 10:return As(t.type._context),null;case 22:case 23:return du(),null;default:return null}}Do=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ro=function(){},Mo=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Ws(Gs.current);var s,a=null;switch(n){case"input":r=X(e,r),i=X(e,i),a=[];break;case"select":r=U({},r,{value:void 0}),i=U({},i,{value:void 0}),a=[];break;case"textarea":r=ie(e,r),i=ie(e,i),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Zi)}for(c in ve(n,i),n=null,r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var l=r[c];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(o.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in i){var u=i[c];if(l=null!=r?r[c]:void 0,i.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(a||(a=[]),a.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(a=a||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(o.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Bi("scroll",e),a||l===u||(a=[])):(a=a||[]).push(c,u))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},Po=function(e,t,n,i){n!==i&&(t.flags|=4)};var Xo=!1,Yo=!1,Qo="function"===typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Eu(e,t,i)}else n.current=null}function el(e,t,n){try{n()}catch(i){Eu(e,t,i)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,n,s)}r=r.next}while(r!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[fr],delete t[gr],delete t[mr],delete t[yr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zi));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function ul(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var cl=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(o){}switch(n.tag){case 5:Yo||Zo(n,t);case 6:var i=cl,r=dl;cl=null,hl(e,t,n),dl=r,null!==(cl=i)&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Vt(e)):lr(cl,n.stateNode));break;case 4:i=cl,r=dl,cl=n.stateNode.containerInfo,dl=!0,hl(e,t,n),cl=i,dl=r;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&el(n,t,a),r=r.next}while(r!==i)}hl(e,t,n);break;case 1:if(!Yo&&(Zo(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){Eu(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Yo=(i=Yo)||null!==n.memoizedState,hl(e,t,n),Yo=i):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qo),t.forEach((function(t){var i=Cu.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,dl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===cl)throw Error(s(160));fl(a,o,r),cl=null,dl=!1;var u=r.alternate;null!==u&&(u.return=null),r.return=null}catch(c){Eu(r,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(m){Eu(e,e.return,m)}try{nl(5,e,e.return)}catch(m){Eu(e,e.return,m)}}break;case 1:gl(t,e),yl(e),512&i&&null!==n&&Zo(n,n.return);break;case 5:if(gl(t,e),yl(e),512&i&&null!==n&&Zo(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(m){Eu(e,e.return,m)}}if(4&i&&null!=(r=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&Q(r,a),be(l,o);var c=be(l,a);for(o=0;o<u.length;o+=2){var d=u[o],h=u[o+1];"style"===d?me(r,h):"dangerouslySetInnerHTML"===d?de(r,h):"children"===d?he(r,h):b(r,d,h,c)}switch(l){case"input":J(r,a);break;case"textarea":se(r,a);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(r,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(r,!!a.multiple,a.defaultValue,!0):ne(r,!!a.multiple,a.multiple?[]:"",!1))}r[fr]=a}catch(m){Eu(e,e.return,m)}}break;case 6:if(gl(t,e),yl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(m){Eu(e,e.return,m)}}break;case 3:if(gl(t,e),yl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(m){Eu(e,e.return,m)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||($l=Qe())),4&i&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(c=Yo)||d,gl(t,e),Yo=c):gl(t,e),yl(e),8192&i){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for(Jo=e,d=e.child;null!==d;){for(h=Jo=d;null!==Jo;){switch(p=(f=Jo).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Zo(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){i=f,n=f.return;try{t=i,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Eu(i,n,m)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){Sl(h);continue}}null!==p?(p.return=f,Jo=p):Sl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{r=h.stateNode,c?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(u=h.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=ge("display",o))}catch(m){Eu(e,e.return,m)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Eu(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),yl(e),4&i&&pl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(he(r,""),i.flags&=-33),ul(e,ol(e),r);break;case 3:case 4:var a=i.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(s(161))}}catch(o){Eu(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Jo=e,bl(e,t,n)}function bl(e,t,n){for(var i=0!==(1&e.mode);null!==Jo;){var r=Jo,s=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||Xo;if(!a){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Xo;var u=Yo;if(Xo=a,(Yo=l)&&!u)for(Jo=r;null!==Jo;)l=(a=Jo).child,22===a.tag&&null!==a.memoizedState?_l(r):null!==l?(l.return=a,Jo=l):_l(r);for(;null!==s;)Jo=s,bl(s,t,n),s=s.sibling;Jo=r,Xo=o,Yo=u}Tl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Jo=s):Tl(e)}}function Tl(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Yo)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Hs(t,a,i);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(s(163))}Yo||512&t.flags&&rl(t)}catch(f){Eu(t,t.return,f)}}if(t===e){Jo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Jo=n;break}Jo=t.return}}function Sl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Jo=n;break}Jo=t.return}}function _l(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Eu(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Eu(t,r,l)}}var s=t.return;try{rl(t)}catch(l){Eu(t,s,l)}break;case 5:var a=t.return;try{rl(t)}catch(l){Eu(t,a,l)}}}catch(l){Eu(t,t.return,l)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var wl,El=Math.ceil,kl=T.ReactCurrentDispatcher,xl=T.ReactCurrentOwner,Al=T.ReactCurrentBatchConfig,Cl=0,Il=null,Ll=null,Dl=0,Rl=0,Ml=Er(0),Pl=0,Ol=null,Nl=0,Ul=0,Fl=0,Bl=null,jl=null,$l=0,Vl=1/0,Hl=null,ql=!1,Gl=null,zl=null,Kl=!1,Wl=null,Xl=0,Yl=0,Ql=null,Jl=-1,Zl=0;function eu(){return 0!==(6&Cl)?Qe():-1!==Jl?Jl:Jl=Qe()}function tu(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Dl?Dl&-Dl:null!==gs.transition?(0===Zl&&(Zl=gt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nu(e,t,n,i){if(50<Yl)throw Yl=0,Ql=null,Error(s(185));yt(e,n,i),0!==(2&Cl)&&e===Il||(e===Il&&(0===(2&Cl)&&(Ul|=n),4===Pl&&ou(e,Dl)),iu(e,i),1===n&&0===Cl&&0===(1&t.mode)&&(Vl=Qe()+500,Br&&Vr()))}function iu(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=r[a];-1===l?0!==(o&n)&&0===(o&i)||(r[a]=ft(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var i=ht(e,e===Il?Dl:0);if(0===i)null!==n&&We(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&We(n),1===t)0===e.tag?function(e){Br=!0,$r(e)}(lu.bind(null,e)):$r(lu.bind(null,e)),ar((function(){0===(6&Cl)&&Vr()})),n=null;else{switch(Tt(i)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Iu(n,ru.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ru(e,t){if(Jl=-1,Zl=0,0!==(6&Cl))throw Error(s(327));var n=e.callbackNode;if(_u()&&e.callbackNode!==n)return null;var i=ht(e,e===Il?Dl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=mu(e,i);else{t=i;var r=Cl;Cl|=2;var a=pu();for(Il===e&&Dl===t||(Hl=null,Vl=Qe()+500,hu(e,t));;)try{vu();break}catch(l){fu(e,l)}xs(),kl.current=a,Cl=r,null!==Ll?t=0:(Il=null,Dl=0,t=Pl)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(i=r,t=su(e,r))),1===t)throw n=Ol,hu(e,0),ou(e,i),iu(e,Qe()),n;if(6===t)ou(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!oi(s(),r))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=mu(e,i))&&(0!==(a=pt(e))&&(i=a,t=su(e,a))),1===t))throw n=Ol,hu(e,0),ou(e,i),iu(e,Qe()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:Su(e,jl,Hl);break;case 3:if(ou(e,i),(130023424&i)===i&&10<(t=$l+500-Qe())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&i)!==i){eu(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(Su.bind(null,e,jl,Hl),t);break}Su(e,jl,Hl);break;case 4:if(ou(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-at(i);a=1<<o,(o=t[o])>r&&(r=o),i&=~a}if(i=r,10<(i=(120>(i=Qe()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*El(i/1960))-i)){e.timeoutHandle=ir(Su.bind(null,e,jl,Hl),i);break}Su(e,jl,Hl);break;default:throw Error(s(329))}}}return iu(e,Qe()),e.callbackNode===n?ru.bind(null,e):null}function su(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(hu(e,t).flags|=256),2!==(e=mu(e,t))&&(t=jl,jl=n,null!==t&&au(t)),e}function au(e){null===jl?jl=e:jl.push.apply(jl,e)}function ou(e,t){for(t&=~Fl,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),i=1<<n;e[n]=-1,t&=~i}}function lu(e){if(0!==(6&Cl))throw Error(s(327));_u();var t=ht(e,0);if(0===(1&t))return iu(e,Qe()),null;var n=mu(e,t);if(0!==e.tag&&2===n){var i=pt(e);0!==i&&(t=i,n=su(e,i))}if(1===n)throw n=Ol,hu(e,0),ou(e,t),iu(e,Qe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Su(e,jl,Hl),iu(e,Qe()),null}function uu(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Vl=Qe()+500,Br&&Vr())}}function cu(e){null!==Wl&&0===Wl.tag&&0===(6&Cl)&&_u();var t=Cl;Cl|=1;var n=Al.transition,i=bt;try{if(Al.transition=null,bt=1,e)return e()}finally{bt=i,Al.transition=n,0===(6&(Cl=t))&&Vr()}}function du(){Rl=Ml.current,kr(Ml)}function hu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Ll)for(n=Ll.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Mr();break;case 3:Ys(),kr(Ir),kr(Cr),na();break;case 5:Js(i);break;case 4:Ys();break;case 13:case 19:kr(Zs);break;case 10:As(i.type._context);break;case 22:case 23:du()}n=n.return}if(Il=e,Ll=e=Mu(e.current,null),Dl=Rl=t,Pl=0,Ol=null,Fl=Ul=Nl=0,jl=Bl=null,null!==Ds){for(t=0;t<Ds.length;t++)if(null!==(i=(n=Ds[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var a=s.next;s.next=r,i.next=a}n.pending=i}Ds=null}return e}function fu(e,t){for(;;){var n=Ll;try{if(xs(),ia.current=Qa,ua){for(var i=aa.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ua=!1}if(sa=0,la=oa=aa=null,ca=!1,da=0,xl.current=null,null===n||null===n.return){Pl=1,Ol=t,Ll=null;break}e:{var a=e,o=n.return,l=n,u=t;if(t=Dl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=mo(o);if(null!==p){p.flags&=-257,yo(p,o,l,0,t),1&p.mode&&go(a,c,t),u=c;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(u),t.updateQueue=m}else g.add(u);break e}if(0===(1&t)){go(a,c,t),gu();break e}u=Error(s(426))}else if(rs&&1&l.mode){var y=mo(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),yo(y,o,l,0,t),ps(lo(u,l));break e}}a=u=lo(u,l),4!==Pl&&(Pl=2),null===Bl?Bl=[a]:Bl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,$s(a,fo(0,u,t));break e;case 1:l=u;var v=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===zl||!zl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,$s(a,po(a,l,t));break e}}a=a.return}while(null!==a)}Tu(n)}catch(T){t=T,Ll===n&&null!==n&&(Ll=n=n.return);continue}break}}function pu(){var e=kl.current;return kl.current=Qa,null===e?Qa:e}function gu(){0!==Pl&&3!==Pl&&2!==Pl||(Pl=4),null===Il||0===(268435455&Nl)&&0===(268435455&Ul)||ou(Il,Dl)}function mu(e,t){var n=Cl;Cl|=2;var i=pu();for(Il===e&&Dl===t||(Hl=null,hu(e,t));;)try{yu();break}catch(r){fu(e,r)}if(xs(),Cl=n,kl.current=i,null!==Ll)throw Error(s(261));return Il=null,Dl=0,Pl}function yu(){for(;null!==Ll;)bu(Ll)}function vu(){for(;null!==Ll&&!Xe();)bu(Ll)}function bu(e){var t=wl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?Tu(e):Ll=t,xl.current=null}function Tu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Rl)))return void(Ll=n)}else{if(null!==(n=Wo(n,t)))return n.flags&=32767,void(Ll=n);if(null===e)return Pl=6,void(Ll=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ll=t);Ll=t=e}while(null!==t);0===Pl&&(Pl=5)}function Su(e,t,n){var i=bt,r=Al.transition;try{Al.transition=null,bt=1,function(e,t,n,i){do{_u()}while(null!==Wl);if(0!==(6&Cl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-at(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,a),e===Il&&(Ll=Il=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Iu(tt,(function(){return _u(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Al.transition,Al.transition=null;var o=bt;bt=1;var l=Cl;Cl|=4,xl.current=null,function(e,t){if(er=qt,fi(e=hi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(S){n=null;break e}var o=0,l=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==r&&3!==h.nodeType||(l=o+r),h!==a||0!==i&&3!==h.nodeType||(u=o+i),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++c===r&&(l=o),f===a&&++d===i&&(u=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},qt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,y=g.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:to(t.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var T=t.stateNode.containerInfo;1===T.nodeType?T.textContent="":9===T.nodeType&&T.documentElement&&T.removeChild(T.documentElement);break;default:throw Error(s(163))}}catch(S){Eu(t,t.return,S)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}g=tl,tl=!1}(e,n),ml(n,e),pi(tr),qt=!!er,tr=er=null,e.current=n,vl(n,e,r),Ye(),Cl=l,bt=o,Al.transition=a}else e.current=n;if(Kl&&(Kl=!1,Wl=e,Xl=r),a=e.pendingLanes,0===a&&(zl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),iu(e,Qe()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(ql)throw ql=!1,e=Gl,Gl=null,e;0!==(1&Xl)&&0!==e.tag&&_u(),a=e.pendingLanes,0!==(1&a)?e===Ql?Yl++:(Yl=0,Ql=e):Yl=0,Vr()}(e,t,n,i)}finally{Al.transition=r,bt=i}return null}function _u(){if(null!==Wl){var e=Tt(Xl),t=Al.transition,n=bt;try{if(Al.transition=null,bt=16>e?16:e,null===Wl)var i=!1;else{if(e=Wl,Wl=null,Xl=0,0!==(6&Cl))throw Error(s(331));var r=Cl;for(Cl|=4,Jo=e.current;null!==Jo;){var a=Jo,o=a.child;if(0!==(16&Jo.flags)){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Jo=c;null!==Jo;){var d=Jo;switch(d.tag){case 0:case 11:case 15:nl(8,d,a)}var h=d.child;if(null!==h)h.return=d,Jo=h;else for(;null!==Jo;){var f=(d=Jo).sibling,p=d.return;if(sl(d),d===c){Jo=null;break}if(null!==f){f.return=p,Jo=f;break}Jo=p}}}var g=a.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Jo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(a=Jo).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Jo=v;break e}Jo=a.return}}var b=e.current;for(Jo=b;null!==Jo;){var T=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==T)T.return=o,Jo=T;else e:for(o=b;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(_){Eu(l,l.return,_)}if(l===o){Jo=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,Jo=S;break e}Jo=l.return}}if(Cl=r,Vr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(_){}i=!0}return i}finally{bt=n,Al.transition=t}}return!1}function wu(e,t,n){e=Bs(e,t=fo(0,t=lo(n,t),1),1),t=eu(),null!==e&&(yt(e,1,t),iu(e,t))}function Eu(e,t,n){if(3===e.tag)wu(e,e,n);else for(;null!==t;){if(3===t.tag){wu(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===zl||!zl.has(i))){t=Bs(t,e=po(t,e=lo(n,e),1),1),e=eu(),null!==t&&(yt(t,1,e),iu(t,e));break}}t=t.return}}function ku(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=eu(),e.pingedLanes|=e.suspendedLanes&n,Il===e&&(Dl&n)===n&&(4===Pl||3===Pl&&(130023424&Dl)===Dl&&500>Qe()-$l?hu(e,0):Fl|=n),iu(e,t)}function xu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=eu();null!==(e=Ps(e,t))&&(yt(e,t,n),iu(e,n))}function Au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),xu(e,n)}function Cu(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),xu(e,n)}function Iu(e,t){return Ke(e,t)}function Lu(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Du(e,t,n,i){return new Lu(e,t,n,i)}function Ru(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mu(e,t){var n=e.alternate;return null===n?((n=Du(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pu(e,t,n,i,r,a){var o=2;if(i=e,"function"===typeof e)Ru(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case w:return Ou(n.children,r,a,t);case E:o=8,r|=8;break;case k:return(e=Du(12,n,t,2|r)).elementType=k,e.lanes=a,e;case I:return(e=Du(13,n,t,r)).elementType=I,e.lanes=a,e;case L:return(e=Du(19,n,t,r)).elementType=L,e.lanes=a,e;case M:return Nu(n,r,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case x:o=10;break e;case A:o=9;break e;case C:o=11;break e;case D:o=14;break e;case R:o=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Du(o,n,t,r)).elementType=e,t.type=i,t.lanes=a,t}function Ou(e,t,n,i){return(e=Du(7,e,i,t)).lanes=n,e}function Nu(e,t,n,i){return(e=Du(22,e,i,t)).elementType=M,e.lanes=n,e.stateNode={isHidden:!1},e}function Uu(e,t,n){return(e=Du(6,e,null,t)).lanes=n,e}function Fu(e,t,n){return(t=Du(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bu(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function ju(e,t,n,i,r,s,a,o,l){return e=new Bu(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Du(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ns(s),e}function $u(e){if(!e)return Ar;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Rr(n))return Or(e,n,t)}return t}function Vu(e,t,n,i,r,s,a,o,l){return(e=ju(n,i,!0,e,0,s,0,o,l)).context=$u(null),n=e.current,(s=Fs(i=eu(),r=tu(n))).callback=void 0!==t&&null!==t?t:null,Bs(n,s,r),e.current.lanes=r,yt(e,r,i),iu(e,i),e}function Hu(e,t,n,i){var r=t.current,s=eu(),a=tu(r);return n=$u(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fs(s,a)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Bs(r,t,a))&&(nu(e,r,a,s),js(e,r,a)),a}function qu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function zu(e,t){Gu(e,t),(e=e.alternate)&&Gu(e,t)}wl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ir.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Io(t),fs();break;case 5:Qs(t);break;case 1:Rr(t.type)&&Nr(t);break;case 4:Xs(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;xr(_s,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(xr(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Uo(e,t,n):(xr(Zs,1&Zs.current),null!==(e=qo(e,t,n))?e.sibling:null);xr(Zs,1&Zs.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Vo(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),xr(Zs,Zs.current),i)break;return null;case 22:case 23:return t.lanes=0,Eo(e,t,n)}return qo(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,rs&&0!==(1048576&t.flags)&&Zr(t,zr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ho(e,t),e=t.pendingProps;var r=Dr(t,Cr.current);Is(t,n),r=ga(null,t,i,e,r,n);var a=ma();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rr(i)?(a=!0,Nr(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ns(t),r.updater=io,t.stateNode=r,r._reactInternals=t,oo(t,i,e,n),t=Co(null,t,i,!0,a,n)):(t.tag=0,rs&&a&&es(t),To(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Ru(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===D)return 14}return 2}(i),e=to(i,e),r){case 0:t=xo(null,t,i,e,n);break e;case 1:t=Ao(null,t,i,e,n);break e;case 11:t=So(null,t,i,e,n);break e;case 14:t=_o(null,t,i,to(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,xo(e,t,i,r=t.elementType===i?r:to(i,r),n);case 1:return i=t.type,r=t.pendingProps,Ao(e,t,i,r=t.elementType===i?r:to(i,r),n);case 3:e:{if(Io(t),null===e)throw Error(s(387));i=t.pendingProps,r=(a=t.memoizedState).element,Us(e,t),Vs(t,i,null,n);var o=t.memoizedState;if(i=o.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Lo(e,t,i,n,r=lo(Error(s(423)),t));break e}if(i!==r){t=Lo(e,t,i,n,r=lo(Error(s(424)),t));break e}for(is=ur(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=Ss(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),i===r){t=qo(e,t,n);break e}To(e,t,i,n)}t=t.child}return t;case 5:return Qs(t),null===e&&us(t),i=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,o=r.children,nr(i,r)?o=null:null!==a&&nr(i,a)&&(t.flags|=32),ko(e,t),To(e,t,o,n),t.child;case 6:return null===e&&us(t),null;case 13:return Uo(e,t,n);case 4:return Xs(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Ts(t,null,i,n):To(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,So(e,t,i,r=t.elementType===i?r:to(i,r),n);case 7:return To(e,t,t.pendingProps,n),t.child;case 8:case 12:return To(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,a=t.memoizedProps,o=r.value,xr(_s,i._currentValue),i._currentValue=o,null!==a)if(oi(a.value,o)){if(a.children===r.children&&!Ir.current){t=qo(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var u=l.firstContext;null!==u;){if(u.context===i){if(1===a.tag){(u=Fs(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}a.lanes|=n,null!==(u=a.alternate)&&(u.lanes|=n),Cs(a.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Cs(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}To(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Is(t,n),i=i(r=Ls(r)),t.flags|=1,To(e,t,i,n),t.child;case 14:return r=to(i=t.type,t.pendingProps),_o(e,t,i,r=to(i.type,r),n);case 15:return wo(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:to(i,r),Ho(e,t),t.tag=1,Rr(i)?(e=!0,Nr(t)):e=!1,Is(t,n),so(t,i,r),oo(t,i,r,n),Co(null,t,i,!0,e,n);case 19:return Vo(e,t,n);case 22:return Eo(e,t,n)}throw Error(s(156,t.tag))};var Ku="function"===typeof reportError?reportError:function(e){console.error(e)};function Wu(e){this._internalRoot=e}function Xu(e){this._internalRoot=e}function Yu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Ju(){}function Zu(e,t,n,i,r){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof r){var o=r;r=function(){var e=qu(a);o.call(e)}}Hu(t,a,e,r)}else a=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=qu(a);s.call(e)}}var a=Vu(t,i,e,0,null,!1,0,"",Ju);return e._reactRootContainer=a,e[pr]=a.current,Vi(8===e.nodeType?e.parentNode:e),cu(),a}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var o=i;i=function(){var e=qu(l);o.call(e)}}var l=ju(e,0,!1,null,0,!1,0,"",Ju);return e._reactRootContainer=l,e[pr]=l.current,Vi(8===e.nodeType?e.parentNode:e),cu((function(){Hu(t,l,n,i)})),l}(n,t,e,r,i);return qu(a)}Xu.prototype.render=Wu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Hu(e,t,null,null)},Xu.prototype.unmount=Wu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cu((function(){Hu(null,e,null,null)})),t[pr]=null}},Xu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mt.length&&0!==t&&t<Mt[n].priority;n++);Mt.splice(n,0,e),0===n&&Ut(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),iu(t,Qe()),0===(6&Cl)&&(Vl=Qe()+500,Vr()))}break;case 13:cu((function(){var t=Ps(e,1);if(null!==t){var n=eu();nu(t,e,1,n)}})),zu(e,1)}},_t=function(e){if(13===e.tag){var t=Ps(e,134217728);if(null!==t)nu(t,e,134217728,eu());zu(e,134217728)}},wt=function(e){if(13===e.tag){var t=tu(e),n=Ps(e,t);if(null!==n)nu(n,e,t,eu());zu(e,t)}},Et=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},_e=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=Sr(i);if(!r)throw Error(s(90));K(i),J(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=uu,Ie=cu;var ec={usingClientEntryPoint:!1,Events:[br,Tr,Sr,xe,Ae,uu]},tc={findFiberByHostInstance:vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nc={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{rt=ic.inject(nc),st=ic}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yu(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yu(e))throw Error(s(299));var n=!1,i="",r=Ku;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=ju(e,1,!1,null,0,n,0,i,r),e[pr]=t.current,Vi(8===e.nodeType?e.parentNode:e),new Wu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return cu(e)},t.hydrate=function(e,t,n){if(!Qu(t))throw Error(s(200));return Zu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yu(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,a="",o=Ku;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Vu(t,null,e,1,null!=n?n:null,r,0,a,o),e[pr]=t.current,Vi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Xu(t)},t.render=function(e,t,n){if(!Qu(t))throw Error(s(200));return Zu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qu(e))throw Error(s(40));return!!e._reactRootContainer&&(cu((function(){Zu(null,null,e,!1,(function(){e._reactRootContainer=null,e[pr]=null}))})),!0)},t.unstable_batchedUpdates=uu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Qu(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zu(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},739:(e,t,n)=>{var i;i="undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},e.exports=i},853:(e,t,n)=>{"use strict";e.exports=n(234)},877:(e,t,n)=>{"use strict";var i=n(739),r=n(634),s=n(307),a=n(9),o=n(459);c.httpHandler=n(252),c.requestInterceptorsStorage=new a,c.responseInterceptorsStorage=new a,c.retryManager=new o;var l=function(e){var t={};return e?(e.trim().split("\n").forEach((function(e){var n=e.indexOf(":"),i=e.slice(0,n).trim().toLowerCase(),r=e.slice(n+1).trim();"undefined"===typeof t[i]?t[i]=r:Array.isArray(t[i])?t[i].push(r):t[i]=[t[i],r]})),t):t};function u(e,t,n){var i=e;return s(t)?(n=t,"string"===typeof e&&(i={uri:e})):i=r({},t,{uri:e}),i.callback=n,i}function c(e,t,n){return d(t=u(e,t,n))}function d(e){if("undefined"===typeof e.callback)throw new Error("callback argument missing");if(e.requestType&&c.requestInterceptorsStorage.getIsEnabled()){var t={uri:e.uri||e.url,headers:e.headers||{},body:e.body,metadata:e.metadata||{},retry:e.retry,timeout:e.timeout},n=c.requestInterceptorsStorage.execute(e.requestType,t);e.uri=n.uri,e.headers=n.headers,e.body=n.body,e.metadata=n.metadata,e.retry=n.retry,e.timeout=n.timeout}var i=!1,r=function(t,n,r){i||(i=!0,e.callback(t,n,r))};function s(){var e=void 0;if(e=f.response?f.response:f.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(n){}return null}(f),T)try{e=JSON.parse(e)}catch(t){}return e}function a(t){if(clearTimeout(p),clearTimeout(e.retryTimeout),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,h||!c.retryManager.getIsEnabled()||!e.retry||!e.retry.shouldRetry()){if(e.requestType&&c.responseInterceptorsStorage.getIsEnabled()){var n={headers:S.headers||{},body:S.body,responseUrl:f.responseURL,responseType:f.responseType},i=c.responseInterceptorsStorage.execute(e.requestType,n);S.body=i.body,S.headers=i.headers}return r(t,S)}e.retryTimeout=setTimeout((function(){e.retry.moveToNextAttempt(),e.xhr=f,d(e)}),e.retry.getCurrentFuzzedDelay())}function o(){if(!h){var t;clearTimeout(p),clearTimeout(e.retryTimeout),t=e.useXDR&&void 0===f.status?200:1223===f.status?204:f.status;var n=S,i=null;if(0!==t?(n={body:s(),statusCode:t,method:m,headers:{},url:g,rawRequest:f},f.getAllResponseHeaders&&(n.headers=l(f.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),e.requestType&&c.responseInterceptorsStorage.getIsEnabled()){var a={headers:n.headers||{},body:n.body,responseUrl:f.responseURL,responseType:f.responseType},o=c.responseInterceptorsStorage.execute(e.requestType,a);n.body=o.body,n.headers=o.headers}return r(i,n,n.body)}}var u,h,f=e.xhr||null;f||(f=e.cors||e.useXDR?new c.XDomainRequest:new c.XMLHttpRequest);var p,g=f.url=e.uri||e.url,m=f.method=e.method||"GET",y=e.body||e.data,v=f.headers=e.headers||{},b=!!e.sync,T=!1,S={body:void 0,headers:{},statusCode:0,method:m,url:g,rawRequest:f};if("json"in e&&!1!==e.json&&(T=!0,v.accept||v.Accept||(v.Accept="application/json"),"GET"!==m&&"HEAD"!==m&&(v["content-type"]||v["Content-Type"]||(v["Content-Type"]="application/json"),y=JSON.stringify(!0===e.json?y:e.json))),f.onreadystatechange=function(){4!==f.readyState||c.responseInterceptorsStorage.getIsEnabled()||setTimeout(o,0)},f.onload=o,f.onerror=a,f.onprogress=function(){},f.onabort=function(){h=!0,clearTimeout(e.retryTimeout)},f.ontimeout=a,f.open(m,g,!b,e.username,e.password),b||(f.withCredentials=!!e.withCredentials),!b&&e.timeout>0&&(p=setTimeout((function(){if(!h){h=!0,f.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",a(e)}}),e.timeout)),f.setRequestHeader)for(u in v)v.hasOwnProperty(u)&&f.setRequestHeader(u,v[u]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(f.responseType=e.responseType),"beforeSend"in e&&"function"===typeof e.beforeSend&&e.beforeSend(f),f.send(y||null),f}e.exports=c,e.exports.default=c,c.XMLHttpRequest=i.XMLHttpRequest||function(){},c.XDomainRequest="withCredentials"in new c.XMLHttpRequest?c.XMLHttpRequest:i.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],(function(e){c["delete"===e?"del":e]=function(t,n,i){return(n=u(t,n,i)).method=e.toUpperCase(),d(n)}}))},899:(e,t,n)=>{var i=n(699);i.DOMImplementation,i.XMLSerializer,t.DOMParser=n(120).DOMParser},923:(e,t)=>{"use strict";function n(e,t){return void 0===t&&(t=Object),t&&"function"===typeof t.freeze?t.freeze(e):e}var i=n({HTML:"text/html",isHTML:function(e){return e===i.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),r=n({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===r.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});t.assign=function(e,t){if(null===e||"object"!==typeof e)throw new TypeError("target is not an object");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},t.find=function(e,t,n){if(void 0===n&&(n=Array.prototype),e&&"function"===typeof n.find)return n.find.call(e,t);for(var i=0;i<e.length;i++)if(Object.prototype.hasOwnProperty.call(e,i)){var r=e[i];if(t.call(void 0,r,i,e))return r}},t.freeze=n,t.MIME_TYPE=i,t.NAMESPACE=r},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},963:e=>{var t=Math.pow(2,32);e.exports={getUint64:function(e){var n,i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.getBigUint64?(n=i.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(n):n:i.getUint32(0)*t+i.getUint32(4)},MAX_UINT32:t}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>"static/js/"+e+".780c195c.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="nav-player:";n.l=(i,r,s,a)=>{if(e[i])e[i].push(r);else{var o,l;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+s){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=i),e[i]=[r];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var r=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/nav-player/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise(((n,i)=>r=e[t]=[n,i]));i.push(r[2]=s);var a=n.p+n.u(t),o=new Error;n.l(a,(i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,r[1](o)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,s,a=i[0],o=i[1],l=i[2],u=0;if(a.some((t=>0!==e[t]))){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(t&&t(i);u<a.length;u++)s=a[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},i=self.webpackChunknav_player=self.webpackChunknav_player||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e=n(43),t=n(391);class i{static registerPlugin(e,t){this.pluginFactories[e]=t}static getPlugin(e){return this.pluginFactories[e]?this.pluginFactories[e]():void 0}static getAvailablePlugins(){return Object.keys(this.pluginFactories)}}i.pluginFactories={};const r=i,s=(t,n,i,s)=>{const a=(0,e.useRef)(null),[o,l]=(0,e.useState)(null);return(0,e.useEffect)((()=>{const e=r.getPlugin(t);if(e){if(a.current){const t=i&&s?{drmType:i,licenseUrl:s}:null;e.initialize(a.current,t?{drm:{[t.drmType]:{serverURL:t.licenseUrl}}}:{}),e.load(n,t),l(e)}return()=>{e&&e.destroy(),l(null)}}console.error(`Plugin "${t}" not found.`)}),[t,n,i,s]),{playerContainerRef:a,playerInstance:o}},a=t=>{const n={buffering:!1,currentBitrate:0,resolution:"N/A",renditionSwitches:0,events:[]},[i,r]=(0,e.useState)(n);return(0,e.useEffect)((()=>{var e,i,s;if(!t)return;r(n);const a=()=>{r((e=>{var n,i;return{...e,currentBitrate:(null===(n=t.getBitrate)||void 0===n?void 0:n.call(t))||e.currentBitrate,resolution:(null===(i=t.getResolution)||void 0===i?void 0:i.call(t))||e.resolution}}))},o=e=>{r((t=>({...t,events:[`[${(new Date).toLocaleTimeString()}] ${e}`,...t.events].slice(0,5)})))};null===(e=t.on)||void 0===e||e.call(t,"buffering",(()=>{o("Buffering..."),r((e=>({...e,buffering:!0})))})),null===(i=t.on)||void 0===i||i.call(t,"playing",(()=>{o("Playing..."),r((e=>({...e,buffering:!1})))})),null===(s=t.on)||void 0===s||s.call(t,"renditionchange",(()=>{o("Rendition Changed"),r((e=>({...e,renditionSwitches:e.renditionSwitches+1}))),a()}));const l=setInterval(a,1e3);return a(),()=>{var e,n,i;null===(e=t.off)||void 0===e||e.call(t,"buffering",(()=>{})),null===(n=t.off)||void 0===n||n.call(t,"playing",(()=>{})),null===(i=t.off)||void 0===i||i.call(t,"renditionchange",(()=>{})),clearInterval(l)}}),[t]),i};var o=n(579);const l=e=>{let{playerInstance:t}=e;const n=a(t);return(0,o.jsxs)("div",{className:"qoeContainer",children:[(0,o.jsx)("h3",{children:"\ud83c\udfa5 Player QoE Metrics"}),(0,o.jsxs)("div",{className:"metrics",children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83d\udcf6 Bitrate:"})," ",n.currentBitrate," Kbps"]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83d\udcfa Resolution:"})," ",n.resolution]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83d\udd04 Rendition Switches:"})," ",n.renditionSwitches]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\u23f3 Buffering:"})," ",n.buffering?"Yes \ud83d\udd34":"No \ud83d\udfe2"]})]}),(0,o.jsx)("h4",{children:"\ud83d\udccb Recent Player Events"}),(0,o.jsx)("ul",{className:"events",children:n.events.map(((e,t)=>(0,o.jsx)("li",{children:e},t)))})]})},u=t=>{let{playerInstance:n}=t;const[i,r]=(0,e.useState)(!1),[s,a]=(0,e.useState)([]),[l,u]=(0,e.useState)("ABR"),[c,d]=(0,e.useState)(0);(0,e.useEffect)((()=>{var e,t;if(!n)return;u("ABR");const i=()=>{var e;const t=(null===(e=n.getAvailableRenditions)||void 0===e?void 0:e.call(n))||[];t.length>0&&(a(t),d((e=>e+1)))};return i(),null===(e=n.on)||void 0===e||e.call(n,"loadedmetadata",i),null===(t=n.on)||void 0===t||t.call(n,"renditionchange",i),()=>{var e,t;null===(e=n.off)||void 0===e||e.call(n,"loadedmetadata",i),null===(t=n.off)||void 0===t||t.call(n,"renditionchange",i)}}),[n]);const h=e=>{var t,i,r;(u(e),"ABR"===e)?null===n||void 0===n||null===(t=n.setAdaptiveBitrate)||void 0===t||t.call(n,!0):(null===n||void 0===n||null===(i=n.setAdaptiveBitrate)||void 0===i||i.call(n,!1),null===n||void 0===n||null===(r=n.setRendition)||void 0===r||r.call(n,e))};return(0,o.jsxs)("div",{className:"accordion",children:[(0,o.jsxs)("button",{className:"accordion-header",onClick:()=>r(!i),children:["\ud83c\udf9b Renditions ",i?"\u25b2":"\u25bc"]}),i&&(0,o.jsxs)("div",{className:"accordion-content",children:[(0,o.jsx)("h4",{children:"\ud83d\udce1 Select Video Quality"}),(0,o.jsxs)("label",{className:"radio-label",children:[(0,o.jsx)("input",{type:"radio",value:"ABR",checked:"ABR"===l,onChange:()=>h("ABR")}),"Auto (ABR)"]}),s.map(((e,t)=>(0,o.jsxs)("label",{className:"radio-label",children:[(0,o.jsx)("input",{type:"radio",value:e.resolution,checked:l===e.resolution,onChange:()=>h(e.resolution)}),e.resolution," (",e.bitrate," Kbps)"]},`${e.resolution}-${t}-${c}`)))]})]})},c=async e=>{if(!navigator.requestMediaKeySystemAccess)return!1;try{return await navigator.requestMediaKeySystemAccess(e,[{initDataTypes:["cenc"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]}]),!0}catch(t){return!1}},d=()=>{const[t,n]=(0,e.useState)(!1),[i,r]=(0,e.useState)({browser:"",resolution:"",supportsWidevine:!1,supportsPlayReady:!1});return(0,e.useEffect)((()=>{(async()=>({browser:navigator.userAgent,resolution:`${window.screen.width}x${window.screen.height}`,supportsWidevine:await c("com.widevine.alpha"),supportsPlayReady:await c("com.microsoft.playready")}))().then(r)}),[]),(0,o.jsxs)("div",{className:"accordion",children:[(0,o.jsxs)("button",{className:"accordion-header",onClick:()=>n(!t),children:["\ud83d\udcf1 Device Capabilities ",t?"\u25b2":"\u25bc"]}),t&&(0,o.jsxs)("div",{className:"accordion-content",children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83c\udf10 Browser:"})," ",i.browser]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83d\udda5 Supported Resolution:"})," ",i.resolution]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83d\udd12 Widevine DRM:"})," ",i.supportsWidevine?"\u2714 Supported":"\u274c Not Supported"]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83d\udd10 PlayReady DRM:"})," ",i.supportsPlayReady?"\u2714 Supported":"\u274c Not Supported"]})]})]})},h=t=>{let{videoURL:n,drmType:i,licenseUrl:r}=t;const[s,a]=(0,e.useState)(!1);return(0,o.jsxs)("div",{className:"accordion",children:[(0,o.jsxs)("button",{className:"accordion-header",onClick:()=>a(!s),children:["\ud83c\udfa5 Stream Details ",s?"\u25b2":"\u25bc"]}),s&&(0,o.jsxs)("div",{className:"accordion-content",children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83d\udce1 Stream URL:"})," ",n]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83d\udd12 DRM Type:"})," ",i||"None"]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"\ud83d\udd11 License URL:"})," ",r||"Not Required"]})]})]})},f=e=>{let{src:t,pluginName:n,drmType:i,licenseUrl:r}=e;const{playerContainerRef:a,playerInstance:c}=s(n,t,i,r);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{ref:a,className:"videoContainer"}),c&&(0,o.jsx)(l,{playerInstance:c}),c&&(0,o.jsx)(u,{playerInstance:c}),(0,o.jsx)(d,{}),(0,o.jsx)(h,{videoURL:t,drmType:i,licenseUrl:r})]})},p=t=>{let{defaultURL:n,onLoad:i}=t;const[r,s]=(0,e.useState)(!1),[a,l]=(0,e.useState)(!1),[u,c]=(0,e.useState)(n),[d,h]=(0,e.useState)(null),[f,p]=(0,e.useState)("");return(0,o.jsxs)("div",{className:"video-url-input",children:[(0,o.jsx)("h3",{children:"\ud83d\udd17 Video Options"}),(0,o.jsxs)("label",{className:"checkbox-container",children:[(0,o.jsx)("input",{type:"checkbox",checked:r,onChange:()=>s(!r)}),"Enable Custom Input"]}),r&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{children:(0,o.jsx)("input",{type:"text",className:"input-field",value:u,onChange:e=>c(e.target.value),placeholder:"Enter video manifest URL..."})}),(0,o.jsxs)("label",{className:"checkbox-container",children:[(0,o.jsx)("input",{type:"checkbox",checked:a,onChange:()=>{l(!a),a||(h(null),p(""))}}),"Enable DRM"]}),a&&(0,o.jsxs)("div",{className:"drm-options",children:[(0,o.jsx)("h4",{children:"\ud83d\udd12 Select DRM Type"}),(0,o.jsxs)("div",{className:"radio-group",children:[(0,o.jsxs)("label",{className:"radio-label",children:[(0,o.jsx)("input",{type:"radio",value:"widevine",checked:"widevine"===d,onChange:()=>h("widevine")}),"Widevine"]}),(0,o.jsxs)("label",{className:"radio-label",children:[(0,o.jsx)("input",{type:"radio",value:"playready",checked:"playready"===d,onChange:()=>h("playready")}),"PlayReady"]})]}),(0,o.jsx)("h4",{children:"\ud83d\udd11 Enter DRM License URL"}),(0,o.jsx)("input",{type:"text",className:"input-field",value:f,onChange:e=>p(e.target.value),placeholder:"Enter license URL..."})]}),(0,o.jsx)("button",{className:"load-button",onClick:()=>{i(u,a?d:null,a?f:null)},children:"Load"})]})]})};function g(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var m,y={exports:{}};m=y,function(){var e=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,t=/^(?=([^\/?#]*))\1([^]*)$/,n=/(?:\/|^)\.(?=\/)/g,i=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,r={buildAbsoluteURL:function(e,n,i){if(i=i||{},e=e.trim(),!(n=n.trim())){if(!i.alwaysNormalize)return e;var s=r.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");return s.path=r.normalizePath(s.path),r.buildURLFromParts(s)}var a=r.parseURL(n);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=r.normalizePath(a.path),r.buildURLFromParts(a)):n;var o=r.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=t.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=r.normalizePath(d)}else u.path=o.path,a.params||(u.params=o.params,a.query||(u.query=o.query));return null===u.path&&(u.path=i.alwaysNormalize?r.normalizePath(a.path):a.path),r.buildURLFromParts(u)},parseURL:function(t){var n=e.exec(t);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(i,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};m.exports=r}();var v=y.exports;function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function _(e,t,n){return(t=S(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},w.apply(this,arguments)}const E=Number.isFinite||function(e){return"number"===typeof e&&isFinite(e)},k=Number.isSafeInteger||function(e){return"number"===typeof e&&Math.abs(e)<=x},x=Number.MAX_SAFE_INTEGER||9007199254740991;let A=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e}({}),C=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),I=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown",e}({});const L=function(){},D={trace:L,debug:L,log:L,warn:L,info:L,error:L};let R=D;function M(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){R[t]=e[t]?e[t].bind(e):function(e){const t=self.console[e];return t?t.bind(self.console,`[${e}] >`):L}(t)}))}const P=R,O=/^(\d+)x(\d+)$/,N=/(.+?)=(".*?"|.*?)(?:,|$)/g;class U{constructor(e){"string"===typeof e&&(e=U.parseAttrList(e)),w(this,e)}get clientAttrs(){return Object.keys(this).filter((e=>"X-"===e.substring(0,2)))}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=O.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={};for(N.lastIndex=0;null!==(t=N.exec(e));){let e=t[2];0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1&&(e=e.slice(1,-1));n[t[1].trim()]=e}return n}}function F(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}class B{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){P.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=w(new U({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=new Date(this.attr["END-DATE"]);E(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(E(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&E(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class j{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var $="audio",V="video",H="audiovideo";class q{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[$]:null,[V]:null,[H]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let i;i=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=v.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class G extends q{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new j,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!E(this.programDateTime))return null;const e=E(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const{elementaryStreams:a}=this,o=a[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,n),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,r)):a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:s}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[$]=null,e[V]=null,e[H]=null}}class z extends q{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new j,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const s=e.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}class K{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&E(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;if(e>0){return 1e3*(this.driftEnd-this.driftStart)/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function W(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}function X(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),i=e[e.length-1].split(",");if(2===i.length){const t="base64"===i[0],r=i[1];t?(e.splice(-1,1),n=W(r)):n=function(e){const t=Y(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}(r)}}return n}function Y(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(e=>e.charCodeAt(0)))}const Q="undefined"!==typeof self?self:void 0;var J={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Z="org.w3.clearkey",ee="com.apple.streamingkeydelivery",te="com.microsoft.playready",ne="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function ie(e){switch(e){case ee:return J.FAIRPLAY;case te:return J.PLAYREADY;case ne:return J.WIDEVINE;case Z:return J.CLEARKEY}}var re="1077efecc0b24d02ace33c1e52e2fb4b",se="e2719d58a985b3c9781ab030af78d30e",ae="9a04f07998404286ab92e65be0885f95",oe="edef8ba979d64acea3c827dcd51d21ed";function le(e){return e===oe?J.WIDEVINE:e===ae?J.PLAYREADY:e===re||e===se?J.CLEARKEY:void 0}function ue(e){switch(e){case J.FAIRPLAY:return ee;case J.PLAYREADY:return te;case J.WIDEVINE:return ne;case J.CLEARKEY:return Z}}function ce(e){const{drmSystems:t,widevineLicenseUrl:n}=e,i=t?[J.FAIRPLAY,J.WIDEVINE,J.PLAYREADY,J.CLEARKEY].filter((e=>!!t[e])):[];return!i[J.WIDEVINE]&&n&&i.push(J.WIDEVINE),i}const de=null!=Q&&null!=(he=Q.navigator)&&he.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var he;function fe(e){const t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),n=String.fromCharCode.apply(null,Array.from(t)),i=n.substring(n.indexOf("<"),n.length),r=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(r){const e=r.childNodes[0]?r.childNodes[0].nodeValue:r.getAttribute("VALUE");if(e){const t=W(e).subarray(0,16);return function(e){const t=function(e,t,n){const i=e[t];e[t]=e[n],e[n]=i};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(t),t}}return null}function pe(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}const ge=(e,t)=>t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,me=(e,t)=>t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,ye=(e,t)=>{const n=t;let i=0;for(;ge(e,t);){i+=10;i+=ve(e,t+6),me(e,t+10)&&(i+=10),t+=i}if(i>0)return e.subarray(n,n+i)},ve=(e,t)=>{let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n},be=(e,t)=>ge(e,t)&&ve(e,t+6)+10<=e.length-t,Te=e=>{const t=we(e);for(let n=0;n<t.length;n++){const e=t[n];if(Se(e))return Ce(e)}},Se=e=>e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info,_e=e=>{const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=ve(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}},we=e=>{let t=0;const n=[];for(;ge(e,t);){const i=ve(e,t+6);t+=10;const r=t+i;for(;t+8<r;){const i=_e(e.subarray(t)),r=Ee(i);r&&n.push(r),t+=i.size+10}me(e,t)&&(t+=10)}return n},Ee=e=>"PRIV"===e.type?ke(e):"W"===e.type[0]?Ae(e):xe(e),ke=e=>{if(e.size<2)return;const t=Ie(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}},xe=e=>{if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=Ie(e.data.subarray(t),!0);t+=n.length+1;const i=Ie(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=Ie(e.data.subarray(1));return{key:e.type,data:t}},Ae=e=>{if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=Ie(e.data.subarray(t),!0);t+=n.length+1;const i=Ie(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=Ie(e.data);return{key:e.type,data:t}},Ce=e=>{if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}},Ie=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=function(){if(navigator.userAgent.includes("PlayStation 4"))return;Le||"undefined"===typeof self.TextDecoder||(Le=new self.TextDecoder("utf-8"));return Le}();if(n){const i=n.decode(e);if(t){const e=i.indexOf("\0");return-1!==e?i.substring(0,e):i}return i.replace(/\0/g,"")}const i=e.length;let r,s,a,o="",l=0;for(;l<i;){if(r=e[l++],0===r&&t)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:s=e[l++],o+=String.fromCharCode((31&r)<<6|63&s);break;case 14:s=e[l++],a=e[l++],o+=String.fromCharCode((15&r)<<12|(63&s)<<6|63&a)}}return o};let Le;const De=function(e){let t="";for(let n=0;n<e.length;n++){let i=e[n].toString(16);i.length<2&&(i="0"+i),t+=i}return t},Re=Math.pow(2,32)-1,Me=[].push,Pe={video:1,audio:2,id3:3,text:4};function Oe(e){return String.fromCharCode.apply(null,e)}function Ne(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function Ue(e,t){const n=Be(e,t);return n<0?4294967296+n:n}function Fe(e,t){let n=Ue(e,t);return n*=Math.pow(2,32),n+=Ue(e,t+4),n}function Be(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function je(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function $e(e,t){const n=[];if(!t.length)return n;const i=e.byteLength;for(let r=0;r<i;){const s=Ue(e,r),a=s>1?r+s:i;if(Oe(e.subarray(r+4,r+8))===t[0])if(1===t.length)n.push(e.subarray(r+8,a));else{const i=$e(e.subarray(r+8,a),t.slice(1));i.length&&Me.apply(n,i)}r=a}return n}function Ve(e){const t=[],n=e[0];let i=8;const r=Ue(e,i);i+=4;let s=0,a=0;0===n?(s=Ue(e,i),a=Ue(e,i+4),i+=8):(s=Fe(e,i),a=Fe(e,i+8),i+=16),i+=2;let o=e.length+a;const l=Ne(e,i);i+=2;for(let u=0;u<l;u++){let n=i;const s=Ue(e,n);n+=4;const a=2147483647&s;if(1===(2147483648&s)>>>31)return P.warn("SIDX has hierarchical references (not supported)"),null;const l=Ue(e,n);n+=4,t.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/r,start:o,end:o+a-1}}),o+=a,n+=4,i=n}return{earliestPresentationTime:s,timescale:r,version:n,referencesCount:l,references:t}}function He(e){const t=[],n=$e(e,["moov","trak"]);for(let i=0;i<n.length;i++){const e=n[i],r=$e(e,["tkhd"])[0];if(r){let n=r[0];const i=Ue(r,0===n?12:20),s=$e(e,["mdia","mdhd"])[0];if(s){n=s[0];const r=Ue(s,0===n?12:20),a=$e(e,["mdia","hdlr"])[0];if(a){const n=Oe(a.subarray(8,12)),s={soun:$,vide:V}[n];if(s){const n=qe($e(e,["mdia","minf","stbl","stsd"])[0]);t[i]={timescale:r,type:s},t[s]=T({timescale:r,id:i},n)}}}}}return $e(e,["moov","mvex","trex"]).forEach((e=>{const n=Ue(e,4),i=t[n];i&&(i.default={duration:Ue(e,12),flags:Ue(e,20)})})),t}function qe(e){const t=e.subarray(8),n=t.subarray(86),i=Oe(t.subarray(4,8));let r=i;const s="enca"===i||"encv"===i;if(s){const e=$e(t,[i])[0];$e(e.subarray("enca"===i?28:78),["sinf"]).forEach((e=>{const t=$e(e,["schm"])[0];if(t){const n=Oe(t.subarray(4,8));if("cbcs"===n||"cenc"===n){const t=$e(e,["frma"])[0];t&&(r=Oe(t))}}}))}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const e=$e(n,["avcC"])[0];r+="."+ze(e[1])+ze(e[2])+ze(e[3]);break}case"mp4a":{const e=$e(t,[i])[0],n=$e(e.subarray(28),["esds"])[0];if(n&&n.length>12){let e=4;if(3!==n[e++])break;e=Ge(n,e),e+=2;const t=n[e++];if(128&t&&(e+=2),64&t&&(e+=n[e++]),4!==n[e++])break;e=Ge(n,e);const i=n[e++];if(64!==i)break;if(r+="."+ze(i),e+=12,5!==n[e++])break;e=Ge(n,e);const s=n[e++];let a=(248&s)>>3;31===a&&(a+=1+((7&s)<<3)+((224&n[e])>>5)),r+="."+a}break}case"hvc1":case"hev1":{const e=$e(n,["hvcC"])[0],t=e[1],i=["","A","B","C"][t>>6],s=31&t,a=Ue(e,2),o=(32&t)>>5?"H":"L",l=e[12],u=e.subarray(6,12);r+="."+i+s,r+="."+a.toString(16).toUpperCase(),r+="."+o+l;let c="";for(let n=u.length;n--;){const e=u[n];if(e||c){c="."+e.toString(16).toUpperCase()+c}}r+=c;break}case"dvh1":case"dvhe":{const e=$e(n,["dvcC"])[0],t=e[2]>>1&127,i=e[2]<<5&32|e[3]>>3&31;r+="."+Ke(t)+"."+Ke(i);break}case"vp09":{const e=$e(n,["vpcC"])[0],t=e[4],i=e[5],s=e[6]>>4&15;r+="."+Ke(t)+"."+Ke(i)+"."+Ke(s);break}case"av01":{const e=$e(n,["av1C"])[0],t=e[1]>>>5,i=31&e[1],s=e[2]>>>7?"H":"M",a=(64&e[2])>>6,o=(32&e[2])>>5,l=2===t&&a?o?12:10:a?10:8,u=(16&e[2])>>4,c=(8&e[2])>>3,d=(4&e[2])>>2,h=3&e[2],f=1,p=1,g=1,m=0;r+="."+t+"."+Ke(i)+s+"."+Ke(l)+"."+u+"."+c+d+h+"."+Ke(f)+"."+Ke(p)+"."+Ke(g)+"."+m;break}}return{codec:r,encrypted:s}}function Ge(e,t){const n=t+5;for(;128&e[t++]&&t<n;);return t}function ze(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function Ke(e){return(e<10?"0":"")+e}function We(e){const t=$e(e,["schm"])[0];if(t){const n=Oe(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return $e(e,["schi","tenc"])[0]}return null}function Xe(e){const t=Ue(e,0);let n=8;1&t&&(n+=4),4&t&&(n+=4);let i=0;const r=Ue(e,4);for(let s=0;s<r;s++){if(256&t){i+=Ue(e,n),n+=4}512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4)}return i}function Ye(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function Qe(e,t){const n=[],i=t.samples,r=t.timescale,s=t.id;let a=!1;return $e(i,["moof"]).map((o=>{const l=o.byteOffset-8;$e(o,["traf"]).map((o=>{const u=$e(o,["tfdt"]).map((e=>{const t=e[0];let n=Ue(e,4);return 1===t&&(n*=Math.pow(2,32),n+=Ue(e,8)),n/r}))[0];return void 0!==u&&(e=u),$e(o,["tfhd"]).map((u=>{const c=Ue(u,4),d=16777215&Ue(u,0);let h=0;const f=0!==(16&d);let p=0;const g=0!==(32&d);let m=8;c===s&&(0!==(1&d)&&(m+=8),0!==(2&d)&&(m+=4),0!==(8&d)&&(h=Ue(u,m),m+=4),f&&(p=Ue(u,m),m+=4),g&&(m+=4),"video"===t.type&&(a=function(e){if(!e)return!1;const t=e.indexOf("."),n=t<0?e:e.substring(0,t);return"hvc1"===n||"hev1"===n||"dvh1"===n||"dvhe"===n}(t.codec)),$e(o,["trun"]).map((s=>{const o=s[0],u=16777215&Ue(s,0),c=0!==(1&u);let d=0;const f=0!==(4&u),g=0!==(256&u);let m=0;const y=0!==(512&u);let v=0;const b=0!==(1024&u),T=0!==(2048&u);let S=0;const _=Ue(s,4);let w=8;c&&(d=Ue(s,w),w+=4),f&&(w+=4);let E=d+l;for(let l=0;l<_;l++){if(g?(m=Ue(s,w),w+=4):m=h,y?(v=Ue(s,w),w+=4):v=p,b&&(w+=4),T&&(S=0===o?Ue(s,w):Be(s,w),w+=4),t.type===V){let t=0;for(;t<v;){const s=Ue(i,E);if(E+=4,Je(a,i[E])){Ze(i.subarray(E,E+s),a?2:1,e+S/r,n)}E+=s,t+=s+4}}e+=m/r}})))}))}))})),n}function Je(e,t){if(e){const e=t>>1&63;return 39===e||40===e}return 6===(31&t)}function Ze(e,t,n,i){const r=et(e);let s=0;s+=t;let a=0,o=0,l=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(255===l);o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(255===l);const e=r.length-s;let t=s;if(o<e)s+=o;else if(o>e){P.error(`Malformed SEI payload. ${o} is too small, only ${e} bytes left to parse.`);break}if(4===a){if(181===r[t++]){const e=Ne(r,t);if(t+=2,49===e){const e=Ue(r,t);if(t+=4,1195456820===e){const e=r[t++];if(3===e){const s=r[t++],o=64&s,l=o?2+3*(31&s):0,u=new Uint8Array(l);if(o){u[0]=s;for(let e=1;e<l;e++)u[e]=r[t++]}i.push({type:e,payloadType:a,pts:n,bytes:u})}}}}}else if(5===a&&o>16){const e=[];for(let n=0;n<16;n++){const i=r[t++].toString(16);e.push(1==i.length?"0"+i:i),3!==n&&5!==n&&7!==n&&9!==n||e.push("-")}const s=o-16,l=new Uint8Array(s);for(let n=0;n<s;n++)l[n]=r[t++];i.push({payloadType:a,pts:n,uuid:e.join(""),userData:Ie(l),userDataBytes:l})}}}function et(e){const t=e.byteLength,n=[];let i=1;for(;i<t-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;const r=t-n.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),s[i]=e[a];return s}function tt(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let i,r,s;if(t){i=1,r=new Uint8Array(16*t.length);for(let e=0;e<t.length;e++){const n=t[e];if(16!==n.byteLength)throw new RangeError("Invalid key");r.set(n,16*e)}}else i=0,r=new Uint8Array;i>0?(s=new Uint8Array(4),t.length>0&&new DataView(s.buffer).setUint32(0,t.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.length;let s=8,a=r;for(;a--;)s+=n[a].byteLength;const o=new Uint8Array(s);for(o[0]=s>>24&255,o[1]=s>>16&255,o[2]=s>>8&255,o[3]=255&s,o.set(e,4),a=0,s=8;a<r;a++)o.set(n[a],s),s+=n[a].byteLength;return o}([112,115,115,104],new Uint8Array([i,0,0,0]),e,s,r,a,n||new Uint8Array)}function nt(e){const t=e.getUint32(0),n=e.byteOffset,i=e.byteLength;if(i<t)return{offset:n,size:i};if(1886614376!==e.getUint32(4))return{offset:n,size:t};const r=e.getUint32(8)>>>24;if(0!==r&&1!==r)return{offset:n,size:t};const s=e.buffer,a=De(new Uint8Array(s,n+12,16)),o=e.getUint32(28);let l=null,u=null;if(0===r){if(t-32<o||o<22)return{offset:n,size:t};u=new Uint8Array(s,n+32,o)}else if(1===r){if(!o||i<n+32+16*o+16)return{offset:n,size:t};l=[];for(let e=0;e<o;e++)l.push(new Uint8Array(s,n+32+16*e,16))}return{version:r,systemId:a,kids:l,data:u,offset:n,size:t}}let it={};class rt{static clearKeyUriToKeyIdMap(){it={}}constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case ee:case ne:case te:case Z:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!==typeof e&&("AES-128"!==this.method||this.iv||P.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=function(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}(e);return new rt(this.method,this.uri,"identity",this.keyFormatVersions,t)}const t=X(this.uri);if(t)switch(this.keyFormat){case ne:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case te:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=tt(e,null,t),this.keyId=fe(t);break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=it[this.uri];if(!e){const t=Object.keys(it).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16);new DataView(e.buffer,12,4).setUint32(0,t),it[this.uri]=e}this.keyId=e}return this}}const st=/\{\$([a-zA-Z0-9-_]+)\}/g;function at(e){return st.test(e)}function ot(e,t,n){if(null!==e.variableList||e.hasVariableRefs)for(let i=n.length;i--;){const r=n[i],s=t[r];s&&(t[r]=lt(e,s))}}function lt(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(st,(t=>{const i=t.substring(2,t.length-1),r=null==n?void 0:n[i];return void 0===r?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),t):r}))}return t}function ut(e,t,n){let i,r,s=e.variableList;if(s||(e.variableList=s={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{const e=new self.URL(n).searchParams;if(!e.has(i))throw new Error(`"${i}" does not match any query parameter in URI: "${n}"`);r=e.get(i)}catch(a){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else i=t.NAME,r=t.VALUE;i in s?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):s[i]=r||""}function ct(e,t,n){const i=t.IMPORT;if(n&&i in n){let t=e.variableList;t||(e.variableList=t={}),t[i]=n[i]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}function dt(){if("undefined"===typeof self)return;return(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}const ht={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function ft(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!e.split(",").some((e=>!pt(e,t,n)))}function pt(e,t){var n;const i=dt(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]);return null!=(n=null==i?void 0:i.isTypeSupported(gt(e,t)))&&n}function gt(e,t){return`${t}/mp4;codecs="${e}"`}function mt(e){if(e){const t=e.substring(0,4);return ht.video[t]}return 2}function yt(e){return e.split(",").reduce(((e,t)=>{const n=ht.video[t];return n?(2*n+e)/(e?3:2):(ht.audio[t]+e)/(e?2:1)}),0)}const vt={};const bt=/flac|opus/i;function Tt(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.replace(bt,(e=>function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(vt[e])return vt[e];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[e];for(let i=0;i<n.length;i++)if(pt(n[i],"audio",t))return vt[e]=n[i],n[i];return e}(e.toLowerCase(),t)))}function St(e,t){return e&&"mp4a"!==e?e:t?t.split(",")[0]:t}const _t=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,wt=/#EXT-X-MEDIA:(.*)/g,Et=/^#EXT(?:INF|-X-TARGETDURATION):/m,kt=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),xt=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class At{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return v.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Et.test(e)}static parseMasterPlaylist(e,t){const n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:at(e)},i=[];let r;for(_t.lastIndex=0;null!=(r=_t.exec(e));)if(r[1]){var s;const e=new U(r[1]);ot(n,e,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const a=lt(n,r[2]),o={attrs:e,bitrate:e.decimalInteger("BANDWIDTH")||e.decimalInteger("AVERAGE-BANDWIDTH"),name:e.NAME,url:At.resolve(a,t)},l=e.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),Lt(e.CODECS,o),null!=(s=o.unknownCodecs)&&s.length||i.push(o),n.levels.push(o)}else if(r[3]){const e=r[3],i=r[4];switch(e){case"SESSION-DATA":{const e=new U(i);ot(n,e,["DATA-ID","LANGUAGE","VALUE","URI"]);const t=e["DATA-ID"];t&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[t]=e);break}case"SESSION-KEY":{const e=Ct(i,t,n);e.encrypted&&e.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(e)):P.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${i}"`);break}case"DEFINE":{const e=new U(i);ot(n,e,["NAME","VALUE","QUERYPARAM"]),ut(n,e,t)}break;case"CONTENT-STEERING":{const e=new U(i);ot(n,e,["SERVER-URI","PATHWAY-ID"]),n.contentSteering={uri:At.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":n.startTimeOffset=It(i)}}const a=i.length>0&&i.length<n.levels.length;return n.levels=a?i:n.levels,0===n.levels.length&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,n){let i;const r={},s=n.levels,a={AUDIO:s.map((e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec}))),SUBTITLES:s.map((e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec}))),"CLOSED-CAPTIONS":[]};let o=0;for(wt.lastIndex=0;null!==(i=wt.exec(e));){const e=new U(i[1]),s=e.TYPE;if(s){const i=a[s],l=r[s]||[];r[s]=l,ot(n,e,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const u=e.LANGUAGE,c=e["ASSOC-LANGUAGE"],d=e.CHANNELS,h=e.CHARACTERISTICS,f=e["INSTREAM-ID"],p={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",name:e.NAME||u||"",type:s,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:u,url:e.URI?At.resolve(e.URI,t):""};if(c&&(p.assocLang=c),d&&(p.channels=d),h&&(p.characteristics=h),f&&(p.instreamId=f),null!=i&&i.length){const e=At.findGroup(i,p.groupId)||i[0];Dt(p,e,"audioCodec"),Dt(p,e,"textCodec")}l.push(p)}}return r}static parseLevelPlaylist(e,t,n,i,r,s){const a=new K(t),o=a.fragments;let l,u,c,d=null,h=0,f=0,p=0,g=0,m=null,y=new G(i,t),v=-1,b=!1,T=null;for(kt.lastIndex=0,a.m3u8=e,a.hasVariableRefs=at(e);null!==(l=kt.exec(e));){b&&(b=!1,y=new G(i,t),y.start=p,y.sn=h,y.cc=g,y.level=n,d&&(y.initSegment=d,y.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null,T&&(y.setByteRange(T),T=null)));const e=l[1];if(e){y.duration=parseFloat(e);const t=(" "+l[2]).slice(1);y.title=t||null,y.tagList.push(t?["INF",e,t]:["INF",e])}else if(l[3]){if(E(y.duration)){y.start=p,c&&Pt(y,c,a),y.sn=h,y.level=n,y.cc=g,o.push(y);const e=(" "+l[3]).slice(1);y.relurl=lt(a,e),Rt(y,m),m=y,p+=y.duration,h++,f=0,b=!0}}else if(l[4]){const e=(" "+l[4]).slice(1);m?y.setByteRange(e,m):y.setByteRange(e)}else if(l[5])y.rawProgramDateTime=(" "+l[5]).slice(1),y.tagList.push(["PROGRAM-DATE-TIME",y.rawProgramDateTime]),-1===v&&(v=o.length);else{if(l=l[0].match(xt),!l){P.warn("No matches on slow regex match for level playlist!");continue}for(u=1;u<l.length&&"undefined"===typeof l[u];u++);const e=(" "+l[u]).slice(1),r=(" "+l[u+1]).slice(1),p=l[u+2]?(" "+l[u+2]).slice(1):"";switch(e){case"PLAYLIST-TYPE":a.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":h=a.startSN=parseInt(r);break;case"SKIP":{const e=new U(r);ot(a,e,["RECENTLY-REMOVED-DATERANGES"]);const t=e.decimalInteger("SKIPPED-SEGMENTS");if(E(t)){a.skippedSegments=t;for(let e=t;e--;)o.unshift(null);h+=t}const n=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");n&&(a.recentlyRemovedDateranges=n.split("\t"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(r),1);break;case"VERSION":a.version=parseInt(r);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(r||p)&&y.tagList.push(p?[r,p]:[r]);break;case"DISCONTINUITY":g++,y.tagList.push(["DIS"]);break;case"GAP":y.gap=!0,y.tagList.push([e]);break;case"BITRATE":y.tagList.push([e,r]);break;case"DATERANGE":{const e=new U(r);ot(a,e,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),ot(a,e,e.clientAttrs);const t=new B(e,a.dateRanges[e.ID]);t.isValid||a.skippedSegments?a.dateRanges[t.id]=t:P.warn(`Ignoring invalid DATERANGE tag: "${r}"`),y.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const e=new U(r);ot(a,e,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in e?ct(a,e,s):ut(a,e,t)}break;case"DISCONTINUITY-SEQUENCE":g=parseInt(r);break;case"KEY":{const e=Ct(r,t,a);if(e.isSupported()){if("NONE"===e.method){c=void 0;break}c||(c={}),c[e.keyFormat]&&(c=w({},c)),c[e.keyFormat]=e}else P.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${r}"`);break}case"START":a.startTimeOffset=It(r);break;case"MAP":{const e=new U(r);if(ot(a,e,["BYTERANGE","URI"]),y.duration){const r=new G(i,t);Mt(r,e,n,c),d=r,y.initSegment=d,d.rawProgramDateTime&&!y.rawProgramDateTime&&(y.rawProgramDateTime=d.rawProgramDateTime)}else{const t=y.byteRangeEndOffset;if(t){const e=y.byteRangeStartOffset;T=`${t-e}@${e}`}else T=null;Mt(y,e,n,c),d=y,b=!0}break}case"SERVER-CONTROL":{const e=new U(r);a.canBlockReload=e.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=e.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&e.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=e.optionalFloat("PART-HOLD-BACK",0),a.holdBack=e.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const e=new U(r);a.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=a.partList;e||(e=a.partList=[]);const n=f>0?e[e.length-1]:void 0,i=f++,s=new U(r);ot(a,s,["BYTERANGE","URI"]);const o=new z(s,y,t,i,n);e.push(o),y.duration+=o.duration;break}case"PRELOAD-HINT":{const e=new U(r);ot(a,e,["URI"]),a.preloadHint=e;break}case"RENDITION-REPORT":{const e=new U(r);ot(a,e,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(e);break}default:P.warn(`line parsed but not handled: ${l}`)}}}m&&!m.relurl?(o.pop(),p-=m.duration,a.partList&&(a.fragmentHint=m)):a.partList&&(Rt(y,m),y.cc=g,a.fragmentHint=y,c&&Pt(y,c,a));const S=o.length,_=o[0],k=o[S-1];if(p+=a.skippedSegments*a.targetduration,p>0&&S&&k){a.averagetargetduration=p/S;const e=k.sn;a.endSN="initSegment"!==e?e:0,a.live||(k.endList=!0),_&&(a.startCC=_.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(p+=a.fragmentHint.duration),a.totalduration=p,a.endCC=g,v>0&&function(e,t){let n=e[t];for(let i=t;i--;){const t=e[i];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}(o,v),a}}function Ct(e,t,n){var i,r;const s=new U(e);ot(n,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=null!=(i=s.METHOD)?i:"",o=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,c=null!=(r=s.KEYFORMAT)?r:"identity";o&&s.IV&&!l&&P.error(`Invalid IV: ${s.IV}`);const d=o?At.resolve(o,t):"",h=(u||"1").split("/").map(Number).filter(Number.isFinite);return new rt(a,d,c,h,l)}function It(e){const t=new U(e).decimalFloatingPoint("TIME-OFFSET");return E(t)?t:null}function Lt(e,t){let n=(e||"").split(/[ ,]+/).filter((e=>e));["video","audio","text"].forEach((e=>{const i=n.filter((t=>function(e,t){const n=ht[t];return!!n&&!!n[e.slice(0,4)]}(t,e)));i.length&&(t[`${e}Codec`]=i.join(","),n=n.filter((e=>-1===i.indexOf(e))))})),t.unknownCodecs=n}function Dt(e,t,n){const i=t[n];i&&(e[n]=i)}function Rt(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),E(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function Mt(e,t,n,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null}function Pt(e,t,n){e.levelkeys=t;const{encryptedFragments:i}=n;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some((e=>t[e].isCommonEncryption))||i.push(e)}var Ot="manifest",Nt="level",Ut="audioTrack",Ft="subtitleTrack",Bt="main",jt="audio",$t="subtitle";function Vt(e){const{type:t}=e;switch(t){case Ut:return jt;case Ft:return $t;default:return Bt}}function Ht(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class qt{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(A.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_LOADING,this.onLevelLoading,this),e.off(A.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(A.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=new(n||i)(t);return this.loaders[e.type]=r,r}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ot,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:s,deliveryDirectives:a}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:Nt,url:s,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Ut,url:r,deliveryDirectives:s})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Ft,url:r,deliveryDirectives:s})}load(e){var t;const n=this.hls.config;let i,r=this.getInternalLoader(e);if(r){const t=r.context;if(t&&t.url===e.url&&t.level===e.level)return void P.trace("[playlist-loader]: playlist request ongoing");P.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}if(i=e.type===Ot?n.manifestLoadPolicy.default:w({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),E(null==(t=e.deliveryDirectives)?void 0:t.part)){let t;if(e.type===Nt&&null!==e.level?t=this.hls.levels[e.level].details:e.type===Ut&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===Ft&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);i=w({},i,{maxTimeToFirstByteMs:Math.min(t,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,i.maxTimeToFirstByteMs)})}}}const s=i.errorRetry||i.timeoutRetry||{},a={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:s.maxNumRetry||0,retryDelay:s.retryDelayMs||0,maxRetryDelay:s.maxRetryDelayMs||0},o={onSuccess:(e,t,n,i)=>{const r=this.getInternalLoader(n);this.resetInternalLoader(n.type);const s=e.data;0===s.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),At.isMediaPlaylist(s)?this.handleTrackOrLevelPlaylist(e,t,n,i||null,r):this.handleMasterPlaylist(e,t,n,i)):this.handleManifestParsingError(e,n,new Error("no EXTM3U delimiter"),i||null,t)},onError:(e,t,n,i)=>{this.handleNetworkError(t,n,!1,e,i)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};r.load(e,a,o)}handleMasterPlaylist(e,t,n,i){const r=this.hls,s=e.data,a=Ht(e,n),o=At.parseMasterPlaylist(s,a);if(o.playlistParsingError)return void this.handleManifestParsingError(e,n,o.playlistParsingError,i,t);const{contentSteering:l,levels:u,sessionData:c,sessionKeys:d,startTimeOffset:h,variableList:f}=o;this.variableList=f;const{AUDIO:p=[],SUBTITLES:g,"CLOSED-CAPTIONS":m}=At.parseMasterPlaylistMedia(s,a,o);if(p.length){p.some((e=>!e.url))||!u[0].audioCodec||u[0].attrs.AUDIO||(P.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new U({}),bitrate:0,url:""}))}r.trigger(A.MANIFEST_LOADED,{levels:u,audioTracks:p,subtitles:g,captions:m,contentSteering:l,url:a,stats:t,networkDetails:i,sessionData:c,sessionKeys:d,startTimeOffset:h,variableList:f})}handleTrackOrLevelPlaylist(e,t,n,i,r){const s=this.hls,{id:a,level:o,type:l}=n,u=Ht(e,n),c=E(o)?o:E(a)?a:0,d=Vt(n),h=At.parseLevelPlaylist(e.data,u,c,d,0,this.variableList);if(l===Ot){const e={attrs:new U({}),bitrate:0,details:h,name:"",url:u};s.trigger(A.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:u,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=h,this.handlePlaylistLoaded(h,e,t,n,i,r)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(A.ERROR,{type:C.NETWORK_ERROR,details:I.MANIFEST_PARSING_ERROR,fatal:t.type===Ot,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===Nt?s+=`: ${e.level} id: ${e.id}`:e.type!==Ut&&e.type!==Ft||(s+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(s);P.warn(`[playlist-loader]: ${s}`);let o=I.UNKNOWN,l=!1;const u=this.getInternalLoader(e);switch(e.type){case Ot:o=n?I.MANIFEST_LOAD_TIMEOUT:I.MANIFEST_LOAD_ERROR,l=!0;break;case Nt:o=n?I.LEVEL_LOAD_TIMEOUT:I.LEVEL_LOAD_ERROR,l=!1;break;case Ut:o=n?I.AUDIO_TRACK_LOAD_TIMEOUT:I.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case Ft:o=n?I.SUBTITLE_TRACK_LOAD_TIMEOUT:I.SUBTITLE_LOAD_ERROR,l=!1}u&&this.resetInternalLoader(e.type);const c={type:C.NETWORK_ERROR,details:o,fatal:l,url:e.url,loader:u,context:e,error:a,networkDetails:t,stats:r};if(i){const n=(null==t?void 0:t.url)||e.url;c.response=T({url:n,data:void 0},i)}this.hls.trigger(A.ERROR,c)}handlePlaylistLoaded(e,t,n,i,r,s){const a=this.hls,{type:o,level:l,id:u,groupId:c,deliveryDirectives:d}=i,h=Ht(t,i),f=Vt(i),p="number"===typeof i.level&&f===Bt?l:void 0;if(!e.fragments.length){const e=new Error("No Segments found in Playlist");return void a.trigger(A.ERROR,{type:C.NETWORK_ERROR,details:I.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:e,reason:e.message,response:t,context:i,level:p,parent:f,networkDetails:r,stats:n})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const g=e.playlistParsingError;if(g)a.trigger(A.ERROR,{type:C.NETWORK_ERROR,details:I.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:g,reason:g.message,response:t,context:i,level:p,parent:f,networkDetails:r,stats:n});else switch(e.live&&s&&(s.getCacheAge&&(e.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),o){case Ot:case Nt:a.trigger(A.LEVEL_LOADED,{details:e,level:p||0,id:u||0,stats:n,networkDetails:r,deliveryDirectives:d});break;case Ut:a.trigger(A.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:r,deliveryDirectives:d});break;case Ft:a.trigger(A.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:r,deliveryDirectives:d})}}}function Gt(e,t){let n;try{n=new Event("addtrack")}catch(i){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function zt(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(i){P.debug(`[texttrack-utils]: ${i}`);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(r){P.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}"disabled"===n&&(e.mode=n)}function Kt(e){const t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let n=e.cues.length;n--;)e.removeCue(e.cues[n]);"disabled"===t&&(e.mode=t)}function Wt(e,t,n,i){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0){const r=function(e,t,n){const i=[],r=function(e,t){if(t<e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let i=0,r=n;for(;i<=r;){const s=Math.floor((r+i)/2);if(t<e[s].startTime)r=s-1;else{if(!(t>e[s].startTime&&i<n))return s;i=s+1}}return e[i].startTime-t<t-e[r].startTime?i:r}(e,t);if(r>-1)for(let s=r,a=e.length;s<a;s++){const r=e[s];if(r.startTime>=t&&r.endTime<=n)i.push(r);else if(r.startTime>n)return i}return i}(e.cues,t,n);for(let t=0;t<r.length;t++)i&&!i(r[t])||e.removeCue(r[t])}"disabled"===r&&(e.mode=r)}function Xt(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[n])}return t}var Yt="org.id3",Qt="com.apple.quicktime.HLS",Jt="https://aomedia.org/emsg/ID3";function Zt(){if("undefined"!==typeof self)return self.VTTCue||self.TextTrackCue}function en(e,t,n,i,r){let s=new e(t,n,"");try{s.value=i,r&&(s.type=r)}catch(a){s=new e(t,n,JSON.stringify(r?T({type:r},i):i))}return s}const tn=(()=>{const e=Zt();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function nn(e,t){return e.getTime()/1e3-t}class rn{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Kt(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Gt(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=Zt();if(s)for(let a=0;a<r.length;a++){const e=r[a].type;if(e===Jt&&!n||!i)continue;const t=we(r[a].data);if(t){const n=r[a].pts;let i=n+r[a].duration;i>tn&&(i=tn);i-n<=0&&(i=n+.25);for(let r=0;r<t.length;r++){const a=t[r];if(!Se(a)){this.updateId3CueEnds(n,e);const t=en(s,n,i,a,e);t&&this.id3Track.addCue(t)}}}}}updateId3CueEnds(e,t){var n;const i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(let r=i.length;r--;){const n=i[r];n.type===t&&n.startTime<e&&n.endTime===tn&&(n.endTime=e)}}onBufferFlushing(e,t){let{startOffset:n,endOffset:i,type:r}=t;const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let e;e="audio"===r?e=>e.type===Yt&&l:"video"===r?e=>e.type===Jt&&o:e=>e.type===Yt&&l||e.type===Jt&&o,Wt(s,n,i,e)}}onLevelUpdated(e,t){let{details:n}=t;if(!this.media||!n.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:i,id3Track:r}=this,{dateRanges:s}=n,a=Object.keys(s);if(r){const e=Object.keys(i).filter((e=>!a.includes(e)));for(let t=e.length;t--;){const n=e[t];Object.keys(i[n].cues).forEach((e=>{r.removeCue(i[n].cues[e])})),delete i[n]}}const o=n.fragments[n.fragments.length-1];if(0===a.length||!E(null==o?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=o.programDateTime/1e3-o.start,u=Zt();for(let h=0;h<a.length;h++){const e=a[h],t=s[e],n=nn(t.startDate,l),r=i[e],o=(null==r?void 0:r.cues)||{};let f=(null==r?void 0:r.durationKnown)||!1,p=tn;const g=t.endDate;if(g)p=nn(g,l),f=!0;else if(t.endOnNext&&!f){const e=a.reduce(((e,n)=>{if(n!==t.id){const i=s[n];if(i.class===t.class&&i.startDate>t.startDate&&(!e||t.startDate<e.startDate))return i}return e}),null);e&&(p=nn(e.startDate,l),f=!0)}const m=Object.keys(t.attr);for(let i=0;i<m.length;i++){const s=m[i];if("ID"===(d=s)||"CLASS"===d||"START-DATE"===d||"DURATION"===d||"END-DATE"===d||"END-ON-NEXT"===d)continue;const a=o[s];if(a)f&&!r.durationKnown&&(a.endTime=p);else if(u){let i=t.attr[s];F(s)&&(c=i,i=Uint8Array.from(c.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer);const r=en(u,n,p,{key:s,data:i},Qt);r&&(r.id=e,this.id3Track.addCue(r),o[s]=r)}}i[e]={cues:o,dateRange:t,durationKnown:f}}var c,d}}class sn{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:s,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let l=a&&n||t;(o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:s*i);const u=i;return l+Math.min(1*this.stallCount,u)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;const i=n.edge,r=e-t-this.edgeStalled,s=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(s,r),a)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(A.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(A.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,t){let{details:n}=t;this.levelDetails=n,n.advanced&&this.timeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===I.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(n=this.levelDetails)&&n.live&&P.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||1===r||!t.live)return;const s=this.targetLatency;if(null===s)return;const a=n-s;if(a<Math.min(this.maxLatency,s+t.targetduration)&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,r)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(t,Math.max(1,n))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}const an=["NONE","TYPE-0","TYPE-1",null];const on=["SDR","PQ","HLG"];var ln="",un="YES",cn="v2";function dn(e){const{canSkipUntil:t,canSkipDateRanges:n,age:i}=e;return t&&i<t/2?n?cn:un:ln}class hn{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class fn{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter((e=>!!e)).map((e=>e.substring(0,4))).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return pn(this._audioGroups,e)}hasSubtitleGroup(e){return pn(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t)if("audio"===e){let e=this._audioGroups;e||(e=this._audioGroups=[]),-1===e.indexOf(t)&&e.push(t)}else if("text"===e){let e=this._subtitleGroups;e||(e=this._subtitleGroups=[]),-1===e.indexOf(t)&&e.push(t)}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return null==(e=this.audioGroups)?void 0:e[0]}get textGroupId(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}addFallback(){}}function pn(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function gn(e,t){const n=t.startPTS;if(E(n)){let i,r=0;t.sn>e.sn?(r=n-e.start,i=e):(r=e.start-n,i=t),i.duration!==r&&(i.duration=r)}else if(t.sn>e.sn){e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function mn(e,t,n,i,r,s){i-n<=0&&(P.warn("Fragment should have a positive duration",t),i=n+t.duration,s=r+t.duration);let a=n,o=i;const l=t.startPTS,u=t.endPTS;if(E(l)){const e=Math.abs(l-n);E(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,a=Math.max(n,l),n=Math.min(n,l),r=Math.min(r,t.startDTS),o=Math.min(i,u),i=Math.max(i,u),s=Math.max(s,t.endDTS)}const c=n-t.start;0!==t.start&&(t.start=n),t.duration=i-t.start,t.startPTS=n,t.maxStartPTS=a,t.startDTS=r,t.endPTS=i,t.minEndPTS=o,t.endDTS=s;const d=t.sn;if(!e||d<e.startSN||d>e.endSN)return 0;let h;const f=d-e.startSN,p=e.fragments;for(p[f]=t,h=f;h>0;h--)gn(p[h],p[h-1]);for(h=f;h<p.length-1;h++)gn(p[h],p[h+1]);return e.fragmentHint&&gn(p[p.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,c}function yn(e,t){let n=null;const i=e.fragments;for(let o=i.length-1;o>=0;o--){const e=i[o].initSegment;if(e){n=e;break}}let r;e.fragmentHint&&delete e.fragmentHint.endPTS,function(e,t,n){const i=t.skippedSegments,r=Math.max(e.startSN,t.startSN)-t.startSN,s=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let u=r;u<=s;u++){const e=l[a+u];let r=o[u];i&&!r&&u<i&&(r=t.fragments[u]=e),e&&r&&n(e,r,u,o)}}(e,t,((e,i,s,a)=>{if(t.skippedSegments&&i.cc!==e.cc){const t=e.cc-i.cc;for(let e=s;e<a.length;e++)a[e].cc+=t}E(e.startPTS)&&E(e.endPTS)&&(i.start=i.startPTS=e.startPTS,i.startDTS=e.startDTS,i.maxStartPTS=e.maxStartPTS,i.endPTS=e.endPTS,i.endDTS=e.endDTS,i.minEndPTS=e.minEndPTS,i.duration=e.endPTS-e.startPTS,i.duration&&(r=i),t.PTSKnown=t.alignedSliding=!0),i.elementaryStreams=e.elementaryStreams,i.loader=e.loader,i.stats=e.stats,e.initSegment&&(i.initSegment=e.initSegment,n=e.initSegment)}));const s=t.fragments;if(n){(t.fragmentHint?s.concat(t.fragmentHint):s).forEach((e=>{var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=n)?void 0:t.relurl)||(e.initSegment=n)}))}if(t.skippedSegments){if(t.deltaUpdateFailed=s.some((e=>!e)),t.deltaUpdateFailed){P.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)s.shift();t.startSN=s[0].sn}else t.canSkipDateRanges&&(t.dateRanges=function(e,t,n){const i=w({},e);n&&n.forEach((e=>{delete i[e]}));return Object.keys(t).forEach((e=>{const n=new B(t[e].attr,i[e]);n.isValid?i[e]=n:P.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)})),i}(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));t.startCC=t.fragments[0].cc,t.endCC=s[s.length-1].cc}!function(e,t,n){if(e&&t){let i=0;for(let r=0,s=e.length;r<=s;r++){const s=e[r],a=t[r+i];s&&a&&s.index===a.index&&s.fragment.sn===a.fragment.sn?n(s,a):i--}}}(e.partList,t.partList,((e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),r?mn(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):vn(e,t),s.length&&(t.totalduration=t.edge-s[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const a=t.advancedDateTime;if(t.advanced&&a){const e=t.edge;t.driftStart||(t.driftStartTime=a,t.driftStart=e),t.driftEndTime=a,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function vn(e,t){const n=t.startSN+t.skippedSegments-e.startSN,i=e.fragments;n<0||n>=i.length||bn(t,i[n].start)}function bn(e,t){if(t){const n=e.fragments;for(let i=e.skippedSegments;i<n.length;i++)n[i].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function Tn(e,t,n){var i;return null!=e&&e.details?Sn(null==(i=e.details)?void 0:i.partList,t,n):null}function Sn(e,t,n){if(e)for(let i=e.length;i--;){const r=e[i];if(r.index===n&&r.fragment.sn===t)return r}return null}function _n(e){e.forEach(((e,t)=>{const{details:n}=e;null!=n&&n.fragments&&n.fragments.forEach((e=>{e.level=t}))}))}function wn(e){switch(e.details){case I.FRAG_LOAD_TIMEOUT:case I.KEY_LOAD_TIMEOUT:case I.LEVEL_LOAD_TIMEOUT:case I.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function En(e,t){const n=wn(t);return e.default[(n?"timeout":"error")+"Retry"]}function kn(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function xn(e){return T(T({},e),{errorRetry:null,timeoutRetry:null})}function An(e,t,n,i){if(!e)return!1;const r=null==i?void 0:i.code,s=t<e.maxNumRetry&&(function(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}(r)||!!n);return e.shouldRetry?e.shouldRetry(e,t,n,i,s):s}const Cn=function(e,t){let n=0,i=e.length-1,r=null,s=null;for(;n<=i;){r=(n+i)/2|0,s=e[r];const a=t(s);if(a>0)n=r+1;else{if(!(a<0))return s;i=r-1}}return null};function In(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.005,s=null;if(e){s=t[e.sn-t[0].sn+1]||null;const i=e.endDTS-n;i>0&&i<15e-7&&(n+=15e-7)}else 0===n&&0===t[0].start&&(s=t[0]);if(s&&((!e||e.level===s.level)&&0===Ln(n,i,s)||function(e,t,n){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){const i=t.tagList.reduce(((e,t)=>("INF"===t[0]&&(e+=parseFloat(t[1])),e)),n);return e.start<=i}return!1}(s,e,Math.min(r,i))))return s;const a=Cn(t,Ln.bind(null,n,i));return!a||a===e&&s?s:a}function Ln(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(n.start<=e&&n.start+n.duration>e)return 0;const i=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=e?1:n.start-i>e&&n.start?-1:0}function Dn(e,t,n){const i=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-i>e}var Rn=0,Mn=2,Pn=3,On=5,Nn=0,Un=1,Fn=2;class Bn{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=P.log.bind(P,`${t}:`),this.warn=P.warn.bind(P,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=null==t?void 0:t.renditionReports;if(i){let s=-1;for(let n=0;n<i.length;n++){const a=i[n];let o;try{o=new self.URL(a.URI,t.url).href}catch(r){P.warn(`Could not construct new URL for Rendition Report: ${r}`),o=a.URI||""}if(o===e){s=n;break}o===e.substring(0,o.length)&&(s=n)}if(-1!==s){const e=i[s],r=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let a=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&e>t.partTarget&&(a+=1)}const o=n&&dn(n);return new hn(r,a>=0?a:void 0,o)}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:i,stats:r}=t,s=self.performance.now(),a=r.loading.first?Math.max(0,s-r.loading.first):0;if(i.advancedDateTime=Date.now()-a,i.live||null!=n&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),n&&i.fragments.length>0&&yn(n,i),!this.canLoad||!i.live)return;let a,o,l;if(i.canBlockReload&&i.endSN&&i.advanced){const e=this.hls.config.lowLatencyMode,r=i.lastPartSn,s=i.endSN,u=i.lastPartIndex,c=r===s;-1!==u?(o=c?s+1:r,l=c?e?0:u:u+1):o=s+1;const d=i.age,h=d+i.ageHeader;let f=Math.min(h-i.partTarget,1.5*i.targetduration);if(f>0){if(n&&f>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${f} with playlist age: ${i.age}`),f=0;else{const e=Math.floor(f/i.targetduration);if(o+=e,void 0!==l){l+=Math.round(f%i.targetduration/i.partTarget)}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${d.toFixed(2)}s goal: ${f} skip sn ${e} to part ${l}`)}i.tuneInGoal=f}if(a=this.getDeliveryDirectives(i,t.deliveryDirectives,o,l),e||!c)return void this.loadPlaylist(a)}else(i.canBlockReload||i.canSkipUntil)&&(a=this.getDeliveryDirectives(i,t.deliveryDirectives,o,l));const u=this.hls.mainForwardBufferInfo,c=u?u.end-u.len:0,d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=1e3*e.targetduration;if(e.updated){const i=e.fragments,r=4;if(i.length&&n*r>t){const e=1e3*i[i.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}(i,1e3*(i.edge-c));i.updated&&s>this.requestScheduled+d&&(this.requestScheduled=r.loading.start),void 0!==o&&i.canBlockReload?this.requestScheduled=r.loading.first+d-(1e3*i.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+d<s?this.requestScheduled=s:this.requestScheduled-s<=0&&(this.requestScheduled+=d);let h=this.requestScheduled-s;h=Math.max(0,h),this.log(`reload live playlist ${e} in ${Math.round(h)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(a)),h)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let r=dn(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=ln),new hn(n,i,r)}checkRetry(e){const t=e.details,n=wn(e),i=e.errorAction,{action:r,retryCount:s=0,retryConfig:a}=i||{},o=!!i&&!!a&&(r===On||!i.resolved&&r===Mn);if(o){var l;if(this.requestScheduled=-1,s>=a.maxNumRetry)return!1;if(n&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=kn(a,s);this.timer=self.setTimeout((()=>this.loadPlaylist()),e),this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,i.resolved=!0}return o}}class jn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class $n{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new jn(e),this.fast_=new jn(t),this.defaultTTFB_=i,this.ttfb_=new jn(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new jn(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new jn(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new jn(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){const n=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/n;this.fast_.sample(n,i),this.slow_.sample(n,i)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const Vn={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},Hn={};function qn(e,t,n,i,r,s){const a=e.audioCodec?e.audioGroups:null,o=null==s?void 0:s.audioCodec,l=null==s?void 0:s.channels,u=l?parseInt(l):o?1/0:2;let c=null;if(null!=a&&a.length)try{c=1===a.length&&a[0]?t.groups[a[0]].channels:a.reduce(((e,n)=>{if(n){const i=t.groups[n];if(!i)throw new Error(`Audio track group ${n} not found`);Object.keys(i.channels).forEach((t=>{e[t]=(e[t]||0)+i.channels[t]}))}return e}),{2:0})}catch(d){return!0}return void 0!==e.videoCodec&&(e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(i,30)||"SDR"!==e.videoRange&&e.videoRange!==n||e.bitrate>Math.max(r,8e6))||!!c&&E(u)&&Object.keys(c).some((e=>parseInt(e)>u))}function Gn(e,t,n){const i=e.videoCodec,r=e.audioCodec;if(!i||!r||!n)return Promise.resolve(Vn);const s={width:e.width,height:e.height,bitrate:Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)),framerate:e.frameRate||30},a=e.videoRange;"SDR"!==a&&(s.transferFunction=a.toLowerCase());const o=i.split(",").map((e=>({type:"media-source",video:T(T({},s),{},{contentType:gt(e,"video")})})));return r&&e.audioGroups&&e.audioGroups.forEach((e=>{var n;e&&(null==(n=t.groups[e])||n.tracks.forEach((t=>{if(t.groupId===e){const e=t.channels||"",n=parseFloat(e);E(n)&&n>2&&o.push.apply(o,r.split(",").map((e=>({type:"media-source",audio:{contentType:gt(e,"audio"),channels:""+n}}))))}})))})),Promise.all(o.map((e=>{const t=function(e){const{audio:t,video:n}=e,i=n||t;if(i){const e=i.contentType.split('"')[1];if(n)return`r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${e}_${Math.ceil(n.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${e}`}return""}(e);return Hn[t]||(Hn[t]=n.decodingInfo(e))}))).then((e=>({supported:!e.some((e=>!e.supported)),configurations:o,decodingInfoResults:e}))).catch((e=>({supported:!1,configurations:o,decodingInfoResults:[],error:e})))}function zn(e,t){let n=!1,i=[];return e&&(n="SDR"!==e,i=[e]),t&&(i=t.allowedVideoRanges||on.slice(0),n=void 0!==t.preferHDR?t.preferHDR:function(){if("function"===typeof matchMedia){const e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}(),i=n?i.filter((e=>"SDR"!==e)):["SDR"]),{preferHDR:n,allowedVideoRanges:i}}function Kn(e,t){P.log(`[abr] start candidates with "${e}" ignored because ${t}`)}function Wn(e,t,n){if("attrs"in e){const n=t.indexOf(e);if(-1!==n)return n}for(let i=0;i<t.length;i++){if(Xn(e,t[i],n))return i}return-1}function Xn(e,t,n){const{groupId:i,name:r,lang:s,assocLang:a,default:o}=e,l=e.forced;return(void 0===i||t.groupId===i)&&(void 0===r||t.name===r)&&(void 0===s||t.lang===s)&&(void 0===s||t.assocLang===a)&&(void 0===o||t.default===o)&&(void 0===l||t.forced===l)&&(!("characteristics"in e)||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e.split(","),i=t.split(",");return n.length===i.length&&!n.some((e=>-1===i.indexOf(e)))}(e.characteristics||"",t.characteristics))&&(void 0===n||n(e,t))}function Yn(e,t){const{audioCodec:n,channels:i}=e;return(void 0===n||(t.audioCodec||"").substring(0,4)===n.substring(0,4))&&(void 0===i||i===(t.channels||"2"))}function Qn(e,t,n){for(let i=t;i>-1;i--)if(n(e[i]))return i;for(let i=t+1;i<e.length;i++)if(n(e[i]))return i;return-1}class Jn{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var Zn="NOT_LOADED",ei="APPENDING",ti="PARTIAL",ni="OK";class ii{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(A.BUFFER_APPENDED,this.onBufferAppended,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.BUFFER_APPENDED,this.onBufferAppended,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const t=n[i];if(!t)break;const r=t.end;if(t.start<=e&&null!==r&&e<=r)return t}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,i=Object.keys(n);for(let r=i.length;r--;){const s=n[i[r]];if((null==s?void 0:s.body.type)===t&&s.buffered){const t=s.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,i){this.timeRanges&&(this.timeRanges[e]=t);const r=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach((i=>{const s=this.fragments[i];if(!s)return;if(r>=s.body.sn)return;if(!s.buffered&&!s.loaded)return void(s.body.type===n&&this.removeFragment(s.body));const a=s.range[e];a&&a.time.some((e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(s.body),n}))}))}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:i}=e;if(!t||"initSegment"===n.sn)return;const r=si(n),s=this.fragments[r];if(!s||s.buffered&&n.gap)return;const a=!n.relurl;if(Object.keys(t).forEach((e=>{const r=n.elementaryStreams[e];if(!r)return;const o=t[e],l=a||!0===r.partial;s.range[e]=this.getBufferedTimes(n,i,l,o)})),s.loaded=null,Object.keys(s.range).length){s.buffered=!0;(s.body.endList=n.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),ri(s)||this.removeParts(n.sn-1,n.type)}else this.removeFragment(s.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter((t=>t.fragment.sn>=e)))}fragBuffered(e,t){const n=si(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},s=e.start,a=e.end,o=e.minEndPTS||a,l=e.maxStartPTS||s;for(let u=0;u<i.length;u++){const e=i.start(u)-this.bufferPadding,t=i.end(u)+this.bufferPadding;if(l>=e&&o<=t){r.time.push({startPTS:Math.max(s,i.start(u)),endPTS:Math.min(a,i.end(u))});break}if(s<t&&a>e){const e=Math.max(s,i.start(u)),t=Math.min(a,i.end(u));t>e&&(r.partial=!0,r.time.push({startPTS:e,endPTS:t}))}else if(a<=e)break}return r}getPartialFragment(e){let t,n,i,r=null,s=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach((l=>{const u=o[l];u&&ri(u)&&(n=u.body.start-a,i=u.body.end+a,e>=n&&e<=i&&(t=Math.min(e-n,i-e),s<=t&&(r=u.body,s=t)))})),r}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||ri(t))}getState(e){const t=si(e),n=this.fragments[t];return n?n.buffered?ri(n)?ti:ni:ei:Zn}isTimeBuffered(e,t,n){let i,r;for(let s=0;s<n.length;s++){if(i=n.start(s)-this.bufferPadding,r=n.end(s)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:i}=t;if("initSegment"===n.sn||n.bitrateTest)return;const r=i?null:t,s=si(n);this.fragments[s]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r}=t;if("initSegment"===n.sn)return;const s=n.type;if(i){let e=this.activePartLists[s];e||(this.activePartLists[s]=e=[]),e.push(i)}this.timeRanges=r,Object.keys(r).forEach((e=>{const t=r[e];this.detectEvictedFragments(e,t,s,i)}))}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=si(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach((s=>{const a=this.fragments[s];if(!a)return;const o=a.body;o.type!==n||i&&!o.gap||o.start<t&&o.end>e&&(a.buffered||r)&&this.removeFragment(o)}))}removeFragment(e){const t=si(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=n.filter((e=>e.fragment.sn!==t))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function ri(e){var t,n,i;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(n=e.range.audio)?void 0:n.partial)||(null==(i=e.range.audiovideo)?void 0:i.partial))}function si(e){return`${e.type}_${e.level}_${e.sn}`}const ai={length:0,start:()=>0,end:()=>0};class oi{static isBuffered(e,t){try{if(e){const n=oi.getBuffered(e);for(let e=0;e<n.length;e++)if(t>=n.start(e)&&t<=n.end(e))return!0}}catch(n){}return!1}static bufferInfo(e,t,n){try{if(e){const i=oi.getBuffered(e),r=[];let s;for(s=0;s<i.length;s++)r.push({start:i.start(s),end:i.end(s)});return this.bufferedInfo(r,t,n)}}catch(i){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort((function(e,t){const n=e.start-t.start;return n||t.end-e.end}));let i=[];if(n)for(let l=0;l<e.length;l++){const t=i.length;if(t){const r=i[t-1].end;e[l].start-r<n?e[l].end>r&&(i[t-1].end=e[l].end):i.push(e[l])}else i.push(e[l])}else i=e;let r,s=0,a=t,o=t;for(let l=0;l<i.length;l++){const e=i[l].start,u=i[l].end;if(t+n>=e&&t<u)a=e,o=u,s=o-t;else if(t+n<e){r=e;break}}return{len:s,start:a||0,end:o||0,nextStart:r}}static getBuffered(e){try{return e.buffered}catch(t){return P.log("failed to get media.buffered",t),ai}}}class li{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=s}}function ui(e,t){for(let i=0,r=e.length;i<r;i++){var n;if((null==(n=e[i])?void 0:n.cc)===t)return e[i]}return null}function ci(e,t){if(e){const n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function di(e,t){const n=t.fragments;for(let i=0,r=n.length;i<r;i++)ci(n[i],e);t.fragmentHint&&ci(t.fragmentHint,e),t.alignedSliding=!0}function hi(e,t,n){t&&(!function(e,t,n){if(function(e,t,n){return!(!t||!(n.endCC>n.startCC||e&&e.cc<n.startCC))}(e,n,t)){const e=function(e,t){const n=e.fragments,i=t.fragments;if(!i.length||!n.length)return void P.log("No fragments to align");const r=ui(n,i[0].cc);if(r&&(!r||r.startPTS))return r;P.log("No frag in previous level to align on")}(n,t);e&&E(e.start)&&(P.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),di(e.start,t))}}(e,n,t),!n.alignedSliding&&t&&fi(n,t),n.alignedSliding||!t||n.skippedSegments||vn(t,n))}function fi(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,i=t.fragments;if(!n.length||!i.length)return;let r,s;const a=Math.min(t.endCC,e.endCC);t.startCC<a&&e.startCC<a&&(r=ui(i,a),s=ui(n,a)),r&&s||(r=i[Math.floor(i.length/2)],s=ui(n,r.cc)||n[Math.floor(n.length/2)]);const o=r.programDateTime,l=s.programDateTime;if(!o||!l)return;di((l-o)/1e3-(s.start-r.start),e)}const pi=Math.pow(2,17);class gi{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new vi({type:C.NETWORK_ERROR,details:I.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some((e=>"GAP"===e[0])))return void o(yi(e));e.gap=!1}const l=this.loader=e.loader=r?new r(i):new s(i),u=mi(e),c=xn(i.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:pi};e.stats=l.stats,l.load(u,d,{onSuccess:(t,n,i,r)=>{this.resetLoader(e,l);let s=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),a({frag:e,part:null,payload:s,networkDetails:r})},onError:(t,i,r,s)=>{this.resetLoader(e,l),o(new vi({type:C.NETWORK_ERROR,details:I.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:T({url:n,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:r,stats:s}))},onAbort:(t,n,i)=>{this.resetLoader(e,l),o(new vi({type:C.NETWORK_ERROR,details:I.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:(t,n,i)=>{this.resetLoader(e,l),o(new vi({type:C.NETWORK_ERROR,details:I.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:i,stats:t}))},onProgress:(n,i,r,s)=>{t&&t({frag:e,part:null,payload:r,networkDetails:s})}})}))}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void o(yi(e,t));const l=this.loader=e.loader=r?new r(i):new s(i),u=mi(e,t),c=xn(i.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:pi};t.stats=l.stats,l.load(u,d,{onSuccess:(i,r,s,o)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const u={frag:e,part:t,payload:i.data,networkDetails:o};n(u),a(u)},onError:(n,i,r,s)=>{this.resetLoader(e,l),o(new vi({type:C.NETWORK_ERROR,details:I.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:T({url:u.url,data:void 0},n),error:new Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:r,stats:s}))},onAbort:(n,i,r)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),o(new vi({type:C.NETWORK_ERROR,details:I.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:(n,i,r)=>{this.resetLoader(e,l),o(new vi({type:C.NETWORK_ERROR,details:I.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:r,stats:n}))}})}))}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const i=Math.round(e.duration/t.duration),s=Math.min(Math.round(n.loaded/r),i),a=(i-s)*Math.round(n.loaded/s);n.total=n.loaded+a}else n.total=Math.max(n.loaded,n.total);const s=n.loading,a=i.loading;s.start?s.first+=a.first-a.start:(s.start=a.start,s.first=a.first),s.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function mi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=t||e,i={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},r=n.byteRangeStartOffset,s=n.byteRangeEndOffset;if(E(r)&&E(s)){var a;let t=r,n=s;if("initSegment"===e.sn&&"AES-128"===(null==(a=e.decryptdata)?void 0:a.method)){const e=s-r;e%16&&(n=s+(16-e%16)),0!==r&&(i.resetIV=!0,t=r-16)}i.rangeStart=t,i.rangeEnd=n}return i}function yi(e,t){const n=new Error(`GAP ${e.gap?"tag":"attribute"} found`),i={type:C.MEDIA_ERROR,details:I.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new vi(i)}class vi extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class bi{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class Ti{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class Si{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(4*i);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],s=n[2],a=n[3],o=this.invSubMix,l=o[0],u=o[1],c=o[2],d=o[3],h=new Uint32Array(256);let f=0,p=0,g=0;for(g=0;g<256;g++)h[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){let n=p^p<<1^p<<2^p<<3^p<<4;n=n>>>8^255&n^99,e[f]=n,t[n]=f;const o=h[f],g=h[o],m=h[g];let y=257*h[n]^16843008*n;i[f]=y<<24|y>>>8,r[f]=y<<16|y>>>16,s[f]=y<<8|y>>>24,a[f]=y,y=16843009*m^65537*g^257*o^16843008*f,l[n]=y<<24|y>>>8,u[n]=y<<16|y>>>16,c[n]=y<<8|y>>>24,d[n]=y,f?(f=o^h[h[h[m^o]]],p^=h[h[p]]):f=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const s=this.ksRows=4*(r+6+1);let a,o;const l=this.keySchedule=new Uint32Array(s),u=this.invKeySchedule=new Uint32Array(s),c=this.sBox,d=this.rcon,h=this.invSubMix,f=h[0],p=h[1],g=h[2],m=h[3];let y,v;for(a=0;a<s;a++)a<r?y=l[a]=t[a]:(v=y,a%r===0?(v=v<<8|v>>>24,v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v],v^=d[a/r|0]<<24):r>6&&a%r===4&&(v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v]),l[a]=y=(l[a-r]^v)>>>0);for(o=0;o<s;o++)a=s-o,v=3&o?l[a]:l[a-4],u[o]=o<4||a<=4?v:f[c[v>>>24]]^p[c[v>>>16&255]]^g[c[v>>>8&255]]^m[c[255&v]],u[o]=u[o]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,o=a[0],l=a[1],u=a[2],c=a[3],d=this.uint8ArrayToUint32Array_(n);let h=d[0],f=d[1],p=d[2],g=d[3];const m=new Int32Array(e),y=new Int32Array(m.length);let v,b,T,S,_,w,E,k,x,A,C,I,L,D;const R=this.networkToHostOrderSwap;for(;t<m.length;){for(x=R(m[t]),A=R(m[t+1]),C=R(m[t+2]),I=R(m[t+3]),_=x^r[0],w=I^r[1],E=C^r[2],k=A^r[3],L=4,D=1;D<i;D++)v=o[_>>>24]^l[w>>16&255]^u[E>>8&255]^c[255&k]^r[L],b=o[w>>>24]^l[E>>16&255]^u[k>>8&255]^c[255&_]^r[L+1],T=o[E>>>24]^l[k>>16&255]^u[_>>8&255]^c[255&w]^r[L+2],S=o[k>>>24]^l[_>>16&255]^u[w>>8&255]^c[255&E]^r[L+3],_=v,w=b,E=T,k=S,L+=4;v=s[_>>>24]<<24^s[w>>16&255]<<16^s[E>>8&255]<<8^s[255&k]^r[L],b=s[w>>>24]<<24^s[E>>16&255]<<16^s[k>>8&255]<<8^s[255&_]^r[L+1],T=s[E>>>24]<<24^s[k>>16&255]<<16^s[_>>8&255]<<8^s[255&w]^r[L+2],S=s[k>>>24]<<24^s[_>>16&255]<<16^s[w>>8&255]<<8^s[255&E]^r[L+3],y[t]=R(v^h),y[t+1]=R(S^f),y[t+2]=R(T^p),y[t+3]=R(b^g),h=x,f=A,p=C,g=I,t+=4}return y.buffer}}class _i{constructor(e){let{removePKCS7Padding:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(n){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?pe(e,0,t-n):e}(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise(((i,r)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const s=this.flush();s?i(s.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:i,currentResult:r,remainderData:s}=this;this.logOnce("JS AES decrypt"),s&&(e=Ye(s,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;i&&(n=i);let o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new Si),o.expandKey(t);const l=r;return this.currentResult=o.decrypt(a.buffer,0,n),this.currentIV=pe(a,-16).buffer,l||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new Ti(this.subtle,t)}return this.fastAesKey.expandKey().then((t=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new bi(this.subtle,new Uint8Array(n)).decrypt(e.buffer,t)})).catch((i=>(P.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,n))))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%16;return n!==e.length&&(t=pe(e,0,n),this.remainderData=pe(e,n)),t}logOnce(e){this.logEnabled&&(P.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const wi=function(e){let t="";const n=e.length;for(let i=0;i<n;i++)t+=`[${e.start(i).toFixed(3)}-${e.end(i).toFixed(3)}]`;return t},Ei="STOPPED",ki="IDLE",xi="KEY_LOADING",Ai="FRAG_LOADING",Ci="FRAG_LOADING_WAITING_RETRY",Ii="WAITING_TRACK",Li="PARSING",Di="PARSED",Ri="ENDED",Mi="ERROR",Pi="WAITING_INIT_PTS",Oi="WAITING_LEVEL";class Ni extends Jn{constructor(e,t,n,i,r){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Ei,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=r,this.logPrefix=i,this.log=P.log.bind(P,`${i}:`),this.warn=P.warn.bind(P,`${i}:`),this.hls=e,this.fragmentLoader=new gi(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new _i(e.config),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Ei}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(null!=n&&n.length){const e=n[n.length-1];return oi.isBuffered(this.media,e.start+e.duration/2)}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levelLastLoaded)?void 0:e.details}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Ei&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:r}=this,s=n?n.currentTime:0,a=oi.bufferInfo(i||n,s,e.maxBufferHole);if(this.log(`media seeking to ${E(s)?s.toFixed(3):s}, state: ${r}`),this.state===Ri)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,i=t.start-n,r=t.start+t.duration+n;if(!a.len||r<a.start||i>a.end){const e=s>r;(s<i||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(s,1/0,this.playlistType,!0),this.lastCurrentTime=s),this.loadedmetadata||a.len||(this.nextLoadPosition=this.startPosition=s),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=Ei,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){this._doFragLoad(e,t,n,(t=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${t.part?" p: "+t.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)})).then((t=>{if(!t)return;const n=this.state;this.fragContextChanged(e)?(n===Ai||!this.fragCurrent&&n===Li)&&(this.fragmentTracker.removeFragment(e),this.state=ki):("payload"in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(A.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))})).catch((t=>{this.state!==Ei&&this.state!==Mi&&(this.warn(`Frag error: ${(null==t?void 0:t.message)||t}`),this.resetFragmentLoading(e))}))}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===ei){const t=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=Math.max(e.duration,i?i.len:this.config.maxBufferLength),s=this.backtrackFragment;(1===(s?e.sn-s.sn:0)||this.reduceMaxBufferLength(r,e.duration))&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===ti&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t){if(!(e-t))return;const n={startOffset:e,endOffset:t,type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null};this.hls.trigger(A.BUFFER_FLUSHING,n)}_loadInitSegment(e,t){this._doFragLoad(e,t).then((t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t})).then((t=>{const{hls:n}=this,{payload:i}=t,r=e.decryptdata;if(i&&i.byteLength>0&&null!=r&&r.key&&r.iv&&"AES-128"===r.method){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer).catch((t=>{throw n.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((i=>{const r=self.performance.now();return n.trigger(A.FRAG_DECRYPTED,{frag:e,payload:i,stats:{tstart:s,tdecrypt:r}}),t.payload=i,this.completeInitSegmentLoad(t)}))}return this.completeInitSegmentLoad(t)})).catch((t=>{this.state!==Ei&&this.state!==Mi&&(this.warn(t),this.resetFragmentLoading(e))}))}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=ki,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,i,r,s;const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Bt?"level":"track"} ${e.level} (frag:[${(null!=(n=e.startPTS)?n:NaN).toFixed(3)}-${(null!=(i=e.endPTS)?i:NaN).toFixed(3)}] > buffer:${a?wi(oi.getBuffered(a)):"(detached)"})`),"initSegment"!==e.sn){var o;if(e.type!==$t){const t=e.elementaryStreams;if(!Object.keys(t).some((e=>!!t[e])))return void(this.state=ki)}const t=null==(o=this.levels)?void 0:o[e.level];null!=t&&t.fragmentError&&(this.log(`Resetting level fragment error count of ${t.fragmentError} on frag buffered`),t.fragmentError=0)}this.state=ki,a&&(!this.loadedmetadata&&e.type==Bt&&a.buffered.length&&(null==(r=this.fragCurrent)?void 0:r.sn)===(null==(s=this.fragPrevious)?void 0:s.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,s=!r||0===r.length||r.some((e=>!e)),a=new li(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!s);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;var r;const s=null==t?void 0:t.details;if(!this.levels||!s)throw new Error(`frag load aborted, missing level${s?"":" detail"}s`);let a=null;if(!e.encrypted||null!=(r=e.decryptdata)&&r.key?!e.encrypted&&s.encryptedFragments.length&&this.keyLoader.loadClear(e,s.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${s.startSN}-${s.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state=xi,this.fragCurrent=e,a=this.keyLoader.load(e).then((e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(A.KEY_LOADED,e),this.state===xi&&(this.state=ki),e})),this.hls.trigger(A.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const r=s.partList;if(r&&i){n>e.end&&s.fragmentHint&&(e=s.fragmentHint);const o=this.getNextPart(r,e,n);if(o>-1){const l=r[o];let u;return this.log(`Loading part sn: ${e.sn} p: ${l.index} cc: ${e.cc} of playlist [${s.startSN}-${s.endSN}] parts [0-${o}-${r.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=Ai,u=a?a.then((n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,i))).catch((e=>this.handleFragLoadError(e))):this.doFragPartsLoad(e,l,t,i).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(A.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):u}if(!e.url||this.loadedEndOfParts(r,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${s?"of ["+s.startSN+"-"+s.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),E(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Ai;const o=this.config.progressive;let l;return l=o&&a?a.then((t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,i))).catch((e=>this.handleFragLoadError(e))):Promise.all([this.fragmentLoader.load(e,o?i:void 0),a]).then((e=>{let[t]=e;return!o&&t&&i&&i(t),t})).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(A.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,n,i){return new Promise(((r,s)=>{var a;const o=[],l=null==(a=n.details)?void 0:a.partList,u=t=>{this.fragmentLoader.loadPart(e,t,i).then((i=>{o[t.index]=i;const s=i.part;this.hls.trigger(A.FRAG_LOADED,i);const a=Tn(n,e.sn,t.index+1)||Sn(l,e.sn,t.index+1);if(!a)return r({frag:e,part:s,partsLoaded:o});u(a)})).catch(s)};u(t)}))}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===I.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(A.ERROR,t)}else this.hls.trigger(A.ERROR,{type:C.OTHER_ERROR,details:I.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Li)return void(this.fragCurrent||this.state===Ei||this.state===Mi||(this.state=ki));const{frag:n,part:i,level:r}=t,s=self.performance.now();n.stats.parsing.end=s,i&&(i.stats.parsing.end=s),this.updateLevelTiming(n,i,r,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:s}=e;if(null==t||!t[i])return this.warn(`Levels object was unset while buffering fragment ${r} of level ${i}. The current chunk will not be buffered.`),null;const a=t[i],o=s>-1?Tn(a,r,s):null,l=o?o.fragment:function(e,t,n){if(null==e||!e.details)return null;const i=e.details;let r=i.fragments[t-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===t?r:t<i.startSN&&n&&n.sn===t?n:null)}(a,r,n);return l?(n&&n!==l&&(l.stats=n.stats),{frag:l,part:o,level:a}):null}bufferFragmentData(e,t,n,i,r){var s;if(!e||this.state!==Li)return;const{data1:a,data2:o}=e;let l=a;if(a&&o&&(l=Ye(a,o)),null==(s=l)||!s.length)return;const u={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};if(this.hls.trigger(A.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!oi.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,i=oi.bufferInfo(t,n,0),r=e.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(e.start-s,i.end-s),n+s);e.start-a>s&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return E(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:i}}=this,r=oi.bufferInfo(e,t,i);if(0===r.len&&void 0!==r.nextStart){const s=this.fragmentTracker.getBufferedFrag(t,n);if(s&&r.nextStart<s.end)return oi.bufferInfo(e,t,Math.max(r.nextStart,i))}return r}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-3*t,n.maxMaxBufferLength/2,i);return r>=i&&(n.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0)}getAppendedFrag(e){const t=this.fragmentTracker.getAppendedFrag(e,Bt);return t&&"fragment"in t?t.fragment:t}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,s=n[0].start;let a;if(t.live){const o=r.initialLiveManifestSize;if(i<o)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${o})`),null;(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<s)&&(a=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=s&&(a=n[0]);if(!a){const n=r.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,n,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===ni||n===ti&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){const s=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(null===a)return a;if(e=a,s&&e&&!e.gap&&n.nextStart){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(null!==t&&n.len+t.len>=r)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let i=-1,r=!1,s=!0;for(let a=0,o=e.length;a<o;a++){const o=e[a];if(s=s&&!o.independent,i>-1&&n<o.start)break;const l=o.loaded;l?i=-1:(r||o.independent||s)&&o.fragment===t&&(i=a),r=l}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=function(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!E(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;n=n||0;for(let i=0;i<e.length;++i){const r=e[i];if(Dn(t,n,r))return r}return null}(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const s=t[r-e.startSN];n.cc===s.cc&&(i=s,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=function(e,t){return Cn(e,(e=>e.cc<t?1:e.cc>t?-1:0))}(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(i=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:s,endSN:a}=n;const{fragmentHint:o}=n,{maxFragLookUpTolerance:l}=i,u=n.partList,c=!!(i.lowLatencyMode&&null!=u&&u.length&&o);let d;if(c&&o&&!this.bitrateTest&&(s=s.concat(o),a=o.sn),e<t){d=In(r,s,e,e>t-l?0:l)}else d=s[s.length-1];if(d){const e=d.sn-n.startSN,t=this.fragmentTracker.getState(d);if((t===ni||t===ti&&d.gap)&&(r=d),r&&d.sn===r.sn&&(!c||u[0].fragment.sn>d.sn)){if(r&&d.level===r.level){const t=s[e+1];d=d.sn<a&&this.fragmentTracker.getState(t)!==ni?t:null}}}return d}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=n.currentTime,s=e.fragments[0].start,a=e.edge,o=r>=s-t.maxFragLookUpTolerance&&r<=a;if(null!==i&&n.duration>i&&(r<i||!o)){const s=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!o&&n.readyState<4||r<a-s)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const r=e.fragments[0].start,s=!t,a=e.alignedSliding&&E(r);if(s||!a&&!r){const{fragPrevious:r}=this;hi(r,n,e);const s=e.fragments[0].start;return this.log(`Live playlist sliding: ${s.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${r?r.sn:"na"} fragments: ${i}`),s}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),-1===n||-1===this.lastCurrentTime){const i=null!==this.startTimeOffset,r=i?this.startTimeOffset:e.startTimeOffset;null!==r&&E(r)?(n=t+r,r<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${r} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Ci)||(this.state=ki)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;var i;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(i=this.fragCurrent)?void 0:i.url}`);const r=t.details===I.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(n,!0);const s=t.errorAction,{action:a,retryCount:o=0,retryConfig:l}=s||{};if(s&&a===On&&l){this.resetStartWhenNotLoaded(this.levelLastLoaded);const i=kn(l,o);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${o+1}/${l.maxNumRetry} in ${i}ms`),s.resolved=!0,this.retryDate=self.performance.now()+i,this.state=Ci}else if(l&&s){if(this.resetFragmentErrors(e),!(o<l.maxNumRetry))return void P.warn(`${t.details} reached or exceeded max retry (${o})`);r||a===Pn||(s.resolved=!0)}else(null==s?void 0:s.action)===Mn?this.state=Oi:this.state=Mi;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Li||this.state===Di){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(null==t?void 0:t.duration)||10);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===jt&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Ei&&(this.state=ki)}afterBufferFlushed(e,t,n){if(!e)return;const i=oi.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Ri&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=ki}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var r;const s=n.details;if(!s)return void this.warn("level.details undefined");if(!Object.keys(e.elementaryStreams).reduce(((t,r)=>{const a=e.elementaryStreams[r];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${e.sn} ${r} duration reliably (${o})`),t||!1;const l=i?0:mn(s,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(A.LEVEL_PTS_UPDATED,{details:s,level:n,drift:l,type:r,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t}),!1)&&null===(null==(r=this.transmuxer)?void 0:r.error)){const t=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===n.fragmentError&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Di,this.hls.trigger(A.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class Ui{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:function(e,t){const n=new Uint8Array(t);let i=0;for(let r=0;r<e.length;r++){const t=e[r];n.set(t,i),i+=t.length}return n}(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function Fi(){return{type:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",id:-1,pid:-1,inputTimeScale:arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4,sequenceNumber:-1,samples:[],dropped:0}}class Bi{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Ye(this.cachedData,e),this.cachedData=null);let n,i=ye(e,0),r=i?i.length:0;const s=this._audioTrack,a=this._id3Track,o=i?Te(i):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&E(o))&&(this.basePTS=ji(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Yt,duration:Number.POSITIVE_INFINITY});r<l;){if(this.canParse(e,r)){const t=this.appendFrame(s,e,r);t?(this.frameIndex++,this.lastPTS=t.sample.pts,r+=t.length,n=r):r=l}else be(e,r)?(i=ye(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Yt,duration:Number.POSITIVE_INFINITY}),r+=i.length,n=r):r++;if(r===l&&n!==l){const t=pe(e,n);this.cachedData?this.cachedData=Ye(this.cachedData,t):this.cachedData=t}}return{audioTrack:s,videoTrack:Fi(),id3Track:a,textTrack:Fi()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Fi(),id3Track:this._id3Track,textTrack:Fi()}}destroy(){}}const ji=(e,t,n)=>{if(E(e))return 90*e;return 9e4*t+(n?9e4*n.baseTime/n.timescale:0)};function $i(e,t){return 255===e[t]&&240===(246&e[t+1])}function Vi(e,t){return 1&e[t+1]?7:9}function Hi(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function qi(e,t){return t+1<e.length&&$i(e,t)}function Gi(e,t){if(qi(e,t)){const n=Vi(e,t);if(t+n>=e.length)return!1;const i=Hi(e,t);if(i<=n)return!1;const r=t+i;return r===e.length||qi(e,r)}return!1}function zi(e,t,n,i,r){if(!e.samplerate){const s=function(e,t,n,i){let r,s,a,o;const l=navigator.userAgent.toLowerCase(),u=i,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=1+((192&t[n+2])>>>6);const d=(60&t[n+2])>>>2;if(!(d>c.length-1))return a=(1&t[n+2])<<2,a|=(192&t[n+3])>>>6,P.log(`manifest codec:${i}, ADTS type:${r}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(r=5,o=new Array(4),s=d-3):(r=2,o=new Array(2),s=d):-1!==l.indexOf("android")?(r=2,o=new Array(2),s=d):(r=5,o=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&d>=6?s=d-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(d>=6&&1===a||/vivaldi/i.test(l))||!i&&1===a)&&(r=2,o=new Array(2)),s=d)),o[0]=r<<3,o[0]|=(14&d)>>1,o[1]|=(1&d)<<7,o[1]|=a<<3,5===r&&(o[1]|=(14&s)>>1,o[2]=(1&s)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:c[d],channelCount:a,codec:"mp4a.40."+r,manifestCodec:u};{const t=new Error(`invalid ADTS sampling index:${d}`);e.emit(A.ERROR,A.ERROR,{type:C.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,fatal:!0,error:t,reason:t.message})}}(t,n,i,r);if(!s)return;e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,P.log(`parsed codec:${e.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function Ki(e){return 9216e4/e}function Wi(e,t,n,i,r){const s=i+r*Ki(e.samplerate),a=function(e,t){const n=Vi(e,t);if(t+n<=e.length){const i=Hi(e,t)-n;if(i>0)return{headerLength:n,frameLength:i}}}(t,n);let o;if(a){const{frameLength:i,headerLength:r}=a,l=r+i,u=Math.max(0,n+l-t.length);u?(o=new Uint8Array(l-r),o.set(t.subarray(n+r,t.length),0)):o=t.subarray(n+r,n+l);const c={unit:o,pts:s};return u||e.samples.push(c),{sample:c,length:l,missing:u}}const l=t.length-n;o=new Uint8Array(l),o.set(t.subarray(n,t.length),0);return{sample:{unit:o,pts:s},length:l,missing:-1}}let Xi=null;const Yi=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Qi=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Ji=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Zi=[0,1,1,4];function er(e,t,n,i,r){if(n+24>t.length)return;const s=tr(t,n);if(s&&n+s.frameLength<=t.length){const a=i+r*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:t.subarray(n,n+s.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(o),{sample:o,length:s.frameLength,missing:0}}}function tr(e,t){const n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){const a=e[t+2]>>1&1,o=e[t+3]>>6,l=1e3*Yi[14*(3===n?3-i:3===i?3:4)+r-1],u=Qi[3*(3===n?0:2===n?1:2)+s],c=3===o?1:2,d=Ji[n][i],h=Zi[i],f=8*d*h,p=Math.floor(d*l/u+a)*h;if(null===Xi){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Xi=e?parseInt(e[1]):0}return!!Xi&&Xi<=87&&2===i&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:p,samplesPerFrame:f}}}function nr(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function ir(e,t){return t+1<e.length&&nr(e,t)}function rr(e,t){if(t+1<e.length&&nr(e,t)){const n=4,i=tr(e,t);let r=n;null!=i&&i.frameLength&&(r=i.frameLength);const s=t+r;return s===e.length||ir(e,s)}return!1}const sr=/\/emsg[-/]ID3/i;const ar=(e,t)=>{let n=0,i=5;t+=i;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;i>0;){a[0]=e[t];const o=Math.min(i,8),l=8-o;s[0]=4278190080>>>24+l<<l,r[0]=(a[0]&s[0])>>l,n=n?n<<o|r[0]:r[0],t+=1,i-=o}return n};class or extends Bi{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=lr(e,t,n,this.basePTS,this.frameIndex);if(-1!==i){return{sample:e.samples[e.samples.length-1],length:i,missing:0}}}static probe(e){if(!e)return!1;const t=ye(e,0);if(!t)return!1;const n=t.length;return 11===e[n]&&119===e[n+1]&&void 0!==Te(t)&&ar(e,n)<16}}function lr(e,t,n,i,r){if(n+8>t.length)return-1;if(11!==t[n]||119!==t[n+1])return-1;const s=t[n+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],o=63&t[n+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+s];if(n+l>t.length)return-1;const u=t[n+6]>>5;let c=0;2===u?c+=2:(1&u&&1!==u&&(c+=2),4&u&&(c+=2));const d=(t[n+6]<<8|t[n+7])>>12-c&1,h=[2,1,2,3,3,4,4,5][u]+d,f=t[n+5]>>3,p=7&t[n+5],g=new Uint8Array([s<<6|f<<1|p>>2,(3&p)<<6|u<<3|d<<2|o>>4,o<<4&224]),m=i+r*(1536/a*9e4),y=t.subarray(n,n+l);return e.config=g,e.channelCount=h,e.samplerate=a,e.samples.push({unit:y,pts:m}),l}class ur{constructor(){this.VideoSample=null}createVideoSample(e,t,n,i){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:i,length:0}}getLastNalUnit(e){var t;let n,i=this.VideoSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){const e=i.units;n=e[e.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,i=n.length;if(!i)return void t.dropped++;{const t=n[i-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}e.debug.length&&P.log(e.pts+"/"+e.dts+":"+e.debug)}}class cr{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&P.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t,n=8,i=8;for(let r=0;r<e;r++)0!==i&&(t=this.readEG(),i=(n+t+256)%256),n=0===i?n:i}readSPS(){let e,t,n,i=0,r=0,s=0,a=0;const o=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),h=this.skipEG.bind(this),f=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);o();const g=o();if(l(5),d(3),o(),f(),100===g||110===g||122===g||244===g||44===g||83===g||86===g||118===g||128===g){const e=u();if(3===e&&d(1),f(),f(),d(1),c())for(t=3!==e?8:12,n=0;n<t;n++)c()&&p(n<6?16:64)}f();const m=u();if(0===m)u();else if(1===m)for(d(1),h(),h(),e=u(),n=0;n<e;n++)h();f(),d(1);const y=u(),v=u(),b=l(1);0===b&&d(1),d(1),c()&&(i=u(),r=u(),s=u(),a=u());let T=[1,1];if(c()&&c()){switch(o()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[o()<<8|o(),o()<<8|o()]}}return{width:Math.ceil(16*(y+1)-2*i-2*r),height:(2-b)*(v+1)*16-(b?2:4)*(s+a),pixelRatio:T}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class dr extends ur{parseAVCPES(e,t,n,i,r){const s=this.parseAVCNALu(e,n.data);let a,o=this.VideoSample,l=!1;n.data=null,o&&s.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),s.forEach((i=>{var s;switch(i.type){case 1:{let t=!1;a=!0;const r=i.data;if(l&&r.length>4){const e=new cr(r).readSliceType();2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var u;if(t)null!=(u=o)&&u.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null);o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),o.frame=!0,o.key=t;break}case 5:a=!0,null!=(s=o)&&s.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),o.key=!0,o.frame=!0;break;case 6:a=!0,Ze(i.data,1,n.pts,t.samples);break;case 7:{var c,d;a=!0,l=!0;const t=i.data,n=new cr(t).readSPS();if(!e.sps||e.width!==n.width||e.height!==n.height||(null==(c=e.pixelRatio)?void 0:c[0])!==n.pixelRatio[0]||(null==(d=e.pixelRatio)?void 0:d[1])!==n.pixelRatio[1]){e.width=n.width,e.height=n.height,e.pixelRatio=n.pixelRatio,e.sps=[t],e.duration=r;const i=t.subarray(1,4);let s="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),s+=t}e.codec=s}break}case 8:a=!0,e.pps=[i.data];break;case 9:a=!0,e.audFound=!0,o&&this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:a=!0;break;default:a=!1,o&&(o.debug+="unknown NAL "+i.type+" ")}if(o&&a){o.units.push(i)}})),i&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let i=e.naluState||0;const r=i,s=[];let a,o,l,u=0,c=-1,d=0;for(-1===i&&(c=0,d=31&t[0],i=0,u=1);u<n;)if(a=t[u++],i)if(1!==i)if(a)if(1===a){if(o=u-i-1,c>=0){const e={data:t.subarray(c,o),type:d};s.push(e)}else{const n=this.getLastNalUnit(e.samples);n&&(r&&u<=4-r&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-r)),o>0&&(n.data=Ye(n.data,t.subarray(0,o)),n.state=0))}u<n?(l=31&t[u],c=u,d=l,i=0):i=-1}else i=0;else i=3;else i=a?0:2;else i=a?0:1;if(c>=0&&i>=0){const e={data:t.subarray(c,n),type:d,state:i};s.push(e)}if(0===s.length){const n=this.getLastNalUnit(e.samples);n&&(n.data=Ye(n.data,t))}return e.naluState=i,s}}class hr{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new _i(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(s).then((r=>{const s=new Uint8Array(r);i.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}))}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)n.set(e.subarray(r,r+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)e.set(n.subarray(i,i+16),r);return e}decryptAvcSample(e,t,n,i,r){const s=et(r.data),a=this.getAvcEncryptedData(s);this.decryptBuffer(a.buffer).then((a=>{r.data=this.getAvcDecryptedUnit(s,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)}))}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void i();const r=e[t].units;for(;!(n>=r.length);n++){const s=r[n];if(!(s.data.length<=48||1!==s.type&&5!==s.type)&&(this.decryptAvcSample(e,t,n,i,s),!this.decrypter.isSync()))return}}}}const fr=188;class pr{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new dr}static probe(e){const t=pr.syncOffset(e);return t>0&&P.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){const t=e.length;let n=Math.min(940,t-fr)+1,i=0;for(;i<n;){let r=!1,s=-1,a=0;for(let o=i;o<t;o+=fr){if(71!==e[o]||t-o!==fr&&71!==e[o+fr]){if(a)return-1;break}if(a++,-1===s&&(s=o,0!==s&&(n=Math.min(s+18612,e.length-fr)+1)),r||(r=0===gr(e,o)),r&&a>1&&(0===s&&a>2||o+fr>n))return s}i++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Pe[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=pr.createTrack("video"),this._audioTrack=pr.createTrack("audio",i),this._id3Track=pr.createTrack("id3"),this._txtTrack=pr.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i||(this.sampleAes=null);const s=this._videoTrack,a=this._audioTrack,o=this._id3Track,l=this._txtTrack;let u=s.pid,c=s.pesData,d=a.pid,h=o.pid,f=a.pesData,p=o.pesData,g=null,m=this.pmtParsed,y=this._pmtId,v=e.length;if(this.remainderData&&(v=(e=Ye(this.remainderData,e)).length,this.remainderData=null),v<fr&&!r)return this.remainderData=e,{audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};const b=Math.max(0,pr.syncOffset(e));v-=(v-b)%fr,v<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,v,e.buffer.byteLength-v));let T=0;for(let _=b;_<v;_+=fr)if(71===e[_]){const t=!!(64&e[_+1]),r=gr(e,_);let v;if((48&e[_+3])>>4>1){if(v=_+5+e[_+4],v===_+fr)continue}else v=_+4;switch(r){case u:t&&(c&&(n=Tr(c))&&this.videoParser.parseAVCPES(s,l,n,!1,this._duration),c={data:[],size:0}),c&&(c.data.push(e.subarray(v,_+fr)),c.size+=_+fr-v);break;case d:if(t){if(f&&(n=Tr(f)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,n);break;case"mp3":this.parseMPEGPES(a,n);break;case"ac3":this.parseAC3PES(a,n)}f={data:[],size:0}}f&&(f.data.push(e.subarray(v,_+fr)),f.size+=_+fr-v);break;case h:t&&(p&&(n=Tr(p))&&this.parseID3PES(o,n),p={data:[],size:0}),p&&(p.data.push(e.subarray(v,_+fr)),p.size+=_+fr-v);break;case 0:t&&(v+=e[v]+1),y=this._pmtId=mr(e,v);break;case y:{t&&(v+=e[v]+1);const n=yr(e,v,this.typeSupported,i,this.observer);u=n.videoPid,u>0&&(s.pid=u,s.segmentCodec=n.segmentVideoCodec),d=n.audioPid,d>0&&(a.pid=d,a.segmentCodec=n.segmentAudioCodec),h=n.id3Pid,h>0&&(o.pid=h),null===g||m||(P.warn(`MPEG-TS PMT found at ${_} after unknown PID '${g}'. Backtracking to sync byte @${b} to parse all TS packets.`),g=null,_=b-188),m=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=r}}else T++;T>0&&vr(this.observer,new Error(`Found ${T} TS packet/s that do not start with 0x47`)),s.pesData=c,a.pesData=f,o.pesData=p;const S={audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};return r&&this.extractRemainingSamples(S),S}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,s=n.pesData,a=t.pesData,o=i.pesData;let l;if(s&&(l=Tr(s))?(this.videoParser.parseAVCPES(n,r,l,!0,this._duration),n.pesData=null):n.pesData=s,a&&(l=Tr(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l);break;case"ac3":this.parseAC3PES(t,l)}t.pesData=null}else null!=a&&a.size&&P.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;o&&(l=Tr(o))?(this.parseID3PES(i,l),i.pesData=null):i.pesData=o}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new hr(this.observer,this.config,t);return this.decrypt(i,r)}decrypt(e,t){return new Promise((n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,(()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,(()=>{n(e)})):n(e)})):r.samples&&t.decryptAvcSamples(r.samples,0,0,(()=>{n(e)}))}))}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r,s,a,o=t.data;if(i){this.aacOverFlow=null;const t=i.missing,r=i.sample.unit.byteLength;if(-1===t)o=Ye(i.sample.unit,o);else{const s=r-t;i.sample.unit.set(o.subarray(0,t),s),e.samples.push(i.sample),n=i.missing}}for(r=n,s=o.length;r<s-1&&!qi(o,r);r++);if(r!==n){let e;const t=r<s-1;if(e=t?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES",vr(this.observer,new Error(e),t),!t)return}if(zi(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!i)return void P.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=Ki(e.samplerate);a=i.sample.pts+t}}let l,u=0;for(;r<s;){if(l=Wi(e,o,r,a,u),r+=l.length,l.missing){this.aacOverFlow=l;break}for(u++;r<s-1&&!qi(o,r);r++);}}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,s=0;const a=t.pts;if(void 0!==a)for(;s<i;)if(ir(n,s)){const t=er(e,n,s,a,r);if(!t)break;s+=t.length,r++}else s++;else P.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(void 0===i)return void P.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=n.length;let s,a=0,o=0;for(;o<r&&(s=lr(e,n,o,i,a++))>0;)o+=s}}parseID3PES(e,t){if(void 0===t.pts)return void P.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=w({},t,{type:this._videoTrack?Jt:Yt,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function gr(e,t){return((31&e[t+1])<<8)+e[t+2]}function mr(e,t){return(31&e[t+10])<<8|e[t+11]}function yr(e,t,n,i,r){const s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){const a=gr(e,t),o=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!i){br("ADTS AAC");break}case 15:-1===s.audioPid&&(s.audioPid=a);break;case 21:-1===s.id3Pid&&(s.id3Pid=a);break;case 219:if(!i){br("H.264");break}case 27:-1===s.videoPid&&(s.videoPid=a,s.segmentVideoCodec="avc");break;case 3:case 4:n.mpeg||n.mp3?-1===s.audioPid&&(s.audioPid=a,s.segmentAudioCodec="mp3"):P.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){br("AC-3");break}case 129:n.ac3?-1===s.audioPid&&(s.audioPid=a,s.segmentAudioCodec="ac3"):P.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===s.audioPid&&o>0){let i=t+5,r=o;for(;r>2;){if(106===e[i])!0!==n.ac3?P.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=a,s.segmentAudioCodec="ac3");const t=e[i+1]+2;i+=t,r-=t}}break;case 194:case 135:return vr(r,new Error("Unsupported EC-3 in M2TS found")),s;case 36:return vr(r,new Error("Unsupported HEVC in M2TS found")),s}t+=o+5}return s}function vr(e,t,n){P.warn(`parsing error: ${t.message}`),e.emit(A.ERROR,A.ERROR,{type:C.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function br(e){P.log(`${e} with AES-128-CBC encryption found in unencrypted stream`)}function Tr(e){let t,n,i,r,s,a=0;const o=e.data;if(!e||0===e.size)return null;for(;o[0].length<19&&o.length>1;)o[0]=Ye(o[0],o[1]),o.splice(1,1);t=o[0];if(1===(t[0]<<16)+(t[1]<<8)+t[2]){if(n=(t[4]<<8)+t[5],n&&n>e.size-6)return null;const l=t[7];192&l&&(r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?(s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,r-s>54e5&&(P.warn(`${Math.round((r-s)/9e4)}s delta between PTS and DTS, align them`),r=s)):s=r),i=t[8];let u=i+9;if(e.size<=u)return null;e.size-=u;const c=new Uint8Array(e.size);for(let e=0,n=o.length;e<n;e++){t=o[e];let n=t.byteLength;if(u){if(u>n){u-=n;continue}t=t.subarray(u),n-=u,u=0}c.set(t,a),a+=n}return n&&(n-=i+3),{data:c,pts:r,dts:s,len:n}}return null}class Sr{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const _r=Math.pow(2,32)-1;class wr{static init(){let e;for(e in wr.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},wr.types)wr.types.hasOwnProperty(e)&&(wr.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);wr.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);wr.STTS=wr.STSC=wr.STCO=r,wr.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),wr.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),wr.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),wr.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);wr.FTYP=wr.box(wr.types.ftyp,s,o,s,a),wr.DINF=wr.box(wr.types.dinf,wr.box(wr.types.dref,i))}static box(e){let t=8;for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];let s=i.length;const a=s;for(;s--;)t+=i[s].byteLength;const o=new Uint8Array(t);for(o[0]=t>>24&255,o[1]=t>>16&255,o[2]=t>>8&255,o[3]=255&t,o.set(e,4),s=0,t=8;s<a;s++)o.set(i[s],t),t+=i[s].byteLength;return o}static hdlr(e){return wr.box(wr.types.hdlr,wr.HDLR_TYPES[e])}static mdat(e){return wr.box(wr.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(_r+1)),i=Math.floor(t%(_r+1));return wr.box(wr.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(e){return wr.box(wr.types.mdia,wr.mdhd(e.timescale,e.duration),wr.hdlr(e.type),wr.minf(e))}static mfhd(e){return wr.box(wr.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?wr.box(wr.types.minf,wr.box(wr.types.smhd,wr.SMHD),wr.DINF,wr.stbl(e)):wr.box(wr.types.minf,wr.box(wr.types.vmhd,wr.VMHD),wr.DINF,wr.stbl(e))}static moof(e,t,n){return wr.box(wr.types.moof,wr.mfhd(e),wr.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=wr.trak(e[t]);return wr.box.apply(null,[wr.types.moov,wr.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(wr.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=wr.trex(e[t]);return wr.box.apply(null,[wr.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(_r+1)),i=Math.floor(t%(_r+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return wr.box(wr.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return wr.box(wr.types.sdtp,n)}static stbl(e){return wr.box(wr.types.stbl,wr.stsd(e),wr.box(wr.types.stts,wr.STTS),wr.box(wr.types.stsc,wr.STSC),wr.box(wr.types.stsz,wr.STSZ),wr.box(wr.types.stco,wr.STCO))}static avc1(e){let t,n,i,r=[],s=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],i=n.byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],i=n.byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));const a=wr.box(wr.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(s))),o=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return wr.box(wr.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,wr.box(wr.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),wr.box(wr.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return wr.box(wr.types.mp4a,wr.audioStsd(e),wr.box(wr.types.esds,wr.esds(e)))}static mp3(e){return wr.box(wr.types[".mp3"],wr.audioStsd(e))}static ac3(e){return wr.box(wr.types["ac-3"],wr.audioStsd(e),wr.box(wr.types.dac3,e.config))}static stsd(e){return"audio"===e.type?"mp3"===e.segmentCodec&&"mp3"===e.codec?wr.box(wr.types.stsd,wr.STSD,wr.mp3(e)):"ac3"===e.segmentCodec?wr.box(wr.types.stsd,wr.STSD,wr.ac3(e)):wr.box(wr.types.stsd,wr.STSD,wr.mp4a(e)):wr.box(wr.types.stsd,wr.STSD,wr.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,i=e.width,r=e.height,s=Math.floor(n/(_r+1)),a=Math.floor(n%(_r+1));return wr.box(wr.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}static traf(e,t){const n=wr.sdtp(e),i=e.id,r=Math.floor(t/(_r+1)),s=Math.floor(t%(_r+1));return wr.box(wr.types.traf,wr.box(wr.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),wr.box(wr.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),wr.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,wr.box(wr.types.trak,wr.tkhd(e),wr.mdia(e))}static trex(e){const t=e.id;return wr.box(wr.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,s=new Uint8Array(r);let a,o,l,u,c,d;for(t+=8+r,s.set(["video"===e.type?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<i;a++)o=n[a],l=o.duration,u=o.size,c=o.flags,d=o.cts,s.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,u>>>24&255,u>>>16&255,u>>>8&255,255&u,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*a);return wr.box(wr.types.trun,s)}static initSegment(e){wr.types||wr.init();const t=wr.moov(e);return Ye(wr.FTYP,t)}}wr.types=void 0,wr.HDLR_TYPES=void 0,wr.STTS=void 0,wr.STSC=void 0,wr.STCO=void 0,wr.STSZ=void 0,wr.VMHD=void 0,wr.SMHD=void 0,wr.STSD=void 0,wr.FTYP=void 0,wr.DINF=void 0;function Er(e,t){const n=e*t*(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1);return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?Math.round(n):n}function kr(e){return Er(e,1e3,1/9e4,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}let xr,Ar=null,Cr=null;class Ir{constructor(e,t,n){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===Ar){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ar=e?parseInt(e[1]):0}if(null===Cr){const e=navigator.userAgent.match(/Safari\/(\d+)/i);Cr=e?parseInt(e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){P.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){P.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){P.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce(((e,i)=>{let r=i.pts,s=r-e;return s<-4294967296&&(t=!0,r=Lr(r,n),s=r-e),s>0?e:r}),n);return t&&P.debug("PTS rollover detected"),i}remux(e,t,n,i,r,s,a,o){let l,u,c,d,h,f,p=r,g=r;const m=e.pid>-1,y=t.pid>-1,v=t.samples.length,b=e.samples.length>0,T=a&&v>0||v>1;if((!m||b)&&(!y||T)||this.ISGenerated||a){if(this.ISGenerated){var S,_,w,E;const e=this.videoTrackConfig;!e||t.width===e.width&&t.height===e.height&&(null==(S=t.pixelRatio)?void 0:S[0])===(null==(_=e.pixelRatio)?void 0:_[0])&&(null==(w=t.pixelRatio)?void 0:w[1])===(null==(E=e.pixelRatio)?void 0:E[1])||this.resetInitSegment()}else c=this.generateIS(e,t,r,s);const n=this.isVideoContiguous;let i,a=-1;if(T&&(a=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(f=!0,a>0){P.warn(`[mp4-remuxer]: Dropped ${a} out of ${v} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,g+=(t.samples[0].pts-e)/t.inputTimeScale,i=g}else-1===a&&(P.warn(`[mp4-remuxer]: No keyframe found out of ${v} video samples`),f=!1);if(this.ISGenerated){if(b&&T){const n=this.getVideoStartPts(t.samples),i=(Lr(e.samples[0].pts,n)-n)/t.inputTimeScale;p+=Math.max(0,i),g+=Math.max(0,-i)}if(b){if(e.samplerate||(P.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,r,s)),u=this.remuxAudio(e,p,this.isAudioContiguous,s,y||T||o===jt?g:void 0),T){const i=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(P.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,r,s)),l=this.remuxVideo(t,g,n,i)}}else T&&(l=this.remuxVideo(t,g,n,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(h=Dr(n,r,this._initPTS,this._initDTS)),i.samples.length&&(d=Rr(i,r,this._initPTS))),{audio:u,video:l,initSegment:c,independent:f,text:d,id3:h}}generateIS(e,t,n,i){const r=e.samples,s=t.samples,a=this.typeSupported,o={},l=this._initPTS;let u,c,d,h=!l||i,f="audio/mp4";if(h&&(u=c=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(f="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}o.audio={id:"audio",container:f,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):wr.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(d=e.inputTimeScale,l&&d===l.timescale?h=!1:u=c=r[0].pts-Math.round(d*n))}if(t.sps&&t.pps&&s.length){if(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:wr.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(d=t.inputTimeScale,l&&d===l.timescale)h=!1;else{const e=this.getVideoStartPts(s),t=Math.round(d*n);c=Math.min(c,Lr(s[0].dts,e)-t),u=Math.min(u,e-t)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:u,timescale:d},this._initDTS={baseTime:c,timescale:d}):u=d=void 0,{tracks:o,initPTS:u,timescale:d}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,s=e.samples,a=[],o=s.length,l=this._initPTS;let u,c,d=this.nextAvcDts,h=8,f=this.videoSampleDuration,p=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,m=!1;if(!n||null===d){const e=t*r,i=s[0].pts-Lr(s[0].dts,s[0].pts);Ar&&null!==d&&Math.abs(e-i-d)<15e3?n=!0:d=e-i}const y=l.baseTime*r/l.timescale;for(let w=0;w<o;w++){const e=s[w];e.pts=Lr(e.pts-y,d),e.dts=Lr(e.dts-y,d),e.dts<s[w>0?w-1:w].dts&&(m=!0)}m&&s.sort((function(e,t){const n=e.dts-t.dts,i=e.pts-t.pts;return n||i})),u=s[0].dts,c=s[s.length-1].dts;const v=c-u,b=v?Math.round(v/(o-1)):f||e.inputTimeScale/30;if(n){const e=u-d,n=e>b,i=e<-1;if((n||i)&&(n?P.warn(`AVC: ${kr(e,!0)} ms (${e}dts) hole between fragments detected at ${t.toFixed(3)}`):P.warn(`AVC: ${kr(-e,!0)} ms (${e}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!i||d>=s[0].pts||Ar)){u=d;const t=s[0].pts-e;if(n)s[0].dts=u,s[0].pts=t;else for(let n=0;n<s.length&&!(s[n].dts>t);n++)s[n].dts-=e,s[n].pts-=e;P.log(`Video: Initial PTS/DTS adjusted: ${kr(t,!0)}/${kr(u,!0)}, delta: ${kr(e,!0)} ms`)}}u=Math.max(0,u);let T=0,S=0,_=u;for(let w=0;w<o;w++){const e=s[w],t=e.units,n=t.length;let i=0;for(let r=0;r<n;r++)i+=t[r].data.length;S+=i,T+=n,e.length=i,e.dts<_?(e.dts=_,_+=b/4|0||1):_=e.dts,p=Math.min(e.pts,p),g=Math.max(e.pts,g)}c=s[o-1].dts;const E=S+4*T+8;let k;try{k=new Uint8Array(E)}catch(U){return void this.observer.emit(A.ERROR,A.ERROR,{type:C.MUX_ERROR,details:I.REMUX_ALLOC_ERROR,fatal:!1,error:U,bytes:E,reason:`fail allocating video mdat ${E}`})}const x=new DataView(k.buffer);x.setUint32(0,E),k.set(wr.types.mdat,4);let L=!1,D=Number.POSITIVE_INFINITY,R=Number.POSITIVE_INFINITY,M=Number.NEGATIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(let w=0;w<o;w++){const e=s[w],t=e.units;let n,l=0;for(let i=0,r=t.length;i<r;i++){const e=t[i],n=e.data,r=e.data.byteLength;x.setUint32(h,r),h+=4,k.set(n,h),h+=r,l+=4+r}if(w<o-1)f=s[w+1].dts-e.dts,n=s[w+1].pts-e.pts;else{const t=this.config,a=w>0?e.dts-s[w-1].dts:b;if(n=w>0?e.pts-s[w-1].pts:b,t.stretchShortVideoTrack&&null!==this.nextAudioPts){const n=Math.floor(t.maxBufferHole*r),s=(i?p+i*r:this.nextAudioPts)-e.pts;s>n?(f=s-a,f<0?f=a:L=!0,P.log(`[mp4-remuxer]: It is approximately ${s/90} ms to the next segment; using duration ${f/90} ms for the last video frame.`)):f=a}else f=a}const u=Math.round(e.pts-e.dts);D=Math.min(D,f),M=Math.max(M,f),R=Math.min(R,n),O=Math.max(O,n),a.push(new Mr(e.key,f,l,u))}if(a.length)if(Ar){if(Ar<70){const e=a[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(Cr&&O-R<M-D&&b/M<.025&&0===a[0].cts){P.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=u;for(let t=0,n=a.length;t<n;t++){const i=e+a[t].duration,r=e+a[t].cts;if(t<n-1){const e=i+a[t+1].cts;a[t].duration=e-r}else a[t].duration=t?a[t-1].duration:b;a[t].cts=0,e=i}}f=L||!f?b:f,this.nextAvcDts=d=c+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;const N={data1:wr.moof(e.sequenceNumber++,u,w({},e,{samples:a})),data2:k,startPTS:p/r,endPTS:(g+f)/r,startDTS:u/r,endDTS:d/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,N}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(e,t,n,i,r){const s=e.inputTimeScale,a=s/(e.samplerate?e.samplerate:s),o=this.getSamplesPerFrame(e),l=o*a,u=this._initPTS,c="mp3"===e.segmentCodec&&this.typeSupported.mpeg,d=[],h=void 0!==r;let f=e.samples,p=c?0:8,g=this.nextAudioPts||-1;const m=t*s,y=u.baseTime*s/u.timescale;if(this.isAudioContiguous=n=n||f.length&&g>0&&(i&&Math.abs(m-g)<9e3||Math.abs(Lr(f[0].pts-y,m)-g)<20*l),f.forEach((function(e){e.pts=Lr(e.pts-y,m)})),!n||g<0){if(f=f.filter((e=>e.pts>=0)),!f.length)return;g=0===r?0:i&&!h?Math.max(0,m):f[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,i=g;n<f.length;n++){const r=f[n],a=r.pts,o=a-i,u=Math.abs(1e3*o/s);if(o<=-t*l&&h)0===n&&(P.warn(`Audio frame @ ${(a/s).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/s)} ms.`),this.nextAudioPts=g=i=a);else if(o>=t*l&&u<1e4&&h){let t=Math.round(o/l);i=a-t*l,i<0&&(t--,i+=l),0===n&&(this.nextAudioPts=g=i),P.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(i/s).toFixed(3)}s due to ${Math.round(1e3*o/s)} ms gap.`);for(let s=0;s<t;s++){const t=Math.max(i,0);let s=Sr.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);s||(P.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),s=r.unit.subarray()),f.splice(n,0,{unit:s,pts:t}),i+=l,n++}}r.pts=i,i+=l}}let v,b=null,T=null,S=0,_=f.length;for(;_--;)S+=f[_].unit.byteLength;for(let w=0,P=f.length;w<P;w++){const t=f[w],i=t.unit;let r=t.pts;if(null!==T){d[w-1].duration=Math.round((r-T)/a)}else{if(n&&"aac"===e.segmentCodec&&(r=g),b=r,!(S>0))return;S+=p;try{v=new Uint8Array(S)}catch(M){return void this.observer.emit(A.ERROR,A.ERROR,{type:C.MUX_ERROR,details:I.REMUX_ALLOC_ERROR,fatal:!1,error:M,bytes:S,reason:`fail allocating audio mdat ${S}`})}if(!c){new DataView(v.buffer).setUint32(0,S),v.set(wr.types.mdat,4)}}v.set(i,p);const s=i.byteLength;p+=s,d.push(new Mr(!0,o,s,0)),T=r}const E=d.length;if(!E)return;const k=d[d.length-1];this.nextAudioPts=g=T+a*k.duration;const x=c?new Uint8Array(0):wr.moof(e.sequenceNumber++,b/a,w({},e,{samples:d}));e.samples=[];const L=b/s,D=g/s,R={data1:x,data2:v,startPTS:L,endPTS:D,startDTS:L,endDTS:D,type:"audio",hasAudio:!0,hasVideo:!1,nb:E};return this.isAudioContiguous=!0,R}remuxEmptyAudio(e,t,n,i){const r=e.inputTimeScale,s=r/(e.samplerate?e.samplerate:r),a=this.nextAudioPts,o=this._initDTS,l=9e4*o.baseTime/o.timescale,u=(null!==a?a:i.startDTS*r)+l,c=i.endDTS*r+l,d=1024*s,h=Math.ceil((c-u)/d),f=Sr.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(P.warn("[mp4-remuxer]: remux empty Audio"),!f)return void P.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const p=[];for(let g=0;g<h;g++){const e=u+g*d;p.push({unit:f,pts:e,dts:e})}return e.samples=p,this.remuxAudio(e,t,n,!1)}}function Lr(e,t){let n;if(null===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}function Dr(e,t,n,i){const r=e.samples.length;if(!r)return;const s=e.inputTimeScale;for(let o=0;o<r;o++){const r=e.samples[o];r.pts=Lr(r.pts-n.baseTime*s/n.timescale,t*s)/s,r.dts=Lr(r.dts-i.baseTime*s/i.timescale,t*s)/s}const a=e.samples;return e.samples=[],{samples:a}}function Rr(e,t,n){const i=e.samples.length;if(!i)return;const r=e.inputTimeScale;for(let a=0;a<i;a++){const i=e.samples[a];i.pts=Lr(i.pts-n.baseTime*r/n.timescale,t*r)/r}e.samples.sort(((e,t)=>e.pts-t.pts));const s=e.samples;return e.samples=[],{samples:s}}class Mr{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}function Pr(e,t){const n=null==e?void 0:e.codec;if(n&&n.length>4)return n;if(t===$){if("ec-3"===n||"ac-3"===n||"alac"===n)return n;if("fLaC"===n||"Opus"===n){return Tt(n,!1)}const e="mp4a.40.5";return P.info(`Parsed audio codec "${n}" or audio object type not handled. Using "${e}"`),e}return P.warn(`Unhandled video codec "${n}"`),"hvc1"===n||"hev1"===n?"hvc1.1.6.L120.90":"av01"===n?"av01.0.04M.08":"avc1.42e01e"}try{xr=self.performance.now.bind(self.performance)}catch(Nv){P.debug("Unable to use Performance API on this environment"),xr=null==Q?void 0:Q.Date.now}const Or=[{demux:class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=Fi("video",1),s=this.audioTrack=Fi("audio",1),a=this.txtTrack=Fi("text",1);if(this.id3Track=Fi("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const o=He(e);if(o.video){const{id:e,timescale:t,codec:n}=o.video;r.id=e,r.timescale=a.timescale=t,r.codec=n}if(o.audio){const{id:e,timescale:t,codec:n}=o.audio;s.id=e,s.timescale=t,s.codec=n}a.id=Pe.text,r.sampleDuration=0,r.duration=s.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return function(e){const t=e.byteLength;for(let n=0;n<t;){const i=Ue(e,n);if(i>8&&109===e[n+4]&&111===e[n+5]&&111===e[n+6]&&102===e[n+7])return!0;n=i>1?n+i:t}return!1}(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Ye(this.remainderData,e));const t=function(e){const t={valid:null,remainder:null},n=$e(e,["moof"]);if(n.length<2)return t.remainder=e,t;const i=n[n.length-1];return t.valid=pe(e,0,i.byteOffset-8),t.remainder=pe(e,i.byteOffset-8),t}(n);this.remainderData=t.remainder,i.samples=t.valid||new Uint8Array}else i.samples=n;const s=this.extractID3Track(i,t);return r.samples=Qe(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=Qe(e,t),{videoTrack:t,audioTrack:Fi(),id3Track:i,textTrack:Fi()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=$e(e.samples,["emsg"]);i&&i.forEach((e=>{const i=function(e){const t=e[0];let n="",i="",r=0,s=0,a=0,o=0,l=0,u=0;if(0===t){for(;"\0"!==Oe(e.subarray(u,u+1));)n+=Oe(e.subarray(u,u+1)),u+=1;for(n+=Oe(e.subarray(u,u+1)),u+=1;"\0"!==Oe(e.subarray(u,u+1));)i+=Oe(e.subarray(u,u+1)),u+=1;i+=Oe(e.subarray(u,u+1)),u+=1,r=Ue(e,12),s=Ue(e,16),o=Ue(e,20),l=Ue(e,24),u=28}else if(1===t){u+=4,r=Ue(e,u),u+=4;const t=Ue(e,u);u+=4;const s=Ue(e,u);for(u+=4,a=2**32*t+s,k(a)||(a=Number.MAX_SAFE_INTEGER,P.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Ue(e,u),u+=4,l=Ue(e,u),u+=4;"\0"!==Oe(e.subarray(u,u+1));)n+=Oe(e.subarray(u,u+1)),u+=1;for(n+=Oe(e.subarray(u,u+1)),u+=1;"\0"!==Oe(e.subarray(u,u+1));)i+=Oe(e.subarray(u,u+1)),u+=1;i+=Oe(e.subarray(u,u+1)),u+=1}return{schemeIdUri:n,value:i,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:e.subarray(u,e.byteLength)}}(e);if(sr.test(i.schemeIdUri)){const e=E(i.presentationTime)?i.presentationTime/i.timeScale:t+i.presentationTimeDelta/i.timeScale;let r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const s=i.payload;n.samples.push({data:s,len:s.byteLength,dts:e,pts:e,type:Jt,duration:r})}}))}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(function(e,t){if(!e||!t)return e;const n=t.keyId;n&&t.isCommonEncryption&&$e(e,["moov","trak"]).forEach((e=>{const t=$e(e,["mdia","minf","stbl","stsd"])[0].subarray(8);let i=$e(t,["enca"]);const r=i.length>0;r||(i=$e(t,["encv"])),i.forEach((e=>{$e(r?e.subarray(28):e.subarray(78),["sinf"]).forEach((e=>{const t=We(e);if(t){const e=t.subarray(8,24);e.some((e=>0!==e))||(P.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${De(e)} -> ${De(n)}`),t.set(n,8))}}))}))}));return e}(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const i=this.initData=He(e);i.audio&&(t=Pr(i.audio,$)),i.video&&(n=Pr(i.video,V));const r={};i.audio&&i.video?r.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?r.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:P.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,n,i,r,s){var a,o;let{initPTS:l,lastEndTime:u}=this;const c={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};E(u)||(u=this.lastEndTime=r||0);const d=t.samples;if(null==d||!d.length)return c;const h={initPTS:void 0,timescale:1};let f=this.initData;if(null!=(a=f)&&a.length||(this.generateInitSegment(d),f=this.initData),null==(o=f)||!o.length)return P.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const p=function(e,t){let n=0,i=0,r=0;const s=$e(e,["moof","traf"]);for(let a=0;a<s.length;a++){const e=s[a],o=$e(e,["tfhd"])[0],l=t[Ue(o,4)];if(!l)continue;const u=l.default,c=Ue(o,0)|(null==u?void 0:u.flags);let d=null==u?void 0:u.duration;8&c&&(d=Ue(o,2&c?12:8));const h=l.timescale||9e4,f=$e(e,["trun"]);for(let t=0;t<f.length;t++)n=Xe(f[t]),!n&&d&&(n=d*Ue(f[t],4)),l.type===V?i+=n/h:l.type===$&&(r+=n/h)}if(0===i&&0===r){let t=1/0,n=0,i=0;const r=$e(e,["sidx"]);for(let e=0;e<r.length;e++){const s=Ve(r[e]);if(null!=s&&s.references){t=Math.min(t,s.earliestPresentationTime/s.timescale);const e=s.references.reduce(((e,t)=>e+t.info.duration||0),0);n=Math.max(n,e+s.earliestPresentationTime/s.timescale),i=n-t}}if(i&&E(i))return i}return i||r}(d,f),g=function(e,t){return $e(t,["moof","traf"]).reduce(((t,n)=>{const i=$e(n,["tfdt"])[0],r=i[0],s=$e(n,["tfhd"]).reduce(((t,n)=>{const s=Ue(n,4),a=e[s];if(a){let e=Ue(i,4);if(1===r){if(e===Re)return P.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;e*=Re+1,e+=Ue(i,8)}const n=e/(a.timescale||9e4);if(E(n)&&(null===t||n<t))return n}return t}),null);return null!==s&&E(s)&&(null===t||s<t)?s:t}),null)}(f,d),m=null===g?r:g;(function(e,t,n,i){if(null===e)return!0;const r=Math.max(i,1),s=t-e.baseTime/e.timescale;return Math.abs(s-n)>r}(l,m,r,p)||h.timescale!==l.timescale&&s)&&(h.initPTS=m-r,l&&1===l.timescale&&P.warn("Adjusting initPTS by "+(h.initPTS-l.baseTime)),this.initPTS=l={baseTime:h.initPTS,timescale:1});const y=e?m-l.baseTime/l.timescale:u,v=y+p;!function(e,t,n){$e(t,["moof","traf"]).forEach((t=>{$e(t,["tfhd"]).forEach((i=>{const r=Ue(i,4),s=e[r];if(!s)return;const a=s.timescale||9e4;$e(t,["tfdt"]).forEach((e=>{const t=e[0],i=n*a;if(i){let n=Ue(e,4);if(0===t)n-=i,n=Math.max(n,0),je(e,4,n);else{n*=Math.pow(2,32),n+=Ue(e,8),n-=i,n=Math.max(n,0);const t=Math.floor(n/(Re+1)),r=Math.floor(n%(Re+1));je(e,4,t),je(e,8,r)}}}))}))}))}(f,d,l.baseTime/l.timescale),p>0?this.lastEndTime=v:(P.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const b=!!f.audio,T=!!f.video;let S="";b&&(S+="audio"),T&&(S+="video");const _={data1:d,startPTS:y,startDTS:y,endPTS:v,endDTS:v,type:S,hasAudio:b,hasVideo:T,nb:1,dropped:0};return c.audio="audio"===_.type?_:void 0,c.video="audio"!==_.type?_:void 0,c.initSegment=h,c.id3=Dr(n,r,l,l),i.samples.length&&(c.text=Rr(i,r,l)),c}}},{demux:pr,remux:Ir},{demux:class extends Bi{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=ye(e,0);let n=(null==t?void 0:t.length)||0;if(rr(e,n))return!1;for(let i=e.length;n<i;n++)if(Gi(e,n))return P.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&$i(e,t)&&Hi(e,t)<=e.length-t}(e,t)}appendFrame(e,t,n){zi(e,this.observer,t,n,e.manifestCodec);const i=Wi(e,t,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}},remux:Ir},{demux:class extends Bi{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=ye(e,0);let n=(null==t?void 0:t.length)||0;if(t&&11===e[n]&&119===e[n+1]&&void 0!==Te(t)&&ar(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(rr(e,n))return P.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return nr(e,t)&&4<=e.length-t}(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return er(e,t,n,this.basePTS,this.frameIndex)}},remux:Ir}];Or.splice(2,0,{demux:or,remux:Ir});class Nr{constructor(e,t,n,i,r){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=r}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=xr();let s=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:o}=this;i&&(this.currentTransmuxState=i);const{contiguous:l,discontinuity:u,trackSwitch:c,accurateTimeOffset:d,timeOffset:h,initSegmentChange:f}=i||a,{audioCodec:p,videoCodec:g,defaultInitPts:m,duration:y,initSegmentData:v}=o,b=function(e,t){let n=null;e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(n=t);return n}(s,t);if(b&&"AES-128"===b.method){const e=this.getDecrypter();if(!e.isSync())return this.decryptionPromise=e.webCryptoDecrypt(s,b.key.buffer,b.iv.buffer).then((e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t})),this.decryptionPromise;{let t=e.softwareDecrypt(s,b.key.buffer,b.iv.buffer);if(n.part>-1&&(t=e.flush()),!t)return r.executeEnd=xr(),Ur(n);s=new Uint8Array(t)}}const T=this.needsProbing(u,c);if(T){const e=this.configureTransmuxer(s);if(e)return P.warn(`[transmuxer] ${e.message}`),this.observer.emit(A.ERROR,A.ERROR,{type:C.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),r.executeEnd=xr(),Ur(n)}(u||c||f||T)&&this.resetInitSegment(v,p,g,y,t),(u||f||T)&&this.resetInitialTimestamp(m),l||this.resetContiguity();const S=this.transmux(s,b,h,d,n),_=this.currentTransmuxState;return _.contiguous=!0,_.discontinuity=!1,_.trackSwitch=!1,r.executeEnd=xr(),S}flush(e){const t=e.transmuxing;t.executeStart=xr();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return r.then((()=>this.flush(e)));const s=[],{timeOffset:a}=i;if(n){const t=n.flush();t&&s.push(this.push(t,null,e))}const{demuxer:o,remuxer:l}=this;if(!o||!l)return t.executeEnd=xr(),[Ur(e)];const u=o.flush(a);return Fr(u)?u.then((t=>(this.flushRemux(s,t,e),s))):(this.flushRemux(s,u,e),s)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:s,textTrack:a}=t,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;P.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const u=this.remuxer.remux(i,r,s,a,l,o,!0,this.id);e.push({remuxResult:u,chunkMeta:n}),n.transmuxing.executeEnd=xr()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:s,remuxer:a}=this;s&&a&&(s.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let s;return s=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,i,r):this.transmuxUnencrypted(e,n,i,r),s}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,s,a,o,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then((e=>({remuxResult:this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,i,!1,this.id),chunkMeta:r})))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i,vendor:r}=this;let s;for(let d=0,h=Or.length;d<h;d++){var a;if(null!=(a=Or[d].demux)&&a.probe(e)){s=Or[d];break}}if(!s)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,u=s.remux,c=s.demux;l&&l instanceof u||(this.remuxer=new u(n,t,i,r)),o&&o instanceof c||(this.demuxer=new c(n,t,i),this.probe=c.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new _i(this.config)),e}}const Ur=e=>({remuxResult:{},chunkMeta:e});function Fr(e){return"then"in e&&e.then instanceof Function}class Br{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class jr{constructor(e,t,n,i,r,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=s}}var $r={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!==typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var l,u,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,r),!0;case 5:return c.fn.call(c.context,t,i,r,s),!0;case 6:return c.fn.call(c.context,t,i,r,s,a),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var h,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,i);break;case 4:c[u].fn.call(c[u].context,t,i,r);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c[u].fn.apply(c[u].context,l)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var l=0,u=[],c=o.length;l<c;l++)(o[l].fn!==t||r&&!o[l].once||i&&o[l].context!==i)&&u.push(o[l]);u.length?this._events[s]=1===u.length?u[0]:u:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}($r);var Vr=g($r.exports);class Hr{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const s=(e,t)=>{(t=t||{}).frag=this.frag,t.id=this.id,e===A.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new Vr,this.observer.on(A.FRAG_DECRYPTED,s),this.observer.on(A.ERROR,s);const a=dt(r.preferManagedMediaSource)||{isTypeSupported:()=>!1},o={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&"undefined"!==typeof Worker){if(r.workerPath||"function"===typeof __HLS_WORKER_BUNDLE__){try{r.workerPath?(P.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=function(e){const t=new self.URL(e,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}(r.workerPath)):(P.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e);return{worker:new self.Worker(t),objectURL:t}}()),this.onwmsg=e=>this.onWorkerMessage(e);const{worker:e}=this.workerContext;e.addEventListener("message",this.onwmsg),e.onerror=e=>{const n=new Error(`${e.message}  (${e.filename}:${e.lineno})`);r.enableWorker=!1,P.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(A.ERROR,{type:C.OTHER_ERROR,details:I.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:n})},e.postMessage({cmd:"init",typeSupported:o,vendor:"",id:t,config:JSON.stringify(r)})}catch(Nv){P.warn(`Error setting up "${t}" Web Worker, fallback to inline`,Nv),this.resetWorker(),this.error=null,this.transmuxer=new Nr(this.observer,o,r,"",t)}return}}this.transmuxer=new Nr(this.observer,o,r,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,r,s,a,o,l,u){var c,d;l.transmuxing.start=self.performance.now();const{transmuxer:h}=this,f=s?s.start:r.start,p=r.decryptdata,g=this.frag,m=!(g&&r.cc===g.cc),y=!(g&&l.level===g.level),v=g?l.sn-g.sn:-1,b=this.part?l.part-this.part.index:-1,T=0===v&&l.id>1&&l.id===(null==g?void 0:g.stats.chunkCount),S=!y&&(1===v||0===v&&(1===b||T&&b<=0)),_=self.performance.now();(y||v||0===r.stats.parsing.start)&&(r.stats.parsing.start=_),!s||!b&&S||(s.stats.parsing.start=_);const w=!(g&&(null==(c=r.initSegment)?void 0:c.url)===(null==(d=g.initSegment)?void 0:d.url)),E=new jr(m,S,o,y,f,w);if(!S||m||w){P.log(`[transmuxer-interface, ${r.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${m}\n        trackSwitch: ${y}\n        contiguous: ${S}\n        accurateTimeOffset: ${o}\n        timeOffset: ${f}\n        initSegmentChange: ${w}`);const e=new Br(n,i,t,a,u);this.configureTransmuxer(e)}if(this.frag=r,this.part=s,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:l,state:E},e instanceof ArrayBuffer?[e]:[]);else if(h){const t=h.push(e,p,l,E);Fr(t)?(h.async=!0,t.then((e=>{this.handleTransmuxComplete(e)})).catch((e=>{this.transmuxerError(e,l,"transmuxer-interface push error")}))):(h.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);Fr(n)||t.async?(Fr(n)||(n=Promise.resolve(n)),n.then((t=>{this.handleFlushResult(t,e)})).catch((t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}))):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach((e=>{this.handleTransmuxComplete(e)})),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(null==t||!t.event)return void P.warn("worker message received with no "+(t?"event name":"data"));const n=this.hls;if(this.hls)switch(t.event){case"init":{var i;const e=null==(i=this.workerContext)?void 0:i.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":P[t.data.logType]&&P[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function qr(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Gr(e[n].attrs,t[n].attrs))return!1;return!0}function Gr(e,t,n){const i=e["STABLE-RENDITION-ID"];return i&&!n?i===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((n=>e[n]!==t[n]))}function zr(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}class Kr{constructor(e){this.buffered=void 0;const t=(t,n,i)=>{if((n>>>=0)>i-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${i})`);return e[n][t]};this.buffered={get length(){return e.length},end:n=>t("end",n,e.length),start:n=>t("start",n,e.length)}}}class Wr{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const i=this.queues[t];i.push(e),1!==i.length||n||this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise((e=>{t=e})),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const t=this.queues[e];if(t.length){const i=t[0];try{i.execute()}catch(n){P.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${n}`),i.onError(n);const t=this.buffers[e];null!=t&&t.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const Xr=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;function Yr(e){const t=e.querySelectorAll("source");[].slice.call(t).forEach((t=>{e.removeChild(t)}))}const Qr={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Jr=e=>String.fromCharCode(Qr[e]||e),Zr=15,es=100,ts={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},ns={17:2,18:4,21:6,22:8,23:10,19:13,20:15},is={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rs={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ss=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class as{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"===typeof t?t():t;P.log(`${this.time} [${e}] ${n}`)}}}const os=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class ls{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class us{constructor(){this.uchar=" ",this.penState=new ls}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class cs{constructor(e){this.chars=[],this.pos=0,this.currPenState=new ls,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<es;t++)this.chars.push(new us);this.logger=e}equals(e){for(let t=0;t<es;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<es;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<es;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>es&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=es)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Jr(e);this.pos>=es?this.logger.log(0,(()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<es;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<es;n++){const i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);this.chars[this.pos].setPenState(this.currPenState)}}class ds{constructor(e){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Zr;t++)this.rows.push(new cs(e));this.logger=e}reset(){for(let e=0;e<Zr;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let n=0;n<Zr;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Zr;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Zr;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,(()=>"pacData = "+JSON.stringify(e)));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let t=0;t<Zr;t++)this.rows[t].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const i=n.rows[e].cueStartTime,r=this.logger.time;if(null!==i&&null!==r&&i<r)for(let s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(n.rows[e+s])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,i=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,(()=>"bkgData = "+JSON.stringify(e))),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let r=0;r<Zr;r++){const n=this.rows[r].getTextString();n&&(i=r+1,e?t.push("Row "+i+": '"+n+"'"):t.push(n.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class hs{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new ds(n),this.nonDisplayedMemory=new ds(n),this.lastOutputScreen=new ds(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(()=>"MODE="+e)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>t+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class fs{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const i=this.logger=new as;this.channels=[null,new hs(e,t,i),new hs(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const e=127&t[n],i=127&t[n+1];let r=!1,s=null;if(0===e&&0===i)continue;this.logger.log(3,(()=>"["+os([t[n],t[n+1]])+"] -> ("+os([e,i])+")"));const a=this.cmdHistory;if(e>=16&&e<=31){if(gs(e,i,a)){ps(null,null,a),this.logger.log(3,(()=>"Repeated command ("+os([e,i])+") is dropped"));continue}ps(e,i,this.cmdHistory),r=this.parseCmd(e,i),r||(r=this.parseMidrow(e,i)),r||(r=this.parsePAC(e,i)),r||(r=this.parseBackgroundAttributes(e,i))}else ps(null,null,a);if(!r&&(s=this.parseChars(e,i),s)){const e=this.currentChannel;if(e&&e>0){this.channels[e].insertChars(s)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,(()=>"Couldn't parse cleaned data "+os([e,i])+" orig: "+os([t[n],t[n+1]])))}}parseCmd(e,t){if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;const n=20===e||21===e||23===e?1:2,i=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.currentChannel=n,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(3,(()=>"MIDROW ("+os([e,t])+")")),!0)}return!1}parsePAC(e,t){let n;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;const i=e<=23?1:2;n=t>=64&&t<=95?1===i?ts[e]:is[e]:1===i?ns[e]:rs[e];const r=this.channels[i];return!!r&&(r.setPAC(this.interpretPAC(n,t)),this.currentChannel=i,!0)}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1===(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let e;e=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,(()=>"Special char '"+Jr(e)+"' in channel "+n)),i=[e]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);return i&&this.logger.log(3,(()=>"Char codes =  "+os(i).join(","))),i}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=45&&t<=47))return!1;let n;const i={};16===e||24===e?(n=Math.floor((t-32)/2),i.background=ss[n],t%2===1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0));const r=e<=23?1:2;return this.channels[r].setBkgData(i),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}ps(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function ps(e,t,n){n.a=e,n.b=t}function gs(e,t,n){return n.a===e&&n.b===t}class ms{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var ys=function(){if(null!=Q&&Q.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!==typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function i(e){return n(t,e)}function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];let r=1;for(;r<arguments.length;r++){const t=arguments[r];for(const n in t)e[n]=t[n]}return e}function s(t,s,a){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let u="",c=!1,d=t,h=s,f=a,p=null,g="",m=!0,y="auto",v="start",b=50,T="middle",S=50,_="middle";Object.defineProperty(o,"id",r({},l,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return d},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return h},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return f},set:function(e){f=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return p},set:function(e){p=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return g},set:function(t){const i=function(t){return n(e,t)}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");g=i,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return y},set:function(e){if("number"!==typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return v},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return T},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");T=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return S},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");S=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return _},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),o.displayState=void 0}return s.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},s}();class vs{decode(e,t){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function bs(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(i||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class Ts{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function Ss(e,t,n,i){const r=i?e.split(i):[e];for(const s in r){if("string"!==typeof r[s])continue;const e=r[s].split(n);if(2!==e.length)continue;t(e[0],e[1])}}const _s=new ys(0,0,""),ws="middle"===_s.align?"middle":"center";function Es(e,t,n){const i=e;function r(){const t=bs(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){e=e.replace(/^\s+/,"")}if(s(),t.startTime=r(),s(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),s(),t.endTime=r(),s(),function(e,t){const i=new Ts;Ss(e,(function(e,t){let r;switch(e){case"region":for(let r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":r=t.split(","),i.integer(e,r[0]),i.percent(e,r[0])&&i.set("snapToLines",!1),i.alt(e,r[0],["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start",ws,"end"]);break;case"position":r=t.split(","),i.percent(e,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start",ws,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",ws,"end","left","right"])}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");let r=i.get("line","auto");"auto"===r&&-1===_s.line&&(r=-1),t.line=r,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",ws);let s=i.get("position","auto");"auto"===s&&50===_s.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}(e,t)}function ks(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class xs{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new vs,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;for(e=ks(e);n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;const i=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),i}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const i=e.match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let r=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:e=n(),t.state){case"HEADER":/:/.test(e)?Ss(e,(function(e,t){}),/:/):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new ys(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Es(e,t.cue,t.regionList)}catch(i){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(r=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(i){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const As=/\r\n|\n\r|\n|\r/g,Cs=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.slice(n,n+t.length)===t},Is=function(e){let t=5381,n=e.length;for(;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function Ls(e,t,n){return Is(e.toString())+Is(t.toString())+Is(n)}function Ds(e,t,n,i,r,s,a){const o=new xs,l=Ie(new Uint8Array(e)).trim().replace(As,"\n").split("\n"),u=[],c=t?function(e){return Er(e,9e4,1/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1))}(t.baseTime,t.timescale):0;let d,h="00:00.000",f=0,p=0,g=!0;o.oncue=function(e){const s=n[i];let a=n.ccOffset;const o=(f-c)/9e4;if(null!=s&&s.new&&(void 0!==p?a=n.ccOffset=s.start:function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;null!=(s=r)&&s.new;){var s;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n}(n,i,o)),o){if(!t)return void(d=new Error("Missing initPTS for VTT MPEGTS"));a=o-n.presentationOffset}const l=e.endTime-e.startTime,h=Lr(9e4*(e.startTime+a-p),9e4*r)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+l,0);const g=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(g)),e.id||(e.id=Ls(e.startTime,e.endTime,g)),e.endTime>0&&u.push(e)},o.onparsingerror=function(e){d=e},o.onflush=function(){d?a(d):s(u)},l.forEach((e=>{if(g){if(Cs(e,"X-TIMESTAMP-MAP=")){g=!1,e.slice(16).split(",").forEach((e=>{Cs(e,"LOCAL:")?h=e.slice(6):Cs(e,"MPEGTS:")&&(f=parseInt(e.slice(7)))}));try{p=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!E(t)||!E(n)||!E(i)||!E(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=6e4*i,t+=36e5*r,t}(h)/1e3}catch(t){d=t}return}""===e&&(g=!1)}o.parse(e+"\n")})),o.flush()}const Rs="stpp.ttml.im1t",Ms=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ps=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Os={left:"start",center:"center",right:"end",start:"start",end:"end"};function Ns(e,t,n,i){const r=$e(new Uint8Array(e),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map((e=>Ie(e))),a=function(e,t){return Er(e,t,1/(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1),arguments.length>3&&void 0!==arguments[3]&&arguments[3])}(t.baseTime,1,t.timescale);try{s.forEach((e=>n(function(e,t){const n=(new DOMParser).parseFromString(e,"text/xml"),i=n.getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},s=Object.keys(r).reduce(((e,t)=>(e[t]=i.getAttribute(`ttp:${t}`)||r[t],e)),{}),a="preserve"!==i.getAttribute("xml:space"),o=Fs(Us(i,"styling","style")),l=Fs(Us(i,"layout","region")),u=Us(i,"body","[begin]");return[].map.call(u,(e=>{const n=Bs(e,a);if(!n||!e.hasAttribute("begin"))return null;const i=Vs(e.getAttribute("begin"),s),r=Vs(e.getAttribute("dur"),s);let u=Vs(e.getAttribute("end"),s);if(null===i)throw $s(e);if(null===u){if(null===r)throw $s(e);u=i+r}const c=new ys(i-t,u-t,n);c.id=Ls(c.startTime,c.endTime,c.text);const d=function(e,t,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;a&&n.hasOwnProperty(a)&&(r=n[a]);return s.reduce(((n,s)=>{const a=js(t,i,s)||js(e,i,s)||js(r,i,s);return a&&(n[s]=a),n}),{})}(l[e.getAttribute("region")],o[e.getAttribute("style")],o),{textAlign:h}=d;if(h){const e=Os[h];e&&(c.lineAlign=e),c.align=h}return w(c,d),c})).filter((e=>null!==e))}(e,a))))}catch(o){i(o)}}function Us(e,t,n){const i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function Fs(e){return e.reduce(((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e}),{})}function Bs(e,t){return[].slice.call(e.childNodes).reduce(((e,n,i)=>{var r;return"br"===n.nodeName&&i?e+"\n":null!=(r=n.childNodes)&&r.length?Bs(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent}),"")}function js(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function $s(e){return new Error(`Could not parse ttml timestamp ${e}`)}function Vs(e,t){if(!e)return null;let n=bs(e);return null===n&&(Ms.test(e)?n=function(e,t){const n=Ms.exec(e),i=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/t.frameRate}(e,t):Ps.test(e)&&(n=function(e,t){const n=Ps.exec(e),i=Number(n[1]);switch(n[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}(e,t))),n}function Hs(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function qs(e,t){return!!e&&e.kind===Hs(t)&&zr(t,e)}class Gs{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(A.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.BUFFER_CODECS,this.onBufferCodecs,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(A.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.BUFFER_CODECS,this.onBufferCodecs,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&E(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&P.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter(((t,n)=>this.isLevelAllowed(t)&&n<=e));return this.clientRect=null,Gs.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(t){}return e}isLevelAllowed(e){return!this.restrictedLevels.some((t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height))}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;let i=e.length-1;const r=Math.max(t,n);for(let o=0;o<e.length;o+=1){const t=e[o];if((t.width>=r||t.height>=r)&&(s=t,!(a=e[o+1])||s.width!==a.width||s.height!==a.height)){i=o;break}}var s,a;return i}}const zs="[eme]";class Ks{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Ks.CDMCleanupPromise?[Ks.CDMCleanupPromise]:[],this.debug=P.debug.bind(P,zs),this.log=P.log.bind(P,zs),this.warn=P.warn.bind(P,zs),this.error=P.error.bind(P,zs),this.onMediaEncrypted=e=>{const{initDataType:t,initData:n}=e,i=`"${e.type}" event: init data type: "${t}"`;if(this.debug(i),null!==n){if(!this.keyFormatPromise){let e=Object.keys(this.keySystemAccessPromises);e.length||(e=ce(this.config));const t=e.map(ue).filter((e=>!!e));this.keyFormatPromise=this.getKeyFormatPromise(t)}this.keyFormatPromise.then((r=>{const s=ie(r);let a,o;if("sinf"===t){if(s!==J.FAIRPLAY)return void this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${t}" for selected key-system ${s}`);const r=Oe(new Uint8Array(n));try{const e=We(W(JSON.parse(r).sinf));if(!e)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");a=e.subarray(8,24),o=J.FAIRPLAY}catch(h){return void this.warn(`${i} Failed to parse sinf: ${h}`)}}else{if(s!==J.WIDEVINE&&s!==J.PLAYREADY)return void this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${t}" for selected key-system ${s}`);const r=function(e){const t=[];if(e instanceof ArrayBuffer){const n=e.byteLength;let i=0;for(;i+32<n;){const n=nt(new DataView(e,i));t.push(n),i+=n.size}}return t}(n),l=r.filter((e=>!!e.systemId&&le(e.systemId)===s));l.length>1&&this.warn(`${i} Using first of ${l.length} pssh found for selected key-system ${s}`);const u=l[0];if(!u)return void(0===r.length||r.some((e=>!e.systemId))?this.warn(`${i} contains incomplete or invalid pssh data`):this.log(`ignoring ${i} for ${r.map((e=>le(e.systemId))).join(",")} pssh data in favor of playlist keys`));if(o=le(u.systemId),0===u.version&&u.data)if(o===J.WIDEVINE){const e=u.data.length-22;a=u.data.subarray(e,e+16)}else o===J.PLAYREADY&&(a=fe(u.data))}if(!o||!a)return void this.log(`Unable to handle ${i} with key-system ${s}`);const l=De(a),{keyIdToKeySessionPromise:u,mediaKeySessions:c}=this;let d=u[l];for(let e=0;e<c.length;e++){const i=c[e],r=i.decryptdata;if(!r.keyId)continue;const s=De(r.keyId);if(l===s||-1!==r.uri.replace(/-/g,"").indexOf(l)){if(d=u[s],r.pssh)break;delete u[s],r.pssh=new Uint8Array(n),r.keyId=a,d=u[l]=d.then((()=>this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-key-match"))),d.catch((e=>this.handleError(e)));break}}if(!d){if(o!==s)return void this.log(`Ignoring "${i}" with ${o} init data for selected key-system ${s}`);d=u[l]=this.getKeySystemSelectionPromise([o]).then((e=>{let{keySystem:i,mediaKeys:r}=e;var s;this.throwIfDestroyed();const o=new rt("ISO-23001-7",l,null!=(s=ue(i))?s:"");return o.pssh=new Uint8Array(n),o.keyId=a,this.attemptSetMediaKeys(i,r).then((()=>{this.throwIfDestroyed();const e=this.createMediaKeySessionContext({decryptdata:o,keySystem:i,mediaKeys:r});return this.generateRequestWithPreferredKeySession(e,t,n,"encrypted-event-no-match")}))})),d.catch((e=>this.handleError(e)))}}))}},this.onWaitingForKey=e=>{this.log(`"${e.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(A.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(A.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(A.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(A.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];return i?i.licenseUrl:e===J.WIDEVINE&&n?n:void 0}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,i=t.map((e=>e.audioCodec)).filter(n),r=t.map((e=>e.videoCodec)).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise(((t,n)=>{const s=e=>{const a=e.shift();this.getMediaKeysPromise(a,i,r).then((e=>t({keySystem:a,mediaKeys:e}))).catch((t=>{e.length?s(e):n(t instanceof Ws?t:new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))};s(e)}))}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!==typeof n){let e=`Configured requestMediaKeySystemAccess is not a function ${n}`;return null===de&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=function(e,t,n,i){let r;switch(e){case J.FAIRPLAY:r=["cenc","sinf"];break;case J.WIDEVINE:case J.PLAYREADY:r=["cenc"];break;case J.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return function(e,t,n,i){return[{initDataTypes:e,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map((e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null}))),videoCapabilities:n.map((e=>({contentType:`video/mp4; codecs="${e}"`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null})))}]}(r,t,n,i)}(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let s=null==r?void 0:r.keySystemAccess;if(!s){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),s=this.requestMediaKeySystemAccess(e,i);const t=this.keySystemAccessPromises[e]={keySystemAccess:s};return s.catch((t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)})),s.then((n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);const i=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=n.createMediaKeys().then((t=>(this.log(`Media-keys created for "${e}"`),i.then((n=>n?this.setMediaKeysServerCertificate(t,e,n):t))))),t.mediaKeys.catch((t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)})),t.mediaKeys}))}return s.then((()=>r.mediaKeys))}createMediaKeySessionContext(e){let{decryptdata:t,keySystem:n,mediaKeys:i}=e;this.log(`Creating key-system session "${n}" keyId: ${De(t.keyId||[])}`);const r=i.createSession(),s={decryptdata:t,keySystem:n,mediaKeys:i,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return De(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${De((null==(n=e.decryptdata)?void 0:n.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise(((t,n)=>{const i=ce(this.config),r=e.map(ie).filter((e=>!!e&&-1!==i.indexOf(e)));return this.getKeySystemSelectionPromise(r).then((e=>{let{keySystem:i}=e;const r=ue(i);r?t(r):n(new Error(`Unable to find format for key-system "${i}"`))})).catch(n)}))}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let r=this.keyIdToKeySessionPromise[n];return r||(r=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then((n=>{let{keySystem:r,mediaKeys:s}=n;return this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(r,s).then((()=>{this.throwIfDestroyed();const e=this.createMediaKeySessionContext({keySystem:r,mediaKeys:s,decryptdata:t});return this.generateRequestWithPreferredKeySession(e,"cenc",t.pssh,"playlist-key")}))})),r.catch((e=>this.handleError(e)))),r}throwIfDestroyed(){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Ws?this.hls.trigger(A.ERROR,e.data):this.hls.trigger(A.ERROR,{type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=ie(e.keyFormat),n=t?[t]:ce(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=ce(this.config)),0===e.length)throw new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(i),i.then((()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((e=>-1===n.indexOf(e)))}))}generateRequestWithPreferredKeySession(e,t,n,i){var r,s;const a=null==(r=this.config.drmSystems)||null==(s=r[e.keySystem])?void 0:s.generateRequest;if(a)try{const i=a.call(this.hls,t,n,e);if(!i)throw new Error("Invalid response from configured generateRequest filter");t=i.initDataType,n=e.decryptdata.pssh=i.initData?new Uint8Array(i.initData):null}catch(f){var o;if(this.warn(f.message),null!=(o=this.hls)&&o.config.debug)throw f}if(null===n)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${l} (init data type: ${t} length: ${n?n.byteLength:null})`);const u=new Vr,c=e._onmessage=t=>{const n=e.mediaKeysSession;if(!n)return void u.emit("error",new Error("invalid state"));const{messageType:i,message:r}=t;this.log(`"${i}" message event for session "${n.sessionId}" message size: ${r.byteLength}`),"license-request"===i||"license-renewal"===i?this.renewLicense(e,r).catch((e=>{this.handleError(e),u.emit("error",e)})):"license-release"===i?e.keySystem===J.FAIRPLAY&&(this.updateKeySession(e,Y("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${i}"`)},d=e._onkeystatuseschange=t=>{if(!e.mediaKeysSession)return void u.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const n=e.keyStatus;u.emit("keyStatus",n),"expired"===n&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",c),e.mediaKeysSession.addEventListener("keystatuseschange",d);const h=new Promise(((e,t)=>{u.on("error",t),u.on("keyStatus",(n=>{n.startsWith("usable")?e():"output-restricted"===n?t(new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===n?t(new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${n}"`)):"expired"===n?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${n}"`)}))}));return e.mediaKeysSession.generateRequest(t,n).then((()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${l}`)})).catch((e=>{throw new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)})).then((()=>h)).catch((t=>{throw u.removeAllListeners(),this.removeSession(e),t})).then((()=>(u.removeAllListeners(),e)))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach(((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${De("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${De(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t}))}fetchServerCertificate(e){const t=this.config,n=new(0,t.loader)(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise(((r,s)=>{const a={responseType:"arraybuffer",url:i},o=t.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(e,t,n,i)=>{r(e.data)},onError:(t,n,r,o)=>{s(new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:T({url:a.url,data:void 0},t)},`"${e}" certificate request failed (${i}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,r)=>{s(new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(e,t,n)=>{s(new Error("aborted"))}};n.load(a,l,u)}))):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise(((i,r)=>{e.setServerCertificate(n).then((r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${null==n?void 0:n.byteLength}) on "${t}"`),i(e)})).catch((e=>{r(new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then((t=>this.updateKeySession(e,new Uint8Array(t)).catch((e=>{throw new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let t;for(let n=0,i=r.length;n<i;n++){var s,a;t=r[n];const i=null==(s=t.querySelector("name"))?void 0:s.textContent,o=null==(a=t.querySelector("value"))?void 0:a.textContent;i&&o&&e.setRequestHeader(i,o)}}const o=i.querySelector("Challenge"),l=null==o?void 0:o.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return Y(atob(l))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then((()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)})).catch((s=>{if(!n.decryptdata)throw s;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)})).then((n=>{e.readyState||e.open("POST",t,!0);return{xhr:e,licenseChallenge:n||i}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise(((i,r)=>{const s=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${s}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let t=a.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,a,s,e)}catch(o){this.error(o)}i(t)}else{const o=n.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)r(new Ws({type:C.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:s,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${s}). Status: ${a.status} (${a.statusText})`));else{const n=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,s,e,t).then((t=>{let{xhr:n,licenseChallenge:i}=t;e.keySystem==J.PLAYREADY&&(i=this.unpackPlayReadyKeyMessage(n,i)),n.send(i)}))}))}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},rt.clearKeyUriToKeyIdMap();const n=t.length;Ks.CDMCleanupPromise=Promise.all(t.map((e=>this.removeSession(e))).concat(null==e?void 0:e.setMediaKeys(null).catch((e=>{this.log(`Could not clear media keys: ${e}`)})))).then((()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)})).catch((e=>{this.log(`Could not close sessions and clear media keys: ${e}`)}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,t){let{sessionKeys:n}=t;if(n&&this.config.emeEnabled&&!this.keyFormatPromise){const e=n.reduce(((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e)),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch((e=>{this.log(`Could not remove session: ${e}`)})).then((()=>t.close())).catch((e=>{this.log(`Could not close session: ${e}`)}))}}}Ks.CDMCleanupPromise=void 0;class Ws extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var Xs,Ys,Qs,Js,Zs,ea;(Ys=Xs||(Xs={})).MANIFEST="m",Ys.AUDIO="a",Ys.VIDEO="v",Ys.MUXED="av",Ys.INIT="i",Ys.CAPTION="c",Ys.TIMED_TEXT="tt",Ys.KEY="k",Ys.OTHER="o",(Js=Qs||(Qs={})).DASH="d",Js.HLS="h",Js.SMOOTH="s",Js.OTHER="o",(ea=Zs||(Zs={})).OBJECT="CMCD-Object",ea.REQUEST="CMCD-Request",ea.SESSION="CMCD-Session",ea.STATUS="CMCD-Status";const ta={[Zs.OBJECT]:["br","d","ot","tb"],[Zs.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Zs.SESSION]:["cid","pr","sf","sid","st","v"],[Zs.STATUS]:["bs","rtp"]};class na{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map((e=>e instanceof na?e:new na(e)))),this.value=e,this.params=t}}class ia{constructor(e){this.description=void 0,this.description=e}}function ra(e,t,n,i){return new Error(`failed to ${e} "${r=t,Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":"object"===typeof r?JSON.stringify(r):String(r)}" as ${n}`,{cause:i});var r}const sa="Bare Item";const aa=/[\x00-\x1f\x7f]+/;function oa(e,t,n){return ra("serialize",e,t,n)}function la(e){if(!1===ArrayBuffer.isView(e))throw oa(e,"Byte Sequence");return`:${t=e,btoa(String.fromCharCode(...t))}:`;var t}function ua(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw oa(e,"Integer");return e.toString()}function ca(e,t){if(e<0)return-ca(-e,t);const n=Math.pow(10,t);if(Math.abs(e*n%1-.5)<Number.EPSILON){const t=Math.floor(e*n);return(t%2===0?t:t+1)/n}return Math.round(e*n)/n}function da(e){const t=ca(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw oa(e,"Decimal");const n=t.toString();return n.includes(".")?n:`${n}.0`}function ha(e){const t=(n=e).description||n.toString().slice(7,-1);var n;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw oa(t,"Token");return t}function fa(e){switch(typeof e){case"number":if(!E(e))throw oa(e,sa);return Number.isInteger(e)?ua(e):da(e);case"string":return function(e){if(aa.test(e))throw oa(e,"String");return`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(e);case"symbol":return ha(e);case"boolean":return function(e){if("boolean"!==typeof e)throw oa(e,"Boolean");return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return`@${ua(e.getTime()/1e3)}`}(e);if(e instanceof Uint8Array)return la(e);if(e instanceof ia)return ha(e);default:throw oa(e,sa)}}function pa(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw oa(e,"Key");return e}function ga(e){return null==e?"":Object.entries(e).map((e=>{let[t,n]=e;return!0===n?`;${pa(t)}`:`;${pa(t)}=${fa(n)}`})).join("")}function ma(e){return e instanceof na?`${fa(e.value)}${ga(e.params)}`:fa(e)}function ya(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{whitespace:!0};if("object"!==typeof e)throw oa(e,"Dict");const n=e instanceof Map?e.entries():Object.entries(e),i=null!=t&&t.whitespace?" ":"";return Array.from(n).map((e=>{let[t,n]=e;n instanceof na===!1&&(n=new na(n));let i=pa(t);var r;return!0===n.value?i+=ga(n.params):(i+="=",Array.isArray(n.value)?i+=`(${(r=n).value.map(ma).join(" ")})${ga(r.params)}`:i+=ma(n)),i})).join(`,${i}`)}const va=e=>Math.round(e),ba=e=>100*va(e/100),Ta={br:va,d:va,bl:ba,dl:ba,mtp:ba,nor:(e,t)=>(null!=t&&t.baseUrl&&(e=function(e,t){const n=new URL(e),i=new URL(t);if(n.origin!==i.origin)return e;const r=n.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")}(e,t.baseUrl)),encodeURIComponent(e)),rtp:ba,tb:va};function Sa(e,t){const n={};if(null==e||"object"!==typeof e)return n;const i=Object.keys(e).sort(),r=w({},Ta,null==t?void 0:t.formatters),s=null==t?void 0:t.filter;return i.forEach((i=>{if(null!=s&&s(i))return;let a=e[i];const o=r[i];o&&(a=o(a,t)),"v"===i&&1===a||"pr"==i&&1===a||(e=>"number"===typeof e?E(e):null!=e&&""!==e&&!1!==e)(a)&&((e=>"ot"===e||"sf"===e||"st"===e)(i)&&"string"===typeof a&&(a=new ia(a)),n[i]=a)})),n}function _a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?function(e,t){return ya(e,t)}(Sa(e,t),w({whitespace:!1},t)):""}function wa(e,t,n){return w(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return{};const n=Object.entries(e),i=Object.entries(ta).concat(Object.entries((null==t?void 0:t.customHeaderMap)||{})),r=n.reduce(((e,t)=>{var n;const[r,s]=t,a=(null==(n=i.find((e=>e[1].includes(r))))?void 0:n[0])||Zs.REQUEST;return null!=e[a]||(e[a]={}),e[a][r]=s,e}),{});return Object.entries(r).reduce(((e,n)=>{let[i,r]=n;return e[i]=_a(r,t),e}),{})}(t,n))}const Ea=/CMCD=[^&#]+/;function ka(e,t,n){const i=function(e){if(!e)return"";const t=_a(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return`CMCD=${encodeURIComponent(t)}`}(t,n);if(!i)return e;if(Ea.test(e))return e.replace(Ea,i);const r=e.includes("?")?"&":"?";return`${e}${r}${i}`}function xa(e,t,n,i){e&&Object.keys(t).forEach((r=>{const s=e.filter((e=>e.groupId===r)).map((e=>{const s=w({},e);return s.details=void 0,s.attrs=new U(s.attrs),s.url=s.attrs.URI=Aa(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),s.groupId=s.attrs["GROUP-ID"]=t[r],s.attrs["PATHWAY-ID"]=i,s}));e.push(...s)}))}function Aa(e,t,n,i){const{HOST:r,PARAMS:s,[n]:a}=i;let o;t&&(o=null==a?void 0:a[t],o&&(e=o));const l=new self.URL(e);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach((e=>{e&&l.searchParams.set(e,s[e])})),l.href}const Ca=/^age:\s*[\d.]+\s*$/im;class Ia{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new j,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then((()=>{if(this.loader===n&&!this.stats.aborted)return r(n,t.url)})).catch((e=>{if(this.loader===n&&!this.stats.aborted)return n.open("GET",t.url,!0),r(n,t.url)})).then((()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)})).catch((e=>{this.callbacks.onError({code:n.status,text:e.message},t,n,i)})):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:s}=n.loadPolicy;if(i)for(const a in i)e.setRequestHeader(a,i[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&E(r)?r:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const i=t.status,s="text"===t.responseType?t.responseText:null;if(i>=200&&i<300){const r=null!=s?s:t.response;if(null!=r){n.loading.end=Math.max(self.performance.now(),n.loading.first);const s="arraybuffer"===t.responseType?r.byteLength:r.length;if(n.loaded=n.total=s,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first),!this.callbacks)return;const a=this.callbacks.onProgress;if(a&&a(n,e,r,t),!this.callbacks)return;const o={url:t.responseURL,data:r,code:i};return void this.callbacks.onSuccess(o,n,e,t)}}const a=r.loadPolicy.errorRetry;An(a,n.retry,!1,{url:e.url,data:void 0,code:i})?this.retry(a):(P.error(`${i} while loading ${e.url}`),this.callbacks.onError({code:i,text:t.statusText},e,t,n))}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry;if(An(e,this.stats.retry,!0))this.retry(e);else{var t;P.warn(`timeout while loading ${null==(t=this.context)?void 0:t.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=kn(e,n.retry),n.retry++,P.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==t?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&Ca.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const La=/(\d+)-(\d+)\/(\d+)/;class Da{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||Ra,this.controller=new self.AbortController,this.stats=new j}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=function(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(w({},e.headers))};e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1));return n}(e,this.controller.signal),s=n.onProgress,a="arraybuffer"===e.responseType,o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=l&&E(l)?l:u,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),n.onTimeout(i,e,this.response)}),t.timeout),self.fetch(this.request).then((r=>{this.response=this.loader=r;const o=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),n.onTimeout(i,e,this.response)}),u-(o-i.loading.start)),!r.ok){const{status:e,statusText:t}=r;throw new Ma(t||"fetch, bad network response",e,r)}return i.loading.first=o,i.total=function(e){const t=e.get("Content-Range");if(t){const e=function(e){const t=La.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(E(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}(r.headers)||i.total,s&&E(t.highWaterMark)?this.loadProgressively(r,i,e,t.highWaterMark,s):a?r.arrayBuffer():"json"===e.responseType?r.json():r.text()})).then((r=>{const a=this.response;if(!a)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const l=r[o];l&&(i.loaded=i.total=l);const u={url:a.url,data:r,code:a.status};s&&!E(t.highWaterMark)&&s(i,e,r,a),n.onSuccess(u,i,e,a)})).catch((t=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const r=t&&t.code||0,s=t?t.message:null;n.onError({code:r,text:s},e,t?t.details:null,i)}))}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;const s=new Ui,a=e.body.getReader(),o=()=>a.read().then((a=>{if(a.done)return s.dataLength&&r(t,n,s.flush(),e),Promise.resolve(new ArrayBuffer(0));const l=a.value,u=l.length;return t.loaded+=u,u<i||s.dataLength?(s.push(l),s.dataLength>=i&&r(t,n,s.flush(),e)):r(t,n,l,e),o()})).catch((()=>Promise.reject()));return o()}}function Ra(e,t){return new self.Request(e.url,t)}class Ma extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const Pa=/\s/,Oa={newCue(e,t,n,i){const r=[];let s,a,o,l,u;const c=self.VTTCue||self.TextTrackCue;for(let h=0;h<i.rows.length;h++)if(s=i.rows[h],o=!0,l=0,u="",!s.isEmpty()){var d;for(let e=0;e<s.chars.length;e++)Pa.test(s.chars[e].uchar)&&o?l++:(u+=s.chars[e].uchar,o=!1);s.cueStartTime=t,t===n&&(n+=1e-4),l>=16?l--:l++;const i=ks(u.trim()),f=Ls(t,n,i);null!=e&&null!=(d=e.cues)&&d.getCueById(f)||(a=new c(t,n,i),a.id=f,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(a))}return e&&r.length&&(r.sort(((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line)),r.forEach((t=>zt(e,t)))),r}},Na=T(T({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ia,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:i,media:r}=n;if(!e||!r)return;const s=performance.now(),a=t?t.stats:e.stats,o=t?t.duration:e.duration,l=s-a.loading.start,u=n.minAutoLevel;if(a.aborted||a.loaded&&a.loaded===a.total||e.level<=u)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!i||r.paused||!r.playbackRate||!r.readyState)return;const c=n.mainForwardBufferInfo;if(null===c)return;const d=this.bwEstimator.getEstimateTTFB(),h=Math.abs(r.playbackRate);if(l<=Math.max(d,o/(2*h)*1e3))return;const f=c.len/h,p=a.loading.first?a.loading.first-a.loading.start:-1,g=a.loaded&&p>-1,m=this.getBwEstimate(),y=n.levels,v=y[e.level],b=a.total||Math.max(a.loaded,Math.round(o*v.averageBitrate/8));let T=g?l-p:l;T<1&&g&&(T=Math.min(l,8*a.loaded/m));const S=g?1e3*a.loaded/T:0,_=S?(b-a.loaded)/S:8*b/m+d/1e3;if(_<=f)return;const w=S?8*S:m;let k,x=Number.POSITIVE_INFINITY;for(k=e.level-1;k>u;k--){const e=y[k].maxBitrate;if(x=this.getTimeToLoadFrag(d/1e3,w,o*e,!y[k].details),x<f)break}if(x>=_)return;if(x>10*o)return;n.nextLoadLevel=n.nextAutoLevel=k,g?this.bwEstimator.sample(l-Math.min(d,p),a.loaded):this.bwEstimator.sampleTTFB(l);const C=y[k].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>C&&this.resetEstimator(C),this.clearTimer(),P.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${f.toFixed(3)} s\n      Estimated load time for current fragment: ${_.toFixed(3)} s\n      Estimated load time for down switch fragment: ${x.toFixed(3)} s\n      TTFB estimate: ${0|p} ms\n      Current BW estimate: ${E(m)?0|m:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${k} @ ${0|C} bps`),n.trigger(A.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:a})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(P.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new $n(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.FRAG_LOADING,this.onFragLoading,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this),e.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.FRAG_LOADING,this.onFragLoading,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this),e.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(A.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){var i;if(!n.bitrateTest)this.fragCurrent=n,this.partCurrent=null!=(i=t.part)?i:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case I.BUFFER_ADD_CODEC_ERROR:case I.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case I.FRAG_LOAD_TIMEOUT:{const e=t.frag,{fragCurrent:n,partCurrent:i}=this;if(e&&n&&e.sn===n.sn&&e.level===n.level){const t=performance.now(),n=i?i.stats:e.stats,r=t-n.loading.start,s=n.loading.first?n.loading.first-n.loading.start:-1;if(n.loaded&&s>-1){const e=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(e,s),n.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(e,t,n,i){return e+n/t+(i?this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,r=i.end-i.start;E(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,t){let{frag:n,part:i}=t;const r=i?i.stats:n.stats;if(n.type===Bt&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(n)){if(this.clearTimer(),n.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const e=i?i.duration:n.duration,t=this.hls.levels[n.level],s=(t.loaded?t.loaded.bytes:0)+r.loaded,a=(t.loaded?t.loaded.duration:0)+e;t.loaded={bytes:s,duration:a},t.realBitrate=Math.round(8*s/a)}if(n.bitrateTest){const e={stats:r,frag:n,part:i,id:n.type};this.onFragBuffered(A.FRAG_BUFFERED,e),n.bitrateTest=!1}else this.lastLoadedFragLevel=n.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=null!=i&&i.stats.loaded?i.stats:n.stats;if(r.aborted)return;if(this.ignoreFragment(n))return;const s=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Bt||"initSegment"===e.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const s=this.hls.firstLevel,a=Math.min(Math.max(s,t),e);return P.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${s} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(-1!==e&&(!t||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const i=t&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,i)&&t[e].loadError<=t[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:r,minAutoLevel:s}=n,a=t?t.duration:e?e.duration:0,o=this.getBwEstimate(),l=this.getStarvationDelay();let u=r.abrBandWidthFactor,c=r.abrBandWidthUpFactor;if(l){const e=this.findBestLevel(o,s,i,l,0,u,c);if(e>=0)return e}let d=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!l){const e=this.bitrateTestDelay;if(e){d=(a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay)-e,P.info(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*d)} ms`),u=c=1}}const h=this.findBestLevel(o,s,i,l,d,u,c);if(P.info(`[abr] ${l?"rebuffering expected":"buffer is empty"}, optimal quality level ${h}`),h>-1)return h;const f=n.levels[s],p=n.levels[n.loadLevel];return(null==f?void 0:f.bitrate)<(null==p?void 0:p.bitrate)?s:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,r,s,a){var o;const l=i+r,u=this.lastLoadedFragLevel,c=-1===u?this.hls.firstLevel:u,{fragCurrent:d,partCurrent:h}=this,{levels:f,allAudioTracks:p,loadLevel:g,config:m}=this.hls;if(1===f.length)return 0;const y=f[c],v=!(null==y||null==(o=y.details)||!o.live),b=-1===g||-1===u;let T,S="SDR",_=(null==y?void 0:y.frameRate)||0;const{audioPreference:w,videoPreference:k}=m,x=this.audioTracksByGroup||(this.audioTracksByGroup=function(e){return e.reduce(((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}(p));if(b){if(-1!==this.firstSelection)return this.firstSelection;const i=this.codecTiers||(this.codecTiers=function(e,t,n,i){return e.slice(n,i+1).reduce(((e,n)=>{if(!n.codecSet)return e;const i=n.audioGroups;let r=e[n.codecSet];r||(e[n.codecSet]=r={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!i,fragmentError:0}),r.minBitrate=Math.min(r.minBitrate,n.bitrate);const s=Math.min(n.height,n.width);return r.minHeight=Math.min(r.minHeight,s),r.minFramerate=Math.min(r.minFramerate,n.frameRate),r.maxScore=Math.max(r.maxScore,n.score),r.fragmentError+=n.fragmentError,r.videoRanges[n.videoRange]=(r.videoRanges[n.videoRange]||0)+1,i&&i.forEach((e=>{if(!e)return;const n=t.groups[e];n&&(r.hasDefaultAudio=r.hasDefaultAudio||t.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(n.channels).forEach((e=>{r.channels[e]=(r.channels[e]||0)+n.channels[e]})))})),e}),{})}(f,x,t,n)),r=function(e,t,n,i,r){const s=Object.keys(e),a=null==i?void 0:i.channels,o=null==i?void 0:i.audioCodec,l=a&&2===parseInt(a);let u=!0,c=!1,d=1/0,h=1/0,f=1/0,p=0,g=[];const{preferHDR:m,allowedVideoRanges:y}=zn(t,r);for(let T=s.length;T--;){const t=e[s[T]];u=t.channels[2]>0,d=Math.min(d,t.minHeight),h=Math.min(h,t.minFramerate),f=Math.min(f,t.minBitrate);const n=y.filter((e=>t.videoRanges[e]>0));n.length>0&&(c=!0,g=n)}d=E(d)?d:0,h=E(h)?h:0;const v=Math.max(1080,d),b=Math.max(30,h);return f=E(f)?f:n,n=Math.max(f,n),c||(t=void 0,g=[]),{codecSet:s.reduce(((t,i)=>{const r=e[i];if(i===t)return t;if(r.minBitrate>n)return Kn(i,`min bitrate of ${r.minBitrate} > current estimate of ${n}`),t;if(!r.hasDefaultAudio)return Kn(i,"no renditions with default or auto-select sound found"),t;if(o&&i.indexOf(o.substring(0,4))%5!==0)return Kn(i,`audio codec preference "${o}" not found`),t;if(a&&!l){if(!r.channels[a])return Kn(i,`no renditions with ${a} channel sound found (channels options: ${Object.keys(r.channels)})`),t}else if((!o||l)&&u&&0===r.channels[2])return Kn(i,"no renditions with stereo sound found"),t;return r.minHeight>v?(Kn(i,`min resolution of ${r.minHeight} > maximum of ${v}`),t):r.minFramerate>b?(Kn(i,`min framerate of ${r.minFramerate} > maximum of ${b}`),t):g.some((e=>r.videoRanges[e]>0))?r.maxScore<p?(Kn(i,`max score of ${r.maxScore} < selected max of ${p}`),t):t&&(yt(i)>=yt(t)||r.fragmentError>e[t].fragmentError)?t:(p=r.maxScore,i):(Kn(i,`no variants with VIDEO-RANGE of ${JSON.stringify(g)} found`),t)}),void 0),videoRanges:g,preferHDR:m,minFramerate:h,minBitrate:f}}(i,S,e,w,k),{codecSet:s,videoRanges:a,minFramerate:o,minBitrate:l,preferHDR:u}=r;T=s,S=u?a[a.length-1]:a[0],_=o,e=Math.max(e,l),P.log(`[abr] picked start tier ${JSON.stringify(r)}`)}else T=null==y?void 0:y.codecSet,S=null==y?void 0:y.videoRange;const A=h?h.duration:d?d.duration:0,C=this.bwEstimator.getEstimateTTFB()/1e3,I=[];for(let D=n;D>=t;D--){var L;const t=f[D],o=D>c;if(!t)continue;if(m.useMediaCapabilities&&!t.supportedResult&&!t.supportedPromise){const n=navigator.mediaCapabilities;"function"===typeof(null==n?void 0:n.decodingInfo)&&qn(t,x,S,_,e,w)?(t.supportedPromise=Gn(t,x,n),t.supportedPromise.then((e=>{if(!this.hls)return;t.supportedResult=e;const n=this.hls.levels,i=n.indexOf(t);e.error?P.warn(`[abr] MediaCapabilities decodingInfo error: "${e.error}" for level ${i} ${JSON.stringify(e)}`):e.supported||(P.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${i} ${JSON.stringify(e)}`),i>-1&&n.length>1&&(P.log(`[abr] Removing unsupported level ${i}`),this.hls.removeLevel(i)))}))):t.supportedResult=Vn}if(T&&t.codecSet!==T||S&&t.videoRange!==S||o&&_>t.frameRate||!o&&_>0&&_<t.frameRate||t.supportedResult&&(null==(L=t.supportedResult.decodingInfoResults)||!L[0].smooth)){I.push(D);continue}const d=t.details,p=(h?null==d?void 0:d.partTarget:null==d?void 0:d.averagetargetduration)||A;let k;k=o?a*e:s*e;const R=A&&i>=2*A&&0===r?f[D].averageBitrate:f[D].maxBitrate,M=this.getTimeToLoadFrag(C,k,R*p,void 0===d);if(k>=R&&(D===u||0===t.loadError&&0===t.fragmentError)&&(M<=C||!E(M)||v&&!this.bitrateTestDelay||M<l)){const e=this.forcedAutoLevel;return D===g||-1!==e&&e===g||(I.length&&P.trace(`[abr] Skipped level(s) ${I.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${f[I[0]].codecs}" ${f[I[0]].videoRange}; not compatible with "${y.codecs}" ${S}`),P.info(`[abr] switch candidate:${c}->${D} adjustedbw(${Math.round(k)})-bitrate=${Math.round(k-R)} ttfb:${C.toFixed(1)} avgDuration:${p.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${M.toFixed(1)} firstSelection:${b} codecSet:${T} videoRange:${S} hls.loadLevel:${g}`)),b&&(this.firstSelection=D),D}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,i=Math.min(Math.max(e,n),t);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}},bufferController:class{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=e=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=e=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:e,mediaSource:t}=this;this.log("Media source opened"),e&&(e.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(A.MEDIA_ATTACHED,{media:e,mediaSource:t})),t&&t.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:e,_objectUrl:t}=this;e!==t&&P.error(`Media element src was set while attaching MediaSource (${t} > ${e})`)},this.hls=e;const t="[buffer-controller]";var n;this.appendSource=(n=dt(e.config.preferManagedMediaSource),"undefined"!==typeof self&&n===self.ManagedMediaSource),this.log=P.log.bind(P,t),this.warn=P.warn.bind(P,t),this.error=P.error.bind(P,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.BUFFER_RESET,this.onBufferReset,this),e.on(A.BUFFER_APPENDING,this.onBufferAppending,this),e.on(A.BUFFER_CODECS,this.onBufferCodecs,this),e.on(A.BUFFER_EOS,this.onBufferEos,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(A.FRAG_PARSED,this.onFragParsed,this),e.on(A.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.BUFFER_RESET,this.onBufferReset,this),e.off(A.BUFFER_APPENDING,this.onBufferAppending,this),e.off(A.BUFFER_CODECS,this.onBufferCodecs,this),e.off(A.BUFFER_EOS,this.onBufferEos,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(A.FRAG_PARSED,this.onFragParsed,this),e.off(A.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Wr(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,i=dt(this.appendSource);if(n&&i){var r;const e=this.mediaSource=new i;this.log(`created media source: ${null==(r=e.constructor)?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming));const t=this._objectUrl=self.URL.createObjectURL(e);if(this.appendSource)try{n.removeAttribute("src");const i=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||i&&e instanceof i,Yr(n),function(e,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,e.appendChild(n)}(n,t),n.load()}catch(s){n.src=t}else n.src=t;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(Nv){this.warn(`onMediaDetaching: ${Nv.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&Yr(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(A.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach((e=>{this.resetBuffer(e)})),this._initSourceBuffer(),this.hls.resumeBuffering()}resetBuffer(e){const t=this.sourceBuffer[e];try{var n;if(t)this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,null!=(n=this.mediaSource)&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}catch(Nv){this.warn(`onBufferReset ${e}`,Nv)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,i=Object.keys(t);if(i.forEach((e=>{if(n){const n=this.tracks[e];if(n&&"function"===typeof n.buffer.changeType){var i;const{id:r,codec:s,levelCodec:a,container:o,metadata:l}=t[e],u=St(n.codec,n.levelCodec),c=null==u?void 0:u.replace(Xr,"$1");let d=St(s,a);const h=null==(i=d)?void 0:i.replace(Xr,"$1");if(d&&c!==h){"audio"===e.slice(0,5)&&(d=Tt(d,this.appendSource));const t=`${o};codecs=${d}`;this.appendChangeType(e,t),this.log(`switching codec ${u} to ${d}`),this.tracks[e]={buffer:n.buffer,codec:s,container:o,levelCodec:a,metadata:l,id:r}}}}else this.pendingTracks[e]=t[e]})),n)return;const r=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==r&&(this.log(`${r} bufferCodec event(s) expected ${i.join(",")}`),this.bufferCodecEventsExpected=r),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,i={execute:()=>{const i=this.sourceBuffer[e];i&&(this.log(`changing ${e} sourceBuffer type to ${t}`),i.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn(`Failed to change ${e} SourceBuffer type`,t)}};n.append(i,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:i,tracks:r}=this,{data:s,type:a,frag:o,part:l,chunkMeta:u}=t,c=u.buffering[a],d=self.performance.now();c.start=d;const h=o.stats.buffering,f=l?l.stats.buffering:null;0===h.start&&(h.start=d),f&&0===f.start&&(f.start=d);const p=r.audio;let g=!1;"audio"===a&&"audio/mpeg"===(null==p?void 0:p.container)&&(g=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const m=o.start,y={execute:()=>{if(c.executeStart=self.performance.now(),g){const e=this.sourceBuffer[a];if(e){const t=m-e.timestampOffset;Math.abs(t)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${m} (delta: ${t}) sn: ${o.sn})`),e.timestampOffset=m)}}this.appendExecutor(s,a)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();c.executeEnd=c.end=e,0===h.first&&(h.first=e),f&&0===f.first&&(f.first=e);const{sourceBuffer:t}=this,n={};for(const i in t)n[i]=oi.getBuffered(t[i]);this.appendErrors[a]=0,"audio"===a||"video"===a?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(A.BUFFER_APPENDED,{type:a,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:n})},onError:e=>{const t={type:C.MEDIA_ERROR,parent:o.type,details:I.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:o,part:l,chunkMeta:u,error:e,err:e,fatal:!1};if(e.code===DOMException.QUOTA_EXCEEDED_ERR)t.details=I.BUFFER_FULL_ERROR;else{const e=++this.appendErrors[a];t.details=I.BUFFER_APPEND_ERROR,this.warn(`Failed ${e}/${n.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),e>=n.config.appendErrorMaxRetry&&(t.fatal=!0)}n.trigger(A.ERROR,t)}};i.append(y,a,!!this.pendingTracks[a])}onBufferFlushing(e,t){const{operationQueue:n}=this,i=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(A.BUFFER_FLUSHED,{type:e})},onError:t=>{this.warn(`Failed to remove from ${e} SourceBuffer`,t)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach((e=>{n.append(i(e),e)}))}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],s=i?i.elementaryStreams:n.elementaryStreams;s[H]?r.push("audiovideo"):(s[$]&&r.push("audio"),s[V]&&r.push("video"));0===r.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers((()=>{const e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);const t=i?i.stats:n.stats;this.hls.trigger(A.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})}),r)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce(((e,n)=>{const i=this.sourceBuffer[n];return!i||t.type&&t.type!==n||(i.ending=!0,i.ended||(i.ended=!0,this.log(`${n} sourceBuffer now EOS`))),e&&!(i&&!i.ended)}),!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers((()=>{this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];t&&(t.ending=!1)}));const{mediaSource:e}=this;e&&"open"===e.readyState?(this.log("Calling mediaSource.endOfStream()"),e.endOfStream()):e&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)})))}onLevelUpdated(e,t){let{details:n}=t;n.fragments.length&&(this.details=n,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||null===t)return;if(!this.getSourceBufferTypes().length)return;const i=e.config,r=n.currentTime,s=t.levelTargetDuration,a=t.live&&null!==i.liveBackBufferLength?i.liveBackBufferLength:i.backBufferLength;if(E(a)&&a>0){const e=Math.max(a,s),t=Math.floor(r/s)*s-e;this.flushBackBuffer(r,s,t)}if(E(i.frontBufferFlushThreshold)&&i.frontBufferFlushThreshold>0){const e=Math.max(i.maxBufferLength,i.frontBufferFlushThreshold),t=Math.max(e,s),n=Math.floor(r/s)*s+t;this.flushFrontBuffer(r,s,n)}}flushBackBuffer(e,t,n){const{details:i,sourceBuffer:r}=this;this.getSourceBufferTypes().forEach((s=>{const a=r[s];if(a){const r=oi.getBuffered(a);if(r.length>0&&n>r.start(0)){if(this.hls.trigger(A.BACK_BUFFER_REACHED,{bufferEnd:n}),null!=i&&i.live)this.hls.trigger(A.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(a.ended&&r.end(r.length-1)-e<2*t)return void this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);this.hls.trigger(A.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:s})}}}))}flushFrontBuffer(e,t,n){const{sourceBuffer:i}=this;this.getSourceBufferTypes().forEach((r=>{const s=i[r];if(s){const i=oi.getBuffered(s),a=i.length;if(a<2)return;const o=i.start(a-1),l=i.end(a-1);if(n>o||e>=o&&e<=l)return;if(s.ended&&e-l<2*t)return void this.log(`Cannot flush ${r} front buffer while SourceBuffer is in ended state`);this.hls.trigger(A.BUFFER_FLUSHING,{startOffset:o,endOffset:1/0,type:r})}}))}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:n,mediaSource:i}=this,r=e.fragments[0].start+e.totalduration,s=n.duration,a=E(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(i.duration=1/0,this.updateSeekableRange(e)):(r>a&&r>s||!E(s))&&(this.log(`Updating Media Source duration to ${r.toFixed(3)}`),i.duration=r)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&null!=t&&t.setLiveSeekableRange){const i=Math.max(0,n[0].start),r=Math.max(i,i+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${i}-${r}.`),t.setLiveSeekableRange(i,r)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&(!e||2===i||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(A.BUFFER_CREATED,{tracks:this.tracks}),e.forEach((e=>{t.executeNext(e)}));else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const r in e)if(!t[r]){var i;const s=e[r];if(!s)throw Error(`source buffer exists for track ${r}, however track does not`);let a=-1===(null==(i=s.levelCodec)?void 0:i.indexOf(","))?s.levelCodec:s.codec;a&&"audio"===r.slice(0,5)&&(a=Tt(a,this.appendSource));const o=`${s.container};codecs=${a}`;this.log(`creating sourceBuffer(${o})`);try{const e=t[r]=n.addSourceBuffer(o),i=r;this.addBufferListener(i,"updatestart",this._onSBUpdateStart),this.addBufferListener(i,"updateend",this._onSBUpdateEnd),this.addBufferListener(i,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(i,"bufferedchange",((e,t)=>{const n=t.removedRanges;null!=n&&n.length&&this.hls.trigger(A.BUFFER_FLUSHED,{type:r})})),this.tracks[r]={buffer:e,codec:a,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id}}catch(Nv){this.error(`error while trying to add sourceBuffer: ${Nv.message}`),this.hls.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:Nv,sourceBufferName:r,mimeType:o})}}}get mediaSrc(){var e,t;const n=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==n?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if("closed"===(null==(t=this.mediaSource)?void 0:t.readyState))return void this.resetBuffer(e);const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${null==(n=this.mediaSource)?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.operationQueue.current(e);r&&r.onError(i)}removeExecutor(e,t,n){const{media:i,mediaSource:r,operationQueue:s,sourceBuffer:a}=this,o=a[e];if(!i||!r||!o)return this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void s.shiftAndExecuteNext(e);const l=E(i.duration)?i.duration:1/0,u=E(r.duration)?r.duration:1/0,c=Math.max(0,t),d=Math.min(n,l,u);d>c&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${c},${d}] from the ${e} SourceBuffer`),o.remove(c,d)):s.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(n)n.ended=!1,n.appendBuffer(e);else if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`)}blockBuffers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSourceBufferTypes();if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map((e=>n.appendBlocker(e)));Promise.all(i).then((()=>{e(),t.forEach((e=>{const t=this.sourceBuffer[e];null!=t&&t.updating||n.shiftAndExecuteNext(e)}))}))}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const i=this.sourceBuffer[e];if(!i)return;const r=n.bind(this,e);this.listeners[e].push({event:t,listener:r}),i.addEventListener(t,r)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach((e=>{t.removeEventListener(e.event,e.listener)}))}},capLevelController:Gs,errorController:class{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=P.log.bind(P,"[info]:"),this.warn=P.warn.bind(P,"[warning]:"),this.error=P.error.bind(P,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(A.ERROR,this.onError,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(A.ERROR,this.onError,this),e.off(A.ERROR,this.onErrorOut,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(null==e?void 0:e.type)===Bt?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,i;if(t.fatal)return;const r=this.hls,s=t.context;switch(t.details){case I.FRAG_LOAD_ERROR:case I.FRAG_LOAD_TIMEOUT:case I.KEY_LOAD_ERROR:case I.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case I.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction={action:Rn,flags:Nn});case I.FRAG_GAP:case I.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=Mn);case I.LEVEL_EMPTY_ERROR:case I.LEVEL_PARSING_ERROR:{var a,o;const e=t.parent===Bt?t.level:r.loadLevel;t.details===I.LEVEL_EMPTY_ERROR&&null!=(a=t.context)&&null!=(o=a.levelDetails)&&o.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case I.LEVEL_LOAD_ERROR:case I.LEVEL_LOAD_TIMEOUT:return void("number"===typeof(null==s?void 0:s.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level)));case I.AUDIO_TRACK_LOAD_ERROR:case I.AUDIO_TRACK_LOAD_TIMEOUT:case I.SUBTITLE_LOAD_ERROR:case I.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const e=r.levels[r.loadLevel];if(e&&(s.type===Ut&&e.hasAudioGroup(s.groupId)||s.type===Ft&&e.hasSubtitleGroup(s.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=Mn,void(t.errorAction.flags=Un)}return;case I.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=r.levels[r.loadLevel],n=null==e?void 0:e.attrs["HDCP-LEVEL"];n?t.errorAction={action:Mn,flags:Fn,hdcpLevel:n}:this.keySystemError(t)}return;case I.BUFFER_ADD_CODEC_ERROR:case I.REMUX_ALLOC_ERROR:case I.BUFFER_APPEND_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(i=t.level)?i:r.loadLevel));case I.INTERNAL_EXCEPTION:case I.BUFFER_APPENDING_ERROR:case I.BUFFER_FULL_ERROR:case I.LEVEL_SWITCH_ERROR:case I.BUFFER_STALLED_ERROR:case I.BUFFER_SEEK_OVER_HOLE:case I.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:Rn,flags:Nn})}t.type===C.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=En(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++;if(An(n,i,wn(e),e.response))return{action:On,flags:Nn,retryConfig:n,retryCount:i};const r=this.getLevelSwitchAction(e,t);return n&&(r.retryConfig=n,r.retryCount=i),r}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:s}=t.config,a=En(e.details.startsWith("key")?s:r,e),o=t.levels.reduce(((e,t)=>e+t.fragmentError),0);if(i){e.details!==I.FRAG_GAP&&i.fragmentError++;if(An(a,o,wn(e),e.response))return{action:On,flags:Nn,retryConfig:a,retryCount:o}}const l=this.getLevelSwitchAction(e,n);return a&&(l.retryConfig=a,l.retryCount=o),l}getLevelSwitchAction(e,t){const n=this.hls;null!==t&&void 0!==t||(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,s;const t=e.details;i.loadError++,t===I.BUFFER_APPEND_ERROR&&i.fragmentError++;let l=-1;const{levels:u,loadLevel:c,minAutoLevel:d,maxAutoLevel:h}=n;n.autoLevelEnabled||(n.loadLevel=-1);const f=null==(r=e.frag)?void 0:r.type,p=(f===jt&&t===I.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(t===I.BUFFER_ADD_CODEC_ERROR||t===I.BUFFER_APPEND_ERROR))&&u.some((e=>{let{audioCodec:t}=e;return i.audioCodec!==t})),g="video"===e.sourceBufferName&&(t===I.BUFFER_ADD_CODEC_ERROR||t===I.BUFFER_APPEND_ERROR)&&u.some((e=>{let{codecSet:t,audioCodec:n}=e;return i.codecSet!==t&&i.audioCodec===n})),{type:m,groupId:y}=null!=(s=e.context)?s:{};for(let n=u.length;n--;){const r=(n+c)%u.length;if(r!==c&&r>=d&&r<=h&&0===u[r].loadError){var a,o;const n=u[r];if(t===I.FRAG_GAP&&f===Bt&&e.frag){const t=u[r].details;if(t){const n=In(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(m===Ut&&n.hasAudioGroup(y)||m===Ft&&n.hasSubtitleGroup(y))continue;if(f===jt&&null!=(a=i.audioGroups)&&a.some((e=>n.hasAudioGroup(e)))||f===$t&&null!=(o=i.subtitleGroups)&&o.some((e=>n.hasSubtitleGroup(e)))||p&&i.audioCodec===n.audioCodec||!p&&i.audioCodec!==n.audioCodec||g&&i.codecSet===n.codecSet)continue}l=r;break}}if(l>-1&&n.loadLevel!==l)return e.levelRetry=!0,this.playlistError=0,{action:Mn,flags:Nn,nextAutoLevel:l}}return{action:Mn,flags:Un}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case Rn:break;case Mn:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===I.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):t.fatal=!0}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:r,nextAutoLevel:s}=n;switch(i){case Nn:this.switchLevel(e,s);break;case Fn:r&&(t.maxHdcpLevel=an[an.indexOf(r)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}n.resolved||this.switchLevel(e,s)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}},fpsController:class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"===typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const e=i-this.lastTime,r=n-this.lastDroppedFrames,s=t-this.lastDecodedFrames,a=1e3*r/e,o=this.hls;if(o.trigger(A.FPS_DROP,{currentDropped:r,currentDecoded:s,totalDroppedFrames:n}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*s){let e=o.currentLevel;P.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=e)&&(e-=1,o.trigger(A.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:o.currentLevel}),o.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:de,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:Oa,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Ni{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",$t),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.ERROR,this.onError,this),e.on(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(A.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.ERROR,this.onError,this),e.off(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(A.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=ki,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=ki,!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let s;const a=n.start;for(let l=0;l<r.length;l++)if(a>=r[l].start&&a<=r[l].end){s=r[l];break}const o=n.start+n.duration;s?s.end=o:(s={start:a,end:o},r.push(s)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(0===n&&i!==Number.POSITIVE_INFINITY){const e=i-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach((t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}})),this.fragmentTracker.removeFragmentsInRange(n,e,$t)}}onFragBuffered(e,t){var n;this.loadedmetadata||t.frag.type!==Bt||null!=(n=this.media)&&n.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===$t&&(t.details===I.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Ei&&(this.state=ki))}onSubtitleTracksUpdated(e,t){let{subtitleTracks:n}=t;this.levels&&qr(this.levels,n)?this.levels=n.map((e=>new fn(e))):(this.tracksBuffered=[],this.levels=n.map((e=>{const t=new fn(e);return this.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,$t),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,null==(n=this.levels)||!n.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:s,id:a}=t;if(!r)return void this.warn(`Subtitle tracks were reset while loading level ${a}`);const o=r[a];if(a>=r.length||!o)return;this.log(`Subtitle track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||null!=(n=o.details)&&n.live){const e=this.mainDetails;if(s.deltaUpdateFailed||!e)return;const t=e.fragments[0];var u;if(o.details)l=this.alignPlaylists(s,o.details,null==(u=this.levelLastLoaded)?void 0:u.details),0===l&&t&&(l=t.start,bn(s,l));else s.hasProgramDateTime&&e.hasProgramDateTime?(fi(s,e),l=s.fragments[0].start):t&&(l=t.start,bn(s,l))}if(o.details=s,this.levelLastLoaded=o,a===i&&(this.startFragRequested||!this.mainDetails&&s.live||this.setStartPosition(this.mainDetails||s,l),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===ki)){In(null,s.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&"AES-128"===i.method){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch((e=>{throw r.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e})).then((n=>{const i=performance.now();r.trigger(A.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:i}})})).catch((e=>{this.warn(`${e.name}: ${e.message}`),this.state=ki}))}}doTick(){if(this.media){if(this.state===ki){const{currentTrackId:e,levels:t}=this,n=null==t?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:i}=this,r=this.getLoadPosition(),s=oi.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:o}=s,l=this.getFwdBufferInfo(this.media,Bt),u=n.details;if(o>this.getMaxBufferLength(null==l?void 0:l.len)+u.levelTargetDuration)return;const c=u.fragments,d=c.length,h=u.edge;let f=null;const p=this.fragPrevious;if(a<h){const e=i.maxFragLookUpTolerance,t=a>h-e?0:e;f=In(p,c,Math.max(c[0].start,a),t),!f&&p&&p.start<c[0].start&&(f=c[0])}else f=c[d-1];if(!f)return;if(f=this.mapToInitFragWhenRequired(f),"initSegment"!==f.sn){const e=c[f.sn-u.startSN-1];e&&e.cc===f.cc&&this.fragmentTracker.getState(e)===Zn&&(f=e)}this.fragmentTracker.getState(f)===Zn&&this.loadFragment(f,n,a)}}else this.state=ki}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new Kr(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends Bn{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const t=Xt(this.media.textTracks);for(let i=0;i<t.length;i++)if("hidden"===t[i].mode)e=t[i];else if("showing"===t[i].mode){e=t[i];break}const n=this.findTrackForTextTrack(e);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVEL_LOADING,this.onLevelLoading,this),e.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(A.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);Xt(this.media.textTracks).forEach((e=>{Kt(e)})),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Subtitle track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some((e=>-1===(null==i?void 0:i.indexOf(e))))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter((e=>!n||-1!==n.indexOf(e.groupId)));if(e.length)this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),e.forEach(((e,t)=>{e.id=t}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.subtitlePreference;if(!r&&t){this.selectDefaultTrack=!1;const n=Wn(t,e);if(n>-1)r=e[n];else{const e=Wn(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const s={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${null==n?void 0:n.join(",")}" group-id`),this.hls.trigger(A.SUBTITLE_TRACKS_UPDATED,s),-1!==i&&-1===this.trackId&&this.setSubtitleTrack(i)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if((!n||r.default)&&(n||e)&&(!e||Xn(r,e)))return i}if(e){for(let n=0;n<t.length;n++){const i=t[n];if(Gr(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const i=t[n];if(Gr(e.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){if(zr(t[n],e))return n}}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Ft||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Xn(e,n))return n;const i=Wn(e,this.tracksInGroup);if(i>-1){const e=this.tracksInGroup[i];return this.setSubtitleTrack(i),e}if(n)return null;{const n=Wn(e,t);if(n>-1)return t[n]}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const i=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}this.log(`Loading subtitle playlist for id ${i}`),this.hls.trigger(A.SUBTITLE_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Xt(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter((e=>zr(n,e)))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach((e=>{"disabled"!==e.mode&&e!==i&&(e.mode="disabled")})),i){const e=this.subtitleDisplay?"showing":"hidden";i.mode!==e&&(i.mode=e)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(e<-1||e>=t.length||!E(e))return void this.warn(`Invalid subtitle track id: ${e}`);this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i)return void this.hls.trigger(A.SUBTITLE_TRACK_SWITCH,{id:e});const r=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:s,groupId:a="",name:o,type:l,url:u}=i;this.hls.trigger(A.SUBTITLE_TRACK_SWITCH,{id:s,groupId:a,name:o,type:l,url:u});const c=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(c)}},timelineController:class{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(A.FRAG_LOADING,this.onFragLoading,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this),e.on(A.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(A.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(A.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(A.FRAG_LOADING,this.onFragLoading,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this),e.off(A.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(A.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(A.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new ms(this,"textTrack1"),t=new ms(this,"textTrack2"),n=new ms(this,"textTrack3"),i=new ms(this,"textTrack4");this.cea608Parser1=new fs(1,e,t),this.cea608Parser2=new fs(3,n,i)}}addCues(e,t,n,i,r){let s=!1;for(let c=r.length;c--;){const e=r[c],i=(a=e[0],o=e[1],l=t,u=n,Math.min(o,u)-Math.max(a,l));if(i>=0&&(e[0]=Math.min(e[0],t),e[1]=Math.max(e[1],n),s=!0,i/(n-t)>.5))return}var a,o,l,u;if(s||r.push([t,n]),this.config.renderTextTracksNatively){const r=this.captionsTracks[e];this.Cues.newCue(r,t,n,i)}else{const r=this.Cues.newCue(null,t,n,i);this.hls.trigger(A.CUES_PARSED,{type:"captions",cues:r,track:e})}}onInitPtsFound(e,t){let{frag:n,id:i,initPTS:r,timescale:s}=t;const{unparsedVttFrags:a}=this;"main"===i&&(this.initPTS[n.cc]={baseTime:r,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach((e=>{this.onFragLoaded(A.FRAG_LOADED,e)})))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(qs(r,{name:e,lang:t,attrs:{}}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:s}=t[e],a=this.getExistingTrack(r,s);if(a)n[e]=a,Kt(n[e]),Gt(n[e],i);else{const t=this.createTextTrack("captions",r,s);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(A.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach((t=>{Kt(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Kt(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some((e=>e.textCodec===Rs));if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(qr(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media,t=e?Xt(e.textTracks):null;if(this.tracks.forEach(((e,n)=>{let i;if(t){let n=null;for(let i=0;i<t.length;i++)if(t[i]&&qs(t[i],e)){n=t[i],t[i]=null;break}n&&(i=n)}if(i)Kt(i);else{const t=Hs(e);i=this.createTextTrack(t,e.name,e.lang),i&&(i.mode="disabled")}i&&this.textTracks.push(i)})),null!=t&&t.length){const e=t.filter((e=>null!==e)).map((e=>e.label));e.length&&P.warn(`Media element contains unused subtitle tracks: ${e.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const e=this.tracks.map((e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e})));this.hls.trigger(A.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n=`textTrack${t[1]}`,i=this.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)}))}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Bt){var n,i;const{cea608Parser1:e,cea608Parser2:r,lastSn:s}=this,{cc:a,sn:o}=t.frag,l=null!=(n=null==(i=t.part)?void 0:i.index)?n:-1;e&&r&&(o!==s+1||o===s&&l!==this.lastPartIndex+1||a!==this.lastCc)&&(e.reset(),r.reset()),this.lastCc=a,this.lastSn=o,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===$t)if(i.byteLength){const e=n.decryptdata,r="stats"in t;if(null==e||!e.encrypted||r){const e=this.tracks[n.level],r=this.vttCCs;r[n.cc]||(r[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===Rs?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Ns(t,this.initPTS[e.cc],(t=>{this._appendCues(t,e.level),n.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(t=>{P.log(`Failed to parse IMSC1: ${t}`),n.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:s}=this,a=r.length-1;if(!r[n.cc]&&-1===a)return void s.push(e);const o=this.hls;Ds(null!=(t=n.initSegment)&&t.data?Ye(n.initSegment.data,new Uint8Array(i)):i,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(e=>{this._appendCues(e,n.level),o.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(t=>{const r="Missing initPTS for VTT MPEGTS"===t.message;r?s.push(e):this._fallbackToIMSC1(n,i),P.log(`Failed to parse VTT cue: ${t}`),r&&a>n.cc||o.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Ns(t,this.initPTS[e.cc],(()=>{n.textCodec=Rs,this._parseIMSC1(e,t)}),(()=>{n.textCodec="wvtt"}))}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach((e=>zt(n,e)))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(A.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===$t&&this.onFragLoaded(A.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!n||!i)return;const{frag:r,samples:s}=t;if(r.type!==Bt||"NONE"!==this.closedCaptionsForLevel(r))for(let a=0;a<s.length;a++){const e=s[a].bytes;if(e){const t=this.extractCea608Data(e);n.addData(s[a].pts,t[0]),i.addData(s[a].pts,t[1])}}}onBufferFlushing(e,t){let{startOffset:n,endOffset:i,endOffsetSubtitles:r,type:s}=t;const{media:a}=this;if(a&&!(a.currentTime<i)){if(!s||"video"===s){const{captionsTracks:e}=this;Object.keys(e).forEach((t=>Wt(e[t],n,i)))}if(this.config.renderTextTracksNatively&&0===n&&void 0!==r){const{textTracks:e}=this;Object.keys(e).forEach((t=>Wt(e[t],n,r)))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let i=2;for(let r=0;r<n;r++){const n=e[i++],r=127&e[i++],s=127&e[i++];if(0===r&&0===s)continue;if(0!==(4&n)){const e=3&n;0!==e&&1!==e||(t[e].push(r),t[e].push(s))}}return t}},audioStreamController:class extends Ni{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",jt),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(A.ERROR,this.onError,this),e.on(A.BUFFER_RESET,this.onBufferReset,this),e.on(A.BUFFER_CREATED,this.onBufferCreated,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(A.ERROR,this.onError,this),e.off(A.BUFFER_RESET,this.onBufferReset,this),e.off(A.BUFFER_CREATED,this.onBufferCreated,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,t){let{frag:n,id:i,initPTS:r,timescale:s}=t;if("main"===i){const e=n.cc;this.initPTS[n.cc]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${e} found from main: ${r}`),this.videoTrackCC=e,this.state===Pi&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state=Ei);const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=ki):(this.loadedmetadata=!1,this.state=Ii),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case ki:this.doTickIdle();break;case Ii:{var e;const{levels:t,trackId:n}=this,i=null==t||null==(e=t[n])?void 0:e.details;if(i){if(this.waitForCdnTuneIn(i))break;this.state=Pi}break}case Ci:{var t;const e=performance.now(),n=this.retryDate;if(!n||e>=n||null!=(t=this.media)&&t.seeking){const{levels:e,trackId:t}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==e?void 0:e[t])||null),this.state=ki}break}case Pi:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:i,complete:r}=e;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=Ai;const e={frag:t,part:n,payload:i.flush(),networkDetails:null};this._handleFragmentLoadProgress(e),r&&super._handleFragmentLoadComplete(e)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const e=this.getLoadPosition(),n=oi.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole);Ln(n.end,this.config.maxFragLookUpTolerance,t)<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${n.end} is needed`),this.clearWaitingFragment())}}else this.state=ki}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=ki)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:i}=this,r=e.config;if(!this.buffering||!n&&(this.startFragRequested||!r.startFragPrefetch)||null==t||!t[i])return;const s=t[i],a=s.details;if(!a||a.live&&this.levelLastLoaded!==s||this.waitForCdnTuneIn(a))return void(this.state=Ii);const o=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&o&&(this.bufferFlushed=!1,this.afterBufferFlushed(o,$,jt));const l=this.getFwdBufferInfo(o,jt);if(null===l)return;if(!this.switchingTrack&&this._streamEnded(l,a))return e.trigger(A.BUFFER_EOS,{type:"audio"}),void(this.state=Ri);const u=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Bt),c=l.len,d=this.getMaxBufferLength(null==u?void 0:u.len),h=a.fragments,f=h[0].start,p=this.getLoadPosition(),g=this.flushing?p:l.end;if(this.switchingTrack&&n){const e=p;a.PTSKnown&&e<f&&(l.end>f||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=f+.05)}if(c>=d&&!this.switchingTrack&&g<h[h.length-1].start)return;let m=this.getNextFragment(g,a),y=!1;if(m&&this.isLoopLoading(m,g)&&(y=!!m.gap,m=this.getNextFragmentLoopLoading(m,a,l,Bt,d)),!m)return void(this.bufferFlushed=!0);const v=u&&m.start>u.end+a.targetduration;if(v||(null==u||!u.len)&&l.len){const e=this.getAppendedFrag(m.start,Bt);if(null===e)return;if(y||(y=!!e.gap||!!v&&0===u.len),v&&!y||y&&l.nextStart&&l.nextStart<e.end)return}this.loadFragment(m,s,g)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,t){let{audioTracks:n}=t;this.resetTransmuxer(),this.levels=n.map((e=>new fn(e)))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(100):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=ki,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=Ei),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(A.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:i}=this,{details:r,id:s}=t;if(!i)return void this.warn(`Audio tracks were reset while loading level ${s}`);this.log(`Audio track ${s} loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const a=i[s];let o=0;if(r.live||null!=(n=a.details)&&n.live){this.checkLiveUpdate(r);const e=this.mainDetails;if(r.deltaUpdateFailed||!e)return;var l;if(!a.details&&r.hasProgramDateTime&&e.hasProgramDateTime)fi(r,e),o=r.fragments[0].start;else o=this.alignPlaylists(r,a.details,null==(l=this.levelLastLoaded)?void 0:l.details)}a.details=r,this.levelLastLoaded=a,this.startFragRequested||!this.mainDetails&&r.live||this.setStartPosition(this.mainDetails||r,o),this.state!==Ii||this.waitForCdnTuneIn(r)||(this.state=ki),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{config:s,trackId:a,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const l=o[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const c=s.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new Hr(this.hls,jt,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const h=this.initPTS[n.cc],f=null==(t=n.initSegment)?void 0:t.data;if(void 0!==h){const e=!1,t=i?i.index:-1,s=-1!==t,a=new li(n.level,n.sn,n.stats.chunkCount,r.byteLength,t,s);d.push(r,f,c,"",n,i,u.totalduration,e,a,h)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${u.startSN} ,${u.endSN}],track ${a}`);const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new Ui,complete:!1};e.push(new Uint8Array(r)),this.waitingVideoCC=this.videoTrackCC,this.state=Pi}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type===jt)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==n.sn){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(A.AUDIO_TRACK_SWITCHED,T({},e)))}this.fragBufferedComplete(n,i)}else if(!this.loadedmetadata&&n.type===Bt){const e=this.videoBuffer||this.media;if(e){oi.getBuffered(e).length&&(this.loadedmetadata=!0)}}}onError(e,t){var n;if(t.fatal)this.state=Mi;else switch(t.details){case I.FRAG_GAP:case I.FRAG_PARSING_ERROR:case I.FRAG_DECRYPT_ERROR:case I.FRAG_LOAD_ERROR:case I.FRAG_LOAD_TIMEOUT:case I.KEY_LOAD_ERROR:case I.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(jt,t);break;case I.AUDIO_TRACK_LOAD_ERROR:case I.AUDIO_TRACK_LOAD_TIMEOUT:case I.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Ii||(null==(n=t.context)?void 0:n.type)!==Ut||(this.state=ki);break;case I.BUFFER_APPEND_ERROR:case I.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;if(t.details===I.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case I.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushing(e,t){let{type:n}=t;n!==V&&(this.flushing=!0)}onBufferFlushed(e,t){let{type:n}=t;if(n!==V){this.flushing=!1,this.bufferFlushed=!0,this.state===Ri&&(this.state=ki);const e=this.mediaBuffer||this.media;e&&(this.afterBufferFlushed(e,n,jt),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:u}=a,{details:c}=u,{audio:d,text:h,id3:f,initSegment:p}=r;if(!this.fragContextChanged(o)&&c){if(this.state=Li,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),null!=p&&p.tracks){const e=o.initSegment||o;this._bufferInitSegment(u,p.tracks,e,s),i.trigger(A.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:p.tracks})}if(d){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=d;l&&(l.elementaryStreams[$]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo($,e,t,n,i),this.bufferFragmentData(d,o,l,s)}if(null!=f&&null!=(t=f.samples)&&t.length){const e=w({id:n,frag:o,details:c},f);i.trigger(A.FRAG_PARSING_METADATA,e)}if(h){const e=w({id:n,frag:o,details:c},h);i.trigger(A.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(e,t,n,i){if(this.state!==Li)return;t.video&&delete t.video;const r=t.audio;if(!r)return;r.id="audio";const s=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${s}/${r.codec}]`),s&&1===s.split(",").length&&(r.levelCodec=s),this.hls.trigger(A.BUFFER_CODECS,t);const a=r.initSegment;if(null!=a&&a.byteLength){const e={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger(A.BUFFER_APPENDING,e)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);var r;if(this.fragCurrent=e,this.switchingTrack||i===Zn||i===ti)if("initSegment"===e.sn)this._loadInitSegment(e,t);else if(null!=(r=t.details)&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Pi;const n=this.mainDetails;n&&n.fragments[0].start!==t.details.fragments[0].start&&fi(t.details,n)}else this.startFragRequested=!0,super.loadFragment(e,t,n);else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a}=this.bufferedTrack;Xn({name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a},e,Yn)||(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(A.AUDIO_TRACK_SWITCHED,T({},e))}},audioTrackController:class extends Bn{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVEL_LOADING,this.onLevelLoading,this),e.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(A.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Audio track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Audio track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some((e=>-1===(null==i?void 0:i.indexOf(e))))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter((e=>!n||-1!==n.indexOf(e.groupId)));if(e.length)this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),e.forEach(((e,t)=>{e.id=t}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.audioPreference;if(!r&&t){const n=Wn(t,e,Yn);if(n>-1)r=e[n];else{const e=Wn(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const a={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group(s): ${null==n?void 0:n.join(",")}`),this.hls.trigger(A.AUDIO_TRACKS_UPDATED,a);const o=this.trackId;if(-1!==i&&-1===o)this.setAudioTrack(i);else if(e.length&&-1===o){var s;const t=new Error(`No audio track selected for current audio group-ID(s): ${null==(s=this.groupIds)?void 0:s.join(",")} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}else this.shouldReloadPlaylist(r)&&this.setAudioTrack(this.trackId)}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Ut||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||(this.requestScheduled=-1,this.checkRetry(t)))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&Xn(e,i,Yn))return i;const r=Wn(e,this.tracksInGroup,Yn);if(r>-1){const e=this.tracksInGroup[r];return this.setAudioTrack(r),e}if(i){let i=t.loadLevel;-1===i&&(i=t.firstAutoLevel);const r=function(e,t,n,i,r){const s=t[i],a=t.reduce(((e,t,n)=>{const i=t.uri;return(e[i]||(e[i]=[])).push(n),e}),{})[s.uri];a.length>1&&(i=Math.max.apply(Math,a));const o=s.videoRange,l=s.frameRate,u=s.codecSet.substring(0,4),c=Qn(t,i,(t=>{if(t.videoRange!==o||t.frameRate!==l||t.codecSet.substring(0,4)!==u)return!1;const i=t.audioGroups,s=n.filter((e=>!i||-1!==i.indexOf(e.groupId)));return Wn(e,s,r)>-1}));return c>-1?c:Qn(t,i,(t=>{const i=t.audioGroups,s=n.filter((e=>!i||-1!==i.indexOf(e.groupId)));return Wn(e,s,r)>-1}))}(e,t.levels,n,i,Yn);if(-1===r)return null;t.nextLoadLevel=r}if(e.channels||e.audioCodec){const t=Wn(e,n);if(t>-1)return n[t]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn(`Invalid audio track id: ${e}`);this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;if(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(A.AUDIO_TRACK_SWITCHING,T({},i)),r)return;const s=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(s)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||Xn(e,i,Yn)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o}=e;for(let e=0;e<t.length;e++){if(Xn({name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o},t[e],Yn))return e}for(let l=0;l<t.length;l++){const n=t[l];if(Gr(e.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return l}for(let l=0;l<t.length;l++){const n=t[l];if(Gr(e.attrs,n.attrs,["LANGUAGE"]))return l}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const i=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}this.log(`loading audio-track playlist ${i} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(A.AUDIO_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null})}}},emeController:Ks,cmcdController:class{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:Xs.MANIFEST,su:!this.initialized})}catch(t){P.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=e=>{try{const t=e.frag,n=this.hls.levels[t.level],i=this.getObjectType(t),r={d:1e3*t.duration,ot:i};i!==Xs.VIDEO&&i!==Xs.AUDIO&&i!=Xs.MUXED||(r.br=n.bitrate/1e3,r.tb=this.getTopBandwidth(i)/1e3,r.bl=this.getBufferLength(i)),this.apply(e,r)}catch(t){P.warn("Could not generate segment CMCD data.",t)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||function(){try{return crypto.randomUUID()}catch(e){try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)}))}}}(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHED,this.onMediaDetached,this),e.on(A.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHED,this.onMediaDetached,this),e.off(A.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer}createData(){var e;return{v:1,sf:Qs.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(t,this.createData());const n=t.ot===Xs.INIT||t.ot===Xs.VIDEO||t.ot===Xs.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce(((e,n)=>(i.includes(n)&&(e[n]=t[n]),e)),{})),this.useHeaders?(e.headers||(e.headers={}),wa(e.headers,t)):e.url=ka(e.url,t)}getObjectType(e){const{type:t}=e;return"subtitle"===t?Xs.TIMED_TEXT:"initSegment"===e.sn?Xs.INIT:"audio"===t?Xs.AUDIO:"main"===t?this.hls.audioTracks.length?Xs.VIDEO:Xs.MUXED:void 0}getTopBandwidth(e){let t,n=0;const i=this.hls;if(e===Xs.AUDIO)t=i.audioTracks;else{const e=i.maxAutoLevel,n=e>-1?e+1:i.levels.length;t=i.levels.slice(0,n)}for(const r of t)r.bitrate>n&&(n=r.bitrate);return n>0?n:NaN}getBufferLength(e){const t=this.hls.media,n=e===Xs.AUDIO?this.audioBuffer:this.videoBuffer;if(!n||!t)return NaN;return 1e3*oi.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}},contentSteeringController:class{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=P.log.bind(P,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter((t=>t!==e)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((null==n?void 0:n.action)===Mn&&n.flags===Un){const e=this.levels;let i=this.pathwayPriority,r=this.pathwayId;if(t.context){const{groupId:n,pathwayId:i,type:s}=t.context;n&&e?r=this.getPathwayForGroupId(n,s,r):i&&(r=i)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!i&&e&&(i=e.reduce(((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e)),[])),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==r),n.resolved||P.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${r} levels: ${e?e.length:e} priorities: ${JSON.stringify(i)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter((t=>e===t.pathwayId))}updatePathwayPriority(e){let t;this.pathwayPriority=e;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach((e=>{i-n[e]>3e5&&delete n[e]}));for(let r=0;r<e.length;r++){const i=e[r];if(i in n)continue;if(i===this.pathwayId)return;const s=this.hls.nextLoadLevel,a=this.hls.levels[s];if(t=this.getLevelsForPathway(i),t.length>0){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,_n(t),this.hls.trigger(A.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[s];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=s);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<i.length;r++)if(t===Ut&&i[r].hasAudioGroup(e)||t===Ft&&i[r].hasSubtitleGroup(e))return i[r].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach((e=>{const{ID:r,"BASE-ID":s,"URI-REPLACEMENT":a}=e;if(t.some((e=>e.pathwayId===r)))return;const o=this.getLevelsForPathway(s).map((e=>{const t=new U(e.attrs);t["PATHWAY-ID"]=r;const s=t.AUDIO&&`${t.AUDIO}_clone_${r}`,o=t.SUBTITLES&&`${t.SUBTITLES}_clone_${r}`;s&&(n[t.AUDIO]=s,t.AUDIO=s),o&&(i[t.SUBTITLES]=o,t.SUBTITLES=o);const l=Aa(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),u=new fn({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(let n=1;n<e.audioGroups.length;n++)u.addGroupId("audio",`${e.audioGroups[n]}_clone_${r}`);if(e.subtitleGroups)for(let n=1;n<e.subtitleGroups.length;n++)u.addGroupId("text",`${e.subtitleGroups[n]}_clone_${r}`);return u}));t.push(...o),xa(this.audioTracks,n,a,r),xa(this.subtitleTracks,i,a,r)}))}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let i;this.loader&&this.loader.destroy(),this.loader=new n(t);try{i=new self.URL(e)}catch(u){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==i.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+e)}const r={responseType:"json",url:i.href},s=t.steeringManifestLoadPolicy.default,a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,n,r)=>{this.log(`Loaded steering manifest: "${i}"`);const s=e.data;if(1!==s.VERSION)return void this.log(`Steering VERSION ${s.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=s;if(a)try{this.uri=new self.URL(a,i).href}catch(u){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||n.url),o&&this.clonePathways(o);const c={steeringManifest:s,url:i.toString()};this.hls.trigger(A.STEERING_MANIFEST_LOADED,c),l&&this.updatePathwayPriority(l)},onError:(e,t,n,i)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let r=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,r);else{const e=this.loader;if("function"===typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(r=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,o,l)}scheduleRefresh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3*this.timeToLoad;this.clearTimeout(),this.reloadTimer=self.setTimeout((()=>{var t;const n=null==(t=this.hls)?void 0:t.media;!n||n.ended?this.scheduleRefresh(e,1e3*this.timeToLoad):this.loadSteeringManifest(e)}),t)}}});function Ua(e){return e&&"object"===typeof e?Array.isArray(e)?e.map(Ua):Object.keys(e).reduce(((t,n)=>(t[n]=Ua(e[n]),t)),{}):e}function Fa(e){const t=e.loader;if(t!==Da&&t!==Ia)P.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1})()&&(e.loader=Da,e.progressive=!0,e.enableSoftwareAES=!0,P.log("[config]: Progressive streaming enabled, using FetchLoader"))}}let Ba;class ja extends Bn{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this),e.on(A.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this),e.off(A.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach((e=>{e.loadError=0,e.fragmentError=0})),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},s={};let a=!1,o=!1,l=!1;t.levels.forEach((e=>{var t,u;const c=e.attrs;let{audioCodec:d,videoCodec:h}=e;-1!==(null==(t=d)?void 0:t.indexOf("mp4a.40.34"))&&(Ba||(Ba=/chrome|firefox/i.test(navigator.userAgent)),Ba&&(e.audioCodec=d=void 0)),d&&(e.audioCodec=d=Tt(d,n)),0===(null==(u=h)?void 0:u.indexOf("avc1"))&&(h=e.videoCodec=function(e){const t=e.split(",");for(let n=0;n<t.length;n++){const e=t[n].split(".");if(e.length>2){let i=e.shift()+".";i+=parseInt(e.shift()).toString(16),i+=("000"+parseInt(e.shift()).toString(16)).slice(-4),t[n]=i}}return t.join(",")}(h));const{width:f,height:p,unknownCodecs:g}=e;if(a||(a=!(!f||!p)),o||(o=!!h),l||(l=!!d),null!=g&&g.length||d&&!ft(d,"audio",n)||h&&!ft(h,"video",n))return;const{CODECS:m,"FRAME-RATE":y,"HDCP-LEVEL":v,"PATHWAY-ID":b,RESOLUTION:T,"VIDEO-RANGE":S}=c,_=`${`${b||"."}-`}${e.bitrate}-${T}-${y}-${m}-${S}-${v}`;if(r[_])if(r[_].uri===e.url||e.attrs["PATHWAY-ID"])r[_].addGroupId("audio",c.AUDIO),r[_].addGroupId("text",c.SUBTITLES);else{const t=s[_]+=1;e.attrs["PATHWAY-ID"]=new Array(t+1).join(".");const n=new fn(e);r[_]=n,i.push(n)}else{const t=new fn(e);r[_]=t,s[_]=1,i.push(t)}})),this.filterAndSortMediaOptions(i,t,a,o,l)}filterAndSortMediaOptions(e,t,n,i,r){let s=[],a=[],o=e;if((n||i)&&r&&(o=o.filter((e=>{let{videoCodec:t,videoRange:n,width:i,height:r}=e;return(!!t||!(!i||!r))&&(!!(s=n)&&on.indexOf(s)>-1);var s}))),0===o.length)return void Promise.resolve().then((()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const e=new Error("no level with compatible codecs found in manifest");this.hls.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}}));if(t.audioTracks){const{preferManagedMediaSource:e}=this.hls.config;s=t.audioTracks.filter((t=>!t.audioCodec||ft(t.audioCodec,"audio",e))),$a(s)}t.subtitles&&(a=t.subtitles,$a(a));const l=o.slice(0);o.sort(((e,t)=>{if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return on.indexOf(e.videoRange)-on.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){const n=mt(e.videoCodec),i=mt(t.videoCodec);if(n!==i)return i-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){const n=yt(e.codecSet),i=yt(t.codecSet);if(n!==i)return i-n}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0}));let u=l[0];if(this.steering&&(o=this.steering.filterParsedLevels(o),o.length!==l.length))for(let f=0;f<l.length;f++)if(l[f].pathwayId===o[0].pathwayId){u=l[f];break}this._levels=o;for(let f=0;f<o.length;f++)if(o[f]===u){var c;this._firstLevel=f;const e=u.bitrate,t=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${o.length} level(s) found, first bitrate: ${e}`),void 0===(null==(c=this.hls.userConfig)?void 0:c.abrEwmaDefaultEstimate)){const n=Math.min(e,this.hls.config.abrEwmaDefaultEstimateMax);n>t&&t===Na.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=n)}break}const d=r&&!i,h={levels:o,audioTracks:s,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:!d&&s.some((e=>!!e.url))};this.hls.trigger(A.MANIFEST_PARSED,h),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(A.ERROR,{type:C.OTHER_ERROR,details:I.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:n,reason:n.message}),i)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,s=t[e],a=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,n===e&&s.details&&i&&r===a)return;this.log(`Switching to level ${e} (${s.height?s.height+"p ":""}${s.videoRange?s.videoRange+" ":""}${s.codecSet?s.codecSet+" ":""}@${s.bitrate})${a?" with Pathway "+a:""} from level ${n}${r?" with Pathway "+r:""}`);const o={level:e,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(A.LEVEL_SWITCHING,o);const l=s.details;if(!l||l.live){const e=this.switchParams(s.uri,null==i?void 0:i.details,l);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){!t.fatal&&t.context&&t.context.type===Nt&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,t){let{frag:n}=t;if(void 0!==n&&n.type===Bt){const e=n.elementaryStreams;if(!Object.keys(e).some((t=>!!e[t])))return;const t=this._levels[n.level];null!=t&&t.loadError&&(this.log(`Resetting level error count of ${t.loadError} on frag buffered`),t.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,s=this._levels[i];var a;if(!s)return this.warn(`Invalid level index ${i}`),void(null!=(a=t.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));i===this.currentLevelIndex?(0===s.fragmentError&&(s.loadError=0),this.playlistLoaded(i,t,s.details)):null!=(n=t.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let r=n.uri;if(e)try{r=e.addDirectives(r)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}const s=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} ${r}`),this.clearTimer(),this.hls.trigger(A.LEVEL_LOADING,{url:r,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter(((t,n)=>n!==e||(this.steering&&this.steering.removeLevel(t),t===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,t.details&&t.details.fragments.forEach((e=>e.level=-1))),!1)));_n(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(A.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,t){let{levels:n}=t;this._levels=n}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(A.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function $a(e){const t={};e.forEach((e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++}))}class Va{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==(null==(t=i.context)?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.KEY_LOAD_ERROR,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return new vi({type:C.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let e=0;e<t.length;e++){const r=t[e];if(i<=r.cc&&("initSegment"===n||"initSegment"===r.sn||n<r.sn)){this.emeController.selectKeySystemFormat(r).then((e=>{r.setKeyFormat(e)}));break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then((t=>this.loadInternal(e,t))):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const n=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,I.KEY_LOAD_ERROR,n))}const s=r.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,I.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${s}"`)));let a=this.keyUriToKeyInfo[s];if(null!=(n=a)&&n.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});var o;if(null!=(i=a)&&i.keyLoadPromise)switch(null==(o=a.mediaKeySessionContext)?void 0:o.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then((t=>(r.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:a})))}switch(a=this.keyUriToKeyInfo[s]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,I.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(n);if(t)return(e.keyLoadPromise=t.then((t=>(e.mediaKeySessionContext=t,n)))).catch((t=>{throw e.keyLoadPromise=null,t}))}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=new(0,n.loader)(n);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise(((r,s)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},o=n.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(e,t,n,i)=>{const{frag:a,keyInfo:o,url:l}=n;if(!a.decryptdata||o!==this.keyUriToKeyInfo[l])return s(this.createKeyLoadError(a,I.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));o.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,o.loader=null,r({frag:a,keyInfo:o})},onError:(e,n,i,r)=>{this.resetLoader(n),s(this.createKeyLoadError(t,I.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),i,T({url:a.url,data:void 0},e)))},onTimeout:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,I.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,I.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};i.load(a,l,u)}))}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],r&&r.destroy()}}function Ha(){return self.SourceBuffer||self.WebKitSourceBuffer}function qa(){if(!dt())return!1;const e=Ha();return!e||e.prototype&&"function"===typeof e.prototype.appendBuffer&&"function"===typeof e.prototype.remove}class Ga{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:i,stalled:r}=this;if(null===i)return;const{currentTime:s,seeking:a}=i,o=this.seeking&&!a,l=!this.seeking&&a;if(this.seeking=a,s!==e){if(this.moved=!0,a||(this.nudgeRetry=0),null!==r){if(this.stallReported){const e=self.performance.now()-r;P.warn(`playback not stuck anymore @${s}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null}return}if(l||o)return void(this.stalled=null);if(i.paused&&!a||i.ended||0===i.playbackRate||!oi.getBuffered(i).length)return void(this.nudgeRetry=0);const u=oi.bufferInfo(i,s,0),c=u.nextStart||0;if(a){const e=u.len>2,n=!c||t&&t.start<=s||c-s>2&&!this.fragmentTracker.getPartialFragment(s);if(e||n)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var d;if(!(u.len>0)&&!c)return;const e=Math.max(c,u.start||0)-s,t=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,n=(null==t||null==(d=t.details)?void 0:d.live)?2*t.details.targetduration:2,r=this.fragmentTracker.getPartialFragment(s);if(e>0&&(e<=n||r))return void(i.paused||this._trySkipBufferHole(r))}const h=self.performance.now();if(null===r)return void(this.stalled=h);const f=h-r;if(!a&&f>=250&&(this._reportStall(u),!this.media))return;const p=oi.bufferInfo(i,s,n.maxBufferHole);this._tryFixBufferStall(p,f)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:i,media:r}=this;if(null===r)return;const s=r.currentTime,a=i.getPartialFragment(s);if(a){if(this._trySkipBufferHole(a)||!this.media)return}(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-s<n.maxBufferHole)&&t>1e3*n.highBufferWatchdogPeriod&&(P.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const i=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);P.warn(i.message),t.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:i}=this;if(null===i)return 0;const r=i.currentTime,s=oi.bufferInfo(i,r,0),a=r<s.start?s.start:s.nextStart;if(a){const o=s.len<=t.maxBufferHole,l=s.len>0&&s.len<1&&i.readyState<3,u=a-r;if(u>0&&(o||l)){if(u>t.maxBufferHole){const{fragmentTracker:t}=this;let n=!1;if(0===r){const e=t.getAppendedFrag(0,Bt);e&&a<e.end&&(n=!0)}if(!n){const n=e||t.getAppendedFrag(r,Bt);if(n){let e=!1,i=n.end;for(;i<a;){const n=t.getPartialFragment(i);if(!n){e=!0;break}i+=n.duration}if(e)return 0}}}const s=Math.max(a+.05,r+.1);if(P.warn(`skipping hole, adjusting currentTime from ${r} to ${s}`),this.moved=!0,this.stalled=null,i.currentTime=s,e&&!e.gap){const t=new Error(`fragment loaded with buffer holes, seeking from ${r} to ${s}`);n.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return s}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:i}=this;if(null===n)return;const r=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const s=r+(i+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${r} to ${s}`);P.warn(a.message),n.currentTime=s,t.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const n=new Error(`Playhead still not moving while enough data buffered @${r} after ${e.nudgeMaxRetry} nudges`);P.error(n.message),t.trigger(A.ERROR,{type:C.MEDIA_ERROR,details:I.BUFFER_STALLED_ERROR,error:n,fatal:!0})}}}class za extends Ni{constructor(e,t,n){super(e,t,n,"[stream-controller]",Bt),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(A.ERROR,this.onError,this),e.on(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(A.BUFFER_CREATED,this.onBufferCreated,this),e.on(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(A.ERROR,this.onError,this),e.off(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(A.BUFFER_CREATED,this.onBufferCreated,this),e.off(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=n.startLevel;-1===e&&(n.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=n.firstAutoLevel),n.nextLoadLevel=e,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=ki,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Ei}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Oi:{const{levels:e,level:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n)){if(this.waitForCdnTuneIn(i))break;this.state=ki;break}if(this.hls.nextLoadLevel!==this.level){this.state=ki;break}break}case Ci:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||null!=(e=this.media)&&e.seeking){const{levels:e,level:t}=this,n=null==e?void 0:e[t];this.resetStartWhenNotLoaded(n||null),this.state=ki}}}this.state===ki&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(null===t||!i&&(this.startFragRequested||!e.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(null==n||!n[r])return;const s=n[r],a=this.getMainFwdBufferInfo();if(null===a)return;const o=this.getLevelDetails();if(o&&this._streamEnded(a,o)){const e={};return this.altAudio&&(e.type="video"),this.hls.trigger(A.BUFFER_EOS,e),void(this.state=Ri)}if(!this.buffering)return;e.loadLevel!==r&&-1===e.manualLevel&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const l=s.details;if(!l||this.state===Oi||l.live&&this.levelLastLoaded!==s)return this.level=r,void(this.state=Oi);const u=a.len,c=this.getMaxBufferLength(s.maxBitrate);if(u>=c)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const d=this.backtrackFragment?this.backtrackFragment.start:a.end;let h=this.getNextFragment(d,l);if(this.couldBacktrack&&!this.fragPrevious&&h&&"initSegment"!==h.sn&&this.fragmentTracker.getState(h)!==ni){var f;const e=(null!=(f=this.backtrackFragment)?f:h).sn-l.startSN,t=l.fragments[e-1];t&&h.cc===t.cc&&(h=t,this.fragmentTracker.removeFragment(t))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(h&&this.isLoopLoading(h,d)){if(!h.gap){const e=this.audioOnly&&!this.altAudio?$:V,t=(e===V?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,Bt)}h=this.getNextFragmentLoopLoading(h,l,a,Bt,c)}h&&(!h.initSegment||h.initSegment.data||this.bitrateTest||(h=h.initSegment),this.loadFragment(h,s,d))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===Zn||i===ti?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Bt)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*r.targetduration)return}if(!t.paused&&e){const t=e[this.hls.nextLoadLevel],i=this.fragLastKbps;n=i&&this.fragCurrent?this.fragCurrent.duration*t.maxBitrate/(1e3*i)+1:0}else n=0;const s=this.getBufferedFrag(t.currentTime+n);if(s){const e=this.followingBufferedFrag(s);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,i=Math.max(s.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*(this.couldBacktrack?.5:.125)),n*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(i,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case xi:case Ai:case Ci:case Li:case Di:this.state=ki}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new Ga(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;E(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(A.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach((e=>{const t=e.audioCodec;t&&(n=n||-1!==t.indexOf("mp4a.40.2"),i=i||-1!==t.indexOf("mp4a.40.5"))})),this.audioCodecSwitch=n&&i&&!function(){var e;const t=Ha();return"function"===typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==ki)return;const i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(i.details))&&(this.state=Oi)}onLevelLoaded(e,t){var n;const{levels:i}=this,r=t.level,s=t.details,a=s.totalduration;if(!i)return void this.warn(`Levels were reset while loading level ${r}`);this.log(`Level ${r} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""}, cc [${s.startCC}, ${s.endCC}] duration:${a}`);const o=i[r],l=this.fragCurrent;!l||this.state!==Ai&&this.state!==Ci||l.level!==t.level&&l.loader&&this.abortCurrentFrag();let u=0;if(s.live||null!=(n=o.details)&&n.live){var c;if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;u=this.alignPlaylists(s,o.details,null==(c=this.levelLastLoaded)?void 0:c.details)}if(o.details=s,this.levelLastLoaded=o,this.hls.trigger(A.LEVEL_UPDATED,{details:s,level:r}),this.state===Oi){if(this.waitForCdnTuneIn(s))return;this.state=ki}this.startFragRequested?s.live&&this.synchronizeToLiveEdge(s):this.setStartPosition(s,u),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{levels:s}=this;if(!s)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const a=s[n.level],o=a.details;if(!o)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const l=a.videoCodec,u=o.PTSKnown||!o.live,c=null==(t=n.initSegment)?void 0:t.data,d=this._getAudioCodec(a),h=this.transmuxer=this.transmuxer||new Hr(this.hls,Bt,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=i?i.index:-1,p=-1!==f,g=new li(n.level,n.sn,n.stats.chunkCount,r.byteLength,f,p),m=this.initPTS[n.cc];h.push(r,c,d,l,n,i,o.totalduration,u,g,m)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const e=this.hls;n&&(e.trigger(A.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(A.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,i=!!this.hls.audioTracks[n].url;if(i){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,s=!1;for(const a in n){const e=n[a];if("main"===e.id){if(r=a,i=e,"video"===a){const e=n[a];e&&(this.videoBuffer=e.buffer)}}else s=!0}s&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n&&n.type!==Bt)return;if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Di&&(this.state=ki));const r=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal)this.state=Mi;else switch(t.details){case I.FRAG_GAP:case I.FRAG_PARSING_ERROR:case I.FRAG_DECRYPT_ERROR:case I.FRAG_LOAD_ERROR:case I.FRAG_LOAD_TIMEOUT:case I.KEY_LOAD_ERROR:case I.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Bt,t);break;case I.LEVEL_LOAD_ERROR:case I.LEVEL_LOAD_TIMEOUT:case I.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Oi||(null==(n=t.context)?void 0:n.type)!==Nt||(this.state=ki);break;case I.BUFFER_APPEND_ERROR:case I.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;if(t.details===I.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case I.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}checkBuffer(){const{media:e,gapController:t}=this;if(e&&t&&e.readyState){if(this.loadedmetadata||!oi.getBuffered(e).length){const e=this.state!==ki?this.fragCurrent:null;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=ki,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,t){let{type:n}=t;if(n!==$||this.audioOnly&&!this.altAudio){const e=(n===V?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,n,Bt),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const i=oi.getBuffered(e),r=(i.length?i.start(0):0)-n;r>0&&(r<this.config.maxBufferHole||r<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${r} to match buffer start`),n+=r,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then((n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=ki,this.startFragRequested=!1,this.bitrateTest=!1;const r=e.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),i.trigger(A.FRAG_LOADED,n),e.bitrateTest=!1}))}_handleTransmuxComplete(e){var t;const n="main",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:u}=a,{video:c,text:d,id3:h,initSegment:f}=r,{details:p}=u,g=this.altAudio?void 0:r.audio;if(this.fragContextChanged(o))this.fragmentTracker.removeFragment(o);else{if(this.state=Li,f){if(null!=f&&f.tracks){const e=o.initSegment||o;this._bufferInitSegment(u,f.tracks,e,s),i.trigger(A.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:f.tracks})}const e=f.initPTS,t=f.timescale;E(e)&&(this.initPTS[o.cc]={baseTime:e,timescale:t},i.trigger(A.INIT_PTS_FOUND,{frag:o,id:n,initPTS:e,timescale:t}))}if(c&&p&&"initSegment"!==o.sn){const e=p.fragments[o.sn-1-p.startSN],t=o.sn===p.startSN,n=!e||o.cc>e.cc;if(!1!==r.independent){const{startPTS:e,endPTS:i,startDTS:r,endDTS:a}=c;if(l)l.elementaryStreams[c.type]={startPTS:e,endPTS:i,startDTS:r,endDTS:a};else if(c.firstKeyFrame&&c.independent&&1===s.id&&!n&&(this.couldBacktrack=!0),c.dropped&&c.independent){const r=this.getMainFwdBufferInfo(),s=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,l=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(!t&&s<l-this.config.maxBufferHole&&!n)return void this.backtrack(o);n&&(o.gap=!0),o.setElementaryStreamInfo(c.type,o.start,i,o.start,a,!0)}else t&&e>2&&(o.gap=!0);o.setElementaryStreamInfo(c.type,e,i,r,a),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(c,o,l,s,t||n)}else{if(!t&&!n)return void this.backtrack(o);o.gap=!0}}if(g){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=g;l&&(l.elementaryStreams[$]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo($,e,t,n,i),this.bufferFragmentData(g,o,l,s)}if(p&&null!=h&&null!=(t=h.samples)&&t.length){const e={id:n,frag:o,details:p,samples:h.samples};i.trigger(A.FRAG_PARSING_METADATA,e)}if(p&&d){const e={id:n,frag:o,details:p,samples:d.samples};i.trigger(A.FRAG_PARSING_USERDATA,e)}}}_bufferInitSegment(e,t,n,i){if(this.state!==Li)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:r,video:s,audiovideo:a}=t;if(r){let t=e.audioCodec;const n=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const e=r.metadata;e&&"channelCount"in e&&1!==(e.channelCount||1)&&-1===n.indexOf("firefox")&&(t="mp4a.40.5")}t&&-1!==t.indexOf("mp4a.40.5")&&-1!==n.indexOf("android")&&"audio/mpeg"!==r.container&&(t="mp4a.40.2",this.log(`Android: force audio codec to ${t}`)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),r.levelCodec=t,r.id="main",this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${r.codec}]`)}s&&(s.levelCodec=e.videoCodec,s.id="main",this.log(`Init video buffer, container:${s.container}, codecs[level/parsed]=[${e.videoCodec||""}/${s.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),this.hls.trigger(A.BUFFER_CODECS,t),Object.keys(t).forEach((e=>{const r=t[e].initSegment;null!=r&&r.byteLength&&this.hls.trigger(A.BUFFER_APPENDING,{type:e,data:r,frag:n,part:null,chunkMeta:i,parent:n.type})})),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Bt)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ki}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(oi.isBuffered(e,n)?t=this.getAppendedFrag(n):oi.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n||(this.fragPlaying=t,this.hls.trigger(A.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger(A.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&E(t)&&E(n.programDateTime)){const e=n.programDateTime+1e3*(t-n.start);return new Date(e)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Ka{static get version(){return"1.5.20"}static isMSESupported(){return qa()}static isSupported(){return function(){if(!qa())return!1;const e=dt();return"function"===typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((t=>e.isTypeSupported(gt(t,"video"))))||["mp4a.40.2","fLaC"].some((t=>e.isTypeSupported(gt(t,"audio")))))}()}static getMediaSource(){return dt()}static get Events(){return A}static get ErrorTypes(){return C}static get ErrorDetails(){return I}static get DefaultConfig(){return Ka.defaultConfig?Ka.defaultConfig:Na}static set DefaultConfig(e){Ka.defaultConfig=e}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Vr,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,function(e,t){if("object"===typeof console&&!0===e||"object"===typeof e){M(e,"debug","log","info","warn","error");try{R.log(`Debug logs enabled for "${t}" in hls.js version 1.5.20`)}catch(n){R=D}}else R=D}(e.debug||!1,"Hls instance");const t=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Ua(e),i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((e=>{const r=`${"level"===e?"playlist":e}LoadPolicy`,s=void 0===t[r],a=[];i.forEach((i=>{const o=`${e}Loading${i}`,l=t[o];if(void 0!==l&&s){a.push(o);const e=n[r].default;switch(t[r]={default:e},i){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l}}})),a.length&&P.warn(`hls.js config: "${a.join('", "')}" setting(s) are deprecated, use "${r}": ${JSON.stringify(t[r])}`)})),T(T({},n),t)}(Ka.DefaultConfig,e);this.userConfig=e,t.progressive&&Fa(t);const{abrController:n,bufferController:i,capLevelController:r,errorController:s,fpsController:a}=t,o=new s(this),l=this.abrController=new n(this),u=this.bufferController=new i(this),c=this.capLevelController=new r(this),d=new a(this),h=new qt(this),f=new rn(this),p=t.contentSteeringController,g=p?new p(this):null,m=this.levelController=new ja(this,g),y=new ii(this),v=new Va(this.config),b=this.streamController=new za(this,y,v);c.setStreamController(b),d.setStreamController(b);const S=[h,m,b];g&&S.splice(1,0,g),this.networkControllers=S;const _=[l,u,c,d,f,y];this.audioTrackController=this.createController(t.audioTrackController,S);const w=t.audioStreamController;w&&S.push(new w(this,y,v)),this.subtitleTrackController=this.createController(t.subtitleTrackController,S);const E=t.subtitleStreamController;E&&S.push(new E(this,y,v)),this.createController(t.timelineController,_),v.emeController=this.emeController=this.createController(t.emeController,_),this.cmcdController=this.createController(t.cmcdController,_),this.latencyController=this.createController(sn,_),this.coreComponents=_,S.push(o);const k=o.onErrorOut;"function"===typeof k&&this.on(A.ERROR,k,o)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.on(e,t,n)}once(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=arguments.length>3?arguments[3]:void 0;this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(P.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const t=e===A.ERROR;this.trigger(A.ERROR,{type:C.OTHER_ERROR,details:I.INTERNAL_EXCEPTION,fatal:t,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){P.log("destroy"),this.trigger(A.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((e=>e.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((e=>e.destroy())),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){P.log("attachMedia"),this._media=e,this.trigger(A.MEDIA_ATTACHING,{media:e})}detachMedia(){P.log("detachMedia"),this.trigger(A.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,i=this.url=v.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,P.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(A.MANIFEST_LOADING,{url:e})}startLoad(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;P.log(`startLoad(${e})`),this.started=!0,this.resumeBuffering();for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].startLoad(e),this.started&&this.networkControllers);t++);}stopLoad(){P.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);}resumeBuffering(){P.log("resume buffering"),this.networkControllers.forEach((e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){P.log("pause buffering"),this.networkControllers.forEach((e=>{e.pauseBuffering&&e.pauseBuffering()}))}swapAudioCodec(){P.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){P.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){P.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){P.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){P.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){P.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){P.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(P.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){(function(e){return an.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(i=-1===t&&null!=e&&e.length?e.length-1:t,n)for(let r=i;r--;){const t=e[r].attrs["HDCP-LEVEL"];if(t&&t<=n)return r}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return null==(t=this.audioTrackController)?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return null==(t=this.subtitleTrackController)||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Ka.defaultConfig=void 0;class Wa{constructor(){this.hls=null,this.video=null,this.eventListeners={}}initialize(e,t){e.innerHTML="";const n=document.createElement("video");n.controls=!0,e.appendChild(n),this.video=n,Ka.isSupported()&&(this.hls=new Ka(t),this.hls.attachMedia(n),this.hls.on(Ka.Events.MEDIA_ATTACHED,(()=>this.emitEvent("playing"))),this.hls.on(Ka.Events.BUFFER_APPENDING,(()=>this.emitEvent("buffering"))),this.hls.on(Ka.Events.ERROR,((e,t)=>this.emitEvent("error",t))),this.hls.on(Ka.Events.LEVEL_SWITCHED,((e,t)=>this.emitEvent("renditionchange",t))))}load(e){this.hls&&this.video?(this.hls.loadSource(e),this.emitEvent("playing")):this.video&&(this.video.src=e,this.video.load(),this.emitEvent("playing"))}getAvailableRenditions(){return this.hls?this.hls.levels.map((e=>({resolution:`${e.width}x${e.height}`,bitrate:Math.round(e.bitrate/1e3)}))).sort(((e,t)=>e.bitrate-t.bitrate)):[]}setRendition(e){if(!this.hls)return;const t=this.hls.levels.findIndex((t=>`${t.width}x${t.height}`===e));-1!==t&&(this.hls.nextLevel=t,console.log(`Switched to ${e}`))}setAdaptiveBitrate(e){this.hls&&(this.hls.nextLevel=e?-1:this.hls.currentLevel,console.log("ABR "+(e?"enabled":"disabled")))}play(){var e;null===(e=this.video)||void 0===e||e.play(),this.emitEvent("playing")}pause(){var e;null===(e=this.video)||void 0===e||e.pause()}destroy(){var e;null===(e=this.hls)||void 0===e||e.destroy(),this.hls=null,this.video=null}getBitrate(){var e,t,n;return Math.round(((null===(e=this.hls)||void 0===e||null===(t=e.levels)||void 0===t||null===(n=t[this.hls.currentLevel])||void 0===n?void 0:n.bitrate)||0)/1e3)}getResolution(){return this.video?`${this.video.videoWidth}x${this.video.videoHeight}`:"N/A"}on(e,t){this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(t)}off(e,t){this.eventListeners[e]&&(this.eventListeners[e]=this.eventListeners[e].filter((e=>e!==t)))}emitEvent(e,t){this.eventListeners[e]&&this.eventListeners[e].forEach((e=>e(t)))}}const Xa={debug:0,info:1,warn:2,error:3,none:4},Ya={debug:"log",info:"info",warn:"warn",error:"error"},Qa=new class{constructor(){this.currentLevel="info"}setLevel(e){this.currentLevel=e}shouldLog(e){return Xa[e]>=0&&Xa[e]>=Xa[this.currentLevel]}log(e){if(!this.shouldLog(e))return;const t=`[${(new Date).toISOString()}] [${e.toUpperCase()}]`;for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];console[Ya[e]](t,...i)}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("debug",...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("info",...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("warn",...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("error",...t)}};class Ja{async parse(e){const{videoTracks:t,audioTracks:n}=await this.parseAdaptationSets(e);return[...t,...n]}async parseVideo(e){const{videoTracks:t}=await this.parseAdaptationSets(e);return t}async parseAudio(e){const{audioTracks:t}=await this.parseAdaptationSets(e);return t}async parseAdaptationSets(e){var t,n,i,r;Qa.info("[MPDParser] Fetching manifest:",e);const s=await fetch(e);if(!s.ok)throw new Error(`[MPDParser] Failed to fetch MPD: ${s.status}`);const a=await s.text(),o=(new DOMParser).parseFromString(a,"application/xml"),l=new URL(".",e).href,u=Array.from(o.querySelectorAll("AdaptationSet")),c=[],d=[];for(const h of u){const e=Array.from(h.querySelectorAll("Representation"));for(const s of e){const e=(null==s?void 0:s.getAttribute("mimeType"))||h.getAttribute("mimeType")||(null===(t=h.querySelector("ContentComponent"))||void 0===t?void 0:t.getAttribute("contentType"))||"",a=(null==s?void 0:s.getAttribute("codecs"))||h.getAttribute("codecs")||(e.includes("video")?"avc1.42E01E":e.includes("audio")?"mp4a.40.2":""),o=(null==s?void 0:s.querySelector("SegmentTemplate"))||h.querySelector("SegmentTemplate");if(!s||!o)continue;const u=null!==(i=null===(n=h.querySelector("BaseURL"))||void 0===n?void 0:n.textContent)&&void 0!==i?i:"",f=new URL(u||".",l).href,p=s.getAttribute("width"),g=s.getAttribute("height"),m=[],y=o.querySelector("SegmentTimeline");if(y){let e=0;for(const t of Array.from(y.querySelectorAll("S"))){const n=parseInt(t.getAttribute("t")||"")||e,i=parseInt(t.getAttribute("d")||""),r=parseInt(t.getAttribute("r")||"0");for(let e=0;e<=(r||0);e++)m.push(n+e*i);e=n+((r||0)+1)*i}}const v={baseURL:f,representationID:s.getAttribute("id")||"",initialization:o.getAttribute("initialization")||"",media:o.getAttribute("media")||"",startNumber:parseInt(o.getAttribute("startNumber")||"1"),timescale:parseInt(o.getAttribute("timescale")||"1"),duration:parseInt(o.getAttribute("duration")||"1"),useTimeTemplate:(null===(r=o.getAttribute("media"))||void 0===r?void 0:r.includes("$Time$"))||!1,mimeType:e,codecs:a,timeline:m.length>0?m:void 0,resolution:p&&g?`${p}x${g}`:void 0,bandwidth:parseInt(s.getAttribute("bandwidth")||"0")};e.includes("audio")?d.push(v):e.includes("video")&&c.push(v)}}return Qa.debug("[MPDParser] Parsed videoTracks:",c),Qa.debug("[MPDParser] Parsed audioTracks:",d),{videoTracks:c,audioTracks:d}}}class Za{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;this.maxRetries=e}async fetchSegment(e){for(let n=1;n<=this.maxRetries;n++)try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status}`);return{url:e,data:await t.arrayBuffer()}}catch(t){if(console.warn(`[SegmentFetcher] Attempt ${n} failed for ${e}`,t),n===this.maxRetries)throw new Error(`[SegmentFetcher] Failed after ${n} attempts: ${e}`);await new Promise((e=>setTimeout(e,100*Math.pow(2,n))))}throw new Error(`Unknown fetch failure for ${e}`)}}class eo{constructor(e){var t;this.SegmentInfo=e,this.info=e,this.baseURL=e.baseURL||"",this.representationID=e.representationID,this.initTemplate=e.initialization,this.mediaTemplate=e.media,this.useTimeTemplate=null!==(t=e.useTimeTemplate)&&void 0!==t?t:-1!==e.media.indexOf("$Time$")}getInitializationURL(){return this.resolveTemplate(this.initTemplate)}getInfo(){return this.info}getMediaSegmentURL(e){if(this.info.useTimeTemplate&&this.info.timeline){const t=this.info.timeline[e];return this.resolveTemplate(this.info.media,void 0,t)}{const t=this.info.startNumber+e;return this.resolveTemplate(this.mediaTemplate,t)}}resolveTemplate(e,t,n){let i=e.replace("$RepresentationID$",this.representationID);return void 0!==t&&(i=i.replace("$Number$",t.toString())),void 0!==n&&(i=i.replace("$Time$",n.toString())),this.baseURL+i}computeSegmentTime(e){return e*this.info.duration}}class to{constructor(e,t){this.videoTrackMap={},this.videoEl=e,this.fetcher=new Za,this.mediaSource=new MediaSource;for(const n of t){const e=n.media.includes("audio")?"audio":"video",t={type:e,mimeType:`${n.mimeType}; codecs="${n.codecs}"`,generator:new eo(n),segmentIndex:0};"audio"!==e||this.audioTrack?"video"===e&&n.resolution&&(this.videoTrackMap[n.resolution]=t):this.audioTrack=t}}async init(){this.videoEl.src=URL.createObjectURL(this.mediaSource),this.mediaSource.addEventListener("sourceopen",(async()=>{if(Qa.info("[MediaSourceHandler] MediaSource opened"),this.audioTrack){this.audioTrack.sourceBuffer=this.mediaSource.addSourceBuffer(this.audioTrack.mimeType);const e=await this.fetcher.fetchSegment(this.audioTrack.generator.getInitializationURL());this.audioTrack.sourceBuffer.appendBuffer(e.data),this.audioTrack.sourceBuffer.addEventListener("updateend",(()=>this.appendNextSegment(this.audioTrack)))}const e=Object.keys(this.videoTrackMap)[0];e&&await this.setRendition(e)}))}async appendNextSegment(e){const t=e.generator.getMediaSegmentURL(e.segmentIndex++);Qa.debug(`[${e.type}] Fetching segment ${e.segmentIndex-1}: ${t}`);try{const n=await this.fetcher.fetchSegment(t);e.sourceBuffer.appendBuffer(n.data)}catch(t){Qa.warn(`[${e.type}] Segment fetch failed:`,t)}}getCurrentBitrate(){var e,t;return null!==(t=null===(e=this.currentVideoTrack)||void 0===e?void 0:e.generator.getInfo().bandwidth)&&void 0!==t?t:0}getCurrentResolution(){return`${this.videoEl.videoWidth}x${this.videoEl.videoHeight}`}getAvailableRenditions(){return Object.entries(this.videoTrackMap).map((e=>{let[t,n]=e;var i;return{resolution:t,bitrate:null!==(i=n.generator.getInfo().bandwidth)&&void 0!==i?i:0}})).sort(((e,t)=>e.bitrate-t.bitrate))}async setRendition(e){const t=this.videoTrackMap[e];if(!t)return void Qa.warn(`[MediaSourceHandler] No track found for resolution: ${e}`);Qa.info(`[MediaSourceHandler] Switching to resolution: ${e}`),this.currentVideoTrack=t,t.sourceBuffer=this.mediaSource.addSourceBuffer(t.mimeType);const n=await this.fetcher.fetchSegment(t.generator.getInitializationURL());t.sourceBuffer.appendBuffer(n.data),t.sourceBuffer.addEventListener("updateend",(()=>this.appendNextSegment(t)))}setAdaptiveBitrate(e){Qa.info(`[MediaSourceHandler] Adaptive Bitrate ${e?"enabled":"disabled"} (stub)`)}}class no{constructor(){Qa.setLevel("debug")}attachVideoElement(e){this.videoElement=e,e.onplay=()=>{var e;return null===(e=this.onPlay)||void 0===e?void 0:e.call(this)},e.onpause=()=>{var e;return null===(e=this.onPause)||void 0===e?void 0:e.call(this)},e.onended=()=>{var e;return null===(e=this.onEnded)||void 0===e?void 0:e.call(this)},e.onerror=()=>{var t;return null===(t=this.onError)||void 0===t?void 0:t.call(this,e.error)},e.ontimeupdate=()=>{var t;return null===(t=this.onTimeUpdate)||void 0===t?void 0:t.call(this,e.currentTime)},e.onwaiting=()=>{var e;return null===(e=this.onBuffering)||void 0===e?void 0:e.call(this)},Qa.info("[Player] Video element attached")}async load(e){var t,n;if(!this.videoElement)throw new Error("[Player] No video element attached. Use attachVideoElement().");this.manifestUrl=e,Qa.info("[Player] Loading manifest:",e);try{const n=new Ja,i=await n.parseVideo(e),r=await n.parseAudio(e),s=[...i,...r];this.mediaSourceHandler=new to(this.videoElement,s),await this.mediaSourceHandler.init(),null===(t=this.onReady)||void 0===t||t.call(this)}catch(e){Qa.error("[Player] Error during load:",e),null===(n=this.onError)||void 0===n||n.call(this,e)}}play(){var e;null===(e=this.videoElement)||void 0===e||e.play().catch((e=>{var t;Qa.error("[Player] Play error:",e),null===(t=this.onError)||void 0===t||t.call(this,e)}))}pause(){var e;null===(e=this.videoElement)||void 0===e||e.pause()}isPaused(){var e,t;return null===(t=null===(e=this.videoElement)||void 0===e?void 0:e.paused)||void 0===t||t}getCurrentTime(){var e,t;return null!==(t=null===(e=this.videoElement)||void 0===e?void 0:e.currentTime)&&void 0!==t?t:0}seekTo(e){this.videoElement&&(this.videoElement.currentTime=e)}setVolume(e){this.videoElement&&(this.videoElement.volume=Math.max(0,Math.min(1,e)))}mute(){this.videoElement&&(this.videoElement.muted=!0)}unmute(){this.videoElement&&(this.videoElement.muted=!1)}reset(){this.videoElement&&(this.videoElement.pause(),this.videoElement.removeAttribute("src"),this.videoElement.load()),this.mediaSourceHandler=void 0,this.manifestUrl=void 0,Qa.info("[Player] Reset complete")}getBitrate(){var e,t;return null!==(t=null===(e=this.mediaSourceHandler)||void 0===e?void 0:e.getCurrentBitrate())&&void 0!==t?t:0}getResolution(){var e,t;return null!==(t=null===(e=this.mediaSourceHandler)||void 0===e?void 0:e.getCurrentResolution())&&void 0!==t?t:"0x0"}getAvailableRenditions(){var e,t;return null!==(t=null===(e=this.mediaSourceHandler)||void 0===e?void 0:e.getAvailableRenditions())&&void 0!==t?t:[]}setRendition(e){var t;null===(t=this.mediaSourceHandler)||void 0===t||t.setRendition(e)}setAdaptiveBitrate(e){var t;null===(t=this.mediaSourceHandler)||void 0===t||t.setAdaptiveBitrate(e)}destroy(){this.reset(),this.videoElement=void 0,Qa.info("[Player] Destroyed player")}}window.MseNavPlayer={Player:no};class io{constructor(){this.player=null,this.videoEl=null,this.containerEl=null,this.eventListeners={}}initialize(e){this.containerEl=e,e.innerHTML="";const t=document.createElement("video");t.controls=!0,t.style.width="100%",t.style.height="100%",e.appendChild(t),this.videoEl=t,this.player=new no,this.player.attachVideoElement(t),this.player.onReady=()=>this.emitEvent("ready"),this.player.onError=e=>this.emitEvent("error",e),this.player.onPlay=()=>this.emitEvent("playing"),this.player.onPause=()=>this.emitEvent("pause"),this.player.onEnded=()=>this.emitEvent("ended"),this.player.onBuffering=()=>this.emitEvent("buffering"),this.player.onTimeUpdate=e=>this.emitEvent("timeupdate",e)}load(e){this.player&&this.player.load(e)}play(){var e;null===(e=this.player)||void 0===e||e.play(),this.emitEvent("playing")}pause(){var e;null===(e=this.player)||void 0===e||e.pause(),this.emitEvent("pause")}destroy(){var e,t;null===(e=this.player)||void 0===e||e.destroy(),null===(t=this.videoEl)||void 0===t||t.remove(),this.videoEl=null,this.player=null}getBitrate(){var e,t;return null!==(e=null===(t=this.player)||void 0===t?void 0:t.getBitrate())&&void 0!==e?e:0}getResolution(){var e,t;return null!==(e=null===(t=this.player)||void 0===t?void 0:t.getResolution())&&void 0!==e?e:"0x0"}getAvailableRenditions(){var e,t;return null!==(e=null===(t=this.player)||void 0===t?void 0:t.getAvailableRenditions())&&void 0!==e?e:[]}setRendition(e){var t;null===(t=this.player)||void 0===t||t.setRendition(e)}setAdaptiveBitrate(e){var t;null===(t=this.player)||void 0===t||t.setAdaptiveBitrate(e)}on(e,t){this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(t)}off(e,t){var n;this.eventListeners[e]=(null===(n=this.eventListeners[e])||void 0===n?void 0:n.filter((e=>e!==t)))||[]}emitEvent(e,t){var n;null===(n=this.eventListeners[e])||void 0===n||n.forEach((e=>e(t)))}}var ro=n(552),so=n.n(ro);class ao{constructor(){this.player=null,this.videoElement=null,this.eventListeners={}}async initialize(e,t){e.innerHTML="";const n=document.createElement("video");if(n.controls=!0,e.appendChild(n),this.videoElement=n,this.player=new(so().Player)(n),this.player.addEventListener("error",(e=>this.emitEvent("error",e))),this.player.addEventListener("buffering",(()=>this.emitEvent("buffering"))),this.player.addEventListener("adaptation",(()=>this.emitEvent("renditionchange"))),this.player.addEventListener("adaptation",(()=>{const e=this.getBitrate(),t=this.getResolution();this.emitEvent("renditionchange",{bitrate:e,resolution:t})})),null!==t&&void 0!==t&&t.drm)for(const i in t.drm)this.player.configure({drm:{servers:{[i]:t.drm[i].serverURL}}})}async load(e,t){var n;if(this.player){if(t){const e="widevine"===t.drmType?"com.widevine.alpha":"com.microsoft.playready";this.player.configure({drm:{servers:{[e]:t.licenseUrl}}})}await(null===(n=this.player)||void 0===n?void 0:n.load(e).then((()=>this.emitEvent("playing"))).catch((e=>this.emitEvent("error",e))))}}getAvailableRenditions(){if(!this.player)return[];return this.player.getVariantTracks().filter((e=>e.width&&e.height)).map((e=>({resolution:`${e.width}x${e.height}`,bitrate:Math.round(e.bandwidth/1e3)}))).sort(((e,t)=>e.bitrate-t.bitrate))}setRendition(e){if(!this.player)return;const t=this.player.getVariantTracks().find((t=>`${t.width}x${t.height}`===e));t&&(this.player.selectVariantTrack(t,!0),this.player.configure({abr:{enabled:!1}}),console.log(`Switched to ${e}`))}setAdaptiveBitrate(e){this.player&&(this.player.configure({abr:{enabled:e}}),console.log("ABR "+(e?"enabled":"disabled")))}play(){var e;null===(e=this.videoElement)||void 0===e||e.play(),this.emitEvent("playing")}pause(){var e;null===(e=this.videoElement)||void 0===e||e.pause()}destroy(){var e;null===(e=this.player)||void 0===e||e.destroy(),this.player=null,this.videoElement=null}getBitrate(){if(!this.player)return 0;const e=this.player.getVariantTracks().find((e=>e.active));return null!==e&&void 0!==e&&e.bandwidth?Math.round(e.bandwidth/1e3):0}getResolution(){return this.videoElement?`${this.videoElement.videoWidth}x${this.videoElement.videoHeight}`:"N/A"}on(e,t){this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(t)}off(e,t){this.eventListeners[e]&&(this.eventListeners[e]=this.eventListeners[e].filter((e=>e!==t)))}emitEvent(e,t){this.eventListeners[e]&&this.eventListeners[e].forEach((e=>e(t)))}}var oo=n(739),lo=n.n(oo),uo=n(26),co=n.n(uo),ho=n(877),fo=n.n(ho),po=n(501),go=n.n(po);function mo(){return mo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mo.apply(null,arguments)}var yo="https://example.com";const vo=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=lo().location&&lo().location.href||"");var n=/^\/\//.test(e),i=!lo().location&&!/\/\//i.test(e);e=new(lo().URL)(e,lo().location||yo);var r=new URL(t,e);return i?r.href.slice(19):n?r.href.slice(r.protocol.length):r.href};var bo=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(n,1),n>-1},t.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),s=t.length,a=0;a<s;++a)t[a].apply(this,r)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}();function To(e){for(var t,n=(t=e,lo().atob?lo().atob(t):Buffer.from(t,"base64").toString("binary")),i=new Uint8Array(n.length),r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}class So extends bo{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const _o=String.fromCharCode(9),wo=function(e){const t=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),n={};return t[1]&&(n.length=parseInt(t[1],10)),t[2]&&(n.offset=parseInt(t[2],10)),n},Eo=function(e){const t={};if(!e)return t;const n=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'));let i,r=n.length;for(;r--;)""!==n[r]&&(i=/([^=]*)=(.*)/.exec(n[r]).slice(1),i[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),t[i[0]]=i[1]);return t},ko=e=>{const t=e.split("x"),n={};return t[0]&&(n.width=parseInt(t[0],10)),t[1]&&(n.height=parseInt(t[1],10)),n};class xo extends bo{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,n;if(0===(e=e.trim()).length)return;if("#"!==e[0])return void this.trigger("data",{type:"uri",uri:e});this.tagMappers.reduce(((t,n)=>{const i=n(e);return i===e?t:t.concat([i])}),[e]).forEach((e=>{for(let t=0;t<this.customParsers.length;t++)if(this.customParsers[t].call(this,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e),t)this.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(e),t)return n={type:"tag",tagType:"inf"},t[1]&&(n.duration=parseFloat(t[1])),t[2]&&(n.title=t[2]),void this.trigger("data",n);if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"targetduration"},t[1]&&(n.duration=parseInt(t[1],10)),void this.trigger("data",n);if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"version"},t[1]&&(n.version=parseInt(t[1],10)),void this.trigger("data",n);if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"media-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void this.trigger("data",n);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void this.trigger("data",n);if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(e),t)return n={type:"tag",tagType:"playlist-type"},t[1]&&(n.playlistType=t[1]),void this.trigger("data",n);if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(e),t)return n=mo(wo(t[1]),{type:"tag",tagType:"byterange"}),void this.trigger("data",n);if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(e),t)return n={type:"tag",tagType:"allow-cache"},t[1]&&(n.allowed=!/NO/.test(t[1])),void this.trigger("data",n);if(t=/^#EXT-X-MAP:(.*)$/.exec(e),t){if(n={type:"tag",tagType:"map"},t[1]){const e=Eo(t[1]);e.URI&&(n.uri=e.URI),e.BYTERANGE&&(n.byterange=wo(e.BYTERANGE))}this.trigger("data",n)}else{if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(e),t)return n={type:"tag",tagType:"stream-inf"},t[1]&&(n.attributes=Eo(t[1]),n.attributes.RESOLUTION&&(n.attributes.RESOLUTION=ko(n.attributes.RESOLUTION)),n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["FRAME-RATE"]&&(n.attributes["FRAME-RATE"]=parseFloat(n.attributes["FRAME-RATE"])),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))),void this.trigger("data",n);if(t=/^#EXT-X-MEDIA:(.*)$/.exec(e),t)return n={type:"tag",tagType:"media"},t[1]&&(n.attributes=Eo(t[1])),void this.trigger("data",n);if(t=/^#EXT-X-ENDLIST/.exec(e),t)this.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e),t)this.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(e),t)return n={type:"tag",tagType:"program-date-time"},t[1]&&(n.dateTimeString=t[1],n.dateTimeObject=new Date(t[1])),void this.trigger("data",n);if(t=/^#EXT-X-KEY:(.*)$/.exec(e),t)return n={type:"tag",tagType:"key"},t[1]&&(n.attributes=Eo(t[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2).toLowerCase()&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void this.trigger("data",n);if(t=/^#EXT-X-START:(.*)$/.exec(e),t)return n={type:"tag",tagType:"start"},t[1]&&(n.attributes=Eo(t[1]),n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]),n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)),void this.trigger("data",n);if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(e),t)return n={type:"tag",tagType:"cue-out-cont"},t[1]?n.data=t[1]:n.data="",void this.trigger("data",n);if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(e),t)return n={type:"tag",tagType:"cue-out"},t[1]?n.data=t[1]:n.data="",void this.trigger("data",n);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e),t)return n={type:"tag",tagType:"cue-in"},t[1]?n.data=t[1]:n.data="",void this.trigger("data",n);if(t=/^#EXT-X-SKIP:(.*)$/.exec(e),t&&t[1])return n={type:"tag",tagType:"skip"},n.attributes=Eo(t[1]),n.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(n.attributes["SKIPPED-SEGMENTS"]=parseInt(n.attributes["SKIPPED-SEGMENTS"],10)),n.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(n.attributes["RECENTLY-REMOVED-DATERANGES"]=n.attributes["RECENTLY-REMOVED-DATERANGES"].split(_o)),void this.trigger("data",n);if(t=/^#EXT-X-PART:(.*)$/.exec(e),t&&t[1])return n={type:"tag",tagType:"part"},n.attributes=Eo(t[1]),["DURATION"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=parseFloat(n.attributes[e]))})),["INDEPENDENT","GAP"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=/YES/.test(n.attributes[e]))})),n.attributes.hasOwnProperty("BYTERANGE")&&(n.attributes.byterange=wo(n.attributes.BYTERANGE)),void this.trigger("data",n);if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(e),t&&t[1])return n={type:"tag",tagType:"server-control"},n.attributes=Eo(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=parseFloat(n.attributes[e]))})),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=/YES/.test(n.attributes[e]))})),void this.trigger("data",n);if(t=/^#EXT-X-PART-INF:(.*)$/.exec(e),t&&t[1])return n={type:"tag",tagType:"part-inf"},n.attributes=Eo(t[1]),["PART-TARGET"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=parseFloat(n.attributes[e]))})),void this.trigger("data",n);if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(e),t&&t[1])return n={type:"tag",tagType:"preload-hint"},n.attributes=Eo(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach((function(e){if(n.attributes.hasOwnProperty(e)){n.attributes[e]=parseInt(n.attributes[e],10);const t="BYTERANGE-LENGTH"===e?"length":"offset";n.attributes.byterange=n.attributes.byterange||{},n.attributes.byterange[t]=n.attributes[e],delete n.attributes[e]}})),void this.trigger("data",n);if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(e),t&&t[1])return n={type:"tag",tagType:"rendition-report"},n.attributes=Eo(t[1]),["LAST-MSN","LAST-PART"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=parseInt(n.attributes[e],10))})),void this.trigger("data",n);if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(e),t&&t[1]){n={type:"tag",tagType:"daterange"},n.attributes=Eo(t[1]),["ID","CLASS"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=String(n.attributes[e]))})),["START-DATE","END-DATE"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=new Date(n.attributes[e]))})),["DURATION","PLANNED-DURATION"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=parseFloat(n.attributes[e]))})),["END-ON-NEXT"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=/YES/i.test(n.attributes[e]))})),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach((function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=n.attributes[e].toString(16))}));const e=/^X-([A-Z]+-)+[A-Z]+$/;for(const t in n.attributes){if(!e.test(t))continue;const i=/[0-9A-Fa-f]{6}/g.test(n.attributes[t]),r=/^\d+(\.\d+)?$/.test(n.attributes[t]);n.attributes[t]=i?n.attributes[t].toString(16):r?parseFloat(n.attributes[t]):String(n.attributes[t])}this.trigger("data",n)}else if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(e),t)this.trigger("data",{type:"tag",tagType:"independent-segments"});else if(t=/^#EXT-X-I-FRAMES-ONLY/.exec(e),t)this.trigger("data",{type:"tag",tagType:"i-frames-only"});else{if(t=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(e),t)return n={type:"tag",tagType:"content-steering"},n.attributes=Eo(t[1]),void this.trigger("data",n);if(t=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(e),t)return n={type:"tag",tagType:"i-frame-playlist"},n.attributes=Eo(t[1]),n.attributes.URI&&(n.uri=n.attributes.URI),n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes.RESOLUTION&&(n.attributes.RESOLUTION=ko(n.attributes.RESOLUTION)),n.attributes["AVERAGE-BANDWIDTH"]&&(n.attributes["AVERAGE-BANDWIDTH"]=parseInt(n.attributes["AVERAGE-BANDWIDTH"],10)),n.attributes["FRAME-RATE"]&&(n.attributes["FRAME-RATE"]=parseFloat(n.attributes["FRAME-RATE"])),void this.trigger("data",n);if(t=/^#EXT-X-DEFINE:(.*)$/.exec(e),t)return n={type:"tag",tagType:"define"},n.attributes=Eo(t[1]),void this.trigger("data",n);this.trigger("data",{type:"tag",data:e.slice(4)})}}}}else this.trigger("data",{type:"comment",text:e.slice(1)})}))}addParser(e){let{expression:t,customType:n,dataParser:i,segment:r}=e;"function"!==typeof i&&(i=e=>e),this.customParsers.push((e=>{if(t.exec(e))return this.trigger("data",{type:"custom",data:i(e),customType:n,segment:r}),!0}))}addTagMapper(e){let{expression:t,map:n}=e;this.tagMappers.push((e=>t.test(e)?n(e):e))}}const Ao=function(e){const t={};return Object.keys(e).forEach((function(n){var i;t[(i=n,i.toLowerCase().replace(/-(\w)/g,(e=>e[1].toUpperCase())))]=e[n]})),t},Co=function(e){const{serverControl:t,targetDuration:n,partTargetDuration:i}=e;if(!t)return;const r="#EXT-X-SERVER-CONTROL",s="holdBack",a="partHoldBack",o=n&&3*n,l=i&&2*i;n&&!t.hasOwnProperty(s)&&(t[s]=o,this.trigger("info",{message:`${r} defaulting HOLD-BACK to targetDuration * 3 (${o}).`})),o&&t[s]<o&&(this.trigger("warn",{message:`${r} clamping HOLD-BACK (${t[s]}) to targetDuration * 3 (${o})`}),t[s]=o),i&&!t.hasOwnProperty(a)&&(t[a]=3*i,this.trigger("info",{message:`${r} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${t[a]}).`})),i&&t[a]<l&&(this.trigger("warn",{message:`${r} clamping PART-HOLD-BACK (${t[a]}) to partTargetDuration * 2 (${l}).`}),t[a]=l)};class Io extends bo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.lineStream=new So,this.parseStream=new xo,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const t=this,n=[];let i,r,s={},a=!1;const o=function(){},l={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};let u=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let c=0,d=0;const h={};this.on("end",(()=>{s.uri||!s.parts&&!s.preloadHints||(!s.map&&i&&(s.map=i),!s.key&&r&&(s.key=r),s.timeline||"number"!==typeof u||(s.timeline=u),this.manifest.preloadSegment=s)})),this.parseStream.on("data",(function(e){let f,p;if(t.manifest.definitions)for(const n in t.manifest.definitions)if(e.uri&&(e.uri=e.uri.replace(`{$${n}}`,t.manifest.definitions[n])),e.attributes)for(const i in e.attributes)"string"===typeof e.attributes[i]&&(e.attributes[i]=e.attributes[i].replace(`{$${n}}`,t.manifest.definitions[n]));({tag(){({version(){e.version&&(this.manifest.version=e.version)},"allow-cache"(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const t={};"length"in e&&(s.byterange=t,t.length=e.length,"offset"in e||(e.offset=c)),"offset"in e&&(s.byterange=t,t.offset=e.offset),c=t.offset+t.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.title&&(s.title=e.title),e.duration>0&&(s.duration=e.duration),0===e.duration&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=n},key(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("com.apple.streamingkeydelivery"===e.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:e.attributes});if("com.microsoft.playready"===e.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.microsoft.playready"]={uri:e.attributes.URI});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:To(e.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),r={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},"undefined"!==typeof e.attributes.IV&&(r.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else r=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence"(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence"(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,u=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type"(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map(){i={},e.uri&&(i.uri=e.uri),e.byterange&&(i.byterange=e.byterange),r&&(i.key=r)},"stream-inf"(){this.manifest.playlists=n,this.manifest.mediaGroups=this.manifest.mediaGroups||l,e.attributes?(s.attributes||(s.attributes={}),mo(s.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||l,!(e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME))return void this.trigger("warn",{message:"ignoring incomplete or missing media group"});const t=this.manifest.mediaGroups[e.attributes.TYPE];t[e.attributes["GROUP-ID"]]=t[e.attributes["GROUP-ID"]]||{},f=t[e.attributes["GROUP-ID"]],p={default:/yes/i.test(e.attributes.DEFAULT)},p.default?p.autoselect=!0:p.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(p.language=e.attributes.LANGUAGE),e.attributes.URI&&(p.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(p.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(p.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(p.forced=/yes/i.test(e.attributes.FORCED)),f[e.attributes.NAME]=p},discontinuity(){u+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(n.length)},"program-date-time"(){"undefined"===typeof this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),s.dateTimeString=e.dateTimeString,s.dateTimeObject=e.dateTimeObject;const{lastProgramDateTime:t}=this;this.lastProgramDateTime=new Date(e.dateTimeString).getTime(),null===t&&this.manifest.segments.reduceRight(((e,t)=>(t.programDateTime=e-1e3*t.duration,t.programDateTime)),this.lastProgramDateTime)},targetduration(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):(this.manifest.targetDuration=e.duration,Co.call(this,this.manifest))},start(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out"(){s.cueOut=e.data},"cue-out-cont"(){s.cueOutCont=e.data},"cue-in"(){s.cueIn=e.data},skip(){this.manifest.skip=Ao(e.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",e.attributes,["SKIPPED-SEGMENTS"])},part(){a=!0;const t=this.manifest.segments.length,n=Ao(e.attributes);s.parts=s.parts||[],s.parts.push(n),n.byterange&&(n.byterange.hasOwnProperty("offset")||(n.byterange.offset=d),d=n.byterange.offset+n.byterange.length);const i=s.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${i} for segment #${t}`,e.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(((e,t)=>{e.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${t} lacks required attribute(s): LAST-PART`})}))},"server-control"(){const t=this.manifest.serverControl=Ao(e.attributes);t.hasOwnProperty("canBlockReload")||(t.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Co.call(this,this.manifest),t.canSkipDateranges&&!t.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const t=this.manifest.segments.length,n=Ao(e.attributes),i=n.type&&"PART"===n.type;s.preloadHints=s.preloadHints||[],s.preloadHints.push(n),n.byterange&&(n.byterange.hasOwnProperty("offset")||(n.byterange.offset=i?d:0,i&&(d=n.byterange.offset+n.byterange.length)));const r=s.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${r} for segment #${t}`,e.attributes,["TYPE","URI"]),n.type)for(let e=0;e<s.preloadHints.length-1;e++){const i=s.preloadHints[e];i.type&&(i.type===n.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${r} for segment #${t} has the same TYPE ${n.type} as preload hint #${e}`}))}},"rendition-report"(){const t=Ao(e.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(t);const n=this.manifest.renditionReports.length-1,i=["LAST-MSN","URI"];a&&i.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${n}`,e.attributes,i)},"part-inf"(){this.manifest.partInf=Ao(e.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",e.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Co.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(Ao(e.attributes));const t=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${t}`,e.attributes,["ID","START-DATE"]);const n=this.manifest.dateRanges[t];n.endDate&&n.startDate&&new Date(n.endDate)<new Date(n.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),n.duration&&n.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),n.plannedDuration&&n.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const i=!!n.endOnNext;if(i&&!n.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),i&&(n.duration||n.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),n.duration&&n.endDate){const e=n.startDate.getTime()+1e3*n.duration;this.manifest.dateRanges[t].endDate=new Date(e)}if(h[n.id]){for(const t in h[n.id])if(n[t]&&JSON.stringify(h[n.id][t])!==JSON.stringify(n[t])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const e=this.manifest.dateRanges.findIndex((e=>e.id===n.id));this.manifest.dateRanges[e]=mo(this.manifest.dateRanges[e],n),h[n.id]=mo(h[n.id],n),this.manifest.dateRanges.pop()}else h[n.id]=n},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=Ao(e.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",e.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const t=(e,t)=>{e in this.manifest.definitions?this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${e}`}):this.manifest.definitions[e]=t};if("QUERYPARAM"in e.attributes){if("NAME"in e.attributes||"IMPORT"in e.attributes)return void this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});const n=this.params.get(e.attributes.QUERYPARAM);return n?void t(e.attributes.QUERYPARAM,decodeURIComponent(n)):void this.trigger("error",{message:`EXT-X-DEFINE: No query param ${e.attributes.QUERYPARAM}`})}return"NAME"in e.attributes?"IMPORT"in e.attributes?void this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"}):"VALUE"in e.attributes&&"string"===typeof e.attributes.VALUE?void t(e.attributes.NAME,e.attributes.VALUE):void this.trigger("error",{message:`EXT-X-DEFINE: No value for ${e.attributes.NAME}`}):"IMPORT"in e.attributes?this.mainDefinitions[e.attributes.IMPORT]?void t(e.attributes.IMPORT,this.mainDefinitions[e.attributes.IMPORT]):void this.trigger("error",{message:`EXT-X-DEFINE: No value ${e.attributes.IMPORT} to import, or IMPORT used on main playlist`}):void this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:e.attributes,uri:e.uri,timeline:u}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",e.attributes,["BANDWIDTH","URI"])}}[e.tagType]||o).call(t)},uri(){s.uri=e.uri,n.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),r&&(s.key=r),s.timeline=u,i&&(s.map=i),d=0,null!==this.lastProgramDateTime&&(s.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=1e3*s.duration),s={}},comment(){},custom(){e.segment?(s.custom=s.custom||{},s.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(t)}))}requiredCompatibilityversion(e,t){(e<t||!e)&&this.trigger("warn",{message:`manifest must be at least version ${t}`})}warnOnMissingAttributes_(e,t,n){const i=[];n.forEach((function(e){t.hasOwnProperty(e)||i.push(e)})),i.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${i.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push("\n"),this.manifest.dateRanges.length&&null===this.lastProgramDateTime&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}var Lo={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Do=["video","audio","text"],Ro=["Video","Audio","Text"],Mo=function(e){return e?e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e,t,n){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(n).toString(16)).slice(-2)})):e},Po=function(e){void 0===e&&(e="");var t=e.split(","),n=[];return t.forEach((function(e){var t;e=e.trim(),Do.forEach((function(i){var r=Lo[i].exec(e.toLowerCase());if(r&&!(r.length<=1)){t=i;var s=e.substring(0,r[1].length),a=e.replace(s,"");n.push({type:s,details:a,mediaType:i})}})),t||n.push({type:e,details:"",mediaType:"unknown"})})),n},Oo=function(e){return void 0===e&&(e=""),Lo.audio.test(e.trim().toLowerCase())},No=function(e){if(e&&"string"===typeof e){var t,n=e.toLowerCase().split(",").map((function(e){return Mo(e.trim())})),i="video";1===n.length&&Oo(n[0])?i="audio":1===n.length&&(void 0===(t=n[0])&&(t=""),Lo.text.test(t.trim().toLowerCase()))&&(i="application");var r="mp4";return n.every((function(e){return Lo.mp4.test(e)}))?r="mp4":n.every((function(e){return Lo.webm.test(e)}))?r="webm":n.every((function(e){return Lo.ogg.test(e)}))&&(r="ogg"),i+"/"+r+';codecs="'+e+'"'}},Uo=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=!1),lo().MediaSource&&lo().MediaSource.isTypeSupported&&lo().MediaSource.isTypeSupported(No(e))||t&&lo().ManagedMediaSource&&lo().ManagedMediaSource.isTypeSupported&&lo().ManagedMediaSource.isTypeSupported(No(e))||!1},Fo=function(e){return void 0===e&&(e=""),e.toLowerCase().split(",").every((function(e){e=e.trim();for(var t=0;t<Ro.length;t++){if(Lo["muxer"+Ro[t]].test(e))return!0}return!1}))},Bo="mp4a.40.2",jo=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,$o=/^application\/dash\+xml/i,Vo=function(e){return jo.test(e)?"hls":$o.test(e)?"dash":"application/vnd.videojs.vhs+json"===e?"vhs-json":null},Ho=function(e){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},qo=function(e){return e instanceof Uint8Array?e:(Array.isArray(e)||Ho(e)||e instanceof ArrayBuffer||(e="number"!==typeof e||"number"===typeof e&&e!==e?0:[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},Go=lo().BigInt||Number,zo=[Go("0x1"),Go("0x100"),Go("0x10000"),Go("0x1000000"),Go("0x100000000"),Go("0x10000000000"),Go("0x1000000000000"),Go("0x100000000000000"),Go("0x10000000000000000")],Ko=(function(){var e=new Uint16Array([65484]),t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);255===t[0]||t[0]}(),function(e,t){var n=void 0===t?{}:t,i=n.signed,r=void 0!==i&&i,s=n.le,a=void 0!==s&&s;e=qo(e);var o=a?"reduce":"reduceRight",l=(e[o]?e[o]:Array.prototype[o]).call(e,(function(t,n,i){var r=a?i:Math.abs(i+1-e.length);return t+Go(n)*zo[r]}),Go(0));if(r){var u=zo[e.length]/Go(2)-Go(1);(l=Go(l))>u&&(l-=u,l-=u,l-=Go(2))}return Number(l)}),Wo=function(e,t){var n=(void 0===t?{}:t).le,i=void 0!==n&&n;("bigint"!==typeof e&&"number"!==typeof e||"number"===typeof e&&e!==e)&&(e=0),e=Go(e);for(var r,s=(r=e,Math.ceil(function(e){return e.toString(2).length}(r)/8)),a=new Uint8Array(new ArrayBuffer(s)),o=0;o<s;o++){var l=i?o:Math.abs(o+1-a.length);a[l]=Number(e/zo[o]&Go(255)),e<0&&(a[l]=Math.abs(~a[l]),a[l]-=0===o?1:2)}return a},Xo=function(e,t){if("string"!==typeof e&&e&&"function"===typeof e.toString&&(e=e.toString()),"string"!==typeof e)return new Uint8Array;t||(e=unescape(encodeURIComponent(e)));for(var n=new Uint8Array(e.length),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n},Yo=function(e,t,n){var i=void 0===n?{}:n,r=i.offset,s=void 0===r?0:r,a=i.mask,o=void 0===a?[]:a;e=qo(e);var l=(t=qo(t)).every?t.every:Array.prototype.every;return t.length&&e.length-s>=t.length&&l.call(t,(function(t,n){return t===(o[n]?o[n]&e[s+n]:e[s+n])}))},Qo=n(899);const Jo=e=>!!e&&"object"===typeof e,Zo=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>("object"!==typeof t||Object.keys(t).forEach((n=>{Array.isArray(e[n])&&Array.isArray(t[n])?e[n]=e[n].concat(t[n]):Jo(e[n])&&Jo(t[n])?e[n]=Zo(e[n],t[n]):e[n]=t[n]})),e)),{})},el=e=>Object.keys(e).map((t=>e[t])),tl=e=>e.reduce(((e,t)=>e.concat(t)),[]),nl=e=>{if(!e.length)return[];const t=[];for(let n=0;n<e.length;n++)t.push(e[n]);return t};var il="INVALID_NUMBER_OF_PERIOD",rl="DASH_EMPTY_MANIFEST",sl="DASH_INVALID_XML",al="NO_BASE_URL",ol="SEGMENT_TIME_UNSPECIFIED",ll="UNSUPPORTED_UTC_TIMING_SCHEME";const ul=e=>{let{baseUrl:t="",source:n="",range:i="",indexRange:r=""}=e;const s={uri:n,resolvedUri:vo(t||"",n)};if(i||r){const e=(i||r).split("-");let t,n=lo().BigInt?lo().BigInt(e[0]):parseInt(e[0],10),a=lo().BigInt?lo().BigInt(e[1]):parseInt(e[1],10);n<Number.MAX_SAFE_INTEGER&&"bigint"===typeof n&&(n=Number(n)),a<Number.MAX_SAFE_INTEGER&&"bigint"===typeof a&&(a=Number(a)),t="bigint"===typeof a||"bigint"===typeof n?lo().BigInt(a)-lo().BigInt(n)+lo().BigInt(1):a-n+1,"bigint"===typeof t&&t<Number.MAX_SAFE_INTEGER&&(t=Number(t)),s.byterange={length:t,offset:n}}return s},cl=e=>(e&&"number"!==typeof e&&(e=parseInt(e,10)),isNaN(e)?null:e),dl={static(e){const{duration:t,timescale:n=1,sourceDuration:i,periodDuration:r}=e,s=cl(e.endNumber),a=t/n;return"number"===typeof s?{start:0,end:s}:"number"===typeof r?{start:0,end:r/a}:{start:0,end:i/a}},dynamic(e){const{NOW:t,clientOffset:n,availabilityStartTime:i,timescale:r=1,duration:s,periodStart:a=0,minimumUpdatePeriod:o=0,timeShiftBufferDepth:l=1/0}=e,u=cl(e.endNumber),c=(t+n)/1e3,d=i+a,h=c+o-d,f=Math.ceil(h*r/s),p=Math.floor((c-d-l)*r/s),g=Math.floor((c-d)*r/s);return{start:Math.max(0,p),end:"number"===typeof u?u:Math.min(f,g)}}},hl=e=>{const{type:t,duration:n,timescale:i=1,periodDuration:r,sourceDuration:s}=e,{start:a,end:o}=dl[t](e),l=((e,t)=>{const n=[];for(let i=e;i<t;i++)n.push(i);return n})(a,o).map((e=>t=>{const{duration:n,timescale:i=1,periodStart:r,startNumber:s=1}=e;return{number:s+t,duration:n/i,timeline:r,time:t*n}})(e));if("static"===t){const e=l.length-1,t="number"===typeof r?r:s;l[e].duration=t-n/i*e}return l},fl=e=>{const{baseUrl:t,initialization:n={},sourceDuration:i,indexRange:r="",periodStart:s,presentationTime:a,number:o=0,duration:l}=e;if(!t)throw new Error(al);const u=ul({baseUrl:t,source:n.sourceURL,range:n.range}),c=ul({baseUrl:t,source:t,indexRange:r});if(c.map=u,l){const t=hl(e);t.length&&(c.duration=t[0].duration,c.timeline=t[0].timeline)}else i&&(c.duration=i,c.timeline=s);return c.presentationTime=a||s,c.number=o,[c]},pl=(e,t,n)=>{const i=e.sidx.map?e.sidx.map:null,r=e.sidx.duration,s=e.timeline||0,a=e.sidx.byterange,o=a.offset+a.length,l=t.timescale,u=t.references.filter((e=>1!==e.referenceType)),c=[],d=e.endList?"static":"dynamic",h=e.sidx.timeline;let f,p=h,g=e.mediaSequence||0;f="bigint"===typeof t.firstOffset?lo().BigInt(o)+t.firstOffset:o+t.firstOffset;for(let m=0;m<u.length;m++){const e=t.references[m],a=e.referencedSize,o=e.subsegmentDuration;let u;u="bigint"===typeof f?f+lo().BigInt(a)-lo().BigInt(1):f+a-1;const y=fl({baseUrl:n,timescale:l,timeline:s,periodStart:h,presentationTime:p,number:g,duration:o,sourceDuration:r,indexRange:`${f}-${u}`,type:d})[0];i&&(y.map=i),c.push(y),f+="bigint"===typeof f?lo().BigInt(a):a,p+=o/l,g++}return e.segments=c,e},gl=["AUDIO","SUBTITLES"],ml=1/60,yl=e=>{return(t=e,n=e=>{let{timeline:t}=e;return t},el(t.reduce(((e,t)=>(t.forEach((t=>{e[n(t)]=t})),e)),{}))).sort(((e,t)=>e.timeline>t.timeline?1:-1));var t,n},vl=e=>{let t=[];var n,i;return n=e,i=(e,n,i,r)=>{t=t.concat(e.playlists||[])},gl.forEach((function(e){for(var t in n.mediaGroups[e])for(var r in n.mediaGroups[e][t]){var s=n.mediaGroups[e][t][r];i(s,e,t,r)}})),t},bl=e=>{let{playlist:t,mediaSequence:n}=e;t.mediaSequence=n,t.segments.forEach(((e,n)=>{e.number=t.mediaSequence+n}))},Tl=e=>{let{oldManifest:t,newManifest:n}=e;const i=t.playlists.concat(vl(t)),r=n.playlists.concat(vl(n));return n.timelineStarts=yl([t.timelineStarts,n.timelineStarts]),(e=>{let{oldPlaylists:t,newPlaylists:n,timelineStarts:i}=e;n.forEach((e=>{e.discontinuitySequence=i.findIndex((function(t){let{timeline:n}=t;return n===e.timeline}));const n=((e,t)=>{for(let n=0;n<e.length;n++)if(e[n].attributes.NAME===t)return e[n];return null})(t,e.attributes.NAME);if(!n)return;if(e.sidx)return;const r=e.segments[0],s=n.segments.findIndex((function(e){return Math.abs(e.presentationTime-r.presentationTime)<ml}));if(-1===s)return bl({playlist:e,mediaSequence:n.mediaSequence+n.segments.length}),e.segments[0].discontinuity=!0,e.discontinuityStarts.unshift(0),void((!n.segments.length&&e.timeline>n.timeline||n.segments.length&&e.timeline>n.segments[n.segments.length-1].timeline)&&e.discontinuitySequence--);n.segments[s].discontinuity&&!r.discontinuity&&(r.discontinuity=!0,e.discontinuityStarts.unshift(0),e.discontinuitySequence--),bl({playlist:e,mediaSequence:n.segments[s].number})}))})({oldPlaylists:i,newPlaylists:r,timelineStarts:n.timelineStarts}),n},Sl=e=>e&&e.uri+"-"+(e=>{let t;return t="bigint"===typeof e.offset||"bigint"===typeof e.length?lo().BigInt(e.offset)+lo().BigInt(e.length)-lo().BigInt(1):e.offset+e.length-1,`${e.offset}-${t}`})(e.byterange),_l=e=>{const t=e.reduce((function(e,t){return e[t.attributes.baseUrl]||(e[t.attributes.baseUrl]=[]),e[t.attributes.baseUrl].push(t),e}),{});let n=[];return Object.values(t).forEach((e=>{const t=el(e.reduce(((e,t)=>{const n=t.attributes.id+(t.attributes.lang||"");return e[n]?(t.segments&&(t.segments[0]&&(t.segments[0].discontinuity=!0),e[n].segments.push(...t.segments)),t.attributes.contentProtection&&(e[n].attributes.contentProtection=t.attributes.contentProtection)):(e[n]=t,e[n].attributes.timelineStarts=[]),e[n].attributes.timelineStarts.push({start:t.attributes.periodStart,timeline:t.attributes.periodStart}),e}),{}));n=n.concat(t)})),n.map((e=>{var t,n;return e.discontinuityStarts=(t=e.segments||[],n="discontinuity",t.reduce(((e,t,i)=>(t[n]&&e.push(i),e)),[])),e}))},wl=(e,t)=>{const n=Sl(e.sidx),i=n&&t[n]&&t[n].sidx;return i&&pl(e,i,e.sidx.resolvedUri),e},El=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Object.keys(t).length)return e;for(const n in e)e[n]=wl(e[n],t);return e},kl=e=>{let{attributes:t,segments:n,sidx:i,discontinuityStarts:r}=e;const s={attributes:{NAME:t.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:t.width,height:t.height},CODECS:t.codecs,BANDWIDTH:t.bandwidth,"PROGRAM-ID":1},uri:"",endList:"static"===t.type,timeline:t.periodStart,resolvedUri:t.baseUrl||"",targetDuration:t.duration,discontinuityStarts:r,timelineStarts:t.timelineStarts,segments:n};return t.frameRate&&(s.attributes["FRAME-RATE"]=t.frameRate),t.contentProtection&&(s.contentProtection=t.contentProtection),t.serviceLocation&&(s.attributes.serviceLocation=t.serviceLocation),i&&(s.sidx=i),s},xl=e=>{let{attributes:t}=e;return"video/mp4"===t.mimeType||"video/webm"===t.mimeType||"video"===t.contentType},Al=e=>{let{attributes:t}=e;return"audio/mp4"===t.mimeType||"audio/webm"===t.mimeType||"audio"===t.contentType},Cl=e=>{let{attributes:t}=e;return"text/vtt"===t.mimeType||"text"===t.contentType},Il=e=>e?Object.keys(e).reduce(((t,n)=>{const i=e[n];return t.concat(i.playlists)}),[]):[],Ll=e=>{let{dashPlaylists:t,locations:n,contentSteering:i,sidxMapping:r={},previousManifest:s,eventStream:a}=e;if(!t.length)return{};const{sourceDuration:o,type:l,suggestedPresentationDelay:u,minimumUpdatePeriod:c}=t[0].attributes,d=_l(t.filter(xl)).map(kl),h=_l(t.filter(Al)),f=_l(t.filter(Cl)),p=t.map((e=>e.attributes.captionServices)).filter(Boolean),g={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:o,playlists:El(d,r)};c>=0&&(g.minimumUpdatePeriod=1e3*c),n&&(g.locations=n),i&&(g.contentSteering=i),"dynamic"===l&&(g.suggestedPresentationDelay=u),a&&a.length>0&&(g.eventStream=a);const m=0===g.playlists.length,y=h.length?function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.reduce(((e,r)=>{const s=r.attributes.role&&r.attributes.role.value||"",a=r.attributes.lang||"";let o=r.attributes.label||"main";if(a&&!r.attributes.label){const e=s?` (${s})`:"";o=`${r.attributes.lang}${e}`}e[o]||(e[o]={language:a,autoselect:!0,default:"main"===s,playlists:[],uri:""});const l=wl(((e,t)=>{let{attributes:n,segments:i,sidx:r,mediaSequence:s,discontinuitySequence:a,discontinuityStarts:o}=e;const l={attributes:{NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs,"PROGRAM-ID":1},uri:"",endList:"static"===n.type,timeline:n.periodStart,resolvedUri:n.baseUrl||"",targetDuration:n.duration,discontinuitySequence:a,discontinuityStarts:o,timelineStarts:n.timelineStarts,mediaSequence:s,segments:i};return n.contentProtection&&(l.contentProtection=n.contentProtection),n.serviceLocation&&(l.attributes.serviceLocation=n.serviceLocation),r&&(l.sidx=r),t&&(l.attributes.AUDIO="audio",l.attributes.SUBTITLES="subs"),l})(r,i),n);return e[o].playlists.push(l),"undefined"===typeof t&&"main"===s&&(t=r,t.default=!0),e}),{});t||(r[Object.keys(r)[0]].default=!0);return r}(h,r,m):null,v=f.length?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.reduce(((e,n)=>{const i=n.attributes.label||n.attributes.lang||"text",r=n.attributes.lang||"und";return e[i]||(e[i]={language:r,default:!1,autoselect:!1,playlists:[],uri:""}),e[i].playlists.push(wl((e=>{let{attributes:t,segments:n,mediaSequence:i,discontinuityStarts:r,discontinuitySequence:s}=e;"undefined"===typeof n&&(n=[{uri:t.baseUrl,timeline:t.periodStart,resolvedUri:t.baseUrl||"",duration:t.sourceDuration,number:0}],t.duration=t.sourceDuration);const a={NAME:t.id,BANDWIDTH:t.bandwidth,"PROGRAM-ID":1};t.codecs&&(a.CODECS=t.codecs);const o={attributes:a,uri:"",endList:"static"===t.type,timeline:t.periodStart,resolvedUri:t.baseUrl||"",targetDuration:t.duration,timelineStarts:t.timelineStarts,discontinuityStarts:r,discontinuitySequence:s,mediaSequence:i,segments:n};return t.serviceLocation&&(o.attributes.serviceLocation=t.serviceLocation),o})(n),t)),e}),{})}(f,r):null,b=d.concat(Il(y),Il(v)),T=b.map((e=>{let{timelineStarts:t}=e;return t}));var S,_;return g.timelineStarts=yl(T),S=b,_=g.timelineStarts,S.forEach((e=>{e.mediaSequence=0,e.discontinuitySequence=_.findIndex((function(t){let{timeline:n}=t;return n===e.timeline})),e.segments&&e.segments.forEach(((e,t)=>{e.number=t}))})),y&&(g.mediaGroups.AUDIO.audio=y),v&&(g.mediaGroups.SUBTITLES.subs=v),p.length&&(g.mediaGroups["CLOSED-CAPTIONS"].cc=p.reduce(((e,t)=>t?(t.forEach((t=>{const{channel:n,language:i}=t;e[i]={autoselect:!1,default:!1,instreamId:n,language:i},t.hasOwnProperty("aspectRatio")&&(e[i].aspectRatio=t.aspectRatio),t.hasOwnProperty("easyReader")&&(e[i].easyReader=t.easyReader),t.hasOwnProperty("3D")&&(e[i]["3D"]=t["3D"])})),e):e),{})),s?Tl({oldManifest:s,newManifest:g}):g},Dl=(e,t,n)=>{const{NOW:i,clientOffset:r,availabilityStartTime:s,timescale:a=1,periodStart:o=0,minimumUpdatePeriod:l=0}=e,u=(i+r)/1e3+l-(s+o);return Math.ceil((u*a-t)/n)},Rl=(e,t)=>{const{type:n,minimumUpdatePeriod:i=0,media:r="",sourceDuration:s,timescale:a=1,startNumber:o=1,periodStart:l}=e,u=[];let c=-1;for(let d=0;d<t.length;d++){const h=t[d],f=h.d,p=h.r||0,g=h.t||0;let m;if(c<0&&(c=g),g&&g>c&&(c=g),p<0){const o=d+1;m=o===t.length?"dynamic"===n&&i>0&&r.indexOf("$Number$")>0?Dl(e,c,f):(s*a-c)/f:(t[o].t-c)/f}else m=p+1;const y=o+u.length+m;let v=o+u.length;for(;v<y;)u.push({number:v,duration:f/a,time:c,timeline:l}),c+=f,v++}return u},Ml=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Pl=(e,t)=>e.replace(Ml,(e=>(t,n,i,r)=>{if("$$"===t)return"$";if("undefined"===typeof e[n])return t;const s=""+e[n];return"RepresentationID"===n?s:(r=i?parseInt(r,10):1,s.length>=r?s:`${new Array(r-s.length+1).join("0")}${s}`)})(t)),Ol=(e,t)=>{const n={RepresentationID:e.id,Bandwidth:e.bandwidth||0},{initialization:i={sourceURL:"",range:""}}=e,r=ul({baseUrl:e.baseUrl,source:Pl(i.sourceURL,n),range:i.range}),s=((e,t)=>e.duration||t?e.duration?hl(e):Rl(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodStart}])(e,t);return s.map((t=>{n.Number=t.number,n.Time=t.time;const i=Pl(e.media||"",n),s=e.timescale||1,a=e.presentationTimeOffset||0,o=e.periodStart+(t.time-a)/s;return{uri:i,timeline:t.timeline,duration:t.duration,resolvedUri:vo(e.baseUrl||"",i),map:r,number:t.number,presentationTime:o}}))},Nl=(e,t)=>{const{duration:n,segmentUrls:i=[],periodStart:r}=e;if(!n&&!t||n&&t)throw new Error(ol);const s=i.map((t=>((e,t)=>{const{baseUrl:n,initialization:i={}}=e,r=ul({baseUrl:n,source:i.sourceURL,range:i.range}),s=ul({baseUrl:n,source:t.media,range:t.mediaRange});return s.map=r,s})(e,t)));let a;n&&(a=hl(e)),t&&(a=Rl(e,t));return a.map(((t,n)=>{if(s[n]){const i=s[n],a=e.timescale||1,o=e.presentationTimeOffset||0;return i.timeline=t.timeline,i.duration=t.duration,i.number=t.number,i.presentationTime=r+(t.time-o)/a,i}})).filter((e=>e))},Ul=e=>{let t,n,{attributes:i,segmentInfo:r}=e;r.template?(n=Ol,t=Zo(i,r.template)):r.base?(n=fl,t=Zo(i,r.base)):r.list&&(n=Nl,t=Zo(i,r.list));const s={attributes:i};if(!n)return s;const a=n(t,r.segmentTimeline);if(t.duration){const{duration:e,timescale:n=1}=t;t.duration=e/n}else a.length?t.duration=a.reduce(((e,t)=>Math.max(e,Math.ceil(t.duration))),0):t.duration=0;return s.attributes=t,s.segments=a,r.base&&t.indexRange&&(s.sidx=a[0],s.segments=[]),s},Fl=(e,t)=>nl(e.childNodes).filter((e=>{let{tagName:n}=e;return n===t})),Bl=e=>e.textContent.trim(),jl=e=>{const t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;const[n,i,r,s,a,o]=t.slice(1);return 31536e3*parseFloat(n||0)+2592e3*parseFloat(i||0)+86400*parseFloat(r||0)+3600*parseFloat(s||0)+60*parseFloat(a||0)+parseFloat(o||0)},$l={mediaPresentationDuration:e=>jl(e),availabilityStartTime(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t=e)&&(t+="Z"),Date.parse(t)/1e3;var t},minimumUpdatePeriod:e=>jl(e),suggestedPresentationDelay:e=>jl(e),type:e=>e,timeShiftBufferDepth:e=>jl(e),start:e=>jl(e),width:e=>parseInt(e,10),height:e=>parseInt(e,10),bandwidth:e=>parseInt(e,10),frameRate:e=>(e=>parseFloat(e.split("/").reduce(((e,t)=>e/t))))(e),startNumber:e=>parseInt(e,10),timescale:e=>parseInt(e,10),presentationTimeOffset:e=>parseInt(e,10),duration(e){const t=parseInt(e,10);return isNaN(t)?jl(e):t},d:e=>parseInt(e,10),t:e=>parseInt(e,10),r:e=>parseInt(e,10),presentationTime:e=>parseInt(e,10),DEFAULT:e=>e},Vl=e=>e&&e.attributes?nl(e.attributes).reduce(((e,t)=>{const n=$l[t.name]||$l.DEFAULT;return e[t.name]=n(t.value),e}),{}):{},Hl={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},ql=(e,t)=>t.length?tl(e.map((function(e){return t.map((function(t){const n=Bl(t),i=vo(e.baseUrl,n),r=Zo(Vl(t),{baseUrl:i});return i!==n&&!r.serviceLocation&&e.serviceLocation&&(r.serviceLocation=e.serviceLocation),r}))}))):e,Gl=e=>{const t=Fl(e,"SegmentTemplate")[0],n=Fl(e,"SegmentList")[0],i=n&&Fl(n,"SegmentURL").map((e=>Zo({tag:"SegmentURL"},Vl(e)))),r=Fl(e,"SegmentBase")[0],s=n||t,a=s&&Fl(s,"SegmentTimeline")[0],o=n||r||t,l=o&&Fl(o,"Initialization")[0],u=t&&Vl(t);u&&l?u.initialization=l&&Vl(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});const c={template:u,segmentTimeline:a&&Fl(a,"S").map((e=>Vl(e))),list:n&&Zo(Vl(n),{segmentUrls:i,initialization:Vl(l)}),base:r&&Zo(Vl(r),{initialization:Vl(l)})};return Object.keys(c).forEach((e=>{c[e]||delete c[e]})),c},zl=e=>tl(Fl(e.node,"EventStream").map((t=>{const n=Vl(t),i=n.schemeIdUri;return Fl(t,"Event").map((t=>{const r=Vl(t),s=r.presentationTime||0,a=n.timescale||1,o=r.duration||0,l=s/a+e.attributes.start;return{schemeIdUri:i,value:n.value,id:r.id,start:l,end:l+o/a,messageData:Bl(t)||r.messageData,contentEncoding:n.contentEncoding,presentationTimeOffset:n.presentationTimeOffset||0}}))}))),Kl=(e,t,n)=>i=>{const r=Vl(i),s=ql(t,Fl(i,"BaseURL")),a=Fl(i,"Role")[0],o={role:Vl(a)};let l=Zo(e,r,o);const u=Fl(i,"Accessibility")[0],c=(e=>{if("urn:scte:dash:cc:cea-608:2015"===e.schemeIdUri)return("string"!==typeof e.value?[]:e.value.split(";")).map((e=>{let t,n;return n=e,/^CC\d=/.test(e)?[t,n]=e.split("="):/^CC\d$/.test(e)&&(t=e),{channel:t,language:n}}));if("urn:scte:dash:cc:cea-708:2015"===e.schemeIdUri)return("string"!==typeof e.value?[]:e.value.split(";")).map((e=>{const t={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(e)){const[n,i=""]=e.split("=");t.channel=n,t.language=e,i.split(",").forEach((e=>{const[n,i]=e.split(":");"lang"===n?t.language=i:"er"===n?t.easyReader=Number(i):"war"===n?t.aspectRatio=Number(i):"3D"===n&&(t["3D"]=Number(i))}))}else t.language=e;return t.channel&&(t.channel="SERVICE"+t.channel),t}))})(Vl(u));c&&(l=Zo(l,{captionServices:c}));const d=Fl(i,"Label")[0];if(d&&d.childNodes.length){const e=d.childNodes[0].nodeValue.trim();l=Zo(l,{label:e})}const h=Fl(i,"ContentProtection").reduce(((e,t)=>{const n=Vl(t);n.schemeIdUri&&(n.schemeIdUri=n.schemeIdUri.toLowerCase());const i=Hl[n.schemeIdUri];if(i){e[i]={attributes:n};const r=Fl(t,"cenc:pssh")[0];if(r){const t=Bl(r);e[i].pssh=t&&To(t)}}return e}),{});Object.keys(h).length&&(l=Zo(l,{contentProtection:h}));const f=Gl(i),p=Fl(i,"Representation"),g=Zo(n,f);return tl(p.map(((e,t,n)=>i=>{const r=Fl(i,"BaseURL"),s=ql(t,r),a=Zo(e,Vl(i)),o=Gl(i);return s.map((e=>({segmentInfo:Zo(n,o),attributes:Zo(a,e)})))})(l,s,g)))},Wl=(e,t)=>(n,i)=>{const r=ql(t,Fl(n.node,"BaseURL")),s=Zo(e,{periodStart:n.attributes.start});"number"===typeof n.attributes.duration&&(s.periodDuration=n.attributes.duration);const a=Fl(n.node,"AdaptationSet"),o=Gl(n.node);return tl(a.map(Kl(s,r,o)))},Xl=(e,t)=>{if(e.length>1&&t({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!e.length)return null;const n=Zo({serverURL:Bl(e[0])},Vl(e[0]));return n.queryBeforeStart="true"===n.queryBeforeStart,n},Yl=e=>{if(""===e)throw new Error(rl);const t=new Qo.DOMParser;let n,i;try{n=t.parseFromString(e,"application/xml"),i=n&&"MPD"===n.documentElement.tagName?n.documentElement:null}catch(r){}if(!i||i&&i.getElementsByTagName("parsererror").length>0)throw new Error(sl);return i},Ql=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{manifestUri:n="",NOW:i=Date.now(),clientOffset:r=0,eventHandler:s=function(){}}=t,a=Fl(e,"Period");if(!a.length)throw new Error(il);const o=Fl(e,"Location"),l=Vl(e),u=ql([{baseUrl:n}],Fl(e,"BaseURL")),c=Fl(e,"ContentSteering");l.type=l.type||"static",l.sourceDuration=l.mediaPresentationDuration||0,l.NOW=i,l.clientOffset=r,o.length&&(l.locations=o.map(Bl));const d=[];return a.forEach(((e,t)=>{const n=Vl(e),i=d[t-1];n.start=(e=>{let{attributes:t,priorPeriodAttributes:n,mpdType:i}=e;return"number"===typeof t.start?t.start:n&&"number"===typeof n.start&&"number"===typeof n.duration?n.start+n.duration:n||"static"!==i?null:0})({attributes:n,priorPeriodAttributes:i?i.attributes:null,mpdType:l.type}),d.push({node:e,attributes:n})})),{locations:l.locations,contentSteeringInfo:Xl(c,s),representationInfo:tl(d.map(Wl(l,u))),eventStream:tl(d.map(zl))}}(Yl(e),t),i=n.representationInfo.map(Ul);return Ll({dashPlaylists:i,locations:n.locations,contentSteering:n.contentSteeringInfo,sidxMapping:t.sidxMapping,previousManifest:t.previousManifest,eventStream:n.eventStream})},Jl=e=>(e=>{const t=Fl(e,"UTCTiming")[0];if(!t)return null;const n=Vl(t);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;default:throw new Error(ll)}return n})(Yl(e));var Zl,eu=n(329),tu=n.n(eu),nu=qo([73,68,51]),iu=function e(t,n){return void 0===n&&(n=0),(t=qo(t)).length-n<10||!Yo(t,nu,{offset:n})?n:(n+=function(e,t){void 0===t&&(t=0);var n=(e=qo(e))[t+5],i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&n)>>4?i+20:i+10}(t,n),e(t,n))},ru=(new Uint8Array([79,112,117,115,72,101,97,100]),function(e){return"string"===typeof e?Xo(e):e}),su=function(e){e=qo(e);for(var t=[],n=0;e.length>n;){var i=e[n],r=0,s=0,a=e[++s];for(s++;128&a;)r=(127&a)<<7,a=e[s],s++;r+=127&a;for(var o=0;o<Zl.length;o++){var l=Zl[o],u=l.id,c=l.parser;if(i===u){t.push(c(e.subarray(s,s+r)));break}}n+=r+s}return t};Zl=[{id:3,parser:function(e){var t={tag:3,id:e[0]<<8|e[1],flags:e[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(128&t.flags&&(t.dependsOnEsId=e[t.size]<<8|e[t.size+1],t.size+=2),64&t.flags){var n=e[t.size];t.url=function(e){if(!e)return"";e=Array.prototype.slice.call(e);var t=String.fromCharCode.apply(null,qo(e));try{return decodeURIComponent(escape(t))}catch(n){}return t}(e.subarray(t.size+1,t.size+1+n)),t.size+=n}return 32&t.flags&&(t.ocrEsId=e[t.size]<<8|e[t.size+1],t.size+=2),t.descriptors=su(e.subarray(t.size))||[],t}},{id:4,parser:function(e){return{tag:4,oti:e[0],streamType:e[1],bufferSize:e[2]<<16|e[3]<<8|e[4],maxBitrate:e[5]<<24|e[6]<<16|e[7]<<8|e[8],avgBitrate:e[9]<<24|e[10]<<16|e[11]<<8|e[12],descriptors:su(e.subarray(13))}}},{id:5,parser:function(e){return{tag:5,bytes:e}}},{id:6,parser:function(e){return{tag:6,bytes:e}}}];var au=function e(t,n,i){void 0===i&&(i=!1),n=function(e){return Array.isArray(e)?e.map((function(e){return ru(e)})):[ru(e)]}(n),t=qo(t);var r=[];if(!n.length)return r;for(var s=0;s<t.length;){var a=(t[s]<<24|t[s+1]<<16|t[s+2]<<8|t[s+3])>>>0,o=t.subarray(s+4,s+8);if(0===a)break;var l=s+a;if(l>t.length){if(i)break;l=t.length}var u=t.subarray(s+8,l);Yo(o,n[0])&&(1===n.length?r.push(u):r.push.apply(r,e(u,n.slice(1),i))),s=l}return r},ou={EBML:qo([26,69,223,163]),DocType:qo([66,130]),Segment:qo([24,83,128,103]),SegmentInfo:qo([21,73,169,102]),Tracks:qo([22,84,174,107]),Track:qo([174]),TrackNumber:qo([215]),DefaultDuration:qo([35,227,131]),TrackEntry:qo([174]),TrackType:qo([131]),FlagDefault:qo([136]),CodecID:qo([134]),CodecPrivate:qo([99,162]),VideoTrack:qo([224]),AudioTrack:qo([225]),Cluster:qo([31,67,182,117]),Timestamp:qo([231]),TimestampScale:qo([42,215,177]),BlockGroup:qo([160]),BlockDuration:qo([155]),Block:qo([161]),SimpleBlock:qo([163])},lu=[128,64,32,16,8,4,2,1],uu=function(e,t,n,i){void 0===n&&(n=!0),void 0===i&&(i=!1);var r=function(e){for(var t=1,n=0;n<lu.length&&!(e&lu[n]);n++)t++;return t}(e[t]),s=e.subarray(t,t+r);return n&&((s=Array.prototype.slice.call(e,t,t+r))[0]^=lu[r-1]),{length:r,value:Ko(s,{signed:i}),bytes:s}},cu=function e(t){return"string"===typeof t?t.match(/.{1,2}/g).map((function(t){return e(t)})):"number"===typeof t?Wo(t):t},du=function e(t,n,i){if(i>=n.length)return n.length;var r=uu(n,i,!1);if(Yo(t.bytes,r.bytes))return i;var s=uu(n,i+r.length);return e(t,n,i+s.length+s.value+r.length)},hu=function e(t,n){n=function(e){return Array.isArray(e)?e.map((function(e){return cu(e)})):[cu(e)]}(n),t=qo(t);var i=[];if(!n.length)return i;for(var r=0;r<t.length;){var s=uu(t,r,!1),a=uu(t,r+s.length),o=r+s.length+a.length;127===a.value&&(a.value=du(s,t,o),a.value!==t.length&&(a.value-=o));var l=o+a.value>t.length?t.length:o+a.value,u=t.subarray(o,l);Yo(n[0],s.bytes)&&(1===n.length?i.push(u):i=i.concat(e(u,n.slice(1)))),r+=s.length+a.length+u.length}return i},fu=qo([0,0,0,1]),pu=qo([0,0,1]),gu=qo([0,0,3]),mu=function(e){for(var t=[],n=1;n<e.length-2;)Yo(e.subarray(n,n+3),gu)&&(t.push(n+2),n++),n++;if(0===t.length)return e;var i=e.length-t.length,r=new Uint8Array(i),s=0;for(n=0;n<i;s++,n++)s===t[0]&&(s++,t.shift()),r[n]=e[s];return r},yu=function(e,t,n,i){void 0===i&&(i=1/0),e=qo(e),n=[].concat(n);for(var r,s=0,a=0;s<e.length&&(a<i||r);){var o=void 0;if(Yo(e.subarray(s),fu)?o=4:Yo(e.subarray(s),pu)&&(o=3),o){if(a++,r)return mu(e.subarray(r,s));var l=void 0;"h264"===t?l=31&e[s+o]:"h265"===t&&(l=e[s+o]>>1&63),-1!==n.indexOf(l)&&(r=s+o),s+=o+("h264"===t?1:2)}else s++}return e.subarray(0,0)},vu={webm:qo([119,101,98,109]),matroska:qo([109,97,116,114,111,115,107,97]),flac:qo([102,76,97,67]),ogg:qo([79,103,103,83]),ac3:qo([11,119]),riff:qo([82,73,70,70]),avi:qo([65,86,73]),wav:qo([87,65,86,69]),"3gp":qo([102,116,121,112,51,103]),mp4:qo([102,116,121,112]),fmp4:qo([115,116,121,112]),mov:qo([102,116,121,112,113,116]),moov:qo([109,111,111,118]),moof:qo([109,111,111,102])},bu={aac:function(e){var t=iu(e);return Yo(e,[255,16],{offset:t,mask:[255,22]})},mp3:function(e){var t=iu(e);return Yo(e,[255,2],{offset:t,mask:[255,6]})},webm:function(e){var t=hu(e,[ou.EBML,ou.DocType])[0];return Yo(t,vu.webm)},mkv:function(e){var t=hu(e,[ou.EBML,ou.DocType])[0];return Yo(t,vu.matroska)},mp4:function(e){return!bu["3gp"](e)&&!bu.mov(e)&&(!(!Yo(e,vu.mp4,{offset:4})&&!Yo(e,vu.fmp4,{offset:4}))||(!(!Yo(e,vu.moof,{offset:4})&&!Yo(e,vu.moov,{offset:4}))||void 0))},mov:function(e){return Yo(e,vu.mov,{offset:4})},"3gp":function(e){return Yo(e,vu["3gp"],{offset:4})},ac3:function(e){var t=iu(e);return Yo(e,vu.ac3,{offset:t})},ts:function(e){if(e.length<189&&e.length>=1)return 71===e[0];for(var t=0;t+188<e.length&&t<188;){if(71===e[t]&&71===e[t+188])return!0;t+=1}return!1},flac:function(e){var t=iu(e);return Yo(e,vu.flac,{offset:t})},ogg:function(e){return Yo(e,vu.ogg)},avi:function(e){return Yo(e,vu.riff)&&Yo(e,vu.avi,{offset:8})},wav:function(e){return Yo(e,vu.riff)&&Yo(e,vu.wav,{offset:8})},h264:function(e){return function(e,t,n){return yu(e,"h264",t,n)}(e,7,3).length},h265:function(e){return function(e,t,n){return yu(e,"h265",t,n)}(e,[32,33],3).length}},Tu=Object.keys(bu).filter((function(e){return"ts"!==e&&"h264"!==e&&"h265"!==e})).concat(["ts","h264","h265"]);Tu.forEach((function(e){var t=bu[e];bu[e]=function(e){return t(qo(e))}}));var Su=bu,_u=function(e){e=qo(e);for(var t=0;t<Tu.length;t++){var n=Tu[t];if(Su[n](e))return n}return""},wu=n(403),Eu="8.21.0";const ku={},xu=function(e,t){return ku[e]=ku[e]||[],t&&(ku[e]=ku[e].concat(t)),ku[e]},Au=function(e,t){const n=xu(e).indexOf(t);return!(n<=-1)&&(ku[e]=ku[e].slice(),ku[e].splice(n,1),!0)},Cu={prefixed:!0},Iu=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],Lu=Iu[0];let Du;for(let n=0;n<Iu.length;n++)if(Iu[n][1]in co()){Du=Iu[n];break}if(Du){for(let e=0;e<Du.length;e++)Cu[Lu[e]]=Du[e];Cu.prefixed=Du[0]!==Lu[0]}let Ru=[];const Mu=function e(t){let n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:":",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s="info";function a(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n("log",s,t)}return n=((e,t,n)=>(i,r,s)=>{const a=t.levels[r],o=new RegExp(`^(${a})$`);let l=e;if("log"!==i&&s.unshift(i.toUpperCase()+":"),n&&(l=`%c${e}`,s.unshift(n)),s.unshift(l+":"),Ru){Ru.push([].concat(s));const e=Ru.length-1e3;Ru.splice(0,e>0?e:0)}if(!lo().console)return;let u=lo().console[i];u||"debug"!==i||(u=lo().console.info||lo().console.log),u&&a&&o.test(i)&&u[Array.isArray(s)?"apply":"call"](lo().console,s)})(t,a,r),a.createLogger=(n,s,a)=>{const o=void 0!==s?s:i;return e(`${t} ${o} ${n}`,o,void 0!==a?a:r)},a.createNewLogger=(t,n,i)=>e(t,n,i),a.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:s},a.level=e=>{if("string"===typeof e){if(!a.levels.hasOwnProperty(e))throw new Error(`"${e}" in not a valid log level`);s=e}return s},a.history=()=>Ru?[].concat(Ru):[],a.history.filter=e=>(Ru||[]).filter((t=>new RegExp(`.*${e}.*`).test(t[0]))),a.history.clear=()=>{Ru&&(Ru.length=0)},a.history.disable=()=>{null!==Ru&&(Ru.length=0,Ru=null)},a.history.enable=()=>{null===Ru&&(Ru=[])},a.error=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n("error",s,t)},a.warn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n("warn",s,t)},a.debug=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n("debug",s,t)},a}("VIDEOJS"),Pu=Mu.createLogger,Ou=Object.prototype.toString,Nu=function(e){return Bu(e)?Object.keys(e):[]};function Uu(e,t){Nu(e).forEach((n=>t(e[n],n)))}function Fu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Nu(e).reduce(((n,i)=>t(n,e[i],i)),n)}function Bu(e){return!!e&&"object"===typeof e}function ju(e){return Bu(e)&&"[object Object]"===Ou.call(e)&&e.constructor===Object}function $u(){const e={};for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach((t=>{t&&Uu(t,((t,n)=>{ju(t)?(ju(e[n])||(e[n]={}),e[n]=$u(e[n],t)):e[n]=t}))})),e}function Vu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];t.push(i)}return t}function Hu(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=n=>Object.defineProperty(e,t,{value:n,enumerable:!0,writable:!0}),s={configurable:!0,enumerable:!0,get(){const e=n();return r(e),e}};return i&&(s.set=r),Object.defineProperty(e,t,s)}var qu=Object.freeze({__proto__:null,each:Uu,reduce:Fu,isObject:Bu,isPlain:ju,merge:$u,values:Vu,defineLazyProperty:Hu});let Gu,zu=!1,Ku=null,Wu=!1,Xu=!1,Yu=!1,Qu=!1,Ju=!1,Zu=null,ec=null;const tc=Boolean(lo().cast&&lo().cast.framework&&lo().cast.framework.CastReceiverContext);let nc=null,ic=!1,rc=!1,sc=!1,ac=!1,oc=!1,lc=!1,uc=!1;const cc=Boolean(mc()&&("ontouchstart"in lo()||lo().navigator.maxTouchPoints||lo().DocumentTouch&&lo().document instanceof lo().DocumentTouch)),dc=lo().navigator&&lo().navigator.userAgentData;if(dc&&dc.platform&&dc.brands&&(Wu="Android"===dc.platform,Yu=Boolean(dc.brands.find((e=>"Microsoft Edge"===e.brand))),Qu=Boolean(dc.brands.find((e=>"Chromium"===e.brand))),Ju=!Yu&&Qu,Zu=ec=(dc.brands.find((e=>"Chromium"===e.brand))||{}).version||null,rc="Windows"===dc.platform),!Qu){const e=lo().navigator&&lo().navigator.userAgent||"";zu=/iPod/i.test(e),Ku=function(){const t=e.match(/OS (\d+)_/i);return t&&t[1]?t[1]:null}(),Wu=/Android/i.test(e),Gu=function(){const t=e.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!t)return null;const n=t[1]&&parseFloat(t[1]),i=t[2]&&parseFloat(t[2]);return n&&i?parseFloat(t[1]+"."+t[2]):n||null}(),Xu=/Firefox/i.test(e),Yu=/Edg/i.test(e),Qu=/Chrome/i.test(e)||/CriOS/i.test(e),Ju=!Yu&&Qu,Zu=ec=function(){const t=e.match(/(Chrome|CriOS)\/(\d+)/);return t&&t[2]?parseFloat(t[2]):null}(),nc=function(){const t=/MSIE\s(\d+)\.\d/.exec(e);let n=t&&parseFloat(t[1]);return!n&&/Trident\/7.0/i.test(e)&&/rv:11.0/.test(e)&&(n=11),n}(),oc=/Tizen/i.test(e),lc=/Web0S/i.test(e),uc=oc||lc,ic=/Safari/i.test(e)&&!Ju&&!Wu&&!Yu&&!uc,rc=/Windows/i.test(e),sc=/iPad/i.test(e)||ic&&cc&&!/iPhone/i.test(e),ac=/iPhone/i.test(e)&&!sc}const hc=ac||sc||zu,fc=(ic||hc)&&!Ju;var pc=Object.freeze({__proto__:null,get IS_IPOD(){return zu},get IOS_VERSION(){return Ku},get IS_ANDROID(){return Wu},get ANDROID_VERSION(){return Gu},get IS_FIREFOX(){return Xu},get IS_EDGE(){return Yu},get IS_CHROMIUM(){return Qu},get IS_CHROME(){return Ju},get CHROMIUM_VERSION(){return Zu},get CHROME_VERSION(){return ec},IS_CHROMECAST_RECEIVER:tc,get IE_VERSION(){return nc},get IS_SAFARI(){return ic},get IS_WINDOWS(){return rc},get IS_IPAD(){return sc},get IS_IPHONE(){return ac},get IS_TIZEN(){return oc},get IS_WEBOS(){return lc},get IS_SMART_TV(){return uc},TOUCH_ENABLED:cc,IS_IOS:hc,IS_ANY_SAFARI:fc});function gc(e){return"string"===typeof e&&Boolean(e.trim())}function mc(){return co()===lo().document}function yc(e){return Bu(e)&&1===e.nodeType}function vc(){try{return lo().parent!==lo().self}catch(e){return!0}}function bc(e){return function(t,n){if(!gc(t))return co()[e](null);gc(n)&&(n=co().querySelector(n));const i=yc(n)?n:co();return i[e]&&i[e](t)}}function Tc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;const r=co().createElement(e);return Object.getOwnPropertyNames(t).forEach((function(e){const n=t[e];"textContent"===e?Sc(r,n):r[e]===n&&"tabIndex"!==e||(r[e]=n)})),Object.getOwnPropertyNames(n).forEach((function(e){r.setAttribute(e,n[e])})),i&&jc(r,i),r}function Sc(e,t){return"undefined"===typeof e.textContent?e.innerText=t:e.textContent=t,e}function _c(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function wc(e,t){return function(e){if(e.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}(t),e.classList.contains(t)}function Ec(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.classList.add(...n.reduce(((e,t)=>e.concat(t.split(/\s+/))),[])),e}function kc(e){if(!e)return Mu.warn("removeClass was called with an element that doesn't exist"),null;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.classList.remove(...n.reduce(((e,t)=>e.concat(t.split(/\s+/))),[])),e}function xc(e,t,n){return"function"===typeof n&&(n=n(e,t)),"boolean"!==typeof n&&(n=void 0),t.split(/\s+/).forEach((t=>e.classList.toggle(t,n))),e}function Ac(e,t){Object.getOwnPropertyNames(t).forEach((function(n){const i=t[n];null===i||"undefined"===typeof i||!1===i?e.removeAttribute(n):e.setAttribute(n,!0===i?"":i)}))}function Cc(e){const t={},n=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(e&&e.attributes&&e.attributes.length>0){const i=e.attributes;for(let e=i.length-1;e>=0;e--){const r=i[e].name;let s=i[e].value;n.includes(r)&&(s=null!==s),t[r]=s}}return t}function Ic(e,t){return e.getAttribute(t)}function Lc(e,t,n){e.setAttribute(t,n)}function Dc(e,t){e.removeAttribute(t)}function Rc(){co().body.focus(),co().onselectstart=function(){return!1}}function Mc(){co().onselectstart=function(){return!0}}function Pc(e){if(e&&e.getBoundingClientRect&&e.parentNode){const t=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach((e=>{void 0!==t[e]&&(n[e]=t[e])})),n.height||(n.height=parseFloat(Gc(e,"height"))),n.width||(n.width=parseFloat(Gc(e,"width"))),n}}function Oc(e){if(!e||e&&!e.offsetParent)return{left:0,top:0,width:0,height:0};const t=e.offsetWidth,n=e.offsetHeight;let i=0,r=0;for(;e.offsetParent&&e!==co()[Cu.fullscreenElement];)i+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent;return{left:i,top:r,width:t,height:n}}function Nc(e,t){const n={x:0,y:0};if(hc){let t=e;for(;t&&"html"!==t.nodeName.toLowerCase();){const e=Gc(t,"transform");if(/^matrix/.test(e)){const t=e.slice(7,-1).split(/,\s/).map(Number);n.x+=t[4],n.y+=t[5]}else if(/^matrix3d/.test(e)){const t=e.slice(9,-1).split(/,\s/).map(Number);n.x+=t[12],n.y+=t[13]}if(t.assignedSlot&&t.assignedSlot.parentElement&&lo().WebKitCSSMatrix){const e=lo().getComputedStyle(t.assignedSlot.parentElement).transform,i=new(lo().WebKitCSSMatrix)(e);n.x+=i.m41,n.y+=i.m42}t=t.parentNode||t.host}}const i={},r=Oc(t.target),s=Oc(e),a=s.width,o=s.height;let l=t.offsetY-(s.top-r.top),u=t.offsetX-(s.left-r.left);return t.changedTouches&&(u=t.changedTouches[0].pageX-s.left,l=t.changedTouches[0].pageY+s.top,hc&&(u-=n.x,l-=n.y)),i.y=1-Math.max(0,Math.min(1,l/o)),i.x=Math.max(0,Math.min(1,u/a)),i}function Uc(e){return Bu(e)&&3===e.nodeType}function Fc(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function Bc(e){return"function"===typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map((e=>("function"===typeof e&&(e=e()),yc(e)||Uc(e)?e:"string"===typeof e&&/\S/.test(e)?co().createTextNode(e):void 0))).filter((e=>e))}function jc(e,t){return Bc(t).forEach((t=>e.appendChild(t))),e}function $c(e,t){return jc(Fc(e),t)}function Vc(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||("mouseup"===e.type&&0===e.button&&0===e.buttons||("mousedown"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons)))}const Hc=bc("querySelector"),qc=bc("querySelectorAll");function Gc(e,t){if(!e||!t)return"";if("function"===typeof lo().getComputedStyle){let i;try{i=lo().getComputedStyle(e)}catch(n){return""}return i?i.getPropertyValue(t)||i[t]:""}return""}function zc(e){[...co().styleSheets].forEach((t=>{try{const n=[...t.cssRules].map((e=>e.cssText)).join(""),i=co().createElement("style");i.textContent=n,e.document.head.appendChild(i)}catch(n){const i=co().createElement("link");i.rel="stylesheet",i.type=t.type,i.media=t.media.mediaText,i.href=t.href,e.document.head.appendChild(i)}}))}var Kc=Object.freeze({__proto__:null,isReal:mc,isEl:yc,isInFrame:vc,createEl:Tc,textContent:Sc,prependTo:_c,hasClass:wc,addClass:Ec,removeClass:kc,toggleClass:xc,setAttributes:Ac,getAttributes:Cc,getAttribute:Ic,setAttribute:Lc,removeAttribute:Dc,blockTextSelection:Rc,unblockTextSelection:Mc,getBoundingClientRect:Pc,findPosition:Oc,getPointerPosition:Nc,isTextNode:Uc,emptyEl:Fc,normalizeContent:Bc,appendContent:jc,insertContent:$c,isSingleLeftClick:Vc,$:Hc,$$:qc,computedStyle:Gc,copyStyleSheetsToWindow:zc});let Wc,Xc=!1;const Yc=function(){if(!1===Wc.options.autoSetup)return;const e=Array.prototype.slice.call(co().getElementsByTagName("video")),t=Array.prototype.slice.call(co().getElementsByTagName("audio")),n=Array.prototype.slice.call(co().getElementsByTagName("video-js")),i=e.concat(t,n);if(i&&i.length>0)for(let r=0,s=i.length;r<s;r++){const e=i[r];if(!e||!e.getAttribute){Qc(1);break}if(void 0===e.player){null!==e.getAttribute("data-setup")&&Wc(e)}}else Xc||Qc(1)};function Qc(e,t){mc()&&(t&&(Wc=t),lo().setTimeout(Yc,e))}function Jc(){Xc=!0,lo().removeEventListener("load",Jc)}mc()&&("complete"===co().readyState?Jc():lo().addEventListener("load",Jc));const Zc=function(e){const t=co().createElement("style");return t.className=e,t},ed=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t};var td=new WeakMap;let nd,id=3;function rd(){return id++}function sd(e,t){if(!td.has(e))return;const n=td.get(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&td.delete(e)}function ad(e,t,n,i){n.forEach((function(n){e(t,n,i)}))}function od(e){if(e.fixed_)return e;function t(){return!0}function n(){return!1}if(!e||!e.isPropagationStopped||!e.isImmediatePropagationStopped){const i=e||lo().event;e={};const r=["layerX","layerY","keyLocation","path","webkitMovementX","webkitMovementY","mozPressure","mozInputSource"];for(const t in i)r.includes(t)||"returnValue"===t&&i.preventDefault||(e[t]=i[t]);if(e.target||(e.target=e.srcElement||co()),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){i.preventDefault&&i.preventDefault(),e.returnValue=!1,i.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),e.cancelBubble=!0,i.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=n,e.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=n,null!==e.clientX&&void 0!==e.clientX){const t=co().documentElement,n=co().body;e.pageX=e.clientX+(t&&t.scrollLeft||n&&n.scrollLeft||0)-(t&&t.clientLeft||n&&n.clientLeft||0),e.pageY=e.clientY+(t&&t.scrollTop||n&&n.scrollTop||0)-(t&&t.clientTop||n&&n.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e.fixed_=!0,e}const ld=["touchstart","touchmove"];function ud(e,t,n){if(Array.isArray(t))return ad(ud,e,t,n);td.has(e)||td.set(e,{});const i=td.get(e);if(i.handlers||(i.handlers={}),i.handlers[t]||(i.handlers[t]=[]),n.guid||(n.guid=rd()),i.handlers[t].push(n),i.dispatcher||(i.disabled=!1,i.dispatcher=function(t,n){if(i.disabled)return;t=od(t);const r=i.handlers[t.type];if(r){const i=r.slice(0);for(let r=0,a=i.length;r<a&&!t.isImmediatePropagationStopped();r++)try{i[r].call(e,t,n)}catch(s){Mu.error(s)}}}),1===i.handlers[t].length)if(e.addEventListener){let n=!1;(function(){if("boolean"!==typeof nd){nd=!1;try{const e=Object.defineProperty({},"passive",{get(){nd=!0}});lo().addEventListener("test",null,e),lo().removeEventListener("test",null,e)}catch(e){}}return nd})()&&ld.indexOf(t)>-1&&(n={passive:!0}),e.addEventListener(t,i.dispatcher,n)}else e.attachEvent&&e.attachEvent("on"+t,i.dispatcher)}function cd(e,t,n){if(!td.has(e))return;const i=td.get(e);if(!i.handlers)return;if(Array.isArray(t))return ad(cd,e,t,n);const r=function(e,t){i.handlers[t]=[],sd(e,t)};if(void 0===t){for(const t in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},t)&&r(e,t);return}const s=i.handlers[t];if(s)if(n){if(n.guid)for(let e=0;e<s.length;e++)s[e].guid===n.guid&&s.splice(e--,1);sd(e,t)}else r(e,t)}function dd(e,t,n){const i=td.has(e)?td.get(e):{},r=e.parentNode||e.ownerDocument;if("string"===typeof t?t={type:t,target:e}:t.target||(t.target=e),t=od(t),i.dispatcher&&i.dispatcher.call(e,t,n),r&&!t.isPropagationStopped()&&!0===t.bubbles)dd.call(null,r,t,n);else if(!r&&!t.defaultPrevented&&t.target&&t.target[t.type]){td.has(t.target)||td.set(t.target,{});const e=td.get(t.target);t.target[t.type]&&(e.disabled=!0,"function"===typeof t.target[t.type]&&t.target[t.type](),e.disabled=!1)}return!t.defaultPrevented}function hd(e,t,n){if(Array.isArray(t))return ad(hd,e,t,n);const i=function(){cd(e,t,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||rd(),ud(e,t,i)}function fd(e,t,n){const i=function(){cd(e,t,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||rd(),ud(e,t,i)}var pd=Object.freeze({__proto__:null,fixEvent:od,on:ud,off:cd,trigger:dd,one:hd,any:fd});const gd=30,md=function(e,t,n){t.guid||(t.guid=rd());const i=t.bind(e);return i.guid=n?n+"_"+t.guid:t.guid,i},yd=function(e,t){let n=lo().performance.now();return function(){const i=lo().performance.now();i-n>=t&&(e(...arguments),n=i)}},vd=function(e,t,n){let i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:lo();const s=function(){const s=this,a=arguments;let o=function(){i=null,o=null,n||e.apply(s,a)};!i&&n&&e.apply(s,a),r.clearTimeout(i),i=r.setTimeout(o,t)};return s.cancel=()=>{r.clearTimeout(i),i=null},s};var bd=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:gd,bind_:md,throttle:yd,debounce:vd});let Td;class Sd{on(e,t){const n=this.addEventListener;this.addEventListener=()=>{},ud(this,e,t),this.addEventListener=n}off(e,t){cd(this,e,t)}one(e,t){const n=this.addEventListener;this.addEventListener=()=>{},hd(this,e,t),this.addEventListener=n}any(e,t){const n=this.addEventListener;this.addEventListener=()=>{},fd(this,e,t),this.addEventListener=n}trigger(e){const t=e.type||e;"string"===typeof e&&(e={type:t}),e=od(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),dd(this,e)}queueTrigger(e){Td||(Td=new Map);const t=e.type||e;let n=Td.get(this);n||(n=new Map,Td.set(this,n));const i=n.get(t);n.delete(t),lo().clearTimeout(i);const r=lo().setTimeout((()=>{n.delete(t),0===n.size&&(n=null,Td.delete(this)),this.trigger(e)}),0);n.set(t,r)}}Sd.prototype.allowedEvents_={},Sd.prototype.addEventListener=Sd.prototype.on,Sd.prototype.removeEventListener=Sd.prototype.off,Sd.prototype.dispatchEvent=Sd.prototype.trigger;const _d=e=>"function"===typeof e.name?e.name():"string"===typeof e.name?e.name:e.name_?e.name_:e.constructor&&e.constructor.name?e.constructor.name:typeof e,wd=e=>e instanceof Sd||!!e.eventBusEl_&&["on","one","off","trigger"].every((t=>"function"===typeof e[t])),Ed=e=>"string"===typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length,kd=(e,t,n)=>{if(!e||!e.nodeName&&!wd(e))throw new Error(`Invalid target for ${_d(t)}#${n}; must be a DOM node or evented object.`)},xd=(e,t,n)=>{if(!Ed(e))throw new Error(`Invalid event type for ${_d(t)}#${n}; must be a non-empty string or array.`)},Ad=(e,t,n)=>{if("function"!==typeof e)throw new Error(`Invalid listener for ${_d(t)}#${n}; must be a function.`)},Cd=(e,t,n)=>{const i=t.length<3||t[0]===e||t[0]===e.eventBusEl_;let r,s,a;return i?(r=e.eventBusEl_,t.length>=3&&t.shift(),[s,a]=t):(r=t[0],s=t[1],a=t[2]),kd(r,e,n),xd(s,e,n),Ad(a,e,n),a=md(e,a),{isTargetingSelf:i,target:r,type:s,listener:a}},Id=(e,t,n,i)=>{kd(e,e,t),e.nodeName?pd[t](e,n,i):e[t](n,i)},Ld={on(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const{isTargetingSelf:i,target:r,type:s,listener:a}=Cd(this,t,"on");if(Id(r,"on",s,a),!i){const e=()=>this.off(r,s,a);e.guid=a.guid;const t=()=>this.off("dispose",e);t.guid=a.guid,Id(this,"on","dispose",e),Id(r,"on","dispose",t)}},one(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];const{isTargetingSelf:r,target:s,type:a,listener:o}=Cd(this,n,"one");if(r)Id(s,"one",a,o);else{const t=function(){e.off(s,a,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];o.apply(null,i)};t.guid=o.guid,Id(s,"one",a,t)}},any(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];const{isTargetingSelf:r,target:s,type:a,listener:o}=Cd(this,n,"any");if(r)Id(s,"any",a,o);else{const t=function(){e.off(s,a,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];o.apply(null,i)};t.guid=o.guid,Id(s,"any",a,t)}},off(e,t,n){if(!e||Ed(e))cd(this.eventBusEl_,e,t);else{const i=e,r=t;kd(i,this,"off"),xd(r,this,"off"),Ad(n,this,"off"),n=md(this,n),this.off("dispose",n),i.nodeName?(cd(i,r,n),cd(i,"dispose",n)):wd(i)&&(i.off(r,n),i.off("dispose",n))}},trigger(e,t){kd(this.eventBusEl_,this,"trigger");const n=e&&"string"!==typeof e?e.type:e;if(!Ed(n))throw new Error(`Invalid event type for ${_d(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return dd(this.eventBusEl_,e,t)}};function Dd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{eventBusKey:n}=t;if(n){if(!e[n].nodeName)throw new Error(`The eventBusKey "${n}" does not refer to an element.`);e.eventBusEl_=e[n]}else e.eventBusEl_=Tc("span",{className:"vjs-event-bus"});return Object.assign(e,Ld),e.eventedCallbacks&&e.eventedCallbacks.forEach((e=>{e()})),e.on("dispose",(()=>{e.off(),[e,e.el_,e.eventBusEl_].forEach((function(e){e&&td.has(e)&&td.delete(e)})),lo().setTimeout((()=>{e.eventBusEl_=null}),0)})),e}const Rd={state:{},setState(e){let t;return"function"===typeof e&&(e=e()),Uu(e,((e,n)=>{this.state[n]!==e&&(t=t||{},t[n]={from:this.state[n],to:e}),this.state[n]=e})),t&&wd(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function Md(e,t){return Object.assign(e,Rd),e.state=Object.assign({},e.state,t),"function"===typeof e.handleStateChanged&&wd(e)&&e.on("statechanged",e.handleStateChanged),e}const Pd=function(e){return"string"!==typeof e?e:e.replace(/./,(e=>e.toLowerCase()))},Od=function(e){return"string"!==typeof e?e:e.replace(/./,(e=>e.toUpperCase()))},Nd=function(e,t){return Od(e)===Od(t)};var Ud=Object.freeze({__proto__:null,toLowerCase:Pd,toTitleCase:Od,titleCaseEquals:Nd});class Fd{constructor(e,t,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=$u({},this.options_),t=this.options_=$u(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){const t=e&&e.id&&e.id()||"no_player";this.id_=`${t}_component_${rd()}`}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),t.className&&this.el_&&t.className.split(" ").forEach((e=>this.addClass(e))),["on","off","one","any","trigger"].forEach((e=>{this[e]=void 0})),!1!==t.evented&&(Dd(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),Md(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,!1!==t.initChildren&&this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}dispose(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(e){return e?(this.options_=$u(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,t,n){return Tc(e,t,n)}localize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const i=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),s=r&&r[i],a=i&&i.split("-")[0],o=r&&r[a];let l=n;return s&&s[e]?l=s[e]:o&&o[e]&&(l=o[e]),t&&(l=l.replace(/\{(\d+)\}/g,(function(e,n){const i=t[n-1];let r=i;return"undefined"===typeof i&&(r=e),r}))),l}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(e)return this.childNameIndex_[e]}getDescendant(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t.reduce(((e,t)=>e.concat(t)),[]);let i=this;for(let r=0;r<t.length;r++)if(i=i.getChild(t[r]),!i||!i.getChild)return;return i}setIcon(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.el();if(!this.player_.options_.experimentalSvgIcons)return;const n="http://www.w3.org/2000/svg",i=Tc("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),r=co().createElementNS(n,"svg");r.setAttributeNS(null,"viewBox","0 0 512 512");const s=co().createElementNS(n,"use");return r.appendChild(s),s.setAttributeNS(null,"href",`#vjs-icon-${e}`),i.appendChild(r),this.iconIsSet_?t.replaceChild(i,t.querySelector(".vjs-icon-placeholder")):t.appendChild(i),this.iconIsSet_=!0,i}addChild(e){let t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.children_.length;if("string"===typeof e){n=Od(e);const r=i.componentClass||n;i.name=n;const s=Fd.getComponent(r);if(!s)throw new Error(`Component ${r} does not exist`);if("function"!==typeof s)return null;t=new s(this.player_||this,i)}else t=e;if(t.parentComponent_&&t.parentComponent_.removeChild(t),this.children_.splice(r,0,t),t.parentComponent_=this,"function"===typeof t.id&&(this.childIndex_[t.id()]=t),n=n||t.name&&Od(t.name()),n&&(this.childNameIndex_[n]=t,this.childNameIndex_[Pd(n)]=t),"function"===typeof t.el&&t.el()){let e=null;this.children_[r+1]&&(this.children_[r+1].el_?e=this.children_[r+1].el_:yc(this.children_[r+1])&&(e=this.children_[r+1])),this.contentEl().insertBefore(t.el(),e)}return t}removeChild(e){if("string"===typeof e&&(e=this.getChild(e)),!e||!this.children_)return;let t=!1;for(let i=this.children_.length-1;i>=0;i--)if(this.children_[i]===e){t=!0,this.children_.splice(i,1);break}if(!t)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Od(e.name())]=null,this.childNameIndex_[Pd(e.name())]=null;const n=e.el();n&&n.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const t=this.options_,n=e=>{const n=e.name;let i=e.opts;if(void 0!==t[n]&&(i=t[n]),!1===i)return;!0===i&&(i={}),i.playerOptions=this.options_.playerOptions;const r=this.addChild(n,i);r&&(this[n]=r)};let i;const r=Fd.getComponent("Tech");i=Array.isArray(e)?e:Object.keys(e),i.concat(Object.keys(this.options_).filter((function(e){return!i.some((function(t){return"string"===typeof t?e===t:e===t.name}))}))).map((t=>{let n,i;return"string"===typeof t?(n=t,i=e[n]||this.options_[n]||{}):(n=t.name,i=t),{name:n,opts:i}})).filter((e=>{const t=Fd.getComponent(e.opts.componentClass||Od(e.name));return t&&!r.isTech(t)})).forEach(n)}}buildCSSClass(){return""}ready(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))}triggerReady(){this.isReady_=!0,this.setTimeout((function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach((function(e){e.call(this)}),this),this.trigger("ready")}),1)}$(e,t){return Hc(e,t||this.contentEl())}$$(e,t){return qc(e,t||this.contentEl())}hasClass(e){return wc(this.el_,e)}addClass(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Ec(this.el_,...t)}removeClass(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];kc(this.el_,...t)}toggleClass(e,t){xc(this.el_,e,t)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return Ic(this.el_,e)}setAttribute(e,t){Lc(this.el_,e,t)}removeAttribute(e){Dc(this.el_,e)}width(e,t){return this.dimension("width",e,t)}height(e,t){return this.dimension("height",e,t)}dimensions(e,t){this.width(e,!0),this.height(t)}dimension(e,t,n){if(void 0!==t)return null!==t&&t===t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;const i=this.el_.style[e],r=i.indexOf("px");return-1!==r?parseInt(i.slice(0,r),10):parseInt(this.el_["offset"+Od(e)],10)}currentDimension(e){let t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=Gc(this.el_,e),t=parseFloat(t),0===t||isNaN(t)){const n=`offset${Od(e)}`;t=this.el_[n]}return t}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}getPositions(){const e=this.el_.getBoundingClientRect();return{boundingClientRect:{x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,right:e.right,bottom:e.bottom,left:e.left},center:{x:e.left+e.width/2,y:e.top+e.height/2,width:0,height:0,top:e.top+e.height/2,right:e.left+e.width/2,bottom:e.top+e.height/2,left:e.left+e.width/2}}}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&("Tab"===e.key||this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled||e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,t=null;let n;this.on("touchstart",(function(i){1===i.touches.length&&(t={pageX:i.touches[0].pageX,pageY:i.touches[0].pageY},e=lo().performance.now(),n=!0)})),this.on("touchmove",(function(e){if(e.touches.length>1)n=!1;else if(t){const i=e.touches[0].pageX-t.pageX,r=e.touches[0].pageY-t.pageY;Math.sqrt(i*i+r*r)>10&&(n=!1)}}));const i=function(){n=!1};this.on("touchleave",i),this.on("touchcancel",i),this.on("touchend",(function(i){if(t=null,!0===n){lo().performance.now()-e<200&&(i.preventDefault(),this.trigger("tap"))}}))}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=md(this.player(),this.player().reportUserActivity);let t;this.on("touchstart",(function(){e(),this.clearInterval(t),t=this.setInterval(e,250)}));const n=function(n){e(),this.clearInterval(t)};this.on("touchmove",e),this.on("touchend",n),this.on("touchcancel",n)}setTimeout(e,t){var n;return e=md(this,e),this.clearTimersOnDispose_(),n=lo().setTimeout((()=>{this.setTimeoutIds_.has(n)&&this.setTimeoutIds_.delete(n),e()}),t),this.setTimeoutIds_.add(n),n}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),lo().clearTimeout(e)),e}setInterval(e,t){e=md(this,e),this.clearTimersOnDispose_();const n=lo().setInterval(e,t);return this.setIntervalIds_.add(n),n}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),lo().clearInterval(e)),e}requestAnimationFrame(e){var t;return this.clearTimersOnDispose_(),e=md(this,e),t=lo().requestAnimationFrame((()=>{this.rafIds_.has(t)&&this.rafIds_.delete(t),e()})),this.rafIds_.add(t),t}requestNamedAnimationFrame(e,t){this.namedRafs_.has(e)&&this.cancelNamedAnimationFrame(e),this.clearTimersOnDispose_(),t=md(this,t);const n=this.requestAnimationFrame((()=>{t(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)}));return this.namedRafs_.set(e,n),e}cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),lo().cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",(()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((e=>{let[t,n]=e;this[t].forEach(((e,t)=>this[n](t)))})),this.clearingTimersOnDispose_=!1})))}getIsDisabled(){return Boolean(this.el_.disabled)}getIsExpresslyInert(){return this.el_.inert&&!this.el_.ownerDocument.documentElement.inert}getIsFocusable(e){return(e||this.el_).tabIndex>=0&&!(this.getIsDisabled()||this.getIsExpresslyInert())}getIsAvailableToBeFocused(e){function t(e){const t=lo().getComputedStyle(e,null),n=t.getPropertyValue("visibility");return"none"!==t.getPropertyValue("display")&&!["hidden","collapse"].includes(n)}return e||(e=this.el()),!!(function(e){if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(co().documentElement.clientWidth||lo().innerWidth))return!1;if(t.y<0)return!1;if(t.y>(co().documentElement.clientHeight||lo().innerHeight))return!1;let n=co().elementFromPoint(t.x,t.y);for(;n;){if(n===e)return!0;if(!n.parentNode)return!1;n=n.parentNode}}(e)&&(n=e,t(n.parentElement)&&t(n)&&"0"!==n.style.opacity&&"0px"!==lo().getComputedStyle(n).height&&"0px"!==lo().getComputedStyle(n).width)&&(!e.parentElement||e.tabIndex>=0));var n}static registerComponent(e,t){if("string"!==typeof e||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const n=Fd.getComponent("Tech"),i=n&&n.isTech(t),r=Fd===t||Fd.prototype.isPrototypeOf(t.prototype);if(i||!r){let t;throw t=i?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error(`Illegal component, "${e}"; ${t}.`)}e=Od(e),Fd.components_||(Fd.components_={});const s=Fd.getComponent("Player");if("Player"===e&&s&&s.players){const e=s.players,t=Object.keys(e);if(e&&t.length>0&&t.map((t=>e[t])).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return Fd.components_[e]=t,Fd.components_[Pd(e)]=t,t}static getComponent(e){if(e&&Fd.components_)return Fd.components_[e]}}function Bd(e,t,n,i){return function(e,t,n){if("number"!==typeof t||t<0||t>n)throw new Error(`Failed to execute '${e}' on 'TimeRanges': The index provided (${t}) is non-numeric or out of bounds (0-${n}).`)}(e,i,n.length-1),n[i][t]}function jd(e){let t;return t=void 0===e||0===e.length?{length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:Bd.bind(null,"start",0,e),end:Bd.bind(null,"end",1,e)},lo().Symbol&&lo().Symbol.iterator&&(t[lo().Symbol.iterator]=()=>(e||[]).values()),t}function $d(e,t){return Array.isArray(e)?jd(e):void 0===e||void 0===t?jd():jd([[e,t]])}Fd.registerComponent("Component",Fd);const Vd=function(e,t){e=e<0?0:e;let n=Math.floor(e%60),i=Math.floor(e/60%60),r=Math.floor(e/3600);const s=Math.floor(t/60%60),a=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(r=i=n="-"),r=r>0||a>0?r+":":"",i=((r||s>=10)&&i<10?"0"+i:i)+":",n=n<10?"0"+n:n,r+i+n};let Hd=Vd;function qd(e){Hd=e}function Gd(){Hd=Vd}function zd(e){return Hd(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e)}var Kd=Object.freeze({__proto__:null,createTimeRanges:$d,createTimeRange:$d,setFormatTime:qd,resetFormatTime:Gd,formatTime:zd});function Wd(e,t){let n,i,r=0;if(!t)return 0;e&&e.length||(e=$d(0,0));for(let s=0;s<e.length;s++)n=e.start(s),i=e.end(s),i>t&&(i=t),r+=i-n;return r/t}function Xd(e){if(e instanceof Xd)return e;"number"===typeof e?this.code=e:"string"===typeof e?this.message=e:Bu(e)&&("number"===typeof e.code&&(this.code=e.code),Object.assign(this,e)),this.message||(this.message=Xd.defaultMessages[this.code]||"")}function Yd(e){return void 0!==e&&null!==e&&"function"===typeof e.then}function Qd(e){Yd(e)&&e.then(null,(e=>{}))}Xd.prototype.code=0,Xd.prototype.message="",Xd.prototype.status=null,Xd.prototype.metadata=null,Xd.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Xd.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."},Xd.MEDIA_ERR_CUSTOM=0,Xd.prototype.MEDIA_ERR_CUSTOM=0,Xd.MEDIA_ERR_ABORTED=1,Xd.prototype.MEDIA_ERR_ABORTED=1,Xd.MEDIA_ERR_NETWORK=2,Xd.prototype.MEDIA_ERR_NETWORK=2,Xd.MEDIA_ERR_DECODE=3,Xd.prototype.MEDIA_ERR_DECODE=3,Xd.MEDIA_ERR_SRC_NOT_SUPPORTED=4,Xd.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED=4,Xd.MEDIA_ERR_ENCRYPTED=5,Xd.prototype.MEDIA_ERR_ENCRYPTED=5;const Jd=function(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(((t,n,i)=>(e[n]&&(t[n]=e[n]),t)),{cues:e.cues&&Array.prototype.map.call(e.cues,(function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}}))})};var Zd=function(e){const t=e.$$("track"),n=Array.prototype.map.call(t,(e=>e.track));return Array.prototype.map.call(t,(function(e){const t=Jd(e.track);return e.src&&(t.src=e.src),t})).concat(Array.prototype.filter.call(e.textTracks(),(function(e){return-1===n.indexOf(e)})).map(Jd))},eh=function(e,t){return e.forEach((function(e){const n=t.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach((e=>n.addCue(e)))})),t.textTracks()};const th="vjs-modal-dialog";class nh extends Fd{constructor(e,t){super(e,t),this.handleKeyDown_=e=>this.handleKeyDown(e),this.close_=e=>this.close(e),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=Tc("div",{className:`${th}-content`},{role:"document"}),this.descEl_=Tc("p",{className:`${th}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),Sc(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog","aria-live":"polite"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${th} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(this.opened_)return void(this.options_.fillAlways&&this.fill());const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}opened(e){return"boolean"===typeof e&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger({type:"modalclose",bubbles:!0}),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if("boolean"===typeof e){const t=this.closeable_=!!e;let n=this.getChild("closeButton");if(t&&!n){const e=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=e,this.on(n,"close",this.close_)}!t&&n&&(this.off(n,"close",this.close_),this.removeChild(n),n.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const t=this.contentEl(),n=t.parentNode,i=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(t),this.empty(),$c(t,e),this.trigger("modalfill"),i?n.insertBefore(t,i):n.appendChild(t);const r=this.getChild("closeButton");r&&n.appendChild(r.el_),this.trigger("aftermodalfill")}empty(){this.trigger("beforemodalempty"),Fc(this.contentEl()),this.trigger("modalempty")}content(e){return"undefined"!==typeof e&&(this.content_=e),this.content_}conditionalFocus_(){const e=co().activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(this.trigger({type:"modalKeydown",originalEvent:e,target:this,bubbles:!0}),e.stopPropagation(),"Escape"===e.key&&this.closeable())return e.preventDefault(),void this.close();if("Tab"!==e.key)return;const t=this.focusableEls_(),n=this.el_.querySelector(":focus");let i;for(let r=0;r<t.length;r++)if(n===t[r]){i=r;break}co().activeElement===this.el_&&(i=0),e.shiftKey&&0===i?(t[t.length-1].focus(),e.preventDefault()):e.shiftKey||i!==t.length-1||(t[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,(e=>(e instanceof lo().HTMLAnchorElement||e instanceof lo().HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof lo().HTMLInputElement||e instanceof lo().HTMLSelectElement||e instanceof lo().HTMLTextAreaElement||e instanceof lo().HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof lo().HTMLIFrameElement||e instanceof lo().HTMLObjectElement||e instanceof lo().HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")))}}nh.prototype.options_={pauseOnOpen:!0,temporary:!0},Fd.registerComponent("ModalDialog",nh);class ih extends Sd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let t=0;t<e.length;t++)this.addTrack(e[t])}addTrack(e){const t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},wd(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let t;for(let n=0,i=this.length;n<i;n++)if(this[n]===e){t=this[n],t.off&&t.off(),this.tracks_.splice(n,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})}getTrackById(e){let t=null;for(let n=0,i=this.length;n<i;n++){const i=this[n];if(i.id===e){t=i;break}}return t}}ih.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const n in ih.prototype.allowedEvents_)ih.prototype["on"+n]=null;const rh=function(e,t){for(let n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].enabled=!1)};const sh=function(e,t){for(let n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].selected=!1)};class ah extends ih{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(e.kind)&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class oh{constructor(e){oh.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const t=this.length||0;let n=0;const i=e.length;this.cues_=e,this.length_=e.length;const r=function(e){""+e in this||Object.defineProperty(this,""+e,{get(){return this.cues_[e]}})};if(t<i)for(n=t;n<i;n++)r.call(this,n)}getCueById(e){let t=null;for(let n=0,i=this.length;n<i;n++){const i=this[n];if(i.id===e){t=i;break}}return t}}const lh={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},uh={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},ch={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},dh={disabled:"disabled",hidden:"hidden",showing:"showing"};class hh extends Sd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super();const t={id:e.id||"vjs_track_"+rd(),kind:e.kind||"",language:e.language||""};let n=e.label||"";for(const i in t)Object.defineProperty(this,i,{get:()=>t[i],set(){}});Object.defineProperty(this,"label",{get:()=>n,set(e){e!==n&&(n=e,this.trigger("labelchange"))}})}}const fh=function(e){return new URL(e,co().baseURI)},ph=function(e){return new URL(e,co().baseURI).href},gh=function(e){if("string"===typeof e){const t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(t)return t.pop().toLowerCase()}return""},mh=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lo().location;return fh(e).origin!==t.origin};var yh=Object.freeze({__proto__:null,parseUrl:fh,getAbsoluteURL:ph,getFileExtension:gh,isCrossOrigin:mh});const vh=function(e,t){const n=new(lo().WebVTT.Parser)(lo(),lo().vttjs,lo().WebVTT.StringDecoder()),i=[];n.oncue=function(e){t.addCue(e)},n.onparsingerror=function(e){i.push(e)},n.onflush=function(){t.trigger({type:"loadeddata",target:t})},n.parse(e),i.length>0&&(lo().console&&lo().console.groupCollapsed&&lo().console.groupCollapsed(`Text Track parsing errors for ${t.src}`),i.forEach((e=>Mu.error(e))),lo().console&&lo().console.groupEnd&&lo().console.groupEnd()),n.flush()},bh=function(e,t){const n={uri:e},i=mh(e);i&&(n.cors=i);const r="use-credentials"===t.tech_.crossOrigin();r&&(n.withCredentials=r),fo()(n,md(this,(function(e,n,i){if(e)return Mu.error(e,n);t.loaded_=!0,"function"!==typeof lo().WebVTT?t.tech_&&t.tech_.any(["vttjsloaded","vttjserror"],(e=>{if("vttjserror"!==e.type)return vh(i,t);Mu.error(`vttjs failed to load, stopping trying to process ${t.src}`)})):vh(i,t)})))};class Th extends hh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.tech)throw new Error("A tech was not provided.");const t=$u(e,{kind:ch[e.kind]||"subtitles",language:e.language||e.srclang||""});let n=dh[t.mode]||"disabled";const i=t.default;"metadata"!==t.kind&&"chapters"!==t.kind||(n="hidden"),super(t),this.tech_=t.tech,this.cues_=[],this.activeCues_=[],this.preload_=!1!==this.tech_.preloadTextTracks;const r=new oh(this.cues_),s=new oh(this.activeCues_);let a=!1;this.timeupdateHandler=md(this,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.tech_.isDisposed()||(this.tech_.isReady_?(this.activeCues=this.activeCues,a&&(this.trigger("cuechange"),a=!1),"timeupdate"!==e.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))):"timeupdate"!==e.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)))}));this.tech_.one("dispose",(()=>{this.stopTracking()})),"disabled"!==n&&this.startTracking(),Object.defineProperties(this,{default:{get:()=>i,set(){}},mode:{get:()=>n,set(e){dh[e]&&n!==e&&(n=e,this.preload_||"disabled"===n||0!==this.cues.length||bh(this.src,this),this.stopTracking(),"disabled"!==n&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?r:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(0===this.cues.length)return s;const e=this.tech_.currentTime(),t=[];for(let n=0,i=this.cues.length;n<i;n++){const i=this.cues[n];i.startTime<=e&&i.endTime>=e&&t.push(i)}if(a=!1,t.length!==this.activeCues_.length)a=!0;else for(let n=0;n<t.length;n++)-1===this.activeCues_.indexOf(t[n])&&(a=!0);return this.activeCues_=t,s.setCues_(this.activeCues_),s},set(){}}}),t.src?(this.src=t.src,this.preload_||(this.loaded_=!0),(this.preload_||"subtitles"!==t.kind&&"captions"!==t.kind)&&bh(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let t=e;if(!("getCueAsHTML"in t)){t=new(lo().vttjs.VTTCue)(e.startTime,e.endTime,e.text);for(const n in e)n in t||(t[n]=e[n]);t.id=e.id,t.originalCue_=e}const n=this.tech_.textTracks();for(let i=0;i<n.length;i++)n[i]!==this&&n[i].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)}removeCue(e){let t=this.cues_.length;for(;t--;){const n=this.cues_[t];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}}}Th.prototype.allowedEvents_={cuechange:"cuechange"};class Sh extends hh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=$u(e,{kind:uh[e.kind]||""});super(t);let n=!1;Object.defineProperty(this,"enabled",{get:()=>n,set(e){"boolean"===typeof e&&e!==n&&(n=e,this.trigger("enabledchange"))}}),t.enabled&&(this.enabled=t.enabled),this.loaded_=!0}}class _h extends hh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=$u(e,{kind:lh[e.kind]||""});super(t);let n=!1;Object.defineProperty(this,"selected",{get:()=>n,set(e){"boolean"===typeof e&&e!==n&&(n=e,this.trigger("selectedchange"))}}),t.selected&&(this.selected=t.selected)}}class wh extends Sd{constructor(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super();const n=new Th(t);this.kind=n.kind,this.src=n.src,this.srclang=n.language,this.label=n.label,this.default=n.default,Object.defineProperties(this,{readyState:{get:()=>e},track:{get:()=>n}}),e=wh.NONE,n.addEventListener("loadeddata",(()=>{e=wh.LOADED,this.trigger({type:"load",target:this})}))}}wh.prototype.allowedEvents_={load:"load"},wh.NONE=0,wh.LOADING=1,wh.LOADED=2,wh.ERROR=3;const Eh={audio:{ListClass:class extends ih{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(let t=e.length-1;t>=0;t--)if(e[t].enabled){rh(e,e[t]);break}super(e),this.changing_=!1}addTrack(e){e.enabled&&rh(this,e),super.addTrack(e),e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,rh(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}},TrackClass:Sh,capitalName:"Audio"},video:{ListClass:class extends ih{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(let t=e.length-1;t>=0;t--)if(e[t].selected){sh(e,e[t]);break}super(e),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set(){}})}addTrack(e){e.selected&&sh(this,e),super.addTrack(e),e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,sh(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}},TrackClass:_h,capitalName:"Video"},text:{ListClass:ah,TrackClass:Th,capitalName:"Text"}};Object.keys(Eh).forEach((function(e){Eh[e].getterName=`${e}Tracks`,Eh[e].privateName=`${e}Tracks_`}));const kh={remoteText:{ListClass:ah,TrackClass:Th,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let t=0,n=e.length;t<n;t++)this.addTrackElement_(e[t])}addTrackElement_(e){const t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let t;for(let n=0,i=this.trackElements_.length;n<i;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t}removeTrackElement_(e){for(let t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"===typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"===typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}}},TrackClass:wh,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},xh=Object.assign({},Eh,kh);kh.names=Object.keys(kh),Eh.names=Object.keys(Eh),xh.names=[].concat(kh.names).concat(Eh.names);class Ah extends Fd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e.reportTouchActivity=!1,super(null,e,t),this.onDurationChange_=e=>this.onDurationChange(e),this.trackProgress_=e=>this.trackProgress(e),this.trackCurrentTime_=e=>this.trackCurrentTime(e),this.stopTrackingCurrentTime_=e=>this.stopTrackingCurrentTime(e),this.disposeSourceHandler_=e=>this.disposeSourceHandler(e),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",(function(){this.hasStarted_=!0})),this.on("loadstart",(function(){this.hasStarted_=!1})),xh.names.forEach((t=>{const n=xh[t];e&&e[n.getterName]&&(this[n.privateName]=e[n.getterName])})),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach((t=>{!1===e[`native${t}Tracks`]&&(this[`featuresNative${t}Tracks`]=!1)})),!1===e.nativeCaptions||!1===e.nativeTextTracks?this.featuresNativeTextTracks=!1:!0!==e.nativeCaptions&&!0!==e.nativeTextTracks||(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=!1!==e.preloadTextTracks,this.autoRemoteTextTracks_=new xh.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",(()=>this.setTimeout((()=>this.triggerSourceset(e)),1))),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(md(this,(function(){const e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()})),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return $d(0,0)}bufferedPercent(){return Wd(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}),250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(Eh.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){(e=[].concat(e)).forEach((e=>{const t=this[`${e}Tracks`]()||[];let n=t.length;for(;n--;){const i=t[n];"text"===e&&this.removeRemoteTextTrack(i),t.removeTrack(i)}}))}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let t=e.length;for(;t--;){const n=e[t];this.removeRemoteTextTrack(n)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return void 0!==e&&(this.error_=new Xd(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?$d(0,0):$d()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){Eh.names.forEach((e=>{const t=Eh[e],n=()=>{this.trigger(`${e}trackchange`)},i=this[t.getterName]();i.addEventListener("removetrack",n),i.addEventListener("addtrack",n),this.on("dispose",(()=>{i.removeEventListener("removetrack",n),i.removeEventListener("addtrack",n)}))}))}addWebVttScript_(){if(!lo().WebVTT)if(co().body.contains(this.el())){if(!this.options_["vtt.js"]&&ju(go())&&Object.keys(go()).length>0)return void this.trigger("vttjsloaded");const e=co().createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",(()=>{e.onload=null,e.onerror=null})),lo().WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),t=this.remoteTextTracks(),n=t=>e.addTrack(t.track),i=t=>e.removeTrack(t.track);t.on("addtrack",n),t.on("removetrack",i),this.addWebVttScript_();const r=()=>this.trigger("texttrackchange"),s=()=>{r();for(let t=0;t<e.length;t++){const n=e[t];n.removeEventListener("cuechange",r),"showing"===n.mode&&n.addEventListener("cuechange",r)}};s(),e.addEventListener("change",s),e.addEventListener("addtrack",s),e.addEventListener("removetrack",s),this.on("dispose",(function(){t.off("addtrack",n),t.off("removetrack",i),e.removeEventListener("change",s),e.removeEventListener("addtrack",s),e.removeEventListener("removetrack",s);for(let t=0;t<e.length;t++){e[t].removeEventListener("cuechange",r)}}))}addTextTrack(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=e.textTracks();r.kind=t,n&&(r.label=n),i&&(r.language=i),r.tech=e;const a=new xh.text.TrackClass(r);return s.addTrack(a),a}(this,e,t,n)}createRemoteTextTrack(e){const t=$u(e,{tech:this});return new kh.remoteTextEl.TrackClass(t)}addRemoteTextTrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;const n=this.createRemoteTextTrack(e);return"boolean"!==typeof t&&(t=!1),this.remoteTextTrackEls().addTrackElement_(n),this.remoteTextTracks().addTrack(n.track),!1===t&&this.ready((()=>this.autoRemoteTextTracks_.addTrack(n.track))),n}removeRemoteTextTrack(e){const t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const t=rd();return!this.isReady_||this.paused()?(this.queuedHanders_.add(t),this.one("playing",(()=>{this.queuedHanders_.has(t)&&(this.queuedHanders_.delete(t),e())}))):this.requestNamedAnimationFrame(t,e),t}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,t){return Ah.canPlayType(e.type)}static isTech(e){return e.prototype instanceof Ah||e instanceof Ah||e===Ah}static registerTech(e,t){if(Ah.techs_||(Ah.techs_={}),!Ah.isTech(t))throw new Error(`Tech ${e} must be a Tech`);if(!Ah.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!Ah.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Od(e),Ah.techs_[e]=t,Ah.techs_[Pd(e)]=t,"Tech"!==e&&Ah.defaultTechOrder_.push(e),t}static getTech(e){if(e)return Ah.techs_&&Ah.techs_[e]?Ah.techs_[e]:(e=Od(e),lo()&&lo().videojs&&lo().videojs[e]?(Mu.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),lo().videojs[e]):void 0)}}xh.names.forEach((function(e){const t=xh[e];Ah.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}})),Ah.prototype.featuresVolumeControl=!0,Ah.prototype.featuresMuteControl=!0,Ah.prototype.featuresFullscreenResize=!1,Ah.prototype.featuresPlaybackRate=!1,Ah.prototype.featuresProgressEvents=!1,Ah.prototype.featuresSourceset=!1,Ah.prototype.featuresTimeupdateEvents=!1,Ah.prototype.featuresNativeTextTracks=!1,Ah.prototype.featuresVideoFrameCallback=!1,Ah.withSourceHandlers=function(e){e.registerSourceHandler=function(t,n){let i=e.sourceHandlers;i||(i=e.sourceHandlers=[]),void 0===n&&(n=i.length),i.splice(n,0,t)},e.canPlayType=function(t){const n=e.sourceHandlers||[];let i;for(let e=0;e<n.length;e++)if(i=n[e].canPlayType(t),i)return i;return""},e.selectSourceHandler=function(t,n){const i=e.sourceHandlers||[];let r;for(let e=0;e<i.length;e++)if(r=i[e].canHandleSource(t,n),r)return i[e];return null},e.canPlaySource=function(t,n){const i=e.selectSourceHandler(t,n);return i?i.canHandleSource(t,n):""};["seekable","seeking","duration"].forEach((function(e){const t=this[e];"function"===typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})}),e.prototype),e.prototype.setSource=function(t){let n=e.selectSourceHandler(t,this.options_);n||(e.nativeSourceHandler?n=e.nativeSourceHandler:Mu.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),n!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=n.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Fd.registerComponent("Tech",Ah),Ah.registerTech("Tech",Ah),Ah.defaultTechOrder_=[];const Ch={},Ih={},Lh={};function Dh(e,t,n){e.setTimeout((()=>Uh(t,Ch[t.type],n,e)),1)}function Rh(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r="call"+Od(n),s=e.reduce(Nh(r),i),a=s===Lh,o=a?null:t[n](s);return function(e,t,n,i){for(let r=e.length-1;r>=0;r--){const s=e[r];s[t]&&s[t](i,n)}}(e,n,o,a),o}const Mh={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},Ph={setCurrentTime:1,setMuted:1,setVolume:1},Oh={play:1,pause:1};function Nh(e){return(t,n)=>t===Lh?Lh:n[e]?n[e](t):t}function Uh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const[a,...o]=t;if("string"===typeof a)Uh(e,Ch[a],n,i,r,s);else if(a){const t=function(e,t){const n=Ih[e.id()];let i=null;if(void 0===n||null===n)return i=t(e),Ih[e.id()]=[[t,i]],i;for(let r=0;r<n.length;r++){const[e,s]=n[r];e===t&&(i=s)}return null===i&&(i=t(e),n.push([t,i])),i}(i,a);if(!t.setSource)return r.push(t),Uh(e,o,n,i,r,s);t.setSource(Object.assign({},e),(function(a,l){if(a)return Uh(e,o,n,i,r,s);r.push(t),Uh(l,e.type===l.type?o:Ch[l.type],n,i,r,s)}))}else o.length?Uh(e,o,n,i,r,s):s?n(e,r):Uh(e,Ch["*"],n,i,r,!0)}const Fh={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Bh=function(){const e=gh(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"");return Fh[e.toLowerCase()]||""},jh=function(e){if(Array.isArray(e)){let t=[];e.forEach((function(e){e=jh(e),Array.isArray(e)?t=t.concat(e):Bu(e)&&t.push(e)})),e=t}else e="string"===typeof e&&e.trim()?[$h({src:e})]:Bu(e)&&"string"===typeof e.src&&e.src&&e.src.trim()?[$h(e)]:[];return e};function $h(e){if(!e.type){const t=Bh(e.src);t&&(e.type=t)}return e}const Vh=oc?10009:lc?461:8,Hh={codes:{play:415,pause:19,ff:417,rw:412,back:Vh},names:{415:"play",19:"pause",417:"ff",412:"rw",[Vh]:"back"},isEventKey(e,t){return t=t.toLowerCase(),!(!this.names[e.keyCode]||this.names[e.keyCode]!==t)},getEventName(e){if(this.names[e.keyCode])return this.names[e.keyCode];if(this.codes[e.code]){const t=this.codes[e.code];return this.names[t]}return null}};class qh extends Sd{constructor(e){super(),this.player_=e,this.focusableComponents=[],this.isListening_=!1,this.isPaused_=!1,this.onKeyDown_=this.onKeyDown_.bind(this),this.lastFocusedComponent_=null}start(){this.isListening_||(this.player_.on("keydown",this.onKeyDown_),this.player_.on("modalKeydown",this.onKeyDown_),this.player_.on("loadedmetadata",(()=>{this.focus(this.updateFocusableComponents()[0])})),this.player_.on("modalclose",(()=>{this.refocusComponent()})),this.player_.on("focusin",this.handlePlayerFocus_.bind(this)),this.player_.on("focusout",this.handlePlayerBlur_.bind(this)),this.isListening_=!0,this.player_.errorDisplay&&this.player_.errorDisplay.on("aftermodalfill",(()=>{this.updateFocusableComponents(),this.focusableComponents.length&&(this.focusableComponents.length>1?this.focusableComponents[1].focus():this.focusableComponents[0].focus())})))}stop(){this.player_.off("keydown",this.onKeyDown_),this.isListening_=!1}onKeyDown_(e){const t=e.originalEvent?e.originalEvent:e;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)){if(this.isPaused_)return;t.preventDefault();const e=t.key.substring(5).toLowerCase();this.move(e)}else if(Hh.isEventKey(t,"play")||Hh.isEventKey(t,"pause")||Hh.isEventKey(t,"ff")||Hh.isEventKey(t,"rw")){t.preventDefault();const e=Hh.getEventName(t);this.performMediaAction_(e)}else Hh.isEventKey(t,"Back")&&e.target&&"function"===typeof e.target.closeable&&e.target.closeable()&&(t.preventDefault(),e.target.close())}performMediaAction_(e){if(this.player_)switch(e){case"play":this.player_.paused()&&this.player_.play();break;case"pause":this.player_.paused()||this.player_.pause();break;case"ff":this.userSeek_(this.player_.currentTime()+5);break;case"rw":this.userSeek_(this.player_.currentTime()-5)}}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}pause(){this.isPaused_=!0}resume(){this.isPaused_=!1}handlePlayerBlur_(e){const t=e.relatedTarget;let n=null;const i=this.getCurrentComponent(e.target);t&&(n=Boolean(t.closest(".video-js")),t.classList.contains("vjs-text-track-settings")&&!this.isPaused_&&this.searchForTrackSelect_()),(e.currentTarget.contains(e.relatedTarget)||n)&&t||(i&&"CloseButton"===i.name()?this.refocusComponent():(this.pause(),i&&i.el()&&(this.lastFocusedComponent_=i)))}handlePlayerFocus_(){this.getCurrentComponent()&&this.getCurrentComponent().getIsFocusable()&&this.resume()}updateFocusableComponents(){const e=this.player_,t=[];function n(e){for(const i of e)i.hasOwnProperty("el_")&&i.getIsFocusable()&&i.getIsAvailableToBeFocused(i.el())&&t.push(i),i.hasOwnProperty("children_")&&i.children_.length>0&&n(i.children_)}return e.children_.forEach((e=>{if(e.hasOwnProperty("el_")){if(e.getIsFocusable&&e.getIsAvailableToBeFocused&&e.getIsFocusable()&&e.getIsAvailableToBeFocused(e.el()))return void t.push(e);e.hasOwnProperty("children_")&&e.children_.length>0?n(e.children_):e.hasOwnProperty("items")&&e.items.length>0?n(e.items):this.findSuitableDOMChild(e)&&t.push(e)}if("ErrorDisplay"===e.name_&&e.opened_){const n=e.el_.querySelector(".vjs-errors-ok-button-container");if(n){n.querySelectorAll("button").forEach(((e,n)=>{t.push({name:()=>"ModalButton"+(n+1),el:()=>e,getPositions:()=>{const t=e.getBoundingClientRect();return{boundingClientRect:{x:t.x,y:t.y,width:t.width,height:t.height,top:t.top,right:t.right,bottom:t.bottom,left:t.left},center:{x:t.left+t.width/2,y:t.top+t.height/2,width:0,height:0,top:t.top+t.height/2,right:t.left+t.width/2,bottom:t.top+t.height/2,left:t.left+t.width/2}}},getIsAvailableToBeFocused:()=>!0,getIsFocusable:e=>!0,focus:()=>e.focus()})}))}}})),this.focusableComponents=t,this.focusableComponents}findSuitableDOMChild(e){return e.el()?function t(n){if(e.getIsFocusable(n)&&e.getIsAvailableToBeFocused(n))return n;for(let e=0;e<n.children.length;e++){const i=t(n.children[e]);if(i)return i}return null}(e.el()):null}getCurrentComponent(e){this.updateFocusableComponents();const t=e||document.activeElement;if(this.focusableComponents.length)for(const n of this.focusableComponents)if(n.el()===t)return n}add(e){const t=[...this.focusableComponents];e.hasOwnProperty("el_")&&e.getIsFocusable()&&e.getIsAvailableToBeFocused(e.el())&&t.push(e),this.focusableComponents=t,this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}remove(e){for(let t=0;t<this.focusableComponents.length;t++)if(this.focusableComponents[t].name()===e.name())return this.focusableComponents.splice(t,1),void this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}clear(){this.focusableComponents.length>0&&(this.focusableComponents=[],this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents}))}move(e){const t=this.getCurrentComponent();if(!t)return;const n=t.getPositions(),i=this.focusableComponents.filter((i=>i!==t&&this.isInDirection_(n.boundingClientRect,i.getPositions().boundingClientRect,e))),r=this.findBestCandidate_(n.center,i,e);r?this.focus(r):this.trigger({type:"endOfFocusableComponents",direction:e,focusedComponent:t})}findBestCandidate_(e,t,n){let i=1/0,r=null;for(const s of t){const t=s.getPositions().center,a=this.calculateDistance_(e,t,n);a<i&&(i=a,r=s)}return r}isInDirection_(e,t,n){switch(n){case"right":return t.left>=e.right;case"left":return t.right<=e.left;case"down":return t.top>=e.bottom;case"up":return t.bottom<=e.top;default:return!1}}refocusComponent(){if(this.lastFocusedComponent_){this.player_.userActive()||this.player_.userActive(!0),this.updateFocusableComponents();for(let e=0;e<this.focusableComponents.length;e++)if(this.focusableComponents[e].name()===this.lastFocusedComponent_.name())return void this.focus(this.focusableComponents[e])}else this.focus(this.updateFocusableComponents()[0])}focus(e){"object"===typeof e&&(e.getIsAvailableToBeFocused(e.el())?e.focus():this.findSuitableDOMChild(e)&&this.findSuitableDOMChild(e).focus())}calculateDistance_(e,t,n){const i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);let s;switch(n){case"right":case"left":s=i+100*r;break;case"up":s=2*r+.5*i;break;case"down":s=5*r+i;break;default:s=i+r}return s}searchForTrackSelect_(){const e=this;for(const t of e.updateFocusableComponents())if("TextTrackSelect"===t.constructor.name){e.focus(t);break}}}Fd.registerComponent("MediaLoader",class extends Fd{constructor(e,t,n){if(super(e,$u({createEl:!1},t),n),t.playerOptions.sources&&0!==t.playerOptions.sources.length)e.src(t.playerOptions.sources);else for(let i=0,r=t.playerOptions.techOrder;i<r.length;i++){const t=Od(r[i]);let n=Ah.getTech(t);if(t||(n=Fd.getComponent(t)),n&&n.isSupported()){e.loadTech_(t);break}}}});class Gh extends Fd{constructor(e,t){super(e,t),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=e=>this.handleMouseOver(e),this.handleMouseOut_=e=>this.handleMouseOut(e),this.handleClick_=e=>this.handleClick(e),this.handleKeyDown_=e=>this.handleKeyDown(e),this.emitTapEvents(),this.enable()}createEl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=Object.assign({className:this.buildCSSClass(),tabIndex:0},t),"button"===e&&Mu.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),n=Object.assign({role:"button"},n),this.tabIndex_=t.tabIndex;const i=Tc(e,t,n);return this.player_.options_.experimentalSvgIcons||i.appendChild(Tc("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(i),i}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=Tc("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.el();if(void 0===e)return this.controlText_||"Need Text";const n=this.localize(e);this.controlText_=e,Sc(this.controlTextEl_,n),this.nonIconControl||this.player_.options_.noUITitleAttributes||t.setAttribute("title",n)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),"undefined"!==typeof this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),"undefined"!==typeof this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){" "===e.key||"Enter"===e.key?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}Fd.registerComponent("ClickableComponent",Gh);class zh extends Gh{constructor(e,t){super(e,t),this.update(),this.update_=e=>this.update(e),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return Tc("div",{className:"vjs-poster"})}crossOrigin(e){if("undefined"===typeof e)return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;null===e||"anonymous"===e||"use-credentials"===e?this.$("img")&&(this.$("img").crossOrigin=e):this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`)}update(e){const t=this.player().poster();this.setSrc(t),t?this.show():this.hide()}setSrc(e){e?(this.$("img")||this.el_.appendChild(Tc("picture",{className:"vjs-poster",tabIndex:-1},{},Tc("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e):this.el_.textContent=""}handleClick(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Qd(this.player_.play()):this.player_.pause())}}zh.prototype.crossorigin=zh.prototype.crossOrigin,Fd.registerComponent("PosterImage",zh);const Kh="#222",Wh="#ccc",Xh={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Yh(e,t){let n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}function Qh(e,t,n){try{e.style[t]=n}catch(i){return}}function Jh(e){return e?`${e}px`:""}Fd.registerComponent("TextTrackDisplay",class extends Fd{constructor(e,t,n){super(e,t,n);const i=e=>{this.updateDisplayOverlay(),this.updateDisplay(e)};e.on("loadstart",(e=>this.toggleDisplay(e))),e.on("texttrackchange",(e=>this.updateDisplay(e))),e.on("loadedmetadata",(e=>{this.updateDisplayOverlay(),this.preselectTrack(e)})),e.ready(md(this,(function(){if(e.tech_&&e.tech_.featuresNativeTextTracks)return void this.hide();e.on("fullscreenchange",i),e.on("playerresize",i);const t=lo().screen.orientation||lo(),n=lo().screen.orientation?"change":"orientationchange";t.addEventListener(n,i),e.on("dispose",(()=>t.removeEventListener(n,i)));const r=this.options_.playerOptions.tracks||[];for(let e=0;e<r.length;e++)this.player_.addRemoteTextTrack(r[e],!0);this.preselectTrack()})))}preselectTrack(){const e={captions:1,subtitles:1},t=this.player_.textTracks(),n=this.player_.cache_.selectedLanguage;let i,r,s;for(let a=0;a<t.length;a++){const o=t[a];n&&n.enabled&&n.language&&n.language===o.language&&o.kind in e?o.kind===n.kind?s=o:s||(s=o):n&&!n.enabled?(s=null,i=null,r=null):o.default&&("descriptions"!==o.kind||i?o.kind in e&&!r&&(r=o):i=o)}s?s.mode="showing":r?r.mode="showing":i&&(i.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){"function"===typeof lo().WebVTT&&lo().WebVTT.processCues(lo(),[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){const t=[];for(let n=0;n<e.length;++n){const i=e[n];"showing"===i.mode&&t.push(i)}return void this.updateForTrack(t)}let n=null,i=null,r=e.length;for(;r--;){const t=e[r];"showing"===t.mode&&("descriptions"===t.kind?n=t:i=t)}if(i?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(i)):n&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(n)),!lo().CSS.supports("inset","10px")){const e=this.el_,t=e.querySelectorAll(".vjs-text-track-cue"),n=this.player_.controlBar.el_.getBoundingClientRect().height,i=this.player_.el_.getBoundingClientRect().height;e.style="",Qh(e,"position","relative"),Qh(e,"height",i-n+"px"),Qh(e,"top","unset"),Qh(e,"bottom",uc?i+"px":"0px"),t.length>0&&t.forEach((e=>{if(e.style.inset){const t=e.style.inset.split(" ");3===t.length&&Object.assign(e.style,{top:t[0],right:t[1],bottom:t[2],left:"unset"})}}))}}updateDisplayOverlay(){if(!this.player_.videoHeight()||!lo().CSS.supports("inset-inline: 10px"))return;const e=this.player_.currentWidth(),t=this.player_.currentHeight(),n=e/t,i=this.player_.videoWidth()/this.player_.videoHeight();let r=0,s=0;Math.abs(n-i)>.1&&(n>i?r=Math.round((e-t*i)/2):s=Math.round((t-e/i)/2)),Qh(this.el_,"insetInline",Jh(r)),Qh(this.el_,"insetBlock",Jh(s))}updateDisplayState(e){const t=this.player_.textTrackSettings.getValues(),n=e.activeCues;let i=n.length;for(;i--;){const e=n[i];if(!e)continue;const r=e.displayState;if(t.color&&(r.firstChild.style.color=t.color),t.textOpacity&&Qh(r.firstChild,"color",Yh(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(r.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&Qh(r.firstChild,"backgroundColor",Yh(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?Qh(r,"backgroundColor",Yh(t.windowColor,t.windowOpacity)):r.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?r.firstChild.style.textShadow=`2px 2px 3px ${Kh}, 2px 2px 4px ${Kh}, 2px 2px 5px ${Kh}`:"raised"===t.edgeStyle?r.firstChild.style.textShadow=`1px 1px ${Kh}, 2px 2px ${Kh}, 3px 3px ${Kh}`:"depressed"===t.edgeStyle?r.firstChild.style.textShadow=`1px 1px ${Wh}, 0 1px ${Wh}, -1px -1px ${Kh}, 0 -1px ${Kh}`:"uniform"===t.edgeStyle&&(r.firstChild.style.textShadow=`0 0 4px ${Kh}, 0 0 4px ${Kh}, 0 0 4px ${Kh}, 0 0 4px ${Kh}`)),t.fontPercent&&1!==t.fontPercent){const e=lo().parseFloat(r.style.fontSize);r.style.fontSize=e*t.fontPercent+"px",r.style.height="auto",r.style.top="auto"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?r.firstChild.style.fontVariant="small-caps":r.firstChild.style.fontFamily=Xh[t.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),"function"!==typeof lo().WebVTT||e.every((e=>!e.activeCues)))return;const t=[];for(let n=0;n<e.length;++n){const i=e[n];for(let e=0;e<i.activeCues.length;++e)t.push(i.activeCues[e])}lo().WebVTT.processCues(lo(),t,this.el_);for(let n=0;n<e.length;++n){const t=e[n];for(let e=0;e<t.activeCues.length;++e){const i=t.activeCues[e].displayState;Ec(i,"vjs-text-track-cue","vjs-text-track-cue-"+(t.language?t.language:n)),t.language&&Lc(i,"lang",t.language)}this.player_.textTrackSettings&&this.updateDisplayState(t)}}});Fd.registerComponent("LoadingSpinner",class extends Fd{createEl(){const e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),n=Tc("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[t])}),i=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return i.appendChild(n),i}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}});class Zh extends Gh{createEl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e="button",t=Object.assign({className:this.buildCSSClass()},t),n=Object.assign({type:"button"},n);const i=Tc(e,t,n);return this.player_.options_.experimentalSvgIcons||i.appendChild(Tc("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(i),i}addChild(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.constructor.name;return Mu.warn(`Adding an actionable (user controllable) child to a Button (${n}) is not supported; use a ClickableComponent instead.`),Fd.prototype.addChild.call(this,e,t)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){" "!==e.key&&"Enter"!==e.key?super.handleKeyDown(e):e.stopPropagation()}}Fd.registerComponent("Button",Zh);class ef extends Zh{constructor(e,t){super(e,t),this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",(e=>this.handleMouseDown(e)))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const t=this.player_.play();if(this.mouseused_&&"clientX"in e&&"clientY"in e)return Qd(t),void(this.player_.tech(!0)&&this.player_.tech(!0).focus());const n=this.player_.getChild("controlBar"),i=n&&n.getChild("playToggle");if(!i)return void this.player_.tech(!0).focus();const r=()=>i.focus();Yd(t)?t.then(r,(()=>{})):this.setTimeout(r,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}ef.prototype.controlText_="Play Video",Fd.registerComponent("BigPlayButton",ef);Fd.registerComponent("CloseButton",class extends Zh{constructor(e,t){super(e,t),this.setIcon("cancel"),this.controlText(t&&t.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){"Escape"===e.key?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}});class tf extends Zh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),t.replay=void 0===t.replay||t.replay,this.setIcon("play"),this.on(e,"play",(e=>this.handlePlay(e))),this.on(e,"pause",(e=>this.handlePause(e))),t.replay&&this.on(e,"ended",(e=>this.handleEnded(e)))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?Qd(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",(e=>this.handleSeeked(e)))}}tf.prototype.controlText_="Play",Fd.registerComponent("PlayToggle",tf);class nf extends Fd{constructor(e,t){super(e,t),this.on(e,["timeupdate","ended","seeking"],(e=>this.update(e))),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),t=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),n=Tc("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)}\xa0`},{role:"presentation"});return t.appendChild(n),this.contentEl_=Tc("span",{className:`${e}-display`},{role:"presentation"}),t.appendChild(this.contentEl_),t}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(e){(this.player_.options_.enableSmoothSeeking||"seeking"!==e.type)&&this.updateContent(e)}updateTextNode_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e=zd(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",(()=>{if(!this.contentEl_)return;let e=this.textNode_;e&&this.contentEl_.firstChild!==e&&(e=null,Mu.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=co().createTextNode(this.formattedTime_),this.textNode_&&(e?this.contentEl_.replaceChild(this.textNode_,e):this.contentEl_.appendChild(this.textNode_))})))}updateContent(e){}}nf.prototype.labelText_="Time",nf.prototype.controlText_="Time",Fd.registerComponent("TimeDisplay",nf);class rf extends nf{buildCSSClass(){return"vjs-current-time"}updateContent(e){let t;t=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)}}rf.prototype.labelText_="Current Time",rf.prototype.controlText_="Current Time",Fd.registerComponent("CurrentTimeDisplay",rf);class sf extends nf{constructor(e,t){super(e,t);const n=e=>this.updateContent(e);this.on(e,"durationchange",n),this.on(e,"loadstart",n),this.on(e,"loadedmetadata",n)}buildCSSClass(){return"vjs-duration"}updateContent(e){const t=this.player_.duration();this.updateTextNode_(t)}}sf.prototype.labelText_="Duration",sf.prototype.controlText_="Duration",Fd.registerComponent("DurationDisplay",sf);Fd.registerComponent("TimeDivider",class extends Fd{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),t=super.createEl("div"),n=super.createEl("span",{textContent:"/"});return t.appendChild(n),e.appendChild(t),e}});class af extends nf{constructor(e,t){super(e,t),this.on(e,"durationchange",(e=>this.updateContent(e)))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return!1!==this.options_.displayNegative&&e.insertBefore(Tc("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if("number"!==typeof this.player_.duration())return;let t;t=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(t)}}af.prototype.labelText_="Remaining Time",af.prototype.controlText_="Remaining Time",Fd.registerComponent("RemainingTimeDisplay",af);Fd.registerComponent("LiveDisplay",class extends Fd{constructor(e,t){super(e,t),this.updateShowing(),this.on(this.player(),"durationchange",(e=>this.updateShowing(e)))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Tc("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(Tc("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")}\xa0`})),this.contentEl_.appendChild(co().createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===1/0?this.show():this.hide()}});class of extends Zh{constructor(e,t){super(e,t),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=e=>this.updateLiveEdgeStatus(e),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",e),this.textEl_=Tc("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}function lf(e,t,n){return e=Number(e),Math.min(n,Math.max(t,isNaN(e)?t:e))}of.prototype.controlText_="Seek to live, currently playing live",Fd.registerComponent("SeekToLive",of);var uf=Object.freeze({__proto__:null,clamp:lf});class cf extends Fd{constructor(e,t){super(e,t),this.handleMouseDown_=e=>this.handleMouseDown(e),this.handleMouseUp_=e=>this.handleMouseUp(e),this.handleKeyDown_=e=>this.handleKeyDown(e),this.handleClick_=e=>this.handleClick(e),this.handleMouseMove_=e=>this.handleMouseMove(e),this.update_=e=>this.update(e),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.className=t.className+" vjs-slider",t=Object.assign({tabIndex:0},t),n=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},n),super.createEl(e,t,n)}handleMouseDown(e){const t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||Ju||e.preventDefault(),Rc(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove_),this.on(t,"mouseup",this.handleMouseUp_),this.on(t,"touchmove",this.handleMouseMove_),this.on(t,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const t=this.bar.el_.ownerDocument;Mc(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove_),this.off(t,"mouseup",this.handleMouseUp_),this.off(t,"touchmove",this.handleMouseMove_),this.off(t,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",(()=>{const t=this.vertical()?"height":"width";this.bar.el().style[t]=(100*e).toFixed(2)+"%"}))),e}getProgress(){return Number(lf(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const t=Nc(this.el_,e);return this.vertical()?t.y:t.x}handleKeyDown(e){const t=this.options_.playerOptions.spatialNavigation,n=t&&t.enabled,i=t&&t.horizontalSeek;n?i&&"ArrowLeft"===e.key||!i&&"ArrowDown"===e.key?(e.preventDefault(),e.stopPropagation(),this.stepBack()):i&&"ArrowRight"===e.key||!i&&"ArrowUp"===e.key?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e):"ArrowLeft"===e.key||"ArrowDown"===e.key?(e.preventDefault(),e.stopPropagation(),this.stepBack()):"ArrowUp"===e.key||"ArrowRight"===e.key?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}Fd.registerComponent("Slider",cf);const df=(e,t)=>lf(e/t*100,0,100).toFixed(2)+"%";Fd.registerComponent("LoadProgressBar",class extends Fd{constructor(e,t){super(e,t),this.partEls_=[],this.on(e,"progress",(e=>this.update(e)))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),t=Tc("span",{className:"vjs-control-text"}),n=Tc("span",{textContent:this.localize("Loaded")}),i=co().createTextNode(": ");return this.percentageEl_=Tc("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(t),t.appendChild(n),t.appendChild(i),t.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",(()=>{const e=this.player_.liveTracker,t=this.player_.buffered(),n=e&&e.isLive()?e.seekableEnd():this.player_.duration(),i=this.player_.bufferedEnd(),r=this.partEls_,s=df(i,n);this.percent_!==s&&(this.el_.style.width=s,Sc(this.percentageEl_,s),this.percent_=s);for(let a=0;a<t.length;a++){const e=t.start(a),n=t.end(a);let s=r[a];s||(s=this.el_.appendChild(Tc()),r[a]=s),s.dataset.start===e&&s.dataset.end===n||(s.dataset.start=e,s.dataset.end=n,s.style.left=df(e,i),s.style.width=df(n-e,i))}for(let a=r.length;a>t.length;a--)this.el_.removeChild(r[a-1]);r.length=t.length}))}});Fd.registerComponent("TimeTooltip",class extends Fd{constructor(e,t){super(e,t),this.update=yd(md(this,this.update),gd)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,t,n){const i=Oc(this.el_),r=Pc(this.player_.el()),s=e.width*t;if(!r||!i)return;let a=e.left-r.left+s,o=e.width-s+(r.right-e.right);o||(o=e.width-s,a=s);let l=i.width/2;a<l?l+=l-a:o<l&&(l=o),l<0?l=0:l>i.width&&(l=i.width),l=Math.round(l),this.el_.style.right=`-${l}px`,this.write(n)}write(e){Sc(this.el_,e)}updateTime(e,t,n,i){this.requestNamedAnimationFrame("TimeTooltip#updateTime",(()=>{let r;const s=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const e=this.player_.liveTracker.liveWindow(),n=e-t*e;r=(n<1?"":"-")+zd(n,e)}else r=zd(n,s);this.update(e,t,r),i&&i()}))}});class hf extends Fd{constructor(e,t){super(e,t),this.setIcon("circle"),this.update=yd(md(this,this.update),gd)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,t){const n=this.getChild("timeTooltip");if(!n)return;const i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,t,i)}}hf.prototype.options_={children:[]},hc||Wu||hf.prototype.options_.children.push("timeTooltip"),Fd.registerComponent("PlayProgressBar",hf);class ff extends Fd{constructor(e,t){super(e,t),this.update=yd(md(this,this.update),gd)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t){const n=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,n,(()=>{this.el_.style.left=e.width*t+"px"}))}}ff.prototype.options_={children:["timeTooltip"]},Fd.registerComponent("MouseTimeDisplay",ff);class pf extends cf{constructor(e,t){(t=$u(pf.prototype.options_,t)).children=[...t.children];const n=e.options_.disableSeekWhileScrubbingOnMobile&&(hc||Wu);(!hc&&!Wu||n)&&t.children.splice(1,0,"mouseTimeDisplay"),super(e,t),this.shouldDisableSeekWhileScrubbingOnMobile_=n,this.pendingSeekTime_=null,this.setEventHandlers_()}setEventHandlers_(){this.update_=md(this,this.update),this.update=yd(this.update_,gd),this.on(this.player_,["durationchange","timeupdate"],this.update),this.on(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in co()&&"visibilityState"in co()&&this.on(co(),"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){"hidden"===co().visibilityState?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(this.player_.ended()||this.player_.paused()||this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,gd))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if("hidden"===co().visibilityState)return;const t=super.update();return this.requestNamedAnimationFrame("SeekBar#update",(()=>{const e=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),n=this.player_.liveTracker;let i=this.player_.duration();n&&n.isLive()&&(i=this.player_.liveTracker.liveCurrentTime()),this.percent_!==t&&(this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.percent_=t),this.currentTime_===e&&this.duration_===i||(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[zd(e,i),zd(i,i)],"{1} of {2}")),this.currentTime_=e,this.duration_=i),this.bar&&this.bar.update(Pc(this.el()),this.getProgress())})),t}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){if(this.pendingSeekTime_)return this.pendingSeekTime_/this.player_.duration();const e=this.getCurrentTime_();let t;const n=this.player_.liveTracker;return n&&n.isLive()?(t=(e-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(t=1)):t=e/this.player_.duration(),t}handleMouseDown(e){Vc(e)&&(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.shouldDisableSeekWhileScrubbingOnMobile_||this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Vc(e)||isNaN(this.player_.duration()))return;n||this.player_.scrubbing()||this.player_.scrubbing(!0);const i=this.calculateDistance(e),r=this.player_.liveTracker;if(r&&r.isLive()){if(i>=.99)return void r.seekToLiveEdge();const e=r.seekableStart(),n=r.liveCurrentTime();if(t=e+i*r.liveWindow(),t>=n&&(t=n),t<=e&&(t=e+.1),t===1/0)return}else t=i*this.player_.duration(),t===this.player_.duration()&&(t-=.1);this.shouldDisableSeekWhileScrubbingOnMobile_?this.pendingSeekTime_=t:this.userSeek_(t),this.player_.options_.enableSmoothSeeking&&this.update()}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");e&&e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");e&&e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.pendingSeekTime_&&(this.userSeek_(this.pendingSeekTime_),this.pendingSeekTime_=null),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Qd(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+5)}stepBack(){this.userSeek_(this.player_.currentTime()-5)}handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const t=this.player_.liveTracker;if(" "===e.key||"Enter"===e.key)e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if("Home"===e.key)e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if("End"===e.key)e.preventDefault(),e.stopPropagation(),t&&t.isLive()?this.userSeek_(t.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(e.key)){e.preventDefault(),e.stopPropagation();const n=.1*parseInt(e.key,10);t&&t.isLive()?this.userSeek_(t.seekableStart()+t.liveWindow()*n):this.userSeek_(this.player_.duration()*n)}else"PageDown"===e.key?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-60)):"PageUp"===e.key?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["durationchange","timeupdate"],this.update),this.off(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in co()&&"visibilityState"in co()&&this.off(co(),"visibilitychange",this.toggleVisibility_),super.dispose()}}pf.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Fd.registerComponent("SeekBar",pf);class gf extends Fd{constructor(e,t){super(e,t),this.handleMouseMove=yd(md(this,this.handleMouseMove),gd),this.throttledHandleMouseSeek=yd(md(this,this.handleMouseSeek),gd),this.handleMouseUpHandler_=e=>this.handleMouseUp(e),this.handleMouseDownHandler_=e=>this.handleMouseDown(e),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const t=this.getChild("seekBar");if(!t)return;const n=t.getChild("playProgressBar"),i=t.getChild("mouseTimeDisplay");if(!n&&!i)return;const r=t.el(),s=Oc(r);let a=Nc(r,e).x;a=lf(a,0,1),i&&i.update(s,a),n&&n.update(s,t.getProgress())}handleMouseSeek(e){const t=this.getChild("seekBar");t&&t.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach((e=>e.disable&&e.disable())),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&Qd(this.player_.play())}}enable(){this.children().forEach((e=>e.enable&&e.enable())),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.getChild("seekBar");t&&t.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}gf.prototype.options_={children:["seekBar"]},Fd.registerComponent("ProgressControl",gf);class mf extends Zh{constructor(e,t){super(e,t),this.setIcon("picture-in-picture-enter"),this.on(e,["enterpictureinpicture","leavepictureinpicture"],(e=>this.handlePictureInPictureChange(e))),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],(e=>this.handlePictureInPictureEnabledChange(e))),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],(()=>this.handlePictureInPictureAudioModeChange())),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){"audio"===this.player_.currentType().substring(0,5)||this.player_.audioPosterMode()||this.player_.audioOnlyMode()?(this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()):this.show()}handlePictureInPictureEnabledChange(){co().pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in lo()?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){"function"===typeof co().exitPictureInPicture&&super.show()}}mf.prototype.controlText_="Picture-in-Picture",Fd.registerComponent("PictureInPictureToggle",mf);class yf extends Zh{constructor(e,t){super(e,t),this.setIcon("fullscreen-enter"),this.on(e,"fullscreenchange",(e=>this.handleFullscreenChange(e))),!1===co()[e.fsApi_.fullscreenEnabled]&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}yf.prototype.controlText_="Fullscreen",Fd.registerComponent("FullscreenToggle",yf);Fd.registerComponent("VolumeLevel",class extends Fd{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",e),e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}});Fd.registerComponent("VolumeLevelTooltip",class extends Fd{constructor(e,t){super(e,t),this.update=yd(md(this,this.update),gd)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,t,n,i){if(!n){const n=Pc(this.el_),i=Pc(this.player_.el()),r=e.width*t;if(!i||!n)return;const s=e.left-i.left+r,a=e.width-r+(i.right-e.right);let o=n.width/2;s<o?o+=o-s:a<o&&(o=a),o<0?o=0:o>n.width&&(o=n.width),this.el_.style.right=`-${o}px`}this.write(`${i}%`)}write(e){Sc(this.el_,e)}updateVolume(e,t,n,i,r){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",(()=>{this.update(e,t,n,i.toFixed(0)),r&&r()}))}});class vf extends Fd{constructor(e,t){super(e,t),this.update=yd(md(this,this.update),gd)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t,n){const i=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,n,i,(()=>{n?this.el_.style.bottom=e.height*t+"px":this.el_.style.left=e.width*t+"px"}))}}vf.prototype.options_={children:["volumeLevelTooltip"]},Fd.registerComponent("MouseVolumeLevelDisplay",vf);class bf extends cf{constructor(e,t){super(e,t),this.on("slideractive",(e=>this.updateLastVolume_(e))),this.on(e,"volumechange",(e=>this.updateARIAAttributes(e))),e.ready((()=>this.updateARIAAttributes()))}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){Vc(e)&&super.handleMouseDown(e)}handleMouseMove(e){const t=this.getChild("mouseVolumeLevelDisplay");if(t){const n=this.el(),i=Pc(n),r=this.vertical();let s=Nc(n,e);s=r?s.y:s.x,s=lf(s,0,1),t.update(i,s,r)}Vc(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")}volumeAsPercentage_(){return Math.round(100*this.player_.volume())}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",(()=>{0===this.player_.volume()&&this.player_.lastVolume_(e)}))}}bf.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},hc||Wu||bf.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),bf.prototype.playerEvent="volumechange",Fd.registerComponent("VolumeBar",bf);class Tf extends Fd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.vertical=t.vertical||!1,("undefined"===typeof t.volumeBar||ju(t.volumeBar))&&(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),super(e,t),function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(this,e),this.throttledHandleMouseMove=yd(md(this,this.handleMouseMove),gd),this.handleMouseUpHandler_=e=>this.handleMouseUp(e),this.on("mousedown",(e=>this.handleMouseDown(e))),this.on("touchstart",(e=>this.handleMouseDown(e))),this.on("mousemove",(e=>this.handleMouseMove(e))),this.on(this.volumeBar,["focus","slideractive"],(()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")})),this.on(this.volumeBar,["blur","sliderinactive"],(()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")}))}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}Tf.prototype.options_={children:["volumeBar"]},Fd.registerComponent("VolumeControl",Tf);class Sf extends Zh{constructor(e,t){super(e,t),function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(this,e),this.on(e,["loadstart","volumechange"],(e=>this.update(e)))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.volume(),n=this.player_.lastVolume_();if(0===t){const e=n<.1?.1:n;this.player_.volume(e),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let t=3;this.setIcon("volume-high"),hc&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?(this.setIcon("volume-mute"),t=0):e<.33?(this.setIcon("volume-low"),t=1):e<.67&&(this.setIcon("volume-medium"),t=2),kc(this.el_,[0,1,2,3].reduce(((e,t)=>e+`${t?" ":""}vjs-vol-${t}`),"")),Ec(this.el_,`vjs-vol-${t}`)}updateControlText_(){const e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)}}Sf.prototype.controlText_="Mute",Fd.registerComponent("MuteToggle",Sf);class _f extends Fd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"undefined"!==typeof t.inline?t.inline=t.inline:t.inline=!0,("undefined"===typeof t.volumeControl||ju(t.volumeControl))&&(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),super(e,t),this.handleKeyPressHandler_=e=>this.handleKeyPress(e),this.on(e,["loadstart"],(e=>this.volumePanelState_(e))),this.on(this.muteToggle,"keyup",(e=>this.handleKeyPress(e))),this.on(this.volumeControl,"keyup",(e=>this.handleVolumeControlKeyUp(e))),this.on("keydown",(e=>this.handleKeyPress(e))),this.on("mouseover",(e=>this.handleMouseOver(e))),this.on("mouseout",(e=>this.handleMouseOut(e))),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){"Escape"===e.key&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),ud(co(),"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),cd(co(),"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){"Escape"===e.key&&this.handleMouseOut()}}_f.prototype.options_={children:["muteToggle","volumeControl"]},Fd.registerComponent("VolumePanel",_f);class wf extends Zh{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){if(isNaN(this.player_.duration()))return;const t=this.player_.currentTime(),n=this.player_.liveTracker,i=n&&n.isLive()?n.seekableEnd():this.player_.duration();let r;r=t+this.skipTime<=i?t+this.skipTime:i,this.player_.currentTime(r)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}wf.prototype.controlText_="Skip Forward",Fd.registerComponent("SkipForward",wf);class Ef extends Zh{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.currentTime(),n=this.player_.liveTracker,i=n&&n.isLive()&&n.seekableStart();let r;r=i&&t-this.skipTime<=i?i:t>=this.skipTime?t-this.skipTime:0,this.player_.currentTime(r)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}Ef.prototype.controlText_="Skip Backward",Fd.registerComponent("SkipBackward",Ef);class kf extends Fd{constructor(e,t){super(e,t),t&&(this.menuButton_=t.menuButton),this.focusedChild_=-1,this.on("keydown",(e=>this.handleKeyDown(e))),this.boundHandleBlur_=e=>this.handleBlur(e),this.boundHandleTapClick_=e=>this.handleTapClick(e)}addEventListenerForItem(e){e instanceof Fd&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof Fd&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){"string"===typeof e&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const t=this.addChild(e);t&&this.addEventListenerForItem(t)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=Tc(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const t=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),ud(t,"click",(function(e){e.preventDefault(),e.stopImmediatePropagation()})),t}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const t=e.relatedTarget||co().activeElement;if(!this.children().some((e=>e.el()===t))){const e=this.menuButton_;e&&e.buttonPressed_&&t!==e.el().firstChild&&e.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const t=this.children();if(!Array.isArray(t))return;const n=t.filter((t=>t.el()===e.target))[0];if(!n)return;"CaptionSettingsMenuItem"!==n.name()&&this.menuButton_.focus()}}handleKeyDown(e){"ArrowLeft"===e.key||"ArrowDown"===e.key?(e.preventDefault(),e.stopPropagation(),this.stepForward()):"ArrowRight"!==e.key&&"ArrowUp"!==e.key||(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this.children().slice();t.length&&t[0].hasClass("vjs-menu-title")&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())}}Fd.registerComponent("Menu",kf);class xf extends Fd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.menuButton_=new Zh(e,t),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const n=Zh.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+n,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const i=e=>this.handleClick(e);this.handleMenuKeyUp_=e=>this.handleMenuKeyUp(e),this.on(this.menuButton_,"tap",i),this.on(this.menuButton_,"click",i),this.on(this.menuButton_,"keydown",(e=>this.handleKeyDown(e))),this.on(this.menuButton_,"mouseenter",(()=>{this.addClass("vjs-hover"),this.menu.show(),ud(co(),"keyup",this.handleMenuKeyUp_)})),this.on("mouseleave",(e=>this.handleMouseLeave(e))),this.on("keydown",(e=>this.handleSubmenuKeyDown(e)))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new kf(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const t=Tc("li",{className:"vjs-menu-title",textContent:Od(this.options_.title),tabIndex:-1}),n=new Fd(this.player_,{el:t});e.addItem(n)}if(this.items=this.createItems(),this.items)for(let t=0;t<this.items.length;t++)e.addItem(this.items[t]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(e){super.setIcon(e,this.menuButton_.el_)}buildWrapperCSSClass(){let e="vjs-menu-button";!0===this.options_.inline?e+="-inline":e+="-popup";return`vjs-menu-button ${e} ${Zh.prototype.buildCSSClass()} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.menuButton_.el();return this.menuButton_.controlText(e,t)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),cd(co(),"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){"Escape"===e.key||"Tab"===e.key?(this.buttonPressed_&&this.unpressButton(),"Tab"===!e.key&&(e.preventDefault(),this.menuButton_.focus())):"Up"!==e.key&&("Down"!==e.key||this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled)||this.buttonPressed_||(e.preventDefault(),this.pressButton())}handleMenuKeyUp(e){"Escape"!==e.key&&"Tab"!==e.key||this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){"Escape"!==e.key&&"Tab"!==e.key||(this.buttonPressed_&&this.unpressButton(),"Tab"===!e.key&&(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),hc&&vc())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}Fd.registerComponent("MenuButton",xf);class Af extends xf{constructor(e,t){const n=t.tracks;if(super(e,t),this.items.length<=1&&this.hide(),!n)return;const i=md(this,this.update);n.addEventListener("removetrack",i),n.addEventListener("addtrack",i),n.addEventListener("labelchange",i),this.player_.on("ready",i),this.player_.on("dispose",(function(){n.removeEventListener("removetrack",i),n.removeEventListener("addtrack",i),n.removeEventListener("labelchange",i)}))}}Fd.registerComponent("TrackButton",Af);class Cf extends Gh{constructor(e,t){super(e,t),this.selectable=t.selectable,this.isSelected_=t.selected||!1,this.multiSelectable=t.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,t,n){this.nonIconControl=!0;const i=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},t),n),r=Tc("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?i.appendChild(r):i.replaceChild(r,i.querySelector(".vjs-icon-placeholder")),i}handleKeyDown(e){["Tab","Escape","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"].includes(e.key)||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}Fd.registerComponent("MenuItem",Cf);class If extends Cf{constructor(e,t){var n;const i=t.track,r=e.textTracks();t.label=i.label||i.language||"Unknown",t.selected="showing"===i.mode,super(e,t),n=this,this.track=i,this.kinds=(t.kinds||[t.kind||this.track.kind]).filter(Boolean);const s=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleTracksChange.apply(n,t)},a=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleSelectedLanguageChange.apply(n,t)};if(e.on(["loadstart","texttrackchange"],s),r.addEventListener("change",s),r.addEventListener("selectedlanguagechange",a),this.on("dispose",(function(){e.off(["loadstart","texttrackchange"],s),r.removeEventListener("change",s),r.removeEventListener("selectedlanguagechange",a)})),void 0===r.onchange){let e;this.on(["tap","click"],(function(){if("object"!==typeof lo().Event)try{e=new(lo().Event)("change")}catch(Nv){}e||(e=co().createEvent("Event"),e.initEvent("change",!0,!0)),r.dispatchEvent(e)}))}this.handleTracksChange()}handleClick(e){const t=this.track,n=this.player_.textTracks();if(super.handleClick(e),n)for(let i=0;i<n.length;i++){const e=n[i];-1!==this.kinds.indexOf(e.kind)&&(e===t?"showing"!==e.mode&&(e.mode="showing"):"disabled"!==e.mode&&(e.mode="disabled"))}}handleTracksChange(e){const t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)}handleSelectedLanguageChange(e){if("showing"===this.track.mode){const e=this.player_.cache_.selectedLanguage;if(e&&e.enabled&&e.language===this.track.language&&e.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}Fd.registerComponent("TextTrackMenuItem",If);class Lf extends If{constructor(e,t){t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,super(e,t)}handleTracksChange(e){const t=this.player().textTracks();let n=!0;for(let i=0,r=t.length;i<r;i++){const e=t[i];if(this.options_.kinds.indexOf(e.kind)>-1&&"showing"===e.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)}handleSelectedLanguageChange(e){const t=this.player().textTracks();let n=!0;for(let i=0,r=t.length;i<r;i++){const e=t[i];if(["captions","descriptions","subtitles"].indexOf(e.kind)>-1&&"showing"===e.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}Fd.registerComponent("OffTextTrackMenuItem",Lf);class Df extends Af{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.tracks=e.textTracks(),super(e,t)}createItems(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:If;this.label_&&(e=`${this.label_} off`),t.push(new Lf(this.player_,{kinds:this.kinds_,kind:this.kind_,label:e})),this.hideThreshold_+=1;const i=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let r=0;r<i.length;r++){const e=i[r];if(this.kinds_.indexOf(e.kind)>-1){const i=new n(this.player_,{track:e,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});i.addClass(`vjs-${e.kind}-menu-item`),t.push(i)}}return t}}Fd.registerComponent("TextTrackButton",Df);class Rf extends Cf{constructor(e,t){const n=t.track,i=t.cue,r=e.currentTime();t.selectable=!0,t.multiSelectable=!1,t.label=i.text,t.selected=i.startTime<=r&&r<i.endTime,super(e,t),this.track=n,this.cue=i}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}Fd.registerComponent("ChaptersTrackMenuItem",Rf);class Mf extends Df{constructor(e,t,n){super(e,t,n),this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach((e=>{e.selected(this.track_.activeCues[0]===e.cue)}))}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&"chapters"!==e.track.kind)return;const t=this.findChaptersTrack();t!==this.track_?(this.setTrack(t),super.update()):(!this.items||t&&t.cues&&t.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const e=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);e&&e.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const e=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);e&&e.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let t=e.length-1;t>=0;t--){const n=e[t];if(n.kind===this.kind_)return n}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(Od(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const t=this.track_.cues;if(!t)return e;for(let n=0,i=t.length;n<i;n++){const i=t[n],r=new Rf(this.player_,{track:this.track_,cue:i});e.push(r)}return e}}Mf.prototype.kind_="chapters",Mf.prototype.controlText_="Chapters",Fd.registerComponent("ChaptersButton",Mf);class Pf extends Df{constructor(e,t,n){super(e,t,n),this.setIcon("audio-description");const i=e.textTracks(),r=md(this,this.handleTracksChange);i.addEventListener("change",r),this.on("dispose",(function(){i.removeEventListener("change",r)}))}handleTracksChange(e){const t=this.player().textTracks();let n=!1;for(let i=0,r=t.length;i<r;i++){const e=t[i];if(e.kind!==this.kind_&&"showing"===e.mode){n=!0;break}}n?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}Pf.prototype.kind_="descriptions",Pf.prototype.controlText_="Descriptions",Fd.registerComponent("DescriptionsButton",Pf);class Of extends Df{constructor(e,t,n){super(e,t,n),this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}Of.prototype.kind_="subtitles",Of.prototype.controlText_="Subtitles",Fd.registerComponent("SubtitlesButton",Of);class Nf extends If{constructor(e,t){t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",super(e,t),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+t.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}Fd.registerComponent("CaptionSettingsMenuItem",Nf);class Uf extends Df{constructor(e,t,n){super(e,t,n),this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Nf(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}Uf.prototype.kind_="captions",Uf.prototype.controlText_="Captions",Fd.registerComponent("CaptionsButton",Uf);class Ff extends If{createEl(e,t,n){const i=super.createEl(e,t,n),r=i.querySelector(".vjs-menu-item-text");return"captions"===this.options_.track.kind&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",i):r.appendChild(Tc("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),r.appendChild(Tc("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),i}}Fd.registerComponent("SubsCapsMenuItem",Ff);class Bf extends Df{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(Od(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Nf(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,Ff),e}}Bf.prototype.kinds_=["captions","subtitles"],Bf.prototype.controlText_="Subtitles",Fd.registerComponent("SubsCapsButton",Bf);class jf extends Cf{constructor(e,t){var n;const i=t.track,r=e.audioTracks();t.label=i.label||i.language||"Unknown",t.selected=i.enabled,super(e,t),n=this,this.track=i,this.addClass(`vjs-${i.kind}-menu-item`);const s=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleTracksChange.apply(n,t)};r.addEventListener("change",s),this.on("dispose",(()=>{r.removeEventListener("change",s)}))}createEl(e,t,n){const i=super.createEl(e,t,n),r=i.querySelector(".vjs-menu-item-text");return["main-desc","descriptions"].indexOf(this.options_.track.kind)>=0&&(r.appendChild(Tc("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),r.appendChild(Tc("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),i}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const e=this.player_.audioTracks();for(let t=0;t<e.length;t++){const n=e[t];n!==this.track&&(n.enabled=n===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}Fd.registerComponent("AudioTrackMenuItem",jf);class $f extends Af{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.tracks=e.audioTracks(),super(e,t),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.hideThreshold_=1;const t=this.player_.audioTracks();for(let n=0;n<t.length;n++){const i=t[n];e.push(new jf(this.player_,{track:i,selectable:!0,multiSelectable:!1}))}return e}}$f.prototype.controlText_="Audio Track",Fd.registerComponent("AudioTrackButton",$f);class Vf extends Cf{constructor(e,t){const n=t.rate,i=parseFloat(n,10);t.label=n,t.selected=i===e.playbackRate(),t.selectable=!0,t.multiSelectable=!1,super(e,t),this.label=n,this.rate=i,this.on(e,"ratechange",(e=>this.update(e)))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}Vf.prototype.contentElType="button",Fd.registerComponent("PlaybackRateMenuItem",Vf);class Hf extends xf{constructor(e,t){super(e,t),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",(e=>this.updateVisibility(e))),this.on(e,"ratechange",(e=>this.updateLabel(e))),this.on(e,"playbackrateschange",(e=>this.handlePlaybackRateschange(e)))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=Tc("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),t=[];for(let n=e.length-1;n>=0;n--)t.push(new Vf(this.player(),{rate:e[n]+"x"}));return t}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}Hf.prototype.controlText_="Playback Rate",Fd.registerComponent("PlaybackRateMenuButton",Hf);class qf extends Fd{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.className||(t.className=this.buildCSSClass()),super.createEl(e,t,n)}}Fd.registerComponent("Spacer",qf);Fd.registerComponent("CustomControlSpacer",class extends qf{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:"\xa0"})}});class Gf extends Fd{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}Gf.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]},Fd.registerComponent("ControlBar",Gf);class zf extends nh{constructor(e,t){super(e,t),this.on(e,"error",(e=>{this.open(e)}))}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}zf.prototype.options_=Object.assign({},nh.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Fd.registerComponent("ErrorDisplay",zf);class Kf extends Fd{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.el_.setAttribute("aria-labelledby",this.selectLabelledbyIds)}createEl(){this.selectLabelledbyIds=[this.options_.legendId,this.options_.labelId].join(" ").trim();return Tc("select",{id:this.options_.id},{},this.options_.SelectOptions.map((e=>{const t=(this.options_.labelId?this.options_.labelId:`vjs-track-option-${rd()}`)+"-"+e[1].replace(/\W+/g,""),n=Tc("option",{id:t,value:this.localize(e[0]),textContent:this.localize(e[1])});return n.setAttribute("aria-labelledby",`${this.selectLabelledbyIds} ${t}`),n})))}}Fd.registerComponent("TextTrackSelect",Kf);class Wf extends Fd{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});const t=Tc("legend",{textContent:this.localize(this.options_.legendText),id:this.options_.legendId});this.el().appendChild(t);const n=this.options_.selects;for(const i of n){const t=this.options_.selectConfigs[i],n=t.className,r=t.id.replace("%s",this.options_.id_);let s=null;const a=`vjs_select_${rd()}`;if("colors"===this.options_.type){s=Tc("span",{className:n});const e=Tc("label",{id:r,className:"vjs-label",textContent:this.localize(t.label)});e.setAttribute("for",a),s.appendChild(e)}const o=new Kf(e,{SelectOptions:t.options,legendId:this.options_.legendId,id:a,labelId:r});this.addChild(o),"colors"===this.options_.type&&(s.appendChild(o.el()),this.el().appendChild(s))}}createEl(){return Tc("fieldset",{className:this.options_.className})}}Fd.registerComponent("TextTrackFieldset",Wf);class Xf extends Fd{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});const t=this.options_.textTrackComponentid,n=new Wf(e,{id_:t,legendId:`captions-text-legend-${t}`,legendText:this.localize("Text"),className:"vjs-fg vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(n);const i=new Wf(e,{id_:t,legendId:`captions-background-${t}`,legendText:this.localize("Text Background"),className:"vjs-bg vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(i);const r=new Wf(e,{id_:t,legendId:`captions-window-${t}`,legendText:this.localize("Caption Area Background"),className:"vjs-window vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(r)}createEl(){return Tc("div",{className:"vjs-track-settings-colors"})}}Fd.registerComponent("TextTrackSettingsColors",Xf);class Yf extends Fd{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});const t=this.options_.textTrackComponentid,n=new Wf(e,{id_:t,legendId:`captions-font-size-${t}`,legendText:"Font Size",className:"vjs-font-percent vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(n);const i=new Wf(e,{id_:t,legendId:`captions-edge-style-${t}`,legendText:this.localize("Text Edge Style"),className:"vjs-edge-style vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(i);const r=new Wf(e,{id_:t,legendId:`captions-font-family-${t}`,legendText:this.localize("Font Family"),className:"vjs-font-family vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(r)}createEl(){return Tc("div",{className:"vjs-track-settings-font"})}}Fd.registerComponent("TextTrackSettingsFont",Yf);class Qf extends Fd{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});const t=this.localize("restore all settings to the default values"),n=new Zh(e,{controlText:t,className:"vjs-default-button"});n.el().classList.remove("vjs-control","vjs-button"),n.el().textContent=this.localize("Reset"),this.addChild(n);const i=new Zh(e,{controlText:t,className:"vjs-done-button"});i.el().classList.remove("vjs-control","vjs-button"),i.el().textContent=this.localize("Done"),this.addChild(i)}createEl(){return Tc("div",{className:"vjs-track-settings-controls"})}}Fd.registerComponent("TrackSettingsControls",Qf);const Jf="vjs-text-track-settings",Zf=["#000","Black"],ep=["#00F","Blue"],tp=["#0FF","Cyan"],np=["#0F0","Green"],ip=["#F0F","Magenta"],rp=["#F00","Red"],sp=["#FFF","White"],ap=["#FF0","Yellow"],op=["1","Opaque"],lp=["0.5","Semi-Transparent"],up=["0","Transparent"],cp={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Zf,sp,rp,np,ep,ap,ip,tp],className:"vjs-bg-color"},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[op,lp,up],className:"vjs-bg-opacity vjs-opacity"},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[sp,Zf,rp,np,ep,ap,ip,tp],className:"vjs-text-color"},edgeStyle:{selector:".vjs-edge-style > select",id:"",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:e=>"1.00"===e?null:Number(e)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[op,lp],className:"vjs-text-opacity vjs-opacity"},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color",className:"vjs-window-color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[up,lp,op],className:"vjs-window-opacity vjs-opacity"}};function dp(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}cp.windowColor.options=cp.backgroundColor.options;Fd.registerComponent("TextTrackSettings",class extends nh{constructor(e,t){t.temporary=!1,super(e,t),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.renderModalComponents(e),this.endDialog=Tc("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),void 0===t.persistTextTrackSettings&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.bindFunctionsToSelectsAndButtons(),this.options_.persistTextTrackSettings&&this.restoreSettings()}renderModalComponents(e){const t=new Xf(e,{textTrackComponentid:this.id_,selectConfigs:cp,fieldSets:[["color","textOpacity"],["backgroundColor","backgroundOpacity"],["windowColor","windowOpacity"]]});this.addChild(t);const n=new Yf(e,{textTrackComponentid:this.id_,selectConfigs:cp,fieldSets:[["fontPercent"],["edgeStyle"],["fontFamily"]]});this.addChild(n);const i=new Qf(e);this.addChild(i)}bindFunctionsToSelectsAndButtons(){this.on(this.$(".vjs-done-button"),["click","tap"],(()=>{this.saveSettings(),this.close()})),this.on(this.$(".vjs-default-button"),["click","tap"],(()=>{this.setDefaults(),this.updateDisplay()})),Uu(cp,(e=>{this.on(this.$(e.selector),"change",this.updateDisplay)}))}dispose(){this.endDialog=null,super.dispose()}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return Fu(cp,((e,t,n)=>{const i=(r=this.$(t.selector),s=t.parser,dp(r.options[r.options.selectedIndex].value,s));var r,s;return void 0!==i&&(e[n]=i),e}),{})}setValues(e){Uu(cp,((t,n)=>{!function(e,t,n){if(t)for(let i=0;i<e.options.length;i++)if(dp(e.options[i].value,n)===t){e.selectedIndex=i;break}}(this.$(t.selector),e[n],t.parser)}))}setDefaults(){Uu(cp,(e=>{const t=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=t}))}restoreSettings(){let e;try{e=JSON.parse(lo().localStorage.getItem(Jf))}catch(Nv){Mu.warn(Nv)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?lo().localStorage.setItem(Jf,JSON.stringify(e)):lo().localStorage.removeItem(Jf)}catch(Nv){Mu.warn(Nv)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}handleLanguagechange(){this.fill(),this.renderModalComponents(this.player_),this.bindFunctionsToSelectsAndButtons()}});Fd.registerComponent("ResizeManager",class extends Fd{constructor(e,t){let n=t.ResizeObserver||lo().ResizeObserver;null===t.ResizeObserver&&(n=!1);super(e,$u({createEl:!n,reportTouchActivity:!1},t)),this.ResizeObserver=t.ResizeObserver||lo().ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=vd((()=>{this.resizeHandler()}),100,!1,this),n?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const e=this.debouncedHandler_;let t=this.unloadListener_=function(){cd(this,"resize",e),cd(this,"unload",t),t=null};ud(this.el_.contentWindow,"unload",t),ud(this.el_.contentWindow,"resize",e)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}});const hp={trackingThreshold:20,liveTolerance:15};Fd.registerComponent("LiveTracker",class extends Fd{constructor(e,t){super(e,$u(hp,t,{createEl:!1})),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=e=>this.handlePlay(e),this.handleFirstTimeupdate_=e=>this.handleFirstTimeupdate(e),this.handleSeeked_=e=>this.handleSeeked(e),this.seekToLiveEdge_=e=>this.seekToLiveEdge(e),this.reset_(),this.on(this.player_,"durationchange",(e=>this.handleDurationchange(e))),this.on(this.player_,"canplay",(()=>this.toggleTracking()))}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const t=Number(lo().performance.now().toFixed(4)),n=-1===this.lastTime_?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+n;const i=this.liveCurrentTime(),r=this.player_.currentTime();let s=this.player_.paused()||this.seekedBehindLive_||Math.abs(i-r)>this.options_.liveTolerance;this.timeupdateSeen_&&i!==1/0||(s=!1),s!==this.behindLiveEdge_&&(this.behindLiveEdge_=s,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,gd),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),t=[];let n=e?e.length:0;for(;n--;)t.push(e.end(n));return t.length?t.sort()[t.length-1]:1/0}seekableStart(){const e=this.player_.seekable(),t=[];let n=e?e.length:0;for(;n--;)t.push(e.start(n));return t.length?t.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return"number"===typeof this.trackingInterval_}seekToLiveEdge(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}});Fd.registerComponent("TitleBar",class extends Fd{constructor(e,t){super(e,t),this.on("statechanged",(e=>this.updateDom_())),this.updateDom_()}createEl(){return this.els={title:Tc("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${rd()}`}),description:Tc("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${rd()}`})},Tc("div",{className:"vjs-title-bar"},{},Vu(this.els))}updateDom_(){const e=this.player_.tech_,t=e&&e.el_,n={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach((e=>{const i=this.state[e],r=this.els[e],s=n[e];Fc(r),i&&Sc(r,i),t&&(t.removeAttribute(s),i&&t.setAttribute(s,r.id))})),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,t=e&&e.el_;t&&(t.removeAttribute("aria-labelledby"),t.removeAttribute("aria-describedby")),super.dispose(),this.els=null}});const fp={initialDisplay:4e3,position:[],takeFocus:!1};Fd.registerComponent("TransientButton",class extends Zh{constructor(e,t){super(e,t=$u(fp,t)),this.controlText(t.controlText),this.hide(),this.on(this.player_,["useractive","userinactive"],(e=>{this.removeClass("force-display")}))}buildCSSClass(){return`vjs-transient-button focus-visible ${this.options_.position.map((e=>`vjs-${e}`)).join(" ")}`}createEl(){const e=Tc("button",{},{type:"button",class:this.buildCSSClass()},Tc("span"));return this.controlTextEl_=e.querySelector("span"),e}show(){super.show(),this.addClass("force-display"),this.options_.takeFocus&&this.el().focus({preventScroll:!0}),this.forceDisplayTimeout=this.player_.setTimeout((()=>{this.removeClass("force-display")}),this.options_.initialDisplay)}hide(){this.removeClass("force-display"),super.hide()}dispose(){this.player_.clearTimeout(this.forceDisplayTimeout),super.dispose()}});const pp=e=>{const t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;const n=e.$$("source"),i=[];let r="";if(!n.length)return!1;for(let s=0;s<n.length;s++){const e=n[s].src;e&&-1===i.indexOf(e)&&i.push(e)}return!!i.length&&(1===i.length&&(r=i[0]),e.triggerSourceset(r),!0)},gp=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(e){const t=co().createElement(this.nodeName.toLowerCase());t.innerHTML=e;const n=co().createDocumentFragment();for(;t.childNodes.length;)n.appendChild(t.childNodes[0]);return this.innerText="",lo().Element.prototype.appendChild.call(this,n),this.innerHTML}}),mp=(e,t)=>{let n={};for(let i=0;i<e.length&&(n=Object.getOwnPropertyDescriptor(e[i],t),!(n&&n.set&&n.get));i++);return n.enumerable=!0,n.configurable=!0,n},yp=function(e){const t=e.el();if(t.resetSourceWatch_)return;const n={},i=(e=>mp([e.el(),lo().HTMLMediaElement.prototype,lo().Element.prototype,gp],"innerHTML"))(e),r=n=>function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const a=n.apply(t,r);return pp(e),a};["append","appendChild","insertAdjacentHTML"].forEach((e=>{t[e]&&(n[e]=t[e],t[e]=r(n[e]))})),Object.defineProperty(t,"innerHTML",$u(i,{set:r(i.set)})),t.resetSourceWatch_=()=>{t.resetSourceWatch_=null,Object.keys(n).forEach((e=>{t[e]=n[e]})),Object.defineProperty(t,"innerHTML",i)},e.one("sourceset",t.resetSourceWatch_)},vp=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?ph(lo().Element.prototype.getAttribute.call(this,"src")):""},set(e){return lo().Element.prototype.setAttribute.call(this,"src",e),e}}),bp=function(e){if(!e.featuresSourceset)return;const t=e.el();if(t.resetSourceset_)return;const n=(e=>mp([e.el(),lo().HTMLMediaElement.prototype,vp],"src"))(e),i=t.setAttribute,r=t.load;Object.defineProperty(t,"src",$u(n,{set:i=>{const r=n.set.call(t,i);return e.triggerSourceset(t.src),r}})),t.setAttribute=(n,r)=>{const s=i.call(t,n,r);return/src/i.test(n)&&e.triggerSourceset(t.src),s},t.load=()=>{const n=r.call(t);return pp(e)||(e.triggerSourceset(""),yp(e)),n},t.currentSrc?e.triggerSourceset(t.currentSrc):pp(e)||yp(e),t.resetSourceset_=()=>{t.resetSourceset_=null,t.load=r,t.setAttribute=i,Object.defineProperty(t,"src",n),t.resetSourceWatch_&&t.resetSourceWatch_()}};class Tp extends Ah{constructor(e,t){super(e,t);const n=e.source;let i=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&"VIDEO"===this.el_.tagName,n&&(this.el_.currentSrc!==n.src||e.tag&&3===e.tag.initNetworkState_)?this.setSource(n):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const e=this.el_.childNodes;let t=e.length;const n=[];for(;t--;){const r=e[t];"track"===r.nodeName.toLowerCase()&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),this.textTracks().addTrack(r.track),i||this.el_.hasAttribute("crossorigin")||!mh(r.src)||(i=!0)):n.push(r))}for(let i=0;i<n.length;i++)this.el_.removeChild(n[i])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&i&&Mu.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),this.restoreMetadataTracksInIOSNativePlayer_(),(cc||ac)&&!0===e.nativeControlsForTouch&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Tp.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){bp(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let t;const n=()=>{t=[];for(let n=0;n<e.length;n++){const i=e[n];"metadata"===i.kind&&t.push({track:i,storedMode:i.mode})}};n(),e.addEventListener("change",n),this.on("dispose",(()=>e.removeEventListener("change",n)));const i=()=>{for(let e=0;e<t.length;e++){const n=t[e];"disabled"===n.track.mode&&n.track.mode!==n.storedMode&&(n.track.mode=n.storedMode)}e.removeEventListener("change",i)};this.on("webkitbeginfullscreen",(()=>{e.removeEventListener("change",n),e.removeEventListener("change",i),e.addEventListener("change",i)})),this.on("webkitendfullscreen",(()=>{e.removeEventListener("change",n),e.addEventListener("change",n),e.removeEventListener("change",i)}))}overrideNative_(e,t){if(t!==this[`featuresNative${e}Tracks`])return;const n=e.toLowerCase();this[`${n}TracksListeners_`]&&Object.keys(this[`${n}TracksListeners_`]).forEach((e=>{this.el()[`${n}Tracks`].removeEventListener(e,this[`${n}TracksListeners_`][e])})),this[`featuresNative${e}Tracks`]=!t,this[`${n}TracksListeners_`]=null,this.proxyNativeTracksForType_(n)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const t=Eh[e],n=this.el()[t.getterName],i=this[t.getterName]();if(!this[`featuresNative${t.capitalName}Tracks`]||!n||!n.addEventListener)return;const r={change:t=>{const n={type:"change",target:i,currentTarget:i,srcElement:i};i.trigger(n),"text"===e&&this[kh.remoteText.getterName]().trigger(n)},addtrack(e){i.addTrack(e.track)},removetrack(e){i.removeTrack(e.track)}},s=function(){const e=[];for(let t=0;t<i.length;t++){let r=!1;for(let e=0;e<n.length;e++)if(n[e]===i[t]){r=!0;break}r||e.push(i[t])}for(;e.length;)i.removeTrack(e.shift())};this[t.getterName+"Listeners_"]=r,Object.keys(r).forEach((e=>{const t=r[e];n.addEventListener(e,t),this.on("dispose",(i=>n.removeEventListener(e,t)))})),this.on("loadstart",s),this.on("dispose",(e=>this.off("loadstart",s)))}proxyNativeTracks_(){Eh.names.forEach((e=>{this.proxyNativeTracksForType_(e)}))}createEl(){let e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){const t=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(t,e),Tp.disposeMediaElement(e),e=t}else{e=co().createElement("video");const t=$u({},this.options_.tag&&Cc(this.options_.tag));cc&&!0===this.options_.nativeControlsForTouch||delete t.controls,Ac(e,Object.assign(t,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}"undefined"!==typeof this.options_.preload&&Lc(e,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const t=["loop","muted","playsinline","autoplay"];for(let n=0;n<t.length;n++){const i=t[n],r=this.options_[i];"undefined"!==typeof r&&(r?Lc(e,i,i):Dc(e,i),e[i]=r)}return e}handleLateInit_(e){if(0===e.networkState||3===e.networkState)return;if(0===e.readyState){let e=!1;const t=function(){e=!0};this.on("loadstart",t);const n=function(){e||this.trigger("loadstart")};return this.on("loadedmetadata",n),void this.ready((function(){this.off("loadstart",t),this.off("loadedmetadata",n),e||this.trigger("loadstart")}))}const t=["loadstart"];t.push("loadedmetadata"),e.readyState>=2&&t.push("loadeddata"),e.readyState>=3&&t.push("canplay"),e.readyState>=4&&t.push("canplaythrough"),this.ready((function(){t.forEach((function(e){this.trigger(e)}),this)}))}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&fc?this.el_.fastSeek(e):this.el_.currentTime=e}catch(t){Mu(t,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Wu&&Ju&&0===this.el_.currentTime){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},t=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",t),this.on("dispose",(()=>{this.off("webkitbeginfullscreen",t),this.off("webkitendfullscreen",e)}))}supportsFullScreen(){return"function"===typeof this.el_.webkitEnterFullScreen}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)Qd(this.el_.play()),this.setTimeout((function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}}),0);else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}}exitFullScreen(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(void 0===e)return this.el_.src;this.setSrc(e)}addSourceElement(e,t){if(!e)return Mu.error("Invalid source URL."),!1;const n={src:e};t&&(n.type=t);const i=Tc("source",{},n);return this.el_.appendChild(i),!0}removeSourceElement(e){if(!e)return Mu.error("Source URL is required to remove the source element."),!1;const t=this.el_.querySelectorAll("source");for(const n of t)if(n.src===e)return this.el_.removeChild(n),!0;return Mu.warn(`No matching source element found with src: ${e}`),!1}reset(){Tp.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,t,n){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,n):super.addTextTrack(e,t,n)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const t=co().createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t}addRemoteTextTrack(e,t){const n=super.addRemoteTextTrack(e,t);return this.featuresNativeTextTracks&&this.el().appendChild(n),n}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const t=this.$$("track");let n=t.length;for(;n--;)e!==t[n]&&e!==t[n].track||this.el().removeChild(t[n])}}getVideoPlaybackQuality(){if("function"===typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();const e={};return"undefined"!==typeof this.el().webkitDroppedFrameCount&&"undefined"!==typeof this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),lo().performance&&(e.creationTime=lo().performance.now()),e}}Hu(Tp,"TEST_VID",(function(){if(!mc())return;const e=co().createElement("video"),t=co().createElement("track");return t.kind="captions",t.srclang="en",t.label="English",e.appendChild(t),e})),Tp.isSupported=function(){try{Tp.TEST_VID.volume=.5}catch(e){return!1}return!(!Tp.TEST_VID||!Tp.TEST_VID.canPlayType)},Tp.canPlayType=function(e){return Tp.TEST_VID.canPlayType(e)},Tp.canPlaySource=function(e,t){return Tp.canPlayType(e.type)},Tp.canControlVolume=function(){try{const e=Tp.TEST_VID.volume;Tp.TEST_VID.volume=e/2+.1;const t=e!==Tp.TEST_VID.volume;return t&&hc?(lo().setTimeout((()=>{Tp&&Tp.prototype&&(Tp.prototype.featuresVolumeControl=e!==Tp.TEST_VID.volume)})),!1):t}catch(e){return!1}},Tp.canMuteVolume=function(){try{const e=Tp.TEST_VID.muted;return Tp.TEST_VID.muted=!e,Tp.TEST_VID.muted?Lc(Tp.TEST_VID,"muted","muted"):Dc(Tp.TEST_VID,"muted"),e!==Tp.TEST_VID.muted}catch(e){return!1}},Tp.canControlPlaybackRate=function(){if(Wu&&Ju&&ec<58)return!1;try{const e=Tp.TEST_VID.playbackRate;return Tp.TEST_VID.playbackRate=e/2+.1,e!==Tp.TEST_VID.playbackRate}catch(e){return!1}},Tp.canOverrideAttributes=function(){try{const e=()=>{};Object.defineProperty(co().createElement("video"),"src",{get:e,set:e}),Object.defineProperty(co().createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(co().createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(co().createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},Tp.supportsNativeTextTracks=function(){return fc||hc&&Ju},Tp.supportsNativeVideoTracks=function(){return!(!Tp.TEST_VID||!Tp.TEST_VID.videoTracks)},Tp.supportsNativeAudioTracks=function(){return!(!Tp.TEST_VID||!Tp.TEST_VID.audioTracks)},Tp.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function(e){let[t,n]=e;Hu(Tp.prototype,t,(()=>Tp[n]()),!0)})),Tp.prototype.featuresVolumeControl=Tp.canControlVolume(),Tp.prototype.movingMediaElementInDOM=!hc,Tp.prototype.featuresFullscreenResize=!0,Tp.prototype.featuresProgressEvents=!0,Tp.prototype.featuresTimeupdateEvents=!0,Tp.prototype.featuresVideoFrameCallback=!(!Tp.TEST_VID||!Tp.TEST_VID.requestVideoFrameCallback),Tp.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"===typeof e.load&&function(){try{e.load()}catch(t){}}()}},Tp.resetMediaElement=function(e){if(!e)return;const t=e.querySelectorAll("source");let n=t.length;for(;n--;)e.removeChild(t[n]);e.removeAttribute("src"),"function"===typeof e.load&&function(){try{e.load()}catch(t){}}()},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(e){Tp.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}})),["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(e){Tp.prototype["set"+Od(e)]=function(t){this.el_[e]=t,t?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}})),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(e){Tp.prototype[e]=function(){return this.el_[e]}})),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach((function(e){Tp.prototype["set"+Od(e)]=function(t){this.el_[e]=t}})),["pause","load","play"].forEach((function(e){Tp.prototype[e]=function(){return this.el_[e]()}})),Ah.withSourceHandlers(Tp),Tp.nativeSourceHandler={},Tp.nativeSourceHandler.canPlayType=function(e){try{return Tp.TEST_VID.canPlayType(e)}catch(t){return""}},Tp.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Tp.nativeSourceHandler.canPlayType(e.type);if(e.src){const t=gh(e.src);return Tp.nativeSourceHandler.canPlayType(`video/${t}`)}return""},Tp.nativeSourceHandler.handleSource=function(e,t,n){t.setSrc(e.src)},Tp.nativeSourceHandler.dispose=function(){},Tp.registerSourceHandler(Tp.nativeSourceHandler),Ah.registerTech("Html5",Tp);const Sp=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],_p={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},wp=["tiny","xsmall","small","medium","large","xlarge","huge"],Ep={};wp.forEach((e=>{const t="x"===e.charAt(0)?`x-${e.substring(1)}`:e;Ep[e]=`vjs-layout-${t}`}));const kp={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};class xp extends Fd{constructor(e,t,n){if(e.id=e.id||t.id||`vjs_video_${rd()}`,(t=Object.assign(xp.getTagSettings(e),t)).initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language){const n=e.closest("[lang]");n&&(t.language=n.getAttribute("lang"))}if(super(null,t,n),this.boundDocumentFullscreenChange_=e=>this.documentFullscreenChange_(e),this.boundFullWindowOnEscKey_=e=>this.fullWindowOnEscKey(e),this.boundUpdateStyleEl_=e=>this.updateStyleEl_(e),this.boundApplyInitTime_=e=>this.applyInitTime_(e),this.boundUpdateCurrentBreakpoint_=e=>this.updateCurrentBreakpoint_(e),this.boundHandleTechClick_=e=>this.handleTechClick_(e),this.boundHandleTechDoubleClick_=e=>this.handleTechDoubleClick_(e),this.boundHandleTechTouchStart_=e=>this.handleTechTouchStart_(e),this.boundHandleTechTouchMove_=e=>this.handleTechTouchMove_(e),this.boundHandleTechTouchEnd_=e=>this.handleTechTouchEnd_(e),this.boundHandleTechTap_=e=>this.handleTechTap_(e),this.boundUpdatePlayerHeightOnAudioOnlyMode_=e=>this.updatePlayerHeightOnAudioOnlyMode_(e),this.isFullscreen_=!1,this.log=Pu(this.id_),this.fsApi_=Cu,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={controlBarHeight:null,playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&Cc(e),this.language(this.options_.language),t.languages){const e={};Object.getOwnPropertyNames(t.languages).forEach((function(n){e[n.toLowerCase()]=t.languages[n]})),this.languages_=e}else this.languages_=xp.prototype.options_.languages;this.resetCache_(),this.poster_=t.poster||"",this.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach((e=>{if("function"!==typeof this[e])throw new Error(`plugin "${e}" does not exist`)})),this.scrubbing_=!1,this.el_=this.createEl(),Dd(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(ud(co(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const i=$u(this.options_);if(t.plugins&&Object.keys(t.plugins).forEach((e=>{this[e](t.plugins[e])})),t.debug&&this.debug(!0),this.options_.playerOptions=i,this.middleware_=[],this.playbackRates(t.playbackRates),t.experimentalSvgIcons){const e=(new(lo().DOMParser)).parseFromString('<svg xmlns="http://www.w3.org/2000/svg">\n  <defs>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-play">\n      <path d="M16 10v28l22-14z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">\n      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">\n      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">\n      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">\n      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">\n      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">\n      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">\n      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">\n      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">\n      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">\n      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">\n      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">\n      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>\n    </symbol>\n    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">\n      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">\n      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>\n    </symbol>\n    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">\n      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">\n      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">\n      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">\n      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-share">\n      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">\n      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-square">\n      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">\n      <circle cx="24" cy="24" r="20"></circle>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">\n      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">\n      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">\n      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">\n      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">\n      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">\n      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">\n      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">\n      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">\n      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">\n      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">\n      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>\n    </symbol>\n    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">\n      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">\n      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">\n      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">\n      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">\n      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">\n      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>\n    </symbol>\n    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">\n      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>\n      <path fill="none" d="M-1-3h24v24H-1z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">\n      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">\n      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1200 1227" id="vjs-icon-twitter">\n      <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">\n      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">\n      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>\n    </symbol>\n  </defs>\n</svg>',"image/svg+xml");if(e.querySelector("parsererror"))Mu.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const t=e.documentElement;t.style.display="none",this.el_.appendChild(t),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio("audio"===e.nodeName.toLowerCase()),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),t.spatialNavigation&&t.spatialNavigation.enabled&&(this.spatialNavigation=new qh(this),this.addClass("vjs-spatial-navigation-enabled")),cc&&this.addClass("vjs-touch-enabled"),hc||this.addClass("vjs-workinghover"),xp.players[this.id_]=this;const r=Eu.split(".")[0];this.addClass(`vjs-v${r}`),this.userActive(!0),this.reportUserActivity(),this.one("play",(e=>this.listenForUserActivity_(e))),this.on("keydown",(e=>this.handleKeyDown(e))),this.on("languagechange",(e=>this.handleLanguagechange(e))),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",(()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)}))}dispose(){var e;this.trigger("dispose"),this.off("dispose"),cd(co(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),cd(co(),"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),xp.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),e=this,Ih.hasOwnProperty(e.id())&&delete Ih[e.id()],xh.names.forEach((e=>{const t=this[xh[e].getterName]();t&&t.off&&t.off()})),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e,t=this.tag,n=this.playerElIngest_=t.parentNode&&t.parentNode.hasAttribute&&t.parentNode.hasAttribute("data-vjs-player");const i="video-js"===this.tag.tagName.toLowerCase();n?e=this.el_=t.parentNode:i||(e=this.el_=super.createEl("div"));const r=Cc(t);if(i){for(e=this.el_=t,t=this.tag=co().createElement("video");e.children.length;)t.appendChild(e.firstChild);wc(e,"video-js")||Ec(e,"video-js"),e.appendChild(t),n=this.playerElIngest_=e,Object.keys(e).forEach((n=>{try{t[n]=e[n]}catch(i){}}))}t.setAttribute("tabindex","-1"),r.tabindex="-1",Ju&&rc&&(t.setAttribute("role","application"),r.role="application"),t.removeAttribute("width"),t.removeAttribute("height"),"width"in r&&delete r.width,"height"in r&&delete r.height,Object.getOwnPropertyNames(r).forEach((function(n){i&&"class"===n||e.setAttribute(n,r[n]),i&&t.setAttribute(n,r[n])})),t.playerId=t.id,t.id+="_html5_api",t.className="vjs-tech",t.player=e.player=this,this.addClass("vjs-paused");const s=["IS_SMART_TV","IS_TIZEN","IS_WEBOS","IS_ANDROID","IS_IPAD","IS_IPHONE","IS_CHROMECAST_RECEIVER"].filter((e=>pc[e])).map((e=>"vjs-device-"+e.substring(3).toLowerCase().replace(/\_/g,"-")));if(this.addClass(...s),!0!==lo().VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Zc("vjs-styles-dimensions");const e=Hc(".vjs-styles-defaults"),t=Hc("head");t.insertBefore(this.styleEl_,e?e.nextSibling:t.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const a=t.getElementsByTagName("a");for(let o=0;o<a.length;o++){const e=a.item(o);Ec(e,"vjs-hidden"),e.setAttribute("hidden","hidden")}return t.initNetworkState_=t.networkState,t.parentNode&&!n&&t.parentNode.insertBefore(e,t),_c(t,e),this.children_.unshift(t),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=e,e}crossOrigin(e){if("undefined"===typeof e)return this.techGet_("crossOrigin");null===e||"anonymous"===e||"use-credentials"===e?(this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)):Mu.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,t){const n=e+"_";if(void 0===t)return this[n]||0;if(""===t||"auto"===t)return this[n]=void 0,void this.updateStyleEl_();const i=parseFloat(t);isNaN(i)?Mu.error(`Improper value "${t}" supplied for for ${e}`):(this[n]=i,this.updateStyleEl_())}fluid(e){if(void 0===e)return!!this.fluid_;var t,n;this.fluid_=!!e,wd(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),n=()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)},wd(t=this)?n():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(n))):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(!0===lo().VIDEOJS_NO_DYNAMIC_STYLE){const e="number"===typeof this.width_?this.width_:this.options_.width,t="number"===typeof this.height_?this.height_:this.options_.height,n=this.tech_&&this.tech_.el();return void(n&&(e>=0&&(n.width=e),t>=0&&(n.height=t)))}let e,t,n,i;n=void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9";const r=n.split(":"),s=r[1]/r[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/s:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*s,i=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(i),ed(this.styleEl_,`\n      .${i} {\n        width: ${e}px;\n        height: ${t}px;\n      }\n\n      .${i}.vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: ${100*s}%;\n      }\n    `)}loadTech_(e,t){this.tech_&&this.unloadTech_();const n=Od(e),i=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==n&&this.tag&&(Ah.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=n,this.isReady_=!1;let r=this.autoplay();("string"===typeof this.autoplay()||!0===this.autoplay()&&this.options_.normalizeAutoplay)&&(r=!1);const s={source:t,autoplay:r,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${i}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};xh.names.forEach((e=>{const t=xh[e];s[t.getterName]=this[t.privateName]})),Object.assign(s,this.options_[n]),Object.assign(s,this.options_[i]),Object.assign(s,this.options_[e.toLowerCase()]),this.tag&&(s.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(s.startTime=this.cache_.currentTime);const a=Ah.getTech(e);if(!a)throw new Error(`No Tech named '${n}' exists! '${n}' should be registered using videojs.registerTech()'`);this.tech_=new a(s),this.tech_.ready(md(this,this.handleTechReady_),!0),eh(this.textTracksJson_||[],this.tech_),Sp.forEach((e=>{this.on(this.tech_,e,(t=>this[`handleTech${Od(e)}_`](t)))})),Object.keys(_p).forEach((e=>{this.on(this.tech_,e,(t=>{0===this.tech_.playbackRate()&&this.tech_.seeking()?this.queuedCallbacks_.push({callback:this[`handleTech${_p[e]}_`].bind(this),event:t}):this[`handleTech${_p[e]}_`](t)}))})),this.on(this.tech_,"loadstart",(e=>this.handleTechLoadStart_(e))),this.on(this.tech_,"sourceset",(e=>this.handleTechSourceset_(e))),this.on(this.tech_,"waiting",(e=>this.handleTechWaiting_(e))),this.on(this.tech_,"ended",(e=>this.handleTechEnded_(e))),this.on(this.tech_,"seeking",(e=>this.handleTechSeeking_(e))),this.on(this.tech_,"play",(e=>this.handleTechPlay_(e))),this.on(this.tech_,"pause",(e=>this.handleTechPause_(e))),this.on(this.tech_,"durationchange",(e=>this.handleTechDurationChange_(e))),this.on(this.tech_,"fullscreenchange",((e,t)=>this.handleTechFullscreenChange_(e,t))),this.on(this.tech_,"fullscreenerror",((e,t)=>this.handleTechFullscreenError_(e,t))),this.on(this.tech_,"enterpictureinpicture",(e=>this.handleTechEnterPictureInPicture_(e))),this.on(this.tech_,"leavepictureinpicture",(e=>this.handleTechLeavePictureInPicture_(e))),this.on(this.tech_,"error",(e=>this.handleTechError_(e))),this.on(this.tech_,"posterchange",(e=>this.handleTechPosterChange_(e))),this.on(this.tech_,"textdata",(e=>this.handleTechTextData_(e))),this.on(this.tech_,"ratechange",(e=>this.handleTechRateChange_(e))),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===n&&this.tag||_c(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){xh.names.forEach((e=>{const t=xh[e];this[t.privateName]=this[t.getterName]()})),this.textTracksJson_=Zd(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return void 0===e&&Mu.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_}version(){return{"video.js":Eu}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(!0===this.autoplay()&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||"string"!==typeof e)return;const t=()=>{const e=this.muted();this.muted(!0);const t=()=>{this.muted(e)};this.playTerminatedQueue_.push(t);const n=this.play();if(Yd(n))return n.catch((e=>{throw t(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${e||""}`)}))};let n;return"any"!==e||this.muted()?n="muted"!==e||this.muted()?this.play():t():(n=this.play(),Yd(n)&&(n=n.catch(t))),Yd(n)?n.then((()=>{this.trigger({type:"autoplay-success",autoplay:e})})).catch((()=>{this.trigger({type:"autoplay-failure",autoplay:e})})):void 0}updateSourceCaches_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e,n="";"string"!==typeof t&&(t=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!n&&(n=((e,t)=>{if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;const n=e.cache_.sources.filter((e=>e.src===t));if(n.length)return n[0].type;const i=e.$$("source");for(let r=0;r<i.length;r++){const e=i[r];if(e.type&&e.src&&e.src===t)return e.type}return Bh(t)})(this,t)),this.cache_.source=$u({},e,{src:t,type:n});const i=this.cache_.sources.filter((e=>e.src&&e.src===t)),r=[],s=this.$$("source"),a=[];for(let o=0;o<s.length;o++){const e=Cc(s[o]);r.push(e),e.src&&e.src===t&&a.push(e.src)}a.length&&!i.length?this.cache_.sources=r:i.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t}handleTechSourceset_(e){if(!this.changingSrc_){let t=e=>this.updateSourceCaches_(e);const n=this.currentSource().src,i=e.src;n&&!/^blob:/.test(n)&&/^blob:/.test(i)&&(!this.lastSource_||this.lastSource_.tech!==i&&this.lastSource_.player!==n)&&(t=()=>{}),t(i),e.src||this.tech_.any(["sourceset","loadstart"],(e=>{if("sourceset"===e.type)return;const t=this.techGet_("currentSrc");this.lastSource_.tech=t,this.updateSourceCaches_(t)}))}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach((e=>e.callback(e.event))),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),t=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",t))};this.on("timeupdate",t)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){this.controls_&&(void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.click&&!1===this.options_.userActions.click||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"===typeof this.options_.userActions.click?this.options_.userActions.click.call(this,e):this.paused()?Qd(this.play()):this.pause()))}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(t=>t.contains(e.target)))||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"===typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isInPictureInPicture()&&!co().pictureInPictureElement?this.exitPictureInPicture():this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const t=e.target.player;if(t&&t!==this)return;const n=this.el();let i=co()[this.fsApi_.fullscreenElement]===n;!i&&n.matches&&(i=n.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(i)}handleTechFullscreenChange_(e,t){t&&(t.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",(()=>{this.removeClass("vjs-ios-native-fs")}))),this.isFullscreen(t.isFullscreen))}handleTechFullscreenError_(e,t){this.trigger("fullscreenerror",t)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();e&&this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,t){this.ready((function(){if(e in Ph)return function(e,t,n,i){return t[n](e.reduce(Nh(n),i))}(this.middleware_,this.tech_,e,t);if(e in Oh)return Rh(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(n){throw Mu(n),n}}),!0)}techGet_(e){if(this.tech_&&this.tech_.isReady_){if(e in Mh)return function(e,t,n){return e.reduceRight(Nh(n),t[n]())}(this.middleware_,this.tech_,e);if(e in Oh)return Rh(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){if(void 0===this.tech_[e])throw Mu(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,t),t;if("TypeError"===t.name)throw Mu(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,t),this.tech_.isReady_=!1,t;throw Mu(t),t}}}play(){return new Promise((e=>{this.play_(e)}))}play_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qd;this.playCallbacks_.push(e);const t=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc())),n=Boolean(fc||hc);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!t)return this.waitToPlay_=e=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(!t&&n&&this.load());const i=this.techGet_("play");n&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),null===i?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(i)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach((function(e){e()}))}runPlayCallbacks_(e){const t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach((function(t){t(e)}))}pause(){this.techCall_("pause")}paused(){return!1!==this.techGet_("paused")}played(){return this.techGet_("played")||$d(0,0)}scrubbing(e){if("undefined"===typeof e)return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){return void 0===e?(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime):(e<0&&(e=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",e),this.cache_.initTime=0,void(isFinite(e)&&(this.cache_.currentTime=Number(e)))):(this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),void this.one("canplay",this.boundApplyInitTime_)))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return e&&e.length||(e=$d(0,0)),e}seekable(){let e=this.techGet_("seekable");return e&&e.length||(e=$d(0,0)),e}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return Wd(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),t=this.duration();let n=e.end(e.length-1);return n>t&&(n=t),n}volume(e){let t;return void 0!==e?(t=Math.max(0,Math.min(1,e)),this.cache_.volume=t,this.techCall_("setVolume",t),void(t>0&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)}muted(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)}defaultMuted(e){return void 0!==e&&this.techCall_("setDefaultMuted",e),this.techGet_("defaultMuted")||!1}lastVolume_(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(void 0!==e){const t=this.isFullscreen_;return this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const t=this;return new Promise(((n,i)=>{function r(){t.off("fullscreenerror",a),t.off("fullscreenchange",s)}function s(){r(),n()}function a(e,t){r(),i(t)}t.one("fullscreenchange",s),t.one("fullscreenerror",a);const o=t.requestFullscreenHelper_(e);o&&(o.then(r,r),o.then(n,i))}))}requestFullscreenHelper_(e){let t;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(t=e)),this.fsApi_.requestFullscreen){const e=this.el_[this.fsApi_.requestFullscreen](t);return e&&e.then((()=>this.isFullscreen(!0)),(()=>this.isFullscreen(!1))),e}this.tech_.supportsFullScreen()&&!0===!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise(((t,n)=>{function i(){e.off("fullscreenerror",s),e.off("fullscreenchange",r)}function r(){i(),t()}function s(e,t){i(),n(t)}e.one("fullscreenchange",r),e.one("fullscreenerror",s);const a=e.exitFullscreenHelper_();a&&(a.then(i,i),a.then(t,n))}))}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=co()[this.fsApi_.exitFullscreen]();return e&&Qd(e.then((()=>this.isFullscreen(!1)))),e}this.tech_.supportsFullScreen()&&!0===!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=co().documentElement.style.overflow,ud(co(),"keydown",this.boundFullWindowOnEscKey_),co().documentElement.style.overflow="hidden",Ec(co().body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){"Escape"===e.key&&!0===this.isFullscreen()&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,cd(co(),"keydown",this.boundFullWindowOnEscKey_),co().documentElement.style.overflow=this.docOrigOverflow,kc(co().body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(void 0===e)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&lo().documentPictureInPicture){const e=co().createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(Tc("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),lo().documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then((t=>(zc(t),this.el_.parentNode.insertBefore(e,this.el_),t.document.body.appendChild(this.el_),t.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger({type:"enterpictureinpicture",pipWindow:t}),t.addEventListener("pagehide",(t=>{const n=t.target.querySelector(".video-js");e.parentNode.replaceChild(n,e),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")})),t)))}return"pictureInPictureEnabled"in co()&&!1===this.disablePictureInPicture()?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){return lo().documentPictureInPicture&&lo().documentPictureInPicture.window?(lo().documentPictureInPicture.window.close(),Promise.resolve()):"pictureInPictureEnabled"in co()?co().exitPictureInPicture():void 0}handleKeyDown(e){const{userActions:t}=this.options_;if(!t||!t.hotkeys)return;(e=>{const t=e.tagName.toLowerCase();if(e.isContentEditable)return!0;if("input"===t)return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(e.type);return-1!==["textarea"].indexOf(t)})(this.el_.ownerDocument.activeElement)||("function"===typeof t.hotkeys?t.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const t=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:n=t=>"f"===e.key.toLowerCase(),muteKey:i=t=>"m"===e.key.toLowerCase(),playPauseKey:r=t=>"k"===e.key.toLowerCase()||" "===e.key.toLowerCase()}=t;if(n.call(this,e)){e.preventDefault(),e.stopPropagation();const t=Fd.getComponent("FullscreenToggle");!1!==co()[this.fsApi_.fullscreenEnabled]&&t.prototype.handleClick.call(this,e)}else if(i.call(this,e)){e.preventDefault(),e.stopPropagation();Fd.getComponent("MuteToggle").prototype.handleClick.call(this,e)}else if(r.call(this,e)){e.preventDefault(),e.stopPropagation();Fd.getComponent("PlayToggle").prototype.handleClick.call(this,e)}}canPlayType(e){let t;for(let n=0,i=this.options_.techOrder;n<i.length;n++){const r=i[n];let s=Ah.getTech(r);if(s||(s=Fd.getComponent(r)),s){if(s.isSupported()&&(t=s.canPlayType(e),t))return t}else Mu.error(`The "${r}" tech is undefined. Skipped browser support check for that tech.`)}return""}selectSource(e){const t=this.options_.techOrder.map((e=>[e,Ah.getTech(e)])).filter((e=>{let[t,n]=e;return n?n.isSupported():(Mu.error(`The "${t}" tech is undefined. Skipped browser support check for that tech.`),!1)})),n=function(e,t,n){let i;return e.some((e=>t.some((t=>{if(i=n(e,t),i)return!0})))),i};let i;const r=(e,t)=>{let[n,i]=e;if(i.canPlaySource(t,this.options_[n.toLowerCase()]))return{source:t,tech:n}};var s;return i=this.options_.sourceOrder?n(e,t,(s=r,(e,t)=>s(t,e))):n(t,e,r),i||!1}handleSrc_(e,t){if("undefined"===typeof e)return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const n=jh(e);if(n.length){if(this.changingSrc_=!0,t||(this.cache_.sources=n),this.updateSourceCaches_(n[0]),Dh(this,n[0],((e,i)=>{this.middleware_=i,t||(this.cache_.sources=n),this.updateSourceCaches_(e);if(this.src_(e))return n.length>1?this.handleSrc_(n.slice(1)):(this.changingSrc_=!1,this.setTimeout((function(){this.error({code:4,message:this.options_.notSupportedMessage})}),0),void this.triggerReady());var r,s;r=i,s=this.tech_,r.forEach((e=>e.setTech&&e.setTech(s)))})),n.length>1){const e=()=>{this.error(null),this.handleSrc_(n.slice(1),!0)},t=()=>{this.off("error",e)};this.one("error",e),this.one("playing",t),this.resetRetryOnError_=()=>{this.off("error",e),this.off("playing",t)}}}else this.setTimeout((function(){this.error({code:4,message:this.options_.notSupportedMessage})}),0)}src(e){return this.handleSrc_(e,!1)}src_(e){const t=this.selectSource([e]);return!t||(Nd(t.tech,this.techName_)?(this.ready((function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1}),!0),!1):(this.changingSrc_=!0,this.loadTech_(t.tech,t.source),this.tech_.ready((()=>{this.changingSrc_=!1})),!1))}addSourceElement(e,t){return!!this.tech_&&this.tech_.addSourceElement(e,t)}removeSourceElement(e){return!!this.tech_&&this.tech_.removeSourceElement(e)}load(){this.tech_&&this.tech_.vhs?this.src(this.currentSource()):this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{Qd(this.play().then((()=>this.doReset_())))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),wd(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:t,progressControl:n,remainingTimeDisplay:i}=this.controlBar||{},{seekBar:r}=n||{};e&&e.updateContent(),t&&t.updateContent(),i&&i.updateContent(),r&&(r.update(),r.loadProgressBar&&r.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")}autoplay(e){if(void 0===e)return this.options_.autoplay||!1;let t;"string"===typeof e&&/(any|play|muted)/.test(e)||!0===e&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_("string"===typeof e?e:"play"),t=!1):this.options_.autoplay=!!e,t="undefined"===typeof t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)}playsinline(e){return void 0!==e&&(this.techCall_("setPlaysinline",e),this.options_.playsinline=e),this.techGet_("playsinline")}loop(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")}poster(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(void 0===e)return this.error_||null;if(xu("beforeerror").forEach((t=>{const n=t(this,e);Bu(n)&&!Array.isArray(n)||"string"===typeof n||"number"===typeof n||null===n?e=n:this.log.error("please return a value that MediaError expects in beforeerror hooks")})),this.options_.suppressNotSupportedError&&e&&4===e.code){const t=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",(function(){this.off(["click","touchstart"],t)}))}if(null===e)return this.error_=null,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new Xd(e),this.addClass("vjs-error"),Mu.error(`(CODE:${this.error_.code} ${Xd.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),xu("error").forEach((e=>e(this,this.error_)))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",(function(e){e.stopPropagation(),e.preventDefault()})),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,t,n;const i=md(this,this.reportUserActivity),r=function(t){i(),this.clearInterval(e)};this.on("mousedown",(function(){i(),this.clearInterval(e),e=this.setInterval(i,250)})),this.on("mousemove",(function(e){e.screenX===t&&e.screenY===n||(t=e.screenX,n=e.screenY,i())})),this.on("mouseup",r),this.on("mouseleave",r);const s=this.getChild("controlBar");let a;!s||hc||Wu||(s.on("mouseenter",(function(e){0!==this.player().options_.inactivityTimeout&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0})),s.on("mouseleave",(function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))),this.on("keydown",i),this.on("keyup",i);this.setInterval((function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(a);const e=this.options_.inactivityTimeout;e<=0||(a=this.setTimeout((function(){this.userActivity_||this.userActive(!1)}),e))}),250)}playbackRate(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)}defaultPlaybackRate(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e}updatePlayerHeightOnAudioOnlyMode_(){const e=this.getChild("ControlBar");e&&this.audioOnlyCache_.controlBarHeight!==e.currentHeight()&&(this.audioOnlyCache_.controlBarHeight=e.currentHeight(),this.height(this.audioOnlyCache_.controlBarHeight))}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),t=this.getChild("ControlBar"),n=t&&t.currentHeight();e.forEach((e=>{e!==t&&e.el_&&!e.hasClass("vjs-hidden")&&(e.hide(),this.audioOnlyCache_.hiddenChildren.push(e))})),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.audioOnlyCache_.controlBarHeight=n,this.on("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.height(n),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.off("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.audioOnlyCache_.hiddenChildren.forEach((e=>e.show())),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if("boolean"!==typeof e||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const e=[];return this.isInPictureInPicture()&&e.push(this.exitPictureInPicture()),this.isFullscreen()&&e.push(this.exitFullscreen()),this.audioPosterMode()&&e.push(this.audioPosterMode(!1)),Promise.all(e).then((()=>this.enableAudioOnlyUI_()))}return Promise.resolve().then((()=>this.disableAudioOnlyUI_()))}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){if("boolean"!==typeof e||e===this.audioPosterMode_)return this.audioPosterMode_;if(this.audioPosterMode_=e,e){if(this.audioOnlyMode()){return this.audioOnlyMode(!1).then((()=>{this.enablePosterModeUI_()}))}return Promise.resolve().then((()=>{this.enablePosterModeUI_()}))}return Promise.resolve().then((()=>{this.disablePosterModeUI_()}))}addTextTrack(e,t,n){if(this.tech_)return this.tech_.addTextTrack(e,t,n)}addRemoteTextTrack(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)}removeRemoteTextTrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{track:t}=e;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(void 0===e)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),wd(this)&&this.trigger("languagechange"))}languages(){return $u(xp.prototype.options_.languages,this.languages_)}toJSON(){const e=$u(this.options_),t=e.tracks;e.tracks=[];for(let n=0;n<t.length;n++){let i=t[n];i=$u(i),i.player=void 0,e.tracks[n]=i}return e}createModal(e,t){(t=t||{}).content=e||"";const n=new nh(this,t);return this.addChild(n),n.on("dispose",(()=>{this.removeChild(n)})),n.open(),n}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),t=this.currentWidth();for(let n=0;n<wp.length;n++){const i=wp[n];if(t<=this.breakpoints_[i]){if(e===i)return;e&&this.removeClass(Ep[e]),this.addClass(Ep[i]),this.breakpoint_=i;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=Object.assign({},kp,e),this.updateCurrentBreakpoint_()),Object.assign(this.breakpoints_)}responsive(e){if(void 0===e)return this.responsive_;return(e=Boolean(e))!==this.responsive_?(this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return Ep[this.breakpoint_]||""}loadMedia(e,t){if(!e||"object"!==typeof e)return;const n=this.crossOrigin();this.reset(),this.cache_.media=$u(e);const{artist:i,artwork:r,description:s,poster:a,src:o,textTracks:l,title:u}=this.cache_.media;!r&&a&&(this.cache_.media.artwork=[{src:a,type:Bh(a)}]),n&&this.crossOrigin(n),o&&this.src(o),a&&this.poster(a),Array.isArray(l)&&l.forEach((e=>this.addRemoteTextTrack(e,!1))),this.titleBar&&this.titleBar.update({title:u,description:s||i||""}),this.ready(t)}getMedia(){if(!this.cache_.media){const e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),(e=>({kind:e.kind,label:e.label,language:e.language,src:e.src})))};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:Bh(t.poster)}]),t}return $u(this.cache_.media)}static getTagSettings(e){const t={sources:[],tracks:[]},n=Cc(e),i=n["data-setup"];if(wc(e,"vjs-fill")&&(n.fill=!0),wc(e,"vjs-fluid")&&(n.fluid=!0),null!==i)try{Object.assign(n,JSON.parse(i||"{}"))}catch(r){Mu.error("data-setup",r)}if(Object.assign(t,n),e.hasChildNodes()){const n=e.childNodes;for(let e=0,i=n.length;e<i;e++){const i=n[e],r=i.nodeName.toLowerCase();"source"===r?t.sources.push(Cc(i)):"track"===r&&t.tracks.push(Cc(i))}}return t}debug(e){if(void 0===e)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(void 0===e)return this.cache_.playbackRates;Array.isArray(e)&&e.every((e=>"number"===typeof e))&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}xh.names.forEach((function(e){const t=xh[e];xp.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}})),xp.prototype.crossorigin=xp.prototype.crossOrigin,xp.players={};const Ap=lo().navigator;xp.prototype.options_={techOrder:Ah.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Ap&&(Ap.languages&&Ap.languages[0]||Ap.userLanguage||Ap.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,spatialNavigation:{enabled:!1,horizontalSeek:!1},enableSmoothSeeking:!1,disableSeekWhileScrubbingOnMobile:!1},Sp.forEach((function(e){xp.prototype[`handleTech${Od(e)}_`]=function(){return this.trigger(e)}})),Fd.registerComponent("Player",xp);const Cp="plugin",Ip="activePlugins_",Lp={},Dp=e=>Lp.hasOwnProperty(e),Rp=e=>Dp(e)?Lp[e]:void 0,Mp=(e,t)=>{e[Ip]=e[Ip]||{},e[Ip][t]=!0},Pp=(e,t,n)=>{const i=(n?"before":"")+"pluginsetup";e.trigger(i,t),e.trigger(i+":"+t.name,t)},Op=(e,t)=>(t.prototype.name=e,function(){Pp(this,{name:e,plugin:t,instance:null},!0);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];const s=new t(...[this,...i]);return this[e]=()=>s,Pp(this,s.getEventHash()),s});class Np{constructor(e){if(this.constructor===Np)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),Dd(this),delete this.trigger,Md(this,this.constructor.defaultState),Mp(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dd(this.eventBusEl_,e,this.getEventHash(t))}handleStateChanged(e){}dispose(){const{name:e,player:t}=this;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[Ip][e]=!1,this.player=this.state=null,t[e]=Op(e,Lp[e])}static isBasic(e){const t="string"===typeof e?Rp(e):e;return"function"===typeof t&&!Np.prototype.isPrototypeOf(t.prototype)}static registerPlugin(e,t){if("string"!==typeof e)throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(Dp(e))Mu.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(xp.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if("function"!==typeof t)throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof t}.`);return Lp[e]=t,e!==Cp&&(Np.isBasic(t)?xp.prototype[e]=function(e,t){const n=function(){Pp(this,{name:e,plugin:t,instance:null},!0);const n=t.apply(this,arguments);return Mp(this,e),Pp(this,{name:e,plugin:t,instance:n}),n};return Object.keys(t).forEach((function(e){n[e]=t[e]})),n}(e,t):xp.prototype[e]=Op(e,t)),t}static deregisterPlugin(e){if(e===Cp)throw new Error("Cannot de-register base plugin.");Dp(e)&&(delete Lp[e],delete xp.prototype[e])}static getPlugins(){let e;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.keys(Lp)).forEach((t=>{const n=Rp(t);n&&(e=e||{},e[t]=n)})),e}static getPluginVersion(e){const t=Rp(e);return t&&t.VERSION||""}}function Up(e,t,n,i){return function(e,t){let n=!1;return function(){n||Mu.warn(e),n=!0;for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t.apply(this,r)}}(`${t} is deprecated and will be removed in ${e}.0; please use ${n} instead.`,i)}Np.getPlugin=Rp,Np.BASE_PLUGIN_NAME=Cp,Np.registerPlugin(Cp,Np),xp.prototype.usingPlugin=function(e){return!!this[Ip]&&!0===this[Ip][e]},xp.prototype.hasPlugin=function(e){return!!Dp(e)};const Fp=e=>0===e.indexOf("#")?e.slice(1):e;function Bp(e,t,n){let i=Bp.getPlayer(e);if(i)return t&&Mu.warn(`Player "${e}" is already initialised. Options will not be applied.`),n&&i.ready(n),i;const r="string"===typeof e?Hc("#"+Fp(e)):e;if(!yc(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");const s="getRootNode"in r&&r.getRootNode()instanceof lo().ShadowRoot?r.getRootNode():r.ownerDocument.body;r.ownerDocument.defaultView&&s.contains(r)||Mu.warn("The element supplied is not included in the DOM"),!0===(t=t||{}).restoreEl&&(t.restoreEl=(r.parentNode&&r.parentNode.hasAttribute&&r.parentNode.hasAttribute("data-vjs-player")?r.parentNode:r).cloneNode(!0)),xu("beforesetup").forEach((e=>{const n=e(r,$u(t));Bu(n)&&!Array.isArray(n)?t=$u(t,n):Mu.error("please return an object in beforesetup hooks")}));const a=Fd.getComponent("Player");return i=new a(r,t,n),xu("setup").forEach((e=>e(i))),i}if(Bp.hooks_=ku,Bp.hooks=xu,Bp.hook=function(e,t){xu(e,t)},Bp.hookOnce=function(e,t){xu(e,[].concat(t).map((t=>{const n=function(){return Au(e,n),t(...arguments)};return n})))},Bp.removeHook=Au,!0!==lo().VIDEOJS_NO_DYNAMIC_STYLE&&mc()){let e=Hc(".vjs-styles-defaults");if(!e){e=Zc("vjs-styles-defaults");const t=Hc("head");t&&t.insertBefore(e,t.firstChild),ed(e,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: 56.25%\n      }\n    ")}}Qc(1,Bp),Bp.VERSION=Eu,Bp.options=xp.prototype.options_,Bp.getPlayers=()=>xp.players,Bp.getPlayer=e=>{const t=xp.players;let n;if("string"===typeof e){const i=Fp(e),r=t[i];if(r)return r;n=Hc("#"+i)}else n=e;if(yc(n)){const{player:e,playerId:i}=n;if(e||t[i])return e||t[i]}},Bp.getAllPlayers=()=>Object.keys(xp.players).map((e=>xp.players[e])).filter(Boolean),Bp.players=xp.players,Bp.getComponent=Fd.getComponent,Bp.registerComponent=(e,t)=>(Ah.isTech(t)&&Mu.warn(`The ${e} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),Fd.registerComponent.call(Fd,e,t)),Bp.getTech=Ah.getTech,Bp.registerTech=Ah.registerTech,Bp.use=function(e,t){Ch[e]=Ch[e]||[],Ch[e].push(t)},Object.defineProperty(Bp,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Bp.middleware,"TERMINATOR",{value:Lh,writeable:!1,enumerable:!0}),Bp.browser=pc,Bp.obj=qu,Bp.mergeOptions=Up(9,"videojs.mergeOptions","videojs.obj.merge",$u),Bp.defineLazyProperty=Up(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",Hu),Bp.bind=Up(9,"videojs.bind","native Function.prototype.bind",md),Bp.registerPlugin=Np.registerPlugin,Bp.deregisterPlugin=Np.deregisterPlugin,Bp.plugin=(e,t)=>(Mu.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Np.registerPlugin(e,t)),Bp.getPlugins=Np.getPlugins,Bp.getPlugin=Np.getPlugin,Bp.getPluginVersion=Np.getPluginVersion,Bp.addLanguage=function(e,t){return e=(""+e).toLowerCase(),Bp.options.languages=$u(Bp.options.languages,{[e]:t}),Bp.options.languages[e]},Bp.log=Mu,Bp.createLogger=Pu,Bp.time=Kd,Bp.createTimeRange=Up(9,"videojs.createTimeRange","videojs.time.createTimeRanges",$d),Bp.createTimeRanges=Up(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",$d),Bp.formatTime=Up(9,"videojs.formatTime","videojs.time.formatTime",zd),Bp.setFormatTime=Up(9,"videojs.setFormatTime","videojs.time.setFormatTime",qd),Bp.resetFormatTime=Up(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",Gd),Bp.parseUrl=Up(9,"videojs.parseUrl","videojs.url.parseUrl",fh),Bp.isCrossOrigin=Up(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",mh),Bp.EventTarget=Sd,Bp.any=fd,Bp.on=ud,Bp.one=hd,Bp.off=cd,Bp.trigger=dd,Bp.xhr=fo(),Bp.TextTrack=Th,Bp.AudioTrack=Sh,Bp.VideoTrack=_h,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((e=>{Bp[e]=function(){return Mu.warn(`videojs.${e}() is deprecated; use videojs.dom.${e}() instead`),Kc[e].apply(null,arguments)}})),Bp.computedStyle=Up(9,"videojs.computedStyle","videojs.dom.computedStyle",Gc),Bp.dom=Kc,Bp.fn=bd,Bp.num=uf,Bp.str=Ud,Bp.url=yh,Bp.Error={NetworkBadStatus:"networkbadstatus",NetworkRequestFailed:"networkrequestfailed",NetworkRequestAborted:"networkrequestaborted",NetworkRequestTimeout:"networkrequesttimeout",NetworkBodyParserFailed:"networkbodyparserfailed",StreamingHlsPlaylistParserError:"streaminghlsplaylistparsererror",StreamingDashManifestParserError:"streamingdashmanifestparsererror",StreamingContentSteeringParserError:"streamingcontentsteeringparsererror",StreamingVttParserError:"streamingvttparsererror",StreamingFailedToSelectNextSegment:"streamingfailedtoselectnextsegment",StreamingFailedToDecryptSegment:"streamingfailedtodecryptsegment",StreamingFailedToTransmuxSegment:"streamingfailedtotransmuxsegment",StreamingFailedToAppendSegment:"streamingfailedtoappendsegment",StreamingCodecsChangeError:"streamingcodecschangeerror"};class jp{constructor(e){let t=this;return t.id=e.id,t.label=t.id,t.width=e.width,t.height=e.height,t.bitrate=e.bandwidth,t.frameRate=e.frameRate,t.enabled_=e.enabled,Object.defineProperty(t,"enabled",{get:()=>t.enabled_(),set(e){t.enabled_(e)}}),t}}class $p extends Bp.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get:()=>e.selectedIndex_}),Object.defineProperty(e,"length",{get:()=>e.levels_.length}),e[Symbol.iterator]=()=>e.levels_.values(),e}addQualityLevel(e){let t=this.getQualityLevelById(e.id);if(t)return t;const n=this.levels_.length;return t=new jp(e),""+n in this||Object.defineProperty(this,n,{get(){return this.levels_[n]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t}removeQualityLevel(e){let t=null;for(let n=0,i=this.length;n<i;n++)if(this[n]===e){t=this.levels_.splice(n,1)[0],this.selectedIndex_===n?this.selectedIndex_=-1:this.selectedIndex_>n&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t}getQualityLevelById(e){for(let t=0,n=this.length;t<n;t++){const n=this[t];if(n.id===e)return n}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}$p.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const n in $p.prototype.allowedEvents_)$p.prototype["on"+n]=null;var Vp="4.1.0";const Hp=function(e){return function(e){const t=e.qualityLevels,n=new $p,i=function(){n.dispose(),e.qualityLevels=t,e.off("dispose",i)};return e.on("dispose",i),e.qualityLevels=()=>n,e.qualityLevels.VERSION=Vp,n}(this,Bp.obj.merge({},e))};Bp.registerPlugin("qualityLevels",Hp),Hp.VERSION=Vp;const qp=vo,Gp=(e,t)=>t&&t.responseURL&&e!==t.responseURL?t.responseURL:e,zp=e=>Bp.log.debug?Bp.log.debug.bind(Bp,"VHS:",`${e} >`):function(){};function Kp(){const e=Bp.obj||Bp,t=e.merge||e.mergeOptions;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t.apply(e,i)}function Wp(){const e=Bp.time||Bp,t=e.createTimeRanges||e.createTimeRanges;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t.apply(e,i)}const Xp=1/30,Yp=.1,Qp=function(e,t){const n=[];let i;if(e&&e.length)for(i=0;i<e.length;i++)t(e.start(i),e.end(i))&&n.push([e.start(i),e.end(i)]);return Wp(n)},Jp=function(e,t){return Qp(e,(function(e,n){return e-Yp<=t&&n+Yp>=t}))},Zp=function(e,t){return Qp(e,(function(e){return e-Xp>=t}))},eg=e=>{const t=[];if(!e||!e.length)return"";for(let n=0;n<e.length;n++)t.push(e.start(n)+" => "+e.end(n));return t.join(", ")},tg=e=>{const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t},ng=function(e){if(e&&e.length&&e.end)return e.end(e.length-1)},ig=function(e,t){let n=0;if(!e||!e.length)return n;for(let i=0;i<e.length;i++){const r=e.start(i),s=e.end(i);t>s||(n+=t>r&&t<=s?s-t:s-r)}return n},rg=(e,t)=>{if(!t.preload)return t.duration;let n=0;return(t.parts||[]).forEach((function(e){n+=e.duration})),(t.preloadHints||[]).forEach((function(t){"PART"===t.type&&(n+=e.partTargetDuration)})),n},sg=e=>(e.segments||[]).reduce(((e,t,n)=>(t.parts?t.parts.forEach((function(i,r){e.push({duration:i.duration,segmentIndex:n,partIndex:r,part:i,segment:t})})):e.push({duration:t.duration,segmentIndex:n,partIndex:null,segment:t,part:null}),e)),[]),ag=e=>{const t=e.segments&&e.segments.length&&e.segments[e.segments.length-1];return t&&t.parts||[]},og=e=>{let{preloadSegment:t}=e;if(!t)return;const{parts:n,preloadHints:i}=t;let r=(i||[]).reduce(((e,t)=>e+("PART"===t.type?1:0)),0);return r+=n&&n.length?n.length:0,r},lg=(e,t)=>{if(t.endList)return 0;if(e&&e.suggestedPresentationDelay)return e.suggestedPresentationDelay;const n=ag(t).length>0;return n&&t.serverControl&&t.serverControl.partHoldBack?t.serverControl.partHoldBack:n&&t.partTargetDuration?3*t.partTargetDuration:t.serverControl&&t.serverControl.holdBack?t.serverControl.holdBack:t.targetDuration?3*t.targetDuration:0},ug=function(e,t,n){if("undefined"===typeof t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence)return 0;const i=function(e,t){let n=0,i=t-e.mediaSequence,r=e.segments[i];if(r){if("undefined"!==typeof r.start)return{result:r.start,precise:!0};if("undefined"!==typeof r.end)return{result:r.end-r.duration,precise:!0}}for(;i--;){if(r=e.segments[i],"undefined"!==typeof r.end)return{result:n+r.end,precise:!0};if(n+=rg(e,r),"undefined"!==typeof r.start)return{result:n+r.start,precise:!0}}return{result:n,precise:!1}}(e,t);if(i.precise)return i.result;const r=function(e,t){let n,i=0,r=t-e.mediaSequence;for(;r<e.segments.length;r++){if(n=e.segments[r],"undefined"!==typeof n.start)return{result:n.start-i,precise:!0};if(i+=rg(e,n),"undefined"!==typeof n.end)return{result:n.end-i,precise:!0}}return{result:-1,precise:!1}}(e,t);return r.precise?r.result:i.result+n},cg=function(e,t,n){if(!e)return 0;if("number"!==typeof n&&(n=0),"undefined"===typeof t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return lo()[1/0]}return ug(e,t,n)},dg=function(e){let{defaultDuration:t,durationList:n,startIndex:i,endIndex:r}=e,s=0;if(i>r&&([i,r]=[r,i]),i<0){for(let e=i;e<Math.min(0,r);e++)s+=t;i=0}for(let a=i;a<r;a++)s+=n[a].duration;return s},hg=function(e,t,n,i){if(!e||!e.segments)return null;if(e.endList)return cg(e);if(null===t)return null;t=t||0;let r=ug(e,e.mediaSequence+e.segments.length,t);return n&&(r-=i="number"===typeof i?i:lg(null,e)),Math.max(0,r)},fg=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},pg=function(e){return e.excludeUntil&&e.excludeUntil===1/0},gg=function(e){const t=fg(e);return!e.disabled&&!t},mg=function(e,t){return t.attributes&&t.attributes[e]},yg=(e,t)=>{if(1===e.playlists.length)return!0;const n=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter((e=>!!gg(e)&&(e.attributes.BANDWIDTH||0)<n)).length},vg=(e,t)=>!(!e&&!t||!e&&t||e&&!t)&&(e===t||(!(!e.id||!t.id||e.id!==t.id)||(!(!e.resolvedUri||!t.resolvedUri||e.resolvedUri!==t.resolvedUri)||!(!e.uri||!t.uri||e.uri!==t.uri)))),bg=function(e,t){const n=e&&e.mediaGroups&&e.mediaGroups.AUDIO||{};let i=!1;for(const r in n){for(const e in n[r])if(i=t(n[r][e]),i)break;if(i)break}return!!i},Tg=e=>{if(!e||!e.playlists||!e.playlists.length){return bg(e,(e=>e.playlists&&e.playlists.length||e.uri))}for(let t=0;t<e.playlists.length;t++){const n=e.playlists[t],i=n.attributes&&n.attributes.CODECS;if(i&&i.split(",").every((e=>Oo(e))))continue;if(!bg(e,(e=>vg(n,e))))return!1}return!0};var Sg={liveEdgeDelay:lg,duration:cg,seekable:function(e,t,n){const i=t||0;let r=hg(e,t,!0,n);return null===r?Wp():(r<i&&(r=i),Wp(i,r))},getMediaInfoForTime:function(e){let{playlist:t,currentTime:n,startingSegmentIndex:i,startingPartIndex:r,startTime:s,exactManifestTimings:a}=e,o=n-s;const l=sg(t);let u=0;for(let c=0;c<l.length;c++){const e=l[c];if(i===e.segmentIndex&&("number"!==typeof r||"number"!==typeof e.partIndex||r===e.partIndex)){u=c;break}}if(o<0){if(u>0)for(let e=u-1;e>=0;e--){const n=l[e];if(o+=n.duration,a){if(o<0)continue}else if(o+Xp<=0)continue;return{partIndex:n.partIndex,segmentIndex:n.segmentIndex,startTime:s-dg({defaultDuration:t.targetDuration,durationList:l,startIndex:u,endIndex:e})}}return{partIndex:l[0]&&l[0].partIndex||null,segmentIndex:l[0]&&l[0].segmentIndex||0,startTime:n}}if(u<0){for(let e=u;e<0;e++)if(o-=t.targetDuration,o<0)return{partIndex:l[0]&&l[0].partIndex||null,segmentIndex:l[0]&&l[0].segmentIndex||0,startTime:n};u=0}for(let c=u;c<l.length;c++){const e=l[c];o-=e.duration;const n=e.duration>Xp;if(!(0===o)&&!(n&&o+Xp>=0)||c===l.length-1){if(a){if(o>0)continue}else if(o-Xp>=0)continue;return{partIndex:e.partIndex,segmentIndex:e.segmentIndex,startTime:s+dg({defaultDuration:t.targetDuration,durationList:l,startIndex:u,endIndex:c})}}}return{segmentIndex:l[l.length-1].segmentIndex,partIndex:l[l.length-1].partIndex,startTime:n}},isEnabled:gg,isDisabled:function(e){return e.disabled},isExcluded:fg,isIncompatible:pg,playlistEnd:hg,isAes:function(e){for(let t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},hasAttribute:mg,estimateSegmentRequestTime:function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!mg("BANDWIDTH",n))return NaN;return(e*n.attributes.BANDWIDTH-8*i)/t},isLowestEnabledRendition:yg,isAudioOnly:Tg,playlistMatch:vg,segmentDurationWithParts:rg};const{log:_g}=Bp,wg=(e,t)=>`${e}-${t}`,Eg=(e,t,n)=>`placeholder-uri-${e}-${t}-${n}`,kg=(e,t)=>{e.mediaGroups&&["AUDIO","SUBTITLES"].forEach((n=>{if(e.mediaGroups[n])for(const i in e.mediaGroups[n])for(const r in e.mediaGroups[n][i]){const s=e.mediaGroups[n][i][r];t(s,n,i,r)}}))},xg=e=>{let{playlist:t,uri:n,id:i}=e;t.id=i,t.playlistErrors_=0,n&&(t.uri=n),t.attributes=t.attributes||{}},Ag=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Eg;e.uri=t;for(let r=0;r<e.playlists.length;r++)if(!e.playlists[r].uri){const t=`placeholder-uri-${r}`;e.playlists[r].uri=t}const i=Tg(e);kg(e,((t,r,s,a)=>{if(!t.playlists||!t.playlists.length){if(i&&"AUDIO"===r&&!t.uri)for(let t=0;t<e.playlists.length;t++){const n=e.playlists[t];if(n.attributes&&n.attributes.AUDIO&&n.attributes.AUDIO===s)return}t.playlists=[mo({},t)]}t.playlists.forEach((function(t,i){const o=n(r,s,a,t),l=wg(i,o);t.uri?t.resolvedUri=t.resolvedUri||qp(e.uri,t.uri):(t.uri=0===i?o:l,t.resolvedUri=t.uri),t.id=t.id||l,t.attributes=t.attributes||{},e.playlists[t.id]=t,e.playlists[t.uri]=t}))})),(e=>{let t=e.playlists.length;for(;t--;){const n=e.playlists[t];xg({playlist:n,id:wg(t,n.uri)}),n.resolvedUri=qp(e.uri,n.uri),e.playlists[n.id]=n,e.playlists[n.uri]=n,n.attributes.BANDWIDTH||_g.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}})(e),(e=>{kg(e,(t=>{t.uri&&(t.resolvedUri=qp(e.uri,t.uri))}))})(e)};class Cg{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(null!==this.offset_)return;if(!e.length)return;const[t]=e;void 0!==t.programDateTime&&(this.offset_=t.programDateTime/1e3)}setPendingDateRanges(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length)return;const[t]=e,n=t.startDate.getTime();this.trimProcessedDateRanges_(n),this.pendingDateRanges_=e.reduce(((e,t)=>(e.set(t.id,t),e)),new Map)}processDateRange(e){this.pendingDateRanges_.delete(e.id),this.processedDateRanges_.set(e.id,e)}getDateRangesToProcess(){if(null===this.offset_)return[];const e={},t=[];this.pendingDateRanges_.forEach(((n,i)=>{if(!this.processedDateRanges_.has(i)&&(n.startTime=n.startDate.getTime()/1e3-this.offset_,n.processDateRange=()=>this.processDateRange(n),t.push(n),n.class))if(e[n.class]){const t=e[n.class].push(n);n.classListIndex=t-1}else e[n.class]=[n],n.classListIndex=0}));for(const n of t){const t=e[n.class]||[];n.endDate?n.endTime=n.endDate.getTime()/1e3-this.offset_:n.endOnNext&&t[n.classListIndex+1]?n.endTime=t[n.classListIndex+1].startTime:n.duration?n.endTime=n.startTime+n.duration:n.plannedDuration?n.endTime=n.startTime+n.plannedDuration:n.endTime=n.startTime}return t}trimProcessedDateRanges_(e){new Map(this.processedDateRanges_).forEach(((t,n)=>{t.startDate.getTime()<e&&this.processedDateRanges_.delete(n)}))}}const Ig=e=>{let{requestType:t,request:n,error:i,parseFailure:r}=e;const s=n.status<200||n.status>299,a=n.status>=400&&n.status<=499,o={uri:n.uri,requestType:t},l=s&&!a||r;if(i&&a)o.error=mo({},i),o.errorType=Bp.Error.NetworkRequestFailed;else if(n.aborted)o.errorType=Bp.Error.NetworkRequestAborted;else if(n.timedout)o.erroType=Bp.Error.NetworkRequestTimeout;else if(l){const e=r?Bp.Error.NetworkBodyParserFailed:Bp.Error.NetworkBadStatus;o.errorType=e,o.status=n.status,o.headers=n.headers}return o},{EventTarget:Lg}=Bp,Dg=(e,t)=>{if(!e)return t;const n=Kp(e,t);if(e.preloadHints&&!t.preloadHints&&delete n.preloadHints,e.parts&&!t.parts)delete n.parts;else if(e.parts&&t.parts)for(let i=0;i<t.parts.length;i++)e.parts&&e.parts[i]&&(n.parts[i]=Kp(e.parts[i],t.parts[i]));return!e.skipped&&t.skipped&&(n.skipped=!1),e.preload&&!t.preload&&(n.preload=!1),n},Rg=(e,t)=>{!e.resolvedUri&&e.uri&&(e.resolvedUri=qp(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=qp(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=qp(t,e.map.uri)),e.map&&e.map.key&&!e.map.key.resolvedUri&&(e.map.key.resolvedUri=qp(t,e.map.key.uri)),e.parts&&e.parts.length&&e.parts.forEach((e=>{e.resolvedUri||(e.resolvedUri=qp(t,e.uri))})),e.preloadHints&&e.preloadHints.length&&e.preloadHints.forEach((e=>{e.resolvedUri||(e.resolvedUri=qp(t,e.uri))}))},Mg=function(e){const t=e.segments||[],n=e.preloadSegment;if(n&&n.parts&&n.parts.length){if(n.preloadHints)for(let e=0;e<n.preloadHints.length;e++)if("MAP"===n.preloadHints[e].type)return t;n.duration=e.targetDuration,n.preload=!0,t.push(n)}return t},Pg=(e,t)=>e===t||e.segments&&t.segments&&e.segments.length===t.segments.length&&e.endList===t.endList&&e.mediaSequence===t.mediaSequence&&e.preloadSegment===t.preloadSegment,Og=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pg;const i=Kp(e,{}),r=i.playlists[t.id];if(!r)return null;if(n(r,t))return null;t.segments=Mg(t);const s=Kp(r,t);if(s.preloadSegment&&!t.preloadSegment&&delete s.preloadSegment,r.segments){if(t.skip){t.segments=t.segments||[];for(let e=0;e<t.skip.skippedSegments;e++)t.segments.unshift({skipped:!0})}s.segments=((e,t,n)=>{const i=e.slice(),r=t.slice();n=n||0;const s=[];let a;for(let o=0;o<r.length;o++){const e=i[o+n],t=r[o];e?(a=e.map||a,s.push(Dg(e,t))):(a&&!t.map&&(t.map=a),s.push(t))}return s})(r.segments,t.segments,t.mediaSequence-r.mediaSequence)}s.segments.forEach((e=>{Rg(e,s.resolvedUri)}));for(let a=0;a<i.playlists.length;a++)i.playlists[a].id===t.id&&(i.playlists[a]=s);return i.playlists[t.id]=s,i.playlists[t.uri]=s,kg(e,((e,n,i,r)=>{if(e.playlists)for(let a=0;a<e.playlists.length;a++)t.id===e.playlists[a].id&&(e.playlists[a]=s)})),i},Ng=(e,t)=>{const n=e.segments||[],i=n[n.length-1],r=i&&i.parts&&i.parts[i.parts.length-1],s=r&&r.duration||i&&i.duration;return t&&s?1e3*s:500*(e.partTargetDuration||e.targetDuration||10)},Ug=(e,t,n)=>{if(!e)return;const i=[];return e.forEach((e=>{if(!e.attributes)return;const{BANDWIDTH:t,RESOLUTION:n,CODECS:r}=e.attributes;i.push({id:e.id,bandwidth:t,resolution:n,codecs:r})})),{type:t,isLive:n,renditions:i}};class Fg extends Lg{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(super(),!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=zp("PlaylistLoader");const{withCredentials:i=!1}=n;this.src=e,this.vhs_=t,this.withCredentials=i,this.addDateRangesToTextTrack_=n.addDateRangesToTextTrack;const r=t.options_;this.customTagParsers=r&&r.customTagParsers||[],this.customTagMappers=r&&r.customTagMappers||[],this.llhls=r&&r.llhls,this.dateRangesStorage_=new Cg,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const e=this.media();if(!e)return;this.dateRangesStorage_.setOffset(e.segments),this.dateRangesStorage_.setPendingDateRanges(e.dateRanges);const t=this.dateRangesStorage_.getDateRangesToProcess();t.length&&this.addDateRangesToTextTrack_&&this.addDateRangesToTextTrack_(t)}handleMediaupdatetimeout_(){if("HAVE_METADATA"!==this.state)return;const e=this.media();let t=qp(this.main.uri,e.uri);this.llhls&&(t=((e,t)=>{if(t.endList||!t.serverControl)return e;const n={};if(t.serverControl.canBlockReload){const{preloadSegment:e}=t;let i=t.mediaSequence+t.segments.length;if(e){const r=e.parts||[],s=og(t)-1;s>-1&&s!==r.length-1&&(n._HLS_part=s),(s>-1||r.length)&&i--}n._HLS_msn=i}if(t.serverControl&&t.serverControl.canSkipUntil&&(n._HLS_skip=t.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(n).length){const t=new(lo().URL)(e);["_HLS_skip","_HLS_msn","_HLS_part"].forEach((function(e){n.hasOwnProperty(e)&&t.searchParams.set(e,n[e])})),e=t.toString()}return e})(t,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:t,withCredentials:this.withCredentials,requestType:"hls-playlist"},((e,t)=>{if(this.request)return e?this.playlistRequestError(this.request,this.media(),"HAVE_METADATA"):void this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}))}playlistRequestError(e,t,n){const{uri:i,id:r}=t;this.request=null,n&&(this.state=n),this.error={playlist:this.main.playlists[r],status:e.status,message:`HLS playlist request error at URL: ${i}.`,responseText:e.responseText,code:e.status>=500?4:2,metadata:Ig({requestType:e.requestType,request:e,error:e.error})},this.trigger("error")}parseManifest_(e){let{url:t,manifestString:n}=e;try{return(e=>{let{onwarn:t,oninfo:n,manifestString:i,customTagParsers:r=[],customTagMappers:s=[],llhls:a}=e;const o=new Io;t&&o.on("warn",t),n&&o.on("info",n),r.forEach((e=>o.addParser(e))),s.forEach((e=>o.addTagMapper(e))),o.push(i),o.end();const l=o.manifest;if(a||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach((function(e){l.hasOwnProperty(e)&&delete l[e]})),l.segments&&l.segments.forEach((function(e){["parts","preloadHints"].forEach((function(t){e.hasOwnProperty(t)&&delete e[t]}))}))),!l.targetDuration){let e=10;l.segments&&l.segments.length&&(e=l.segments.reduce(((e,t)=>Math.max(e,t.duration)),0)),t&&t({message:`manifest has no targetDuration defaulting to ${e}`}),l.targetDuration=e}const u=ag(l);if(u.length&&!l.partTargetDuration){const e=u.reduce(((e,t)=>Math.max(e,t.duration)),0);t&&(t({message:`manifest has no partTargetDuration defaulting to ${e}`}),_g.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),l.partTargetDuration=e}return l})({onwarn:e=>{let{message:n}=e;return this.logger_(`m3u8-parser warn for ${t}: ${n}`)},oninfo:e=>{let{message:n}=e;return this.logger_(`m3u8-parser info for ${t}: ${n}`)},manifestString:n,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}catch(i){this.error=i,this.error.metadata={errorType:Bp.Error.StreamingHlsPlaylistParserError,error:i}}}haveMetadata(e){let{playlistString:t,playlistObject:n,url:i,id:r}=e;this.request=null,this.state="HAVE_METADATA";const s={playlistInfo:{type:"media",uri:i}};this.trigger({type:"playlistparsestart",metadata:s});const a=n||this.parseManifest_({url:i,manifestString:t});a.lastRequest=Date.now(),xg({playlist:a,uri:i,id:r});const o=Og(this.main,a);this.targetDuration=a.partTargetDuration||a.targetDuration,this.pendingMedia_=null,o?(this.main=o,this.media_=this.main.playlists[r]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(Ng(this.media(),!!o)),s.parsedPlaylist=Ug(this.main.playlists,s.playlistInfo.type,!this.media_.endList),this.trigger({type:"playlistparsecomplete",metadata:s}),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),lo().clearTimeout(this.mediaUpdateTimeout),lo().clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new Cg,this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,t){if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"===typeof e){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(lo().clearTimeout(this.finalRenditionTimeout),t){const t=(e.partTargetDuration||e.targetDuration)/2*1e3||5e3;return void(this.finalRenditionTimeout=lo().setTimeout(this.media.bind(this,e,!1),t))}const n=this.state,i=!this.media_||e.id!==this.media_.id,r=this.main.playlists[e.id];if(r&&r.endList||e.endList&&e.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,void(i&&(this.trigger("mediachanging"),"HAVE_MAIN_MANIFEST"===n?this.trigger("loadedmetadata"):this.trigger("mediachange")));if(this.updateMediaUpdateTimeout_(Ng(e,!0)),!i)return;if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e;const s={playlistInfo:{type:"media",uri:e.uri}};this.trigger({type:"playlistrequeststart",metadata:s}),this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials,requestType:"hls-playlist"},((t,i)=>{if(this.request){if(e.lastRequest=Date.now(),e.resolvedUri=Gp(e.resolvedUri,i),t)return this.playlistRequestError(this.request,e,n);this.trigger({type:"playlistrequestcomplete",metadata:s}),this.haveMetadata({playlistString:i.responseText,url:e.uri,id:e.id}),"HAVE_MAIN_MANIFEST"===n?this.trigger("loadedmetadata"):this.trigger("mediachange")}}))}pause(){this.mediaUpdateTimeout&&(lo().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(lo().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const t=this.media();if(e){const e=t?(t.partTargetDuration||t.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=lo().setTimeout((()=>{this.mediaUpdateTimeout=null,this.load()}),e)}else this.started?t&&!t.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(lo().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=lo().setTimeout((()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)}),e))}start(){if(this.started=!0,"object"===typeof this.src)return this.src.uri||(this.src.uri=lo().location.href),this.src.resolvedUri=this.src.uri,void setTimeout((()=>{this.setupInitialPlaylist(this.src)}),0);const e={playlistInfo:{type:"multivariant",uri:this.src}};this.trigger({type:"playlistrequeststart",metadata:e}),this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials,requestType:"hls-playlist"},((t,n)=>{if(!this.request)return;if(this.request=null,t)return this.error={status:n.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:n.responseText,code:2,metadata:Ig({requestType:n.requestType,request:n,error:t})},"HAVE_NOTHING"===this.state&&(this.started=!1),this.trigger("error");this.trigger({type:"playlistrequestcomplete",metadata:e}),this.src=Gp(this.src,n),this.trigger({type:"playlistparsestart",metadata:e});const i=this.parseManifest_({manifestString:n.responseText,url:this.src});e.parsedPlaylist=Ug(i.playlists,e.playlistInfo.type,!1),this.trigger({type:"playlistparsecomplete",metadata:e}),this.setupInitialPlaylist(i)}))}srcUri(){return"string"===typeof this.src?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists)return this.main=e,Ag(this.main,this.srcUri()),e.playlists.forEach((e=>{e.segments=Mg(e),e.segments.forEach((t=>{Rg(t,e.resolvedUri)}))})),this.trigger("loadedplaylist"),void(this.request||this.media(this.main.playlists[0]));const t=this.srcUri()||lo().location.href;this.main=((e,t)=>{const n=wg(0,t),i={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:lo().location.href,resolvedUri:lo().location.href,playlists:[{uri:t,id:n,resolvedUri:t,attributes:{}}]};return i.playlists[n]=i.playlists[0],i.playlists[t]=i.playlists[0],i})(0,t),this.haveMetadata({playlistObject:e,url:t,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(e,t){const n=this.main,i=e.ID;let r=n.playlists.length;for(;r--;){const s=n.playlists[r];if(s.attributes["PATHWAY-ID"]===i){const a=s.resolvedUri,o=s.id;if(t){const t=this.createCloneURI_(s.resolvedUri,e),a=wg(i,t),o=this.createCloneAttributes_(i,s.attributes),l=this.createClonePlaylist_(s,a,e,o);n.playlists[r]=l,n.playlists[a]=l,n.playlists[t]=l}else n.playlists.splice(r,1);delete n.playlists[o],delete n.playlists[a]}}this.updateOrDeleteCloneMedia(e,t)}updateOrDeleteCloneMedia(e,t){const n=this.main,i=e.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((e=>{if(n.mediaGroups[e]&&n.mediaGroups[e][i])for(const t in n.mediaGroups[e])if(t===i){for(const i in n.mediaGroups[e][t]){n.mediaGroups[e][t][i].playlists.forEach(((e,t)=>{const i=n.playlists[e.id],r=i.id,s=i.resolvedUri;delete n.playlists[r],delete n.playlists[s]}))}delete n.mediaGroups[e][t]}})),t&&this.createClonedMediaGroups_(e)}addClonePathway(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.main,i=n.playlists.length,r=this.createCloneURI_(t.resolvedUri,e),s=wg(e.ID,r),a=this.createCloneAttributes_(e.ID,t.attributes),o=this.createClonePlaylist_(t,s,e,a);n.playlists[i]=o,n.playlists[s]=o,n.playlists[r]=o,this.createClonedMediaGroups_(e)}createClonedMediaGroups_(e){const t=e.ID,n=e["BASE-ID"],i=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((r=>{if(i.mediaGroups[r]&&!i.mediaGroups[r][t])for(const s in i.mediaGroups[r])if(s===n){i.mediaGroups[r][t]={};for(const n in i.mediaGroups[r][s]){const a=i.mediaGroups[r][s][n];i.mediaGroups[r][t][n]=mo({},a);const o=i.mediaGroups[r][t][n],l=this.createCloneURI_(a.resolvedUri,e);o.resolvedUri=l,o.uri=l,o.playlists=[],a.playlists.forEach(((s,a)=>{const l=i.playlists[s.id],u=Eg(r,t,n),c=wg(t,u);if(l&&!i.playlists[c]){const t=this.createClonePlaylist_(l,c,e),n=t.resolvedUri;i.playlists[c]=t,i.playlists[n]=t}o.playlists[a]=this.createClonePlaylist_(s,c,e)}))}}}))}createClonePlaylist_(e,t,n,i){const r=this.createCloneURI_(e.resolvedUri,n),s={resolvedUri:r,uri:r,id:t};return e.segments&&(s.segments=[]),i&&(s.attributes=i),Kp(e,s)}createCloneURI_(e,t){const n=new URL(e);n.hostname=t["URI-REPLACEMENT"].HOST;const i=t["URI-REPLACEMENT"].PARAMS;for(const r of Object.keys(i))n.searchParams.set(r,i[r]);return n.href}createCloneAttributes_(e,t){const n={"PATHWAY-ID":e};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((i=>{t[i]&&(n[i]=e)})),n}getKeyIdSet(e){if(e.contentProtection){const t=new Set;for(const n in e.contentProtection){const i=e.contentProtection[n].attributes.keyId;i&&t.add(i.toLowerCase())}return t}}}const Bg=function(e,t,n,i){const r="arraybuffer"===e.responseType?e.response:e.responseText;!t&&r&&(e.responseTime=Date.now(),e.roundTripTime=e.responseTime-e.requestTime,e.bytesReceived=r.byteLength||r.length,e.bandwidth||(e.bandwidth=Math.floor(e.bytesReceived/e.roundTripTime*8*1e3))),n.headers&&(e.responseHeaders=n.headers),t&&"ETIMEDOUT"===t.code&&(e.timedout=!0),t||e.aborted||200===n.statusCode||206===n.statusCode||0===n.statusCode||(t=new Error("XHR Failed with a response of: "+(e&&(r||e.responseText)))),i(t,e)},jg=function(){const e=function e(t,n){t=Kp({timeout:45e3},t);const i=e.beforeRequest||Bp.Vhs.xhr.beforeRequest,r=e._requestCallbackSet||Bp.Vhs.xhr._requestCallbackSet||new Set,s=e._responseCallbackSet||Bp.Vhs.xhr._responseCallbackSet;i&&"function"===typeof i&&(Bp.log.warn("beforeRequest is deprecated, use onRequest instead."),r.add(i));const a=!0===Bp.Vhs.xhr.original?Bp.xhr:Bp.Vhs.xhr,o=((e,t)=>{if(!e||!e.size)return;let n=t;return e.forEach((e=>{n=e(n)})),n})(r,t);r.delete(i);const l=a(o||t,(function(e,t){return((e,t,n,i)=>{e&&e.size&&e.forEach((e=>{e(t,n,i)}))})(s,l,e,t),Bg(l,e,t,n)})),u=l.abort;return l.abort=function(){return l.aborted=!0,u.apply(l,arguments)},l.uri=t.uri,l.requestType=t.requestType,l.requestTime=Date.now(),l};return e.original=!0,e},$g=function(e){const t={};return e.byterange&&(t.Range=function(e){let t;const n=e.offset;return t="bigint"===typeof e.offset||"bigint"===typeof e.length?lo().BigInt(e.offset)+lo().BigInt(e.length)-lo().BigInt(1):e.offset+e.length-1,"bytes="+n+"-"+t}(e.byterange)),t},Vg=function(e,t){return e.start(t)+"-"+e.end(t)},Hg=function(e,t){const n=e.toString(16);return"00".substring(0,2-n.length)+n+(t%2?" ":"")},qg=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},Gg=function(e){const t={};return Object.keys(e).forEach((n=>{const i=e[n];Ho(i)?t[n]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:t[n]=i})),t},zg=function(e){const t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},Kg=function(e){return e.resolvedUri},Wg=e=>{const t=Array.prototype.slice.call(e),n=16;let i,r,s="";for(let a=0;a<t.length/n;a++)i=t.slice(a*n,a*n+n).map(Hg).join(""),r=t.slice(a*n,a*n+n).map(qg).join(""),s+=i+" "+r+"\n";return s};var Xg=Object.freeze({__proto__:null,createTransferableMessage:Gg,initSegmentId:zg,segmentKeyId:Kg,hexDump:Wg,tagDump:e=>{let{bytes:t}=e;return Wg(t)},textRanges:e=>{let t,n="";for(t=0;t<e.length;t++)n+=Vg(e,t)+" ";return n}});const Yg=e=>{let{playlist:t,time:n,callback:i}=e;if(!i)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===n)return i({message:"getProgramTime: playlist and time must be provided"});const r=((e,t)=>{if(!t||!t.segments||0===t.segments.length)return null;let n,i=0;for(let s=0;s<t.segments.length&&(n=t.segments[s],i=n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:i+n.duration,!(e<=i));s++);const r=t.segments[t.segments.length-1];if(r.videoTimingInfo&&r.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>i){if(e>i+.25*r.duration)return null;n=r}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:i-n.duration,type:n.videoTimingInfo?"accurate":"estimate"}})(n,t);if(!r)return i({message:"valid programTime was not found"});if("estimate"===r.type)return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:r.estimatedStart});const s={mediaSeconds:n},a=((e,t)=>{if(!t.dateTimeObject)return null;const n=t.videoTimingInfo.transmuxerPrependedSeconds,i=e-(t.videoTimingInfo.transmuxedPresentationStart+n);return new Date(t.dateTimeObject.getTime()+1e3*i)})(n,r.segment);return a&&(s.programDateTime=a.toISOString()),i(null,s)},Qg=e=>{let{programTime:t,playlist:n,retryCount:i=2,seekTo:r,pauseAfterSeek:s=!0,tech:a,callback:o}=e;if(!o)throw new Error("seekToProgramTime: callback must be provided");if("undefined"===typeof t||!n||!r)return o({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!n.endList&&!a.hasStarted_)return o({message:"player must be playing a live stream to start buffering"});if(!(e=>{if(!e.segments||0===e.segments.length)return!1;for(let t=0;t<e.segments.length;t++)if(!e.segments[t].dateTimeObject)return!1;return!0})(n))return o({message:"programDateTime tags must be provided in the manifest "+n.resolvedUri});const l=((e,t)=>{let n;try{n=new Date(e)}catch(l){return null}if(!t||!t.segments||0===t.segments.length)return null;let i=t.segments[0];if(n<new Date(i.dateTimeObject))return null;for(let u=0;u<t.segments.length-1&&(i=t.segments[u],!(n<new Date(t.segments[u+1].dateTimeObject)));u++);const r=t.segments[t.segments.length-1],s=r.dateTimeObject,a=r.videoTimingInfo?(o=r.videoTimingInfo).transmuxedPresentationEnd-o.transmuxedPresentationStart-o.transmuxerPrependedSeconds:r.duration+.25*r.duration;var o;return n>new Date(s.getTime()+1e3*a)?null:(n>new Date(s)&&(i=r),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:Sg.duration(t,t.mediaSequence+t.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})})(t,n);if(!l)return o({message:`${t} was not found in the stream`});const u=l.segment,c=((e,t)=>{let n,i;try{n=new Date(e),i=new Date(t)}catch(s){}const r=n.getTime();return(i.getTime()-r)/1e3})(u.dateTimeObject,t);if("estimate"===l.type)return 0===i?o({message:`${t} is not buffered yet. Try again`}):(r(l.estimatedStart+c),void a.one("seeked",(()=>{Qg({programTime:t,playlist:n,retryCount:i-1,seekTo:r,pauseAfterSeek:s,tech:a,callback:o})})));const d=u.start+c;a.one("seeked",(()=>o(null,a.currentTime()))),s&&a.pause(),r(d)},Jg=(e,t)=>{if(4===e.readyState)return t()},Zg=(e,t,n,i)=>{let r,s=[],a=!1;const o=function(e,t,i,r){return t.abort(),a=!0,n(e,t,i,r)},l=function(e,t){if(a)return;if(e)return e.metadata=Ig({requestType:i,request:t,error:e}),o(e,t,"",s);const n=t.responseText.substring(s&&s.byteLength||0,t.responseText.length);if(s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if((t=t.filter((function(e){return e&&(e.byteLength||e.length)&&"string"!==typeof e}))).length<=1)return qo(t[0]);var i=t.reduce((function(e,t,n){return e+(t.byteLength||t.length)}),0),r=new Uint8Array(i),s=0;return t.forEach((function(e){e=qo(e),r.set(e,s),s+=e.byteLength})),r}(s,Xo(n,!0)),r=r||iu(s),s.length<10||r&&s.length<r+2)return Jg(t,(()=>o(e,t,"",s)));const l=_u(s);return"ts"===l&&s.length<188||!l&&s.length<376?Jg(t,(()=>o(e,t,"",s))):o(null,t,l,s)},u={uri:e,beforeSend(e){e.overrideMimeType("text/plain; charset=x-user-defined"),e.addEventListener("progress",(function(t){let{total:n,loaded:i}=t;return Bg(e,null,{statusCode:e.status},l)}))}},c=t(u,(function(e,t){return Bg(c,e,t,l)}));return c},{EventTarget:em}=Bp,tm=function(e,t){if(!Pg(e,t))return!1;if(e.sidx&&t.sidx&&(e.sidx.offset!==t.sidx.offset||e.sidx.length!==t.sidx.length))return!1;if(!e.sidx&&t.sidx||e.sidx&&!t.sidx)return!1;if(e.segments&&!t.segments||!e.segments&&t.segments)return!1;if(!e.segments&&!t.segments)return!0;for(let n=0;n<e.segments.length;n++){const i=e.segments[n],r=t.segments[n];if(i.uri!==r.uri)return!1;if(!i.byterange&&!r.byterange)continue;const s=i.byterange,a=r.byterange;if(s&&!a||!s&&a)return!1;if(s.offset!==a.offset||s.length!==a.length)return!1}return!0},nm=(e,t,n,i)=>`placeholder-uri-${e}-${t}-${i.attributes.NAME||n}`,im=(e,t,n)=>{let i=!0,r=Kp(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod,timelineStarts:t.timelineStarts});for(let s=0;s<t.playlists.length;s++){const e=t.playlists[s];if(e.sidx){const t=Sl(e.sidx);n&&n[t]&&n[t].sidx&&pl(e,n[t].sidx,e.sidx.resolvedUri)}const a=Og(r,e,tm);a&&(r=a,i=!1)}return kg(t,((e,t,n,s)=>{if(e.playlists&&e.playlists.length){const a=e.playlists[0].id,o=Og(r,e.playlists[0],tm);o&&(r=o,s in r.mediaGroups[t][n]||(r.mediaGroups[t][n][s]=e),r.mediaGroups[t][n][s].playlists[0]=r.playlists[a],i=!1)}})),((e,t)=>{kg(e,((n,i,r,s)=>{t.mediaGroups[i][r]&&s in t.mediaGroups[i][r]||delete e.mediaGroups[i][r][s]}))})(r,t),t.minimumUpdatePeriod!==e.minimumUpdatePeriod&&(i=!1),i?null:r},rm=(e,t)=>{const n={};for(const s in e){const a=e[s].sidx;if(a){const e=Sl(a);if(!t[e])break;const s=t[e].sidxInfo;i=s,r=a,(Boolean(!i.map&&!r.map)||Boolean(i.map&&r.map&&i.map.byterange.offset===r.map.byterange.offset&&i.map.byterange.length===r.map.byterange.length))&&i.uri===r.uri&&i.byterange.offset===r.byterange.offset&&i.byterange.length===r.byterange.length&&(n[e]=t[e])}}var i,r;return n};class sm extends em{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;super(),this.isPaused_=!0,this.mainPlaylistLoader_=i||this,i||(this.isMain_=!0);const{withCredentials:r=!1}=n;if(this.vhs_=t,this.withCredentials=r,this.addMetadataToTextTrack=n.addMetadataToTextTrack,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",(()=>{this.refreshXml_()})),this.on("mediaupdatetimeout",(()=>{this.refreshMedia_(this.media().id)})),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=zp("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}get isPaused(){return this.isPaused_}requestErrored_(e,t,n){return!this.request||(this.request=null,e?(this.error="object"!==typeof e||e instanceof Error?{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2,metadata:e.metadata}:e,n&&(this.state=n),this.trigger("error"),!0):void 0)}addSidxSegments_(e,t,n){const i=e.sidx&&Sl(e.sidx);if(!e.sidx||!i||this.mainPlaylistLoader_.sidxMapping_[i])return lo().clearTimeout(this.mediaRequest_),void(this.mediaRequest_=lo().setTimeout((()=>n(!1)),0));const r=Gp(e.sidx.resolvedUri),s=(r,s)=>{if(this.requestErrored_(r,s,t))return;const a=this.mainPlaylistLoader_.sidxMapping_,{requestType:o}=s;let l;try{l=tu()(qo(s.response).subarray(8))}catch(u){return u.metadata=Ig({requestType:o,request:s,parseFailure:!0}),void this.requestErrored_(u,s,t)}return a[i]={sidxInfo:e.sidx,sidx:l},pl(e,l,e.sidx.resolvedUri),n(!0)};this.request=Zg(r,this.vhs_.xhr,((t,n,i,a)=>{if(t)return s(t,n);if(!i||"mp4"!==i){const t=i||"unknown";return s({status:n.status,message:`Unsupported ${t} container type for sidx segment at URL: ${r}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:1/0,code:2},n)}const{offset:o,length:l}=e.sidx.byterange;if(a.length>=l+o)return s(t,{response:a.subarray(o,o+l),status:n.status,uri:n.uri});this.request=this.vhs_.xhr({uri:r,responseType:"arraybuffer",requestType:"dash-sidx",headers:$g({byterange:e.sidx.byterange})},s)}),"dash-sidx")}dispose(){this.isPaused_=!0,this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},lo().clearTimeout(this.minimumUpdatePeriodTimeout_),lo().clearTimeout(this.mediaRequest_),lo().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);const t=this.state;if("string"===typeof e){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const n=!this.media_||e.id!==this.media_.id;if(n&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList)return this.state="HAVE_METADATA",this.media_=e,void(n&&(this.trigger("mediachanging"),this.trigger("mediachange")));n&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,t,(n=>{this.haveMetadata({startingState:t,playlist:e})})))}haveMetadata(e){let{startingState:t,playlist:n}=e;this.state="HAVE_METADATA",this.loadedPlaylists_[n.id]=n,lo().clearTimeout(this.mediaRequest_),this.mediaRequest_=null,this.refreshMedia_(n.id),"HAVE_MAIN_MANIFEST"===t?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.isPaused_=!0,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),lo().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(lo().clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),"HAVE_NOTHING"===this.state&&(this.started=!1)}load(e){this.isPaused_=!1,lo().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const t=this.media();if(e){const e=t?t.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=lo().setTimeout((()=>this.load()),e)}else this.started?t&&!t.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()}start(){if(this.started=!0,!this.isMain_)return lo().clearTimeout(this.mediaRequest_),void(this.mediaRequest_=lo().setTimeout((()=>this.haveMain_()),0));this.requestMain_(((e,t)=>{this.haveMain_(),this.hasPendingRequest()||this.media_||this.media(this.mainPlaylistLoader_.main.playlists[0])}))}requestMain_(e){const t={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestrequeststart",metadata:t}),this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials,requestType:"dash-manifest"},((n,i)=>{if(n){const{requestType:e}=i;n.metadata=Ig({requestType:e,request:i,error:n})}if(this.requestErrored_(n,i))return void("HAVE_NOTHING"===this.state&&(this.started=!1));this.trigger({type:"manifestrequestcomplete",metadata:t});const r=i.responseText!==this.mainPlaylistLoader_.mainXml_;return this.mainPlaylistLoader_.mainXml_=i.responseText,i.responseHeaders&&i.responseHeaders.date?this.mainLoaded_=Date.parse(i.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=Gp(this.mainPlaylistLoader_.srcUrl,i),r?(this.handleMain_(),void this.syncClientServerClock_((()=>e(i,r)))):e(i,r)}))}syncClientServerClock_(e){const t=Jl(this.mainPlaylistLoader_.mainXml_);return null===t?(this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e()):"DIRECT"===t.method?(this.mainPlaylistLoader_.clientOffset_=t.value-Date.now(),e()):void(this.request=this.vhs_.xhr({uri:qp(this.mainPlaylistLoader_.srcUrl,t.value),method:t.method,withCredentials:this.withCredentials,requestType:"dash-clock-sync"},((n,i)=>{if(!this.request)return;if(n){const{requestType:t}=i;return this.error.metadata=Ig({requestType:t,request:i,error:n}),this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e()}let r;r="HEAD"===t.method?i.responseHeaders&&i.responseHeaders.date?Date.parse(i.responseHeaders.date):this.mainLoaded_:Date.parse(i.responseText),this.mainPlaylistLoader_.clientOffset_=r-Date.now(),e()})))}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){lo().clearTimeout(this.mediaRequest_),this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main,t={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};let n;this.trigger({type:"manifestparsestart",metadata:t});try{n=(e=>{let{mainXml:t,srcUrl:n,clientOffset:i,sidxMapping:r,previousManifest:s}=e;const a=Ql(t,{manifestUri:n,clientOffset:i,sidxMapping:r,previousManifest:s});return Ag(a,n,nm),a})({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e})}catch(r){this.error=r,this.error.metadata={errorType:Bp.Error.StreamingDashManifestParserError,error:r},this.trigger("error")}e&&(n=im(e,n,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=n||e;const i=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];if(i&&i!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=i),(!e||n&&n.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(n),n){const{duration:e,endList:i}=n,r=[];n.playlists.forEach((e=>{r.push({id:e.id,bandwidth:e.attributes.BANDWIDTH,resolution:e.attributes.RESOLUTION,codecs:e.attributes.CODECS})}));const s={duration:e,isLive:!i,renditions:r};t.parsedManifest=s,this.trigger({type:"manifestparsecomplete",metadata:t})}return Boolean(n)}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(lo().clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let t=e.main&&e.main.minimumUpdatePeriod;0===t&&(e.media()?t=1e3*e.media().targetDuration:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),"number"!==typeof t||t<=0?t<0&&this.logger_(`found invalid minimumUpdatePeriod of ${t}, not setting a timeout`):this.createMUPTimeout_(t)}createMUPTimeout_(e){const t=this.mainPlaylistLoader_;t.minimumUpdatePeriodTimeout_=lo().setTimeout((()=>{t.minimumUpdatePeriodTimeout_=null,t.trigger("minimumUpdatePeriod"),t.createMUPTimeout_(e)}),e)}refreshXml_(){this.requestMain_(((e,t)=>{t&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=((e,t)=>{let n=rm(e.playlists,t);return kg(e,((e,i,r,s)=>{if(e.playlists&&e.playlists.length){const i=e.playlists;n=Kp(n,rm(i,t))}})),n})(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,(e=>{this.refreshMedia_(this.media().id)})))}))}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const t=this.mainPlaylistLoader_.main.playlists,n=!this.media_||this.media_!==t[e];if(n?this.media_=t[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const e=()=>{this.media().endList||(this.mediaUpdateTimeout=lo().setTimeout((()=>{this.trigger("mediaupdatetimeout"),e()}),Ng(this.media(),Boolean(n))))};e()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(e){if(e&&this.mainPlaylistLoader_.main.eventStream){const e=this.mainPlaylistLoader_.main.eventStream.map((e=>({cueTime:e.start,frames:[{data:e.messageData}]})));this.addMetadataToTextTrack("EventStream",e,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(e){if(e.contentProtection){const t=new Set;for(const n in e.contentProtection){const i=e.contentProtection[n].attributes["cenc:default_KID"];i&&t.add(i.replace(/-/g,"").toLowerCase())}return t}}}var am={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const om=function(e){return e.on=e.addEventListener,e.off=e.removeEventListener,e},lm=function(e){return function(){const t=function(e){try{return URL.createObjectURL(new Blob([e],{type:"application/javascript"}))}catch(t){const n=new BlobBuilder;return n.append(e),URL.createObjectURL(n.getBlob())}}(e),n=om(new Worker(t));n.objURL=t;const i=n.terminate;return n.on=n.addEventListener,n.off=n.removeEventListener,n.terminate=function(){return URL.revokeObjectURL(t),i.call(this)},n}},um=function(e){return`var browserWorkerPolyFill = ${om.toString()};\nbrowserWorkerPolyFill(self);\n`+e},cm=function(e){return e.toString().replace(/^function.+?{/,"").slice(0,-1)};var dm=lm(um(cm((function(){var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},t=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var i;return!!e[t]&&(i=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(i,1),i>-1)},this.trigger=function(t){var n,i,r,s;if(n=e[t])if(2===arguments.length)for(r=n.length,i=0;i<r;++i)n[i].call(this,arguments[1]);else{for(s=[],i=arguments.length,i=1;i<arguments.length;++i)s.push(arguments[i]);for(r=n.length,i=0;i<r;++i)n[i].apply(this,s)}},this.dispose=function(){e={}}}};t.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},t.prototype.push=function(e){this.trigger("data",e)},t.prototype.flush=function(e){this.trigger("done",e)},t.prototype.partialFlush=function(e){this.trigger("partialdone",e)},t.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},t.prototype.reset=function(e){this.trigger("reset",e)};var i,r,s,a,o,l,u,c,d,h,f,p,g,m,y,v,b,T,S,_,w,E,k,x,A,C,I,L,D,R,M,P,O,N,U,F,B=t,j=Math.pow(2,32),$={getUint64:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getBigUint64?(t=n.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(t):t:n.getUint32(0)*j+n.getUint32(4)},MAX_UINT32:j},V=$.MAX_UINT32;!function(){var e;if(k={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!==typeof Uint8Array){for(e in k)k.hasOwnProperty(e)&&(k[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);x=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),C=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),A=new Uint8Array([0,0,0,1]),I=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),L=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),D={video:I,audio:L},P=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),M=new Uint8Array([0,0,0,0,0,0,0,0]),O=new Uint8Array([0,0,0,0,0,0,0,0]),N=O,U=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),F=O,R=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),i=function(e){var t,n,i=[],r=0;for(t=1;t<arguments.length;t++)i.push(arguments[t]);for(t=i.length;t--;)r+=i[t].byteLength;for(n=new Uint8Array(r+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),t=0,r=8;t<i.length;t++)n.set(i[t],r),r+=i[t].byteLength;return n},r=function(){return i(k.dinf,i(k.dref,P))},s=function(e){return i(k.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},a=function(){return i(k.ftyp,x,A,x,C)},v=function(e){return i(k.hdlr,D[e])},o=function(e){return i(k.mdat,e)},y=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),i(k.mdhd,t)},m=function(e){return i(k.mdia,y(e),v(e.type),u(e))},l=function(e){return i(k.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},u=function(e){return i(k.minf,"video"===e.type?i(k.vmhd,R):i(k.smhd,M),r(),T(e))},c=function(e,t){for(var n=[],r=t.length;r--;)n[r]=_(t[r]);return i.apply(null,[k.moof,l(e)].concat(n))},d=function(e){for(var t=e.length,n=[];t--;)n[t]=p(e[t]);return i.apply(null,[k.moov,f(4294967295)].concat(n).concat(h(e)))},h=function(e){for(var t=e.length,n=[];t--;)n[t]=w(e[t]);return i.apply(null,[k.mvex].concat(n))},f=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return i(k.mvhd,t)},b=function(e){var t,n,r=e.samples||[],s=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)t=r[n].flags,s[n+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return i(k.sdtp,s)},T=function(e){return i(k.stbl,S(e),i(k.stts,F),i(k.stsc,N),i(k.stsz,U),i(k.stco,O))},function(){var e,t;S=function(n){return i(k.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===n.type?e(n):t(n))},e=function(e){var t,n,r=e.sps||[],s=e.pps||[],a=[],o=[];for(t=0;t<r.length;t++)a.push((65280&r[t].byteLength)>>>8),a.push(255&r[t].byteLength),a=a.concat(Array.prototype.slice.call(r[t]));for(t=0;t<s.length;t++)o.push((65280&s[t].byteLength)>>>8),o.push(255&s[t].byteLength),o=o.concat(Array.prototype.slice.call(s[t]));if(n=[k.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),i(k.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([r.length],a,[s.length],o))),i(k.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var l=e.sarRatio[0],u=e.sarRatio[1];n.push(i(k.pasp,new Uint8Array([(4278190080&l)>>24,(16711680&l)>>16,(65280&l)>>8,255&l,(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u])))}return i.apply(null,n)},t=function(e){return i(k.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),s(e))}}(),g=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return i(k.tkhd,t)},_=function(e){var t,n,r,s,a,o;return t=i(k.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),a=Math.floor(e.baseMediaDecodeTime/V),o=Math.floor(e.baseMediaDecodeTime%V),n=i(k.tfdt,new Uint8Array([1,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),"audio"===e.type?(r=E(e,92),i(k.traf,t,n,r)):(s=b(e),r=E(e,s.length+92),i(k.traf,t,n,r,s))},p=function(e){return e.duration=e.duration||4294967295,i(k.trak,g(e),m(e))},w=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),i(k.trex,t)},function(){var e,t,n;n=function(e,t){var n=0,i=0,r=0,s=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(i=2),void 0!==e[0].flags&&(r=4),void 0!==e[0].compositionTimeOffset&&(s=8)),[0,0,n|i|r|s,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},t=function(e,t){var r,s,a,o,l,u;for(t+=20+16*(o=e.samples||[]).length,a=n(o,t),(s=new Uint8Array(a.length+16*o.length)).set(a),r=a.length,u=0;u<o.length;u++)l=o[u],s[r++]=(4278190080&l.duration)>>>24,s[r++]=(16711680&l.duration)>>>16,s[r++]=(65280&l.duration)>>>8,s[r++]=255&l.duration,s[r++]=(4278190080&l.size)>>>24,s[r++]=(16711680&l.size)>>>16,s[r++]=(65280&l.size)>>>8,s[r++]=255&l.size,s[r++]=l.flags.isLeading<<2|l.flags.dependsOn,s[r++]=l.flags.isDependedOn<<6|l.flags.hasRedundancy<<4|l.flags.paddingValue<<1|l.flags.isNonSyncSample,s[r++]=61440&l.flags.degradationPriority,s[r++]=15&l.flags.degradationPriority,s[r++]=(4278190080&l.compositionTimeOffset)>>>24,s[r++]=(16711680&l.compositionTimeOffset)>>>16,s[r++]=(65280&l.compositionTimeOffset)>>>8,s[r++]=255&l.compositionTimeOffset;return i(k.trun,s)},e=function(e,t){var r,s,a,o,l,u;for(t+=20+8*(o=e.samples||[]).length,a=n(o,t),(r=new Uint8Array(a.length+8*o.length)).set(a),s=a.length,u=0;u<o.length;u++)l=o[u],r[s++]=(4278190080&l.duration)>>>24,r[s++]=(16711680&l.duration)>>>16,r[s++]=(65280&l.duration)>>>8,r[s++]=255&l.duration,r[s++]=(4278190080&l.size)>>>24,r[s++]=(16711680&l.size)>>>16,r[s++]=(65280&l.size)>>>8,r[s++]=255&l.size;return i(k.trun,r)},E=function(n,i){return"audio"===n.type?e(n,i):t(n,i)}}();var H,q,G,z,K,W,X,Y,Q={ftyp:a,mdat:o,moof:c,moov:d,initSegment:function(e){var t,n=a(),i=d(e);return(t=new Uint8Array(n.byteLength+i.byteLength)).set(n),t.set(i,n.byteLength),t}},J=function(e,t){var n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},Z={groupNalsIntoFrames:function(e){var t,n,i=[],r=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,i.byteLength=0,t=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(n=e[t]).nalUnitType?(i.length&&(i.duration=n.dts-i.dts,r.byteLength+=i.byteLength,r.nalCount+=i.length,r.duration+=i.duration,r.push(i)),(i=[n]).byteLength=n.data.byteLength,i.pts=n.pts,i.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(i.keyFrame=!0),i.duration=n.dts-i.dts,i.byteLength+=n.data.byteLength,i.push(n));return r.length&&(!i.duration||i.duration<=0)&&(i.duration=r[r.length-1].duration),r.byteLength+=i.byteLength,r.nalCount+=i.length,r.duration+=i.duration,r.push(i),r},groupFramesIntoGops:function(e){var t,n,i=[],r=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,t=0;t<e.length;t++)(n=e[t]).keyFrame?(i.length&&(r.push(i),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration),(i=[n]).nalCount=n.length,i.byteLength=n.byteLength,i.pts=n.pts,i.dts=n.dts,i.duration=n.duration):(i.duration+=n.duration,i.nalCount+=n.length,i.byteLength+=n.byteLength,i.push(n));return r.length&&i.duration<=0&&(i.duration=r[r.length-1].duration),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration,r.push(i),r},extendFirstKeyFrame:function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},generateSampleTable:function(e,t){var n,i,r,s,a,o=t||0,l=[];for(n=0;n<e.length;n++)for(s=e[n],i=0;i<s.length;i++)a=s[i],o+=(r=J(a,o)).size,l.push(r);return l},concatenateNalData:function(e){var t,n,i,r,s,a,o=0,l=e.byteLength,u=e.nalCount,c=new Uint8Array(l+4*u),d=new DataView(c.buffer);for(t=0;t<e.length;t++)for(r=e[t],n=0;n<r.length;n++)for(s=r[n],i=0;i<s.length;i++)a=s[i],d.setUint32(o,a.data.byteLength),o+=4,c.set(a.data,o),o+=a.data.byteLength;return c},generateSampleTableForFrame:function(e,t){var n,i=[];return n=J(e,t||0),i.push(n),i},concatenateNalDataForFrame:function(e){var t,n,i=0,r=e.byteLength,s=e.length,a=new Uint8Array(r+4*s),o=new DataView(a.buffer);for(t=0;t<e.length;t++)n=e[t],o.setUint32(i,n.data.byteLength),i+=4,a.set(n.data,i),i+=n.data.byteLength;return a}},ee=[33,16,5,32,164,27],te=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],ne=function(e){for(var t=[];e--;)t.push(0);return t},ie=9e4;W=function(e,t){return q(K(e,t))},X=function(e,t){return G(z(e),t)},Y=function(e,t,n){return z(n?e:e-t)};var re={ONE_SECOND_IN_TS:ie,secondsToVideoTs:q=function(e){return e*ie},secondsToAudioTs:G=function(e,t){return e*t},videoTsToSeconds:z=function(e){return e/ie},audioTsToSeconds:K=function(e,t){return e/t},audioTsToVideoTs:W,videoTsToAudioTs:X,metadataTsToSeconds:Y},se=function(){if(!H){var e={96e3:[ee,[227,64],ne(154),[56]],88200:[ee,[231],ne(170),[56]],64e3:[ee,[248,192],ne(240),[56]],48e3:[ee,[255,192],ne(268),[55,148,128],ne(54),[112]],44100:[ee,[255,192],ne(268),[55,163,128],ne(84),[112]],32e3:[ee,[255,192],ne(268),[55,234],ne(226),[112]],24e3:[ee,[255,192],ne(268),[55,255,128],ne(268),[111,112],ne(126),[224]],16e3:[ee,[255,192],ne(268),[55,255,128],ne(268),[111,255],ne(269),[223,108],ne(195),[1,192]],12e3:[te,ne(268),[3,127,248],ne(268),[6,255,240],ne(268),[13,255,224],ne(268),[27,253,128],ne(259),[56]],11025:[te,ne(268),[3,127,248],ne(268),[6,255,240],ne(268),[13,255,224],ne(268),[27,255,192],ne(268),[55,175,128],ne(108),[112]],8e3:[te,ne(268),[3,121,16],ne(47),[7]]};t=e,H=Object.keys(t).reduce((function(e,n){return e[n]=new Uint8Array(t[n].reduce((function(e,t){return e.concat(t)}),[])),e}),{})}var t;return H},ae=re,oe={prefixWithSilence:function(e,t,n,i){var r,s,a,o,l,u=0,c=0,d=0;if(t.length&&(r=ae.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),s=Math.ceil(ae.ONE_SECOND_IN_TS/(e.samplerate/1024)),n&&i&&(u=r-Math.max(n,i),d=(c=Math.floor(u/s))*s),!(c<1||d>ae.ONE_SECOND_IN_TS/2))){for((a=se()[e.samplerate])||(a=t[0].data),o=0;o<c;o++)l=t[0],t.splice(0,0,{data:a,dts:l.dts-s,pts:l.pts-s});return e.baseMediaDecodeTime-=Math.floor(ae.videoTsToAudioTs(d,e.samplerate)),d}},trimAdtsFramesByEarliestDts:function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter((function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)})))},generateSampleTable:function(e){var t,n,i=[];for(t=0;t<e.length;t++)n=e[t],i.push({size:n.data.byteLength,duration:1024});return i},concatenateFrameData:function(e){var t,n,i=0,r=new Uint8Array(function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].data.byteLength;return n}(e));for(t=0;t<e.length;t++)n=e[t],r.set(n.data,i),i+=n.data.byteLength;return r}},le=re.ONE_SECOND_IN_TS,ue={clearDtsInfo:function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(e,t){var n,i=e.minSegmentDts;return t||(i-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=i,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/le,n=Math.floor(n)),n},collectDtsInfo:function(e,t){"number"===typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"===typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))}},ce={parseSei:function(e){for(var t=0,n={payloadType:-1,payloadSize:0},i=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)i+=255,t++;for(i+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!n.payload&&4===i){if("GA94"===String.fromCharCode(e[t+3],e[t+4],e[t+5],e[t+6])){n.payloadType=i,n.payloadSize=r,n.payload=e.subarray(t,t+r);break}n.payload=void 0}t+=r,i=0,r=0}return n},parseUserData:function(e){return 181!==e.payload[0]||49!==(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},parseCaptionPackets:function(e,t){var n,i,r,s,a=[];if(!(64&t[0]))return a;for(i=31&t[0],n=0;n<i;n++)s={type:3&t[(r=3*n)+2],pts:e},4&t[r+2]&&(s.ccData=t[r+3]<<8|t[r+4],a.push(s));return a},discardEmulationPreventionBytes:function(e){for(var t,n,i=e.byteLength,r=[],s=1;s<i-2;)0===e[s]&&0===e[s+1]&&3===e[s+2]?(r.push(s+2),s+=2):s++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var a=0;for(s=0;s<t;a++,s++)a===r[0]&&(a++,r.shift()),n[s]=e[a];return n},USER_DATA_REGISTERED_ITU_T_T35:4},de=B,he=ce,fe=function(e){e=e||{},fe.prototype.init.call(this),this.parse708captions_="boolean"!==typeof e.parse708captions||e.parse708captions,this.captionPackets_=[],this.ccStreams_=[new we(0,0),new we(0,1),new we(1,0),new we(1,1)],this.parse708captions_&&(this.cc708Stream_=new ve({captionServices:e.captionServices})),this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};fe.prototype=new de,fe.prototype.push=function(e){var t,n,i;if("sei_rbsp"===e.nalUnitType&&(t=he.parseSei(e.escapedRBSP)).payload&&t.payloadType===he.USER_DATA_REGISTERED_ITU_T_T35&&(n=he.parseUserData(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));i=he.parseCaptionPackets(e.pts,n),this.captionPackets_=this.captionPackets_.concat(i),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},fe.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)},fe.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach((function(e,t){e.presortIndex=t})),this.captionPackets_.sort((function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts})),this.captionPackets_.forEach((function(e){e.type<2?this.dispatchCea608Packet(e):this.dispatchCea708Packet(e)}),this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},fe.prototype.flush=function(){return this.flushStream("flush")},fe.prototype.partialFlush=function(){return this.flushStream("partialFlush")},fe.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},fe.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},fe.prototype.setsChannel1Active=function(e){return 4096===(30720&e.ccData)},fe.prototype.setsChannel2Active=function(e){return 6144===(30720&e.ccData)},fe.prototype.setsTextOrXDSActive=function(e){return 256===(28928&e.ccData)||4138===(30974&e.ccData)||6186===(30974&e.ccData)},fe.prototype.dispatchCea708Packet=function(e){this.parse708captions_&&this.cc708Stream_.push(e)};var pe={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},ge=function(e){return 32<=e&&e<=127||160<=e&&e<=255},me=function(e){this.windowNum=e,this.reset()};me.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},me.prototype.getText=function(){return this.rows.join("\n")},me.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},me.prototype.newLine=function(e){for(this.rows.length>=this.virtualRowCount&&"function"===typeof this.beforeRowOverflow&&this.beforeRowOverflow(e),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},me.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},me.prototype.addText=function(e){this.rows[this.rowIdx]+=e},me.prototype.backspace=function(){if(!this.isEmpty()){var e=this.rows[this.rowIdx];this.rows[this.rowIdx]=e.substr(0,e.length-1)}};var ye=function(e,t,n){this.serviceNum=e,this.text="",this.currentWindow=new me(-1),this.windows=[],this.stream=n,"string"===typeof t&&this.createTextDecoder(t)};ye.prototype.init=function(e,t){this.startPts=e;for(var n=0;n<8;n++)this.windows[n]=new me(n),"function"===typeof t&&(this.windows[n].beforeRowOverflow=t)},ye.prototype.setCurrentWindow=function(e){this.currentWindow=this.windows[e]},ye.prototype.createTextDecoder=function(e){if("undefined"===typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(e)}catch(t){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+e+" encoding. "+t})}};var ve=function(e){e=e||{},ve.prototype.init.call(this);var t,n=this,i=e.captionServices||{},r={};Object.keys(i).forEach((e=>{t=i[e],/^SERVICE/.test(e)&&(r[e]=t.encoding)})),this.serviceEncodings=r,this.current708Packet=null,this.services={},this.push=function(e){3===e.type?(n.new708Packet(),n.add708Bytes(e)):(null===n.current708Packet&&n.new708Packet(),n.add708Bytes(e))}};ve.prototype=new de,ve.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},ve.prototype.add708Bytes=function(e){var t=e.ccData,n=t>>>8,i=255&t;this.current708Packet.ptsVals.push(e.pts),this.current708Packet.data.push(n),this.current708Packet.data.push(i)},ve.prototype.push708Packet=function(){var e=this.current708Packet,t=e.data,n=null,i=null,r=0,s=t[r++];for(e.seq=s>>6,e.sizeCode=63&s;r<t.length;r++)i=31&(s=t[r++]),7===(n=s>>5)&&i>0&&(n=s=t[r++]),this.pushServiceBlock(n,r,i),i>0&&(r+=i-1)},ve.prototype.pushServiceBlock=function(e,t,n){var i,r=t,s=this.current708Packet.data,a=this.services[e];for(a||(a=this.initService(e,r));r<t+n&&r<s.length;r++)i=s[r],ge(i)?r=this.handleText(r,a):24===i?r=this.multiByteCharacter(r,a):16===i?r=this.extendedCommands(r,a):128<=i&&i<=135?r=this.setCurrentWindow(r,a):152<=i&&i<=159?r=this.defineWindow(r,a):136===i?r=this.clearWindows(r,a):140===i?r=this.deleteWindows(r,a):137===i?r=this.displayWindows(r,a):138===i?r=this.hideWindows(r,a):139===i?r=this.toggleWindows(r,a):151===i?r=this.setWindowAttributes(r,a):144===i?r=this.setPenAttributes(r,a):145===i?r=this.setPenColor(r,a):146===i?r=this.setPenLocation(r,a):143===i?a=this.reset(r,a):8===i?a.currentWindow.backspace():12===i?a.currentWindow.clearText():13===i?a.currentWindow.pendingNewLine=!0:14===i?a.currentWindow.clearText():141===i&&r++},ve.prototype.extendedCommands=function(e,t){var n=this.current708Packet.data[++e];return ge(n)&&(e=this.handleText(e,t,{isExtended:!0})),e},ve.prototype.getPts=function(e){return this.current708Packet.ptsVals[Math.floor(e/2)]},ve.prototype.initService=function(e,t){var n,i,r=this;return(n="SERVICE"+e)in this.serviceEncodings&&(i=this.serviceEncodings[n]),this.services[e]=new ye(e,i,r),this.services[e].init(this.getPts(t),(function(t){r.flushDisplayed(t,r.services[e])})),this.services[e]},ve.prototype.handleText=function(e,t,n){var i,r,s=n&&n.isExtended,a=n&&n.isMultiByte,o=this.current708Packet.data,l=s?4096:0,u=o[e],c=o[e+1],d=t.currentWindow;if(a?(r=[u,c],e++):r=[u],t.textDecoder_&&!s)i=t.textDecoder_.decode(new Uint8Array(r));else if(a){const e=r.map((e=>("0"+(255&e).toString(16)).slice(-2))).join("");i=String.fromCharCode(parseInt(e,16))}else i=function(e){var t=pe[e]||e;return 4096&e&&e===t?"":String.fromCharCode(t)}(l|u);return d.pendingNewLine&&!d.isEmpty()&&d.newLine(this.getPts(e)),d.pendingNewLine=!1,d.addText(i),e},ve.prototype.multiByteCharacter=function(e,t){var n=this.current708Packet.data,i=n[e+1],r=n[e+2];return ge(i)&&ge(r)&&(e=this.handleText(++e,t,{isMultiByte:!0})),e},ve.prototype.setCurrentWindow=function(e,t){var n=7&this.current708Packet.data[e];return t.setCurrentWindow(n),e},ve.prototype.defineWindow=function(e,t){var n=this.current708Packet.data,i=n[e],r=7&i;t.setCurrentWindow(r);var s=t.currentWindow;return i=n[++e],s.visible=(32&i)>>5,s.rowLock=(16&i)>>4,s.columnLock=(8&i)>>3,s.priority=7&i,i=n[++e],s.relativePositioning=(128&i)>>7,s.anchorVertical=127&i,i=n[++e],s.anchorHorizontal=i,i=n[++e],s.anchorPoint=(240&i)>>4,s.rowCount=15&i,i=n[++e],s.columnCount=63&i,i=n[++e],s.windowStyle=(56&i)>>3,s.penStyle=7&i,s.virtualRowCount=s.rowCount+1,e},ve.prototype.setWindowAttributes=function(e,t){var n=this.current708Packet.data,i=n[e],r=t.currentWindow.winAttr;return i=n[++e],r.fillOpacity=(192&i)>>6,r.fillRed=(48&i)>>4,r.fillGreen=(12&i)>>2,r.fillBlue=3&i,i=n[++e],r.borderType=(192&i)>>6,r.borderRed=(48&i)>>4,r.borderGreen=(12&i)>>2,r.borderBlue=3&i,i=n[++e],r.borderType+=(128&i)>>5,r.wordWrap=(64&i)>>6,r.printDirection=(48&i)>>4,r.scrollDirection=(12&i)>>2,r.justify=3&i,i=n[++e],r.effectSpeed=(240&i)>>4,r.effectDirection=(12&i)>>2,r.displayEffect=3&i,e},ve.prototype.flushDisplayed=function(e,t){for(var n=[],i=0;i<8;i++)t.windows[i].visible&&!t.windows[i].isEmpty()&&n.push(t.windows[i].getText());t.endPts=e,t.text=n.join("\n\n"),this.pushCaption(t),t.startPts=e},ve.prototype.pushCaption=function(e){""!==e.text&&(this.trigger("data",{startPts:e.startPts,endPts:e.endPts,text:e.text,stream:"cc708_"+e.serviceNum}),e.text="",e.startPts=e.endPts)},ve.prototype.displayWindows=function(e,t){var n=this.current708Packet.data[++e],i=this.getPts(e);this.flushDisplayed(i,t);for(var r=0;r<8;r++)n&1<<r&&(t.windows[r].visible=1);return e},ve.prototype.hideWindows=function(e,t){var n=this.current708Packet.data[++e],i=this.getPts(e);this.flushDisplayed(i,t);for(var r=0;r<8;r++)n&1<<r&&(t.windows[r].visible=0);return e},ve.prototype.toggleWindows=function(e,t){var n=this.current708Packet.data[++e],i=this.getPts(e);this.flushDisplayed(i,t);for(var r=0;r<8;r++)n&1<<r&&(t.windows[r].visible^=1);return e},ve.prototype.clearWindows=function(e,t){var n=this.current708Packet.data[++e],i=this.getPts(e);this.flushDisplayed(i,t);for(var r=0;r<8;r++)n&1<<r&&t.windows[r].clearText();return e},ve.prototype.deleteWindows=function(e,t){var n=this.current708Packet.data[++e],i=this.getPts(e);this.flushDisplayed(i,t);for(var r=0;r<8;r++)n&1<<r&&t.windows[r].reset();return e},ve.prototype.setPenAttributes=function(e,t){var n=this.current708Packet.data,i=n[e],r=t.currentWindow.penAttr;return i=n[++e],r.textTag=(240&i)>>4,r.offset=(12&i)>>2,r.penSize=3&i,i=n[++e],r.italics=(128&i)>>7,r.underline=(64&i)>>6,r.edgeType=(56&i)>>3,r.fontStyle=7&i,e},ve.prototype.setPenColor=function(e,t){var n=this.current708Packet.data,i=n[e],r=t.currentWindow.penColor;return i=n[++e],r.fgOpacity=(192&i)>>6,r.fgRed=(48&i)>>4,r.fgGreen=(12&i)>>2,r.fgBlue=3&i,i=n[++e],r.bgOpacity=(192&i)>>6,r.bgRed=(48&i)>>4,r.bgGreen=(12&i)>>2,r.bgBlue=3&i,i=n[++e],r.edgeRed=(48&i)>>4,r.edgeGreen=(12&i)>>2,r.edgeBlue=3&i,e},ve.prototype.setPenLocation=function(e,t){var n=this.current708Packet.data,i=n[e],r=t.currentWindow.penLoc;return t.currentWindow.pendingNewLine=!0,i=n[++e],r.row=15&i,i=n[++e],r.column=63&i,e},ve.prototype.reset=function(e,t){var n=this.getPts(e);return this.flushDisplayed(n,t),this.initService(t.serviceNum,e)};var be={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Te=function(e){return null===e?"":(e=be[e]||e,String.fromCharCode(e))},Se=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],_e=function(){for(var e=[],t=15;t--;)e.push({text:"",indent:0,offset:0});return e},we=function(e,t){we.prototype.init.call(this),this.field_=e||0,this.dataChannel_=t||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,i,r,s;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096===(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),i=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=_e();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=_e();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=_e()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(i,r))s=Te((i=(3&i)<<8)|r),this[this.mode_](e.pts,s),this.column_++;else if(this.isExtCharacter(i,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),s=Te((i=(3&i)<<8)|r),this[this.mode_](e.pts,s),this.column_++;else if(this.isMidRowCode(i,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14===(14&r)&&this.addFormatting(e.pts,["i"]),1===(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(i,r)){const e=3&r;this.nonDisplayed_[this.row_].offset=e,this.column_+=e}else if(this.isPAC(i,r)){var a=Se.indexOf(7968&t);if("rollUp"===this.mode_&&(a-this.rollUpRows_+1<0&&(a=this.rollUpRows_-1),this.setRollUp(e.pts,a)),a!==this.row_&&a>=0&&a<=14&&(this.clearFormatting(e.pts),this.row_=a),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16===(16&t)){const e=(14&t)>>1;this.column_=4*e,this.nonDisplayed_[this.row_].indent+=e}this.isColorPAC(r)&&14===(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(i)&&(0===r&&(r=null),s=Te(i),s+=Te(r),this[this.mode_](e.pts,s),this.column_+=s.length)}else this.lastControlCode_=null}};we.prototype=new de,we.prototype.flushDisplayed=function(e){const t=e=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+e+"."})},n=[];this.displayed_.forEach(((e,i)=>{if(e&&e.text&&e.text.length){try{e.text=e.text.trim()}catch(r){t(i)}e.text.length&&n.push({text:e.text,line:i+1,position:10+Math.min(70,10*e.indent)+2.5*e.offset})}else void 0!==e&&null!==e||t(i)})),n.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,content:n,stream:this.name_})},we.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=_e(),this.nonDisplayed_=_e(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},we.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},we.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},we.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},we.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},we.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},we.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},we.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},we.prototype.isNormalChar=function(e){return e>=32&&e<=127},we.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=_e(),this.displayed_=_e()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]={text:"",indent:0,offset:0};void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},we.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,n)},we.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[],this[this.mode_](e,t)}},we.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_].text;n+=t,this.nonDisplayed_[this.row_].text=n},we.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_].text;n+=t,this.displayed_[this.row_].text=n},we.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]={text:"",indent:0,offset:0};for(e=this.row_+1;e<15;e++)this.displayed_[e]={text:"",indent:0,offset:0};for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},we.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_].text;n+=t,this.displayed_[this.row_].text=n};var Ee={CaptionStream:fe,Cea608Stream:we,Cea708Stream:ve},ke={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},xe=B,Ae="shared",Ce=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},Ie=function(e){var t,n;Ie.prototype.init.call(this),this.type_=e||Ae,this.push=function(e){"metadata"!==e.type?this.type_!==Ae&&e.type!==this.type_||(void 0===n&&(n=e.dts),e.dts=Ce(e.dts,n),e.pts=Ce(e.pts,n),t=e.dts,this.trigger("data",e)):this.trigger("data",e)},this.flush=function(){n=t,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){n=void 0,t=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Ie.prototype=new xe;var Le,De={TimestampRolloverStream:Ie,handleRollover:Ce},Re=(e,t,n)=>{if(!e)return-1;for(var i=n;i<e.length;i++)if(e[i]===t)return i;return-1},Me=Re,Pe=3,Oe=function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r},Ne=function(e,t,n){return decodeURIComponent(Oe(e,t,n))},Ue=function(e,t,n){return unescape(Oe(e,t,n))},Fe=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Be={APIC:function(e){var t,n,i=1;e.data[0]===Pe&&((t=Me(e.data,0,i))<0||(e.mimeType=Ue(e.data,i,t),i=t+1,e.pictureType=e.data[i],i++,(n=Me(e.data,0,i))<0||(e.description=Ne(e.data,i,n),i=n+1,"--\x3e"===e.mimeType?e.url=Ue(e.data,i,e.data.length):e.pictureData=e.data.subarray(i,e.data.length))))},"T*":function(e){e.data[0]===Pe&&(e.value=Ne(e.data,1,e.data.length).replace(/\0*$/,""),e.values=e.value.split("\0"))},TXXX:function(e){var t;e.data[0]===Pe&&-1!==(t=Me(e.data,0,1))&&(e.description=Ne(e.data,1,t),e.value=Ne(e.data,t+1,e.data.length).replace(/\0*$/,""),e.data=e.value)},"W*":function(e){e.url=Ue(e.data,0,e.data.length).replace(/\0.*$/,"")},WXXX:function(e){var t;e.data[0]===Pe&&-1!==(t=Me(e.data,0,1))&&(e.description=Ne(e.data,1,t),e.url=Ue(e.data,t+1,e.data.length).replace(/\0.*$/,""))},PRIV:function(e){var t;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=Ue(e.data,0,t);break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}},je={parseId3Frames:function(e){var t,n=10,i=0,r=[];if(!(e.length<10||e[0]!=="I".charCodeAt(0)||e[1]!=="D".charCodeAt(0)||e[2]!=="3".charCodeAt(0))){i=Fe(e.subarray(6,10)),i+=10,64&e[5]&&(n+=4,n+=Fe(e.subarray(10,14)),i-=Fe(e.subarray(16,20)));do{if((t=Fe(e.subarray(n+4,n+8)))<1)break;var s={id:String.fromCharCode(e[n],e[n+1],e[n+2],e[n+3]),data:e.subarray(n+10,n+t+10)};s.key=s.id,Be[s.id]?Be[s.id](s):"T"===s.id[0]?Be["T*"](s):"W"===s.id[0]&&Be["W*"](s),r.push(s),n+=10,n+=t}while(n<i);return r}},parseSyncSafeInteger:Fe,frameParsers:Be},$e=ke,Ve=je;(Le=function(e){var t,n={descriptor:e&&e.descriptor},i=0,r=[],s=0;if(Le.prototype.init.call(this),this.dispatchType=$e.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(t=0;t<n.descriptor.length;t++)this.dispatchType+=("00"+n.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,n,a,o,l;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(s=0,r.length=0),0===r.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(r.push(e),s+=e.data.byteLength,1===r.length&&(i=Ve.parseSyncSafeInteger(e.data.subarray(6,10)),i+=10),!(s<i)){for(t={data:new Uint8Array(i),frames:[],pts:r[0].pts,dts:r[0].dts},l=0;l<i;)t.data.set(r[0].data.subarray(0,i-l),l),l+=r[0].data.byteLength,s-=r[0].data.byteLength,r.shift();n=10,64&t.data[5]&&(n+=4,n+=Ve.parseSyncSafeInteger(t.data.subarray(10,14)),i-=Ve.parseSyncSafeInteger(t.data.subarray(16,20)));do{if((a=Ve.parseSyncSafeInteger(t.data.subarray(n+4,n+8)))<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if((o={id:String.fromCharCode(t.data[n],t.data[n+1],t.data[n+2],t.data[n+3]),data:t.data.subarray(n+10,n+a+10)}).key=o.id,Ve.frameParsers[o.id]?Ve.frameParsers[o.id](o):"T"===o.id[0]?Ve.frameParsers["T*"](o):"W"===o.id[0]&&Ve.frameParsers["W*"](o),"com.apple.streaming.transportStreamTimestamp"===o.owner){var u=o.data,c=(1&u[3])<<30|u[4]<<22|u[5]<<14|u[6]<<6|u[7]>>>2;c*=4,c+=3&u[7],o.timeStamp=c,void 0===t.pts&&void 0===t.dts&&(t.pts=o.timeStamp,t.dts=o.timeStamp),this.trigger("timestamp",o)}t.frames.push(o),n+=10,n+=a}while(n<i);this.trigger("data",t)}}}).prototype=new B;var He,qe,Ge,ze=Le,Ke=B,We=Ee,Xe=ke,Ye=De.TimestampRolloverStream,Qe=188;(He=function(){var e=new Uint8Array(Qe),t=0;He.prototype.init.call(this),this.push=function(n){var i,r=0,s=Qe;for(t?((i=new Uint8Array(n.byteLength+t)).set(e.subarray(0,t)),i.set(n,t),t=0):i=n;s<i.byteLength;)71!==i[r]||71!==i[s]?(r++,s++):(this.trigger("data",i.subarray(r,s)),r+=Qe,s+=Qe);r<i.byteLength&&(e.set(i.subarray(r),0),t=i.byteLength-r)},this.flush=function(){t===Qe&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){t=0,this.trigger("reset")}}).prototype=new Ke,qe=function(){var e,t,n,i;qe.prototype.init.call(this),i=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,i){var r=0;i.payloadUnitStartIndicator&&(r+=e[r]+1),"pat"===i.type?t(e.subarray(r),i):n(e.subarray(r),i)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],i.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=i.pmtPid},n=function(e,t){var n,r;if(1&e[5]){for(i.programMapTable={video:null,audio:null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<n;){var s=e[r],a=(31&e[r+1])<<8|e[r+2];s===Xe.H264_STREAM_TYPE&&null===i.programMapTable.video?i.programMapTable.video=a:s===Xe.ADTS_STREAM_TYPE&&null===i.programMapTable.audio?i.programMapTable.audio=a:s===Xe.METADATA_STREAM_TYPE&&(i.programMapTable["timed-metadata"][a]=s),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=i.programMapTable}},this.push=function(t){var n={},i=4;if(n.payloadUnitStartIndicator=!!(64&t[1]),n.pid=31&t[1],n.pid<<=8,n.pid|=t[2],(48&t[3])>>>4>1&&(i+=t[i]+1),0===n.pid)n.type="pat",e(t.subarray(i),n),this.trigger("data",n);else if(n.pid===this.pmtPid)for(n.type="pmt",e(t.subarray(i),n),this.trigger("data",n);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,i,n]):this.processPes_(t,i,n)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=Xe.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=Xe.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}},qe.prototype=new Ke,qe.STREAM_TYPES={h264:27,adts:15},Ge=function(){var e,t=this,n=!1,i={data:[],size:0},r={data:[],size:0},s={data:[],size:0},a=function(e,n,i){var r,s,a=new Uint8Array(e.size),o={type:n},l=0,u=0;if(e.data.length&&!(e.size<9)){for(o.trackId=e.data[0].pid,l=0;l<e.data.length;l++)s=e.data[l],a.set(s.data,u),u+=s.data.byteLength;!function(e,t){var n;const i=e[0]<<16|e[1]<<8|e[2];t.data=new Uint8Array,1===i&&(t.packetLength=6+(e[4]<<8|e[5]),t.dataAlignmentIndicator=0!==(4&e[6]),192&(n=e[7])&&(t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,t.pts*=4,t.pts+=(6&e[13])>>>1,t.dts=t.pts,64&n&&(t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,t.dts*=4,t.dts+=(6&e[18])>>>1)),t.data=e.subarray(9+e[8]))}(a,o),r="video"===n||o.packetLength<=e.size,(i||r)&&(e.size=0,e.data.length=0),r&&t.trigger("data",o)}};Ge.prototype.init.call(this),this.push=function(o){({pat:function(){},pes:function(){var e,t;switch(o.streamType){case Xe.H264_STREAM_TYPE:e=i,t="video";break;case Xe.ADTS_STREAM_TYPE:e=r,t="audio";break;case Xe.METADATA_STREAM_TYPE:e=s,t="timed-metadata";break;default:return}o.payloadUnitStartIndicator&&a(e,t,!0),e.data.push(o),e.size+=o.data.byteLength},pmt:function(){var i={type:"metadata",tracks:[]};null!==(e=o.programMapTable).video&&i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"}),null!==e.audio&&i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"}),n=!0,t.trigger("data",i)}})[o.type]()},this.reset=function(){i.size=0,i.data.length=0,r.size=0,r.data.length=0,this.trigger("reset")},this.flushStreams_=function(){a(i,"video"),a(r,"audio"),a(s,"timed-metadata")},this.flush=function(){if(!n&&e){var i={type:"metadata",tracks:[]};null!==e.video&&i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"}),null!==e.audio&&i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"}),t.trigger("data",i)}n=!1,this.flushStreams_(),this.trigger("done")}},Ge.prototype=new Ke;var Je={PAT_PID:0,MP2T_PACKET_LENGTH:Qe,TransportPacketStream:He,TransportParseStream:qe,ElementaryStream:Ge,TimestampRolloverStream:Ye,CaptionStream:We.CaptionStream,Cea608Stream:We.Cea608Stream,Cea708Stream:We.Cea708Stream,MetadataStream:ze};for(var Ze in Xe)Xe.hasOwnProperty(Ze)&&(Je[Ze]=Xe[Ze]);var et,tt=Je,nt=re.ONE_SECOND_IN_TS,it=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(et=function(e){var t,n=0;et.prototype.init.call(this),this.skipWarn_=function(e,t){this.trigger("log",{level:"warn",message:`adts skiping bytes ${e} to ${t} in frame ${n} outside syncword`})},this.push=function(i){var r,s,a,o,l,u=0;if(e||(n=0),"audio"===i.type){var c;for(t&&t.length?(a=t,(t=new Uint8Array(a.byteLength+i.data.byteLength)).set(a),t.set(i.data,a.byteLength)):t=i.data;u+7<t.length;)if(255===t[u]&&240===(246&t[u+1])){if("number"===typeof c&&(this.skipWarn_(c,u),c=null),s=2*(1&~t[u+1]),r=(3&t[u+3])<<11|t[u+4]<<3|(224&t[u+5])>>5,l=(o=1024*(1+(3&t[u+6])))*nt/it[(60&t[u+2])>>>2],t.byteLength-u<r)break;this.trigger("data",{pts:i.pts+n*l,dts:i.dts+n*l,sampleCount:o,audioobjecttype:1+(t[u+2]>>>6&3),channelcount:(1&t[u+2])<<2|(192&t[u+3])>>>6,samplerate:it[(60&t[u+2])>>>2],samplingfrequencyindex:(60&t[u+2])>>>2,samplesize:16,data:t.subarray(u+7+s,u+r)}),n++,u+=r}else"number"!==typeof c&&(c=u),u++;"number"===typeof c&&(this.skipWarn_(c,u),c=null),t=t.subarray(u)}},this.flush=function(){n=0,this.trigger("done")},this.reset=function(){t=void 0,this.trigger("reset")},this.endTimeline=function(){t=void 0,this.trigger("endedtimeline")}}).prototype=new B;var rt,st,at,ot=et,lt=B,ut=function(e){var t=e.byteLength,n=0,i=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+i},this.loadWord=function(){var r=e.byteLength-t,s=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");s.set(e.subarray(r,r+a)),n=new DataView(s.buffer).getUint32(0),i=8*a,t-=a},this.skipBits=function(e){var r;i>e?(n<<=e,i-=e):(e-=i,e-=8*(r=Math.floor(e/8)),t-=r,this.loadWord(),n<<=e,i-=e)},this.readBits=function(e){var r=Math.min(i,e),s=n>>>32-r;return(i-=r)>0?n<<=r:t>0&&this.loadWord(),(r=e-r)>0?s<<r|this.readBits(r):s},this.skipLeadingZeros=function(){var e;for(e=0;e<i;++e)if(0!==(n&2147483648>>>e))return n<<=e,i-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(st=function(){var e,t,n=0;st.prototype.init.call(this),this.push=function(i){var r;t?((r=new Uint8Array(t.byteLength+i.data.byteLength)).set(t),r.set(i.data,t.byteLength),t=r):t=i.data;for(var s=t.byteLength;n<s-3;n++)if(1===t[n+2]){e=n+5;break}for(;e<s;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}n+3!==e-2&&this.trigger("data",t.subarray(n+3,e-2));do{e++}while(1!==t[e]&&e<s);n=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3}t=t.subarray(n),e-=n,n=0},this.reset=function(){t=null,n=0,this.trigger("reset")},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(n+3)),t=null,n=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new lt,at={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},rt=function(){var e,t,n,i,r,s,a,o=new st;rt.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,n=e.pts,i=e.dts,o.push(e))},o.on("data",(function(a){var o={trackId:t,pts:n,dts:i,data:a,nalUnitTypeCode:31&a[0]};switch(o.nalUnitTypeCode){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp",o.escapedRBSP=r(a.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp",o.escapedRBSP=r(a.subarray(1)),o.config=s(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",o)})),o.on("done",(function(){e.trigger("done")})),o.on("partialdone",(function(){e.trigger("partialdone")})),o.on("reset",(function(){e.trigger("reset")})),o.on("endedtimeline",(function(){e.trigger("endedtimeline")})),this.flush=function(){o.flush()},this.partialFlush=function(){o.partialFlush()},this.reset=function(){o.reset()},this.endTimeline=function(){o.endTimeline()},a=function(e,t){var n,i=8,r=8;for(n=0;n<e;n++)0!==r&&(r=(i+t.readExpGolomb()+256)%256),i=0===r?i:r},r=function(e){for(var t,n,i=e.byteLength,r=[],s=1;s<i-2;)0===e[s]&&0===e[s+1]&&3===e[s+2]?(r.push(s+2),s+=2):s++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var a=0;for(s=0;s<t;a++,s++)a===r[0]&&(a++,r.shift()),n[s]=e[a];return n},s=function(e){var t,n,i,r,s,o,l,u,c,d,h,f,p=0,g=0,m=0,y=0,v=[1,1];if(n=(t=new ut(e)).readUnsignedByte(),r=t.readUnsignedByte(),i=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),at[n]&&(3===(s=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(h=3!==s?8:12,f=0;f<h;f++)t.readBoolean()&&a(f<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(o=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===o)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),l=t.readUnsignedExpGolomb(),f=0;f<l;f++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),u=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(d=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(p=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:v=[1,1];break;case 2:v=[12,11];break;case 3:v=[10,11];break;case 4:v=[16,11];break;case 5:v=[40,33];break;case 6:v=[24,11];break;case 7:v=[20,11];break;case 8:v=[32,11];break;case 9:v=[80,33];break;case 10:v=[18,11];break;case 11:v=[15,11];break;case 12:v=[64,33];break;case 13:v=[160,99];break;case 14:v=[4,3];break;case 15:v=[3,2];break;case 16:v=[2,1];break;case 255:v=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}v&&(v[0],v[1])}return{profileIdc:n,levelIdc:i,profileCompatibility:r,width:16*(u+1)-2*p-2*g,height:(2-d)*(c+1)*16-2*m-2*y,sarRatio:v}}},rt.prototype=new lt;var ct,dt={H264Stream:rt,NalByteStream:st},ht=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],ft=function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return n=n>=0?n:0,(16&e[t+5])>>4?n+20:n+10},pt=function(e,t){return e.length-t<10||e[t]!=="I".charCodeAt(0)||e[t+1]!=="D".charCodeAt(0)||e[t+2]!=="3".charCodeAt(0)?t:(t+=ft(e,t),pt(e,t))},gt=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},mt={isLikelyAacData:function(e){var t=pt(e,0);return e.length>=t+2&&255===(255&e[t])&&240===(240&e[t+1])&&16===(22&e[t+1])},parseId3TagSize:ft,parseAdtsSize:function(e,t){var n=(224&e[t+5])>>5,i=e[t+4]<<3;return 6144&e[t+3]|i|n},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240===(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240===(246&e[t+1]))return ht[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,n,i;t=10,64&e[5]&&(t+=4,t+=gt(e.subarray(10,14)));do{if((n=gt(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){i=e.subarray(t+10,t+n+10);for(var r=0;r<i.byteLength;r++)if(0===i[r]){var s=unescape(function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r}(i,0,r));if("com.apple.streaming.transportStreamTimestamp"===s){var a=i.subarray(r+1),o=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return o*=4,o+=3&a[7]}break}}t+=10,t+=n}while(t<e.byteLength);return null}},yt=mt;(ct=function(){var e=new Uint8Array,t=0;ct.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(n){var i,r,s,a,o=0,l=0;for(e.length?(a=e.length,(e=new Uint8Array(n.byteLength+a)).set(e.subarray(0,a)),e.set(n,a)):e=n;e.length-l>=3;)if(e[l]!=="I".charCodeAt(0)||e[l+1]!=="D".charCodeAt(0)||e[l+2]!=="3".charCodeAt(0))if(255!==(255&e[l])||240!==(240&e[l+1]))l++;else{if(e.length-l<7)break;if(l+(o=yt.parseAdtsSize(e,l))>e.length)break;s={type:"audio",data:e.subarray(l,l+o),pts:t,dts:t},this.trigger("data",s),l+=o}else{if(e.length-l<10)break;if(l+(o=yt.parseId3TagSize(e,l))>e.length)break;r={type:"timed-metadata",data:e.subarray(l,l+o)},this.trigger("data",r),l+=o}i=e.length-l,e=i>0?e.subarray(l):new Uint8Array},this.reset=function(){e=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){e=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new B;var vt,bt,Tt,St,_t=B,wt=Q,Et=Z,kt=oe,xt=ue,At=tt,Ct=re,It=ot,Lt=dt.H264Stream,Dt=ct,Rt=mt.isLikelyAacData,Mt=re.ONE_SECOND_IN_TS,Pt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Ot=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Nt=function(e,t){t.stream=e,this.trigger("log",t)},Ut=function(e,t){for(var n=Object.keys(t),i=0;i<n.length;i++){var r=n[i];"headOfPipeline"!==r&&t[r].on&&t[r].on("log",Nt.bind(e,r))}},Ft=function(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},Bt=function(e,t,n,i,r,s){return{start:{dts:e,pts:e+(n-t)},end:{dts:e+(i-t),pts:e+(r-n)},prependedContentDuration:s,baseMediaDecodeTime:e}};bt=function(e,t){var n,i=[],r=0,s=0,a=1/0;n=(t=t||{}).firstSequenceNumber||0,bt.prototype.init.call(this),this.push=function(t){xt.collectDtsInfo(e,t),e&&Pt.forEach((function(n){e[n]=t[n]})),i.push(t)},this.setEarliestDts=function(e){r=e},this.setVideoBaseMediaDecodeTime=function(e){a=e},this.setAudioAppendStart=function(e){s=e},this.flush=function(){var o,l,u,c,d,h,f;0!==i.length?(o=kt.trimAdtsFramesByEarliestDts(i,e,r),e.baseMediaDecodeTime=xt.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps),f=kt.prefixWithSilence(e,o,s,a),e.samples=kt.generateSampleTable(o),u=wt.mdat(kt.concatenateFrameData(o)),i=[],l=wt.moof(n,[e]),c=new Uint8Array(l.byteLength+u.byteLength),n++,c.set(l),c.set(u,l.byteLength),xt.clearDtsInfo(e),d=Math.ceil(1024*Mt/e.samplerate),o.length&&(h=o.length*d,this.trigger("segmentTimingInfo",Bt(Ct.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),o[0].dts,o[0].pts,o[0].dts+h,o[0].pts+h,f||0)),this.trigger("timingInfo",{start:o[0].pts,end:o[0].pts+h})),this.trigger("data",{track:e,boxes:c}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){xt.clearDtsInfo(e),i=[],this.trigger("reset")}},bt.prototype=new _t,vt=function(e,t){var n,i,r,s=[],a=[];n=(t=t||{}).firstSequenceNumber||0,vt.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){xt.collectDtsInfo(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.config,e.sps=[t.data],Ot.forEach((function(t){e[t]=i[t]}),this)),"pic_parameter_set_rbsp"!==t.nalUnitType||r||(r=t.data,e.pps=[t.data]),s.push(t)},this.flush=function(){for(var i,r,o,l,u,c,d,h,f=0;s.length&&"access_unit_delimiter_rbsp"!==s[0].nalUnitType;)s.shift();if(0===s.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(i=Et.groupNalsIntoFrames(s),(o=Et.groupFramesIntoGops(i))[0][0].keyFrame||((r=this.getGopForFusion_(s[0],e))?(f=r.duration,o.unshift(r),o.byteLength+=r.byteLength,o.nalCount+=r.nalCount,o.pts=r.pts,o.dts=r.dts,o.duration+=r.duration):o=Et.extendFirstKeyFrame(o)),a.length){var p;if(!(p=t.alignGopsAtEnd?this.alignGopsAtEnd_(o):this.alignGopsAtStart_(o)))return this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),s=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");xt.clearDtsInfo(e),o=p}xt.collectDtsInfo(e,o),e.samples=Et.generateSampleTable(o),u=wt.mdat(Et.concatenateNalData(o)),e.baseMediaDecodeTime=xt.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",o.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}))),d=o[0],h=o[o.length-1],this.trigger("segmentTimingInfo",Bt(e.baseMediaDecodeTime,d.dts,d.pts,h.dts+h.duration,h.pts+h.duration,f)),this.trigger("timingInfo",{start:o[0].pts,end:o[o.length-1].pts+o[o.length-1].duration}),this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),s=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),l=wt.moof(n,[e]),c=new Uint8Array(l.byteLength+u.byteLength),n++,c.set(l),c.set(u,l.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),s=[],this.gopCache_.length=0,a.length=0,this.trigger("reset")},this.resetStream_=function(){xt.clearDtsInfo(e),i=void 0,r=void 0},this.getGopForFusion_=function(t){var n,i,r,s,a,o=1/0;for(a=0;a<this.gopCache_.length;a++)r=(s=this.gopCache_[a]).gop,e.pps&&Ft(e.pps[0],s.pps[0])&&e.sps&&Ft(e.sps[0],s.sps[0])&&(r.dts<e.timelineStartInfo.dts||(n=t.dts-r.dts-r.duration)>=-1e4&&n<=45e3&&(!i||o>n)&&(i=s,o=n));return i?i.gop:null},this.alignGopsAtStart_=function(e){var t,n,i,r,s,o,l,u;for(s=e.byteLength,o=e.nalCount,l=e.duration,t=n=0;t<a.length&&n<e.length&&(i=a[t],r=e[n],i.pts!==r.pts);)r.pts>i.pts?t++:(n++,s-=r.byteLength,o-=r.nalCount,l-=r.duration);return 0===n?e:n===e.length?null:((u=e.slice(n)).byteLength=s,u.duration=l,u.nalCount=o,u.pts=u[0].pts,u.dts=u[0].dts,u)},this.alignGopsAtEnd_=function(e){var t,n,i,r,s,o,l;for(t=a.length-1,n=e.length-1,s=null,o=!1;t>=0&&n>=0;){if(i=a[t],r=e[n],i.pts===r.pts){o=!0;break}i.pts>r.pts?t--:(t===a.length-1&&(s=n),n--)}if(!o&&null===s)return null;if(0===(l=o?n:s))return e;var u=e.slice(l),c=u.reduce((function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e}),{byteLength:0,duration:0,nalCount:0});return u.byteLength=c.byteLength,u.duration=c.duration,u.nalCount=c.nalCount,u.pts=u[0].pts,u.dts=u[0].dts,u},this.alignGopsWith=function(e){a=e}},vt.prototype=new _t,St=function(e,t){this.numberOfTracks=0,this.metadataStream=t,"undefined"!==typeof(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"===typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,St.prototype.init.call(this),this.push=function(e){return e.content||e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}},St.prototype=new _t,St.prototype.flush=function(e){var t,n,i,r,s=0,a={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(o=this.videoTrack.timelineStartInfo.pts,Ot.forEach((function(e){a.info[e]=this.videoTrack[e]}),this)):this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts,Pt.forEach((function(e){a.info[e]=this.audioTrack[e]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?a.type=this.pendingTracks[0].type:a.type="combined",this.emittedTracks+=this.pendingTracks.length,i=wt.initSegment(this.pendingTracks),a.initSegment=new Uint8Array(i.byteLength),a.initSegment.set(i),a.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)a.data.set(this.pendingBoxes[r],s),s+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=Ct.metadataTsToSeconds(t.startPts,o,this.keepOriginalTimestamps),t.endTime=Ct.metadataTsToSeconds(t.endPts,o,this.keepOriginalTimestamps),a.captionStreams[t.stream]=!0,a.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(n=this.pendingMetadata[r]).cueTime=Ct.metadataTsToSeconds(n.pts,o,this.keepOriginalTimestamps),a.metadata.push(n);for(a.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",a),r=0;r<a.captions.length;r++)t=a.captions[r],this.trigger("caption",t);for(r=0;r<a.metadata.length;r++)n=a.metadata[r],this.trigger("id3Frame",n)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},St.prototype.setRemux=function(e){this.remuxTracks=e},(Tt=function(e){var t,n,i=this,r=!0;Tt.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="aac",r.metadataStream=new At.MetadataStream,r.aacStream=new Dt,r.audioTimestampRolloverStream=new At.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new At.TimestampRolloverStream("timed-metadata"),r.adtsStream=new It,r.coalesceStream=new St(e,r.metadataStream),r.headOfPipeline=r.aacStream,r.aacStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.aacStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.metadataStream.on("timestamp",(function(e){r.aacStream.setTimestamp(e.timeStamp)})),r.aacStream.on("data",(function(s){"timed-metadata"!==s.type&&"audio"!==s.type||r.audioSegmentStream||(n=n||{timelineStartInfo:{baseMediaDecodeTime:i.baseMediaDecodeTime},codec:"adts",type:"audio"},r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new bt(n,e),r.audioSegmentStream.on("log",i.getLogTrigger_("audioSegmentStream")),r.audioSegmentStream.on("timingInfo",i.trigger.bind(i,"audioTimingInfo")),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream),i.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t}))})),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done")),Ut(this,r)},this.setupTsPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="ts",r.metadataStream=new At.MetadataStream,r.packetStream=new At.TransportPacketStream,r.parseStream=new At.TransportParseStream,r.elementaryStream=new At.ElementaryStream,r.timestampRolloverStream=new At.TimestampRolloverStream,r.adtsStream=new It,r.h264Stream=new Lt,r.captionStream=new At.CaptionStream(e),r.coalesceStream=new St(e,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream).pipe(r.timestampRolloverStream),r.timestampRolloverStream.pipe(r.h264Stream),r.timestampRolloverStream.pipe(r.adtsStream),r.timestampRolloverStream.pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",(function(s){var a;if("metadata"===s.type){for(a=s.tracks.length;a--;)t||"video"!==s.tracks[a].type?n||"audio"!==s.tracks[a].type||((n=s.tracks[a]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime):(t=s.tracks[a]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime;t&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new vt(t,e),r.videoSegmentStream.on("log",i.getLogTrigger_("videoSegmentStream")),r.videoSegmentStream.on("timelineStartInfo",(function(t){n&&!e.keepOriginalTimestamps&&(n.timelineStartInfo=t,r.audioSegmentStream.setEarliestDts(t.dts-i.baseMediaDecodeTime))})),r.videoSegmentStream.on("processedGopsInfo",i.trigger.bind(i,"gopInfo")),r.videoSegmentStream.on("segmentTimingInfo",i.trigger.bind(i,"videoSegmentTimingInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",(function(e){n&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)})),r.videoSegmentStream.on("timingInfo",i.trigger.bind(i,"videoTimingInfo")),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),n&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new bt(n,e),r.audioSegmentStream.on("log",i.getLogTrigger_("audioSegmentStream")),r.audioSegmentStream.on("timingInfo",i.trigger.bind(i,"audioTimingInfo")),r.audioSegmentStream.on("segmentTimingInfo",i.trigger.bind(i,"audioSegmentTimingInfo")),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream)),i.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t})}})),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("id3Frame",(function(e){e.dispatchType=r.metadataStream.dispatchType,i.trigger("id3Frame",e)})),r.coalesceStream.on("caption",this.trigger.bind(this,"caption")),r.coalesceStream.on("done",this.trigger.bind(this,"done")),Ut(this,r)},this.setBaseMediaDecodeTime=function(i){var r=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=i),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,xt.clearDtsInfo(n),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),t&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[]),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,xt.clearDtsInfo(t),r.captionStream.reset()),r.timestampRolloverStream&&r.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(t){var n=this.transmuxPipeline_;e.remux=t,n&&n.coalesceStream&&n.coalesceStream.setRemux(t)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.getLogTrigger_=function(e){var t=this;return function(n){n.stream=e,t.trigger("log",n)}},this.push=function(e){if(r){var t=Rt(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new _t;var jt,$t,Vt={Transmuxer:Tt,VideoSegmentStream:vt,AudioSegmentStream:bt,AUDIO_PROPERTIES:Pt,VIDEO_PROPERTIES:Ot,generateSegmentTimingInfo:Bt},Ht=function(e){return e>>>0},qt=function(e){return("00"+e.toString(16)).slice(-2)},Gt=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},zt=Ht,Kt=Gt,Wt=function(e,t){var n,i,r,s,a,o=[];if(!t.length)return null;for(n=0;n<e.byteLength;)i=zt(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),r=Kt(e.subarray(n+4,n+8)),s=i>1?n+i:e.byteLength,r===t[0]&&(1===t.length?o.push(e.subarray(n+8,s)):(a=Wt(e.subarray(n+8,s),t.slice(1))).length&&(o=o.concat(a))),n=s;return o},Xt=Wt,Yt=Ht,Qt=$.getUint64,Jt=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4))};return 1===t.version?t.baseMediaDecodeTime=Qt(e.subarray(4)):t.baseMediaDecodeTime=Yt(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),t},Zt=function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},r=1&i.flags[2],s=2&i.flags[2],a=8&i.flags[2],o=16&i.flags[2],l=32&i.flags[2],u=65536&i.flags[0],c=131072&i.flags[0];return t=8,r&&(t+=4,i.baseDataOffset=n.getUint32(12),t+=4),s&&(i.sampleDescriptionIndex=n.getUint32(t),t+=4),a&&(i.defaultSampleDuration=n.getUint32(t),t+=4),o&&(i.defaultSampleSize=n.getUint32(t),t+=4),l&&(i.defaultSampleFlags=n.getUint32(t)),u&&(i.durationIsEmpty=!0),!r&&c&&(i.baseDataOffsetIsMoof=!0),i},en=$.getUint64,tn=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},nn=function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&n.flags[2],s=4&n.flags[2],a=1&n.flags[1],o=2&n.flags[1],l=4&n.flags[1],u=8&n.flags[1],c=i.getUint32(4),d=8;for(r&&(n.dataOffset=i.getInt32(d),d+=4),s&&c&&(t={flags:tn(e.subarray(d,d+4))},d+=4,a&&(t.duration=i.getUint32(d),d+=4),o&&(t.size=i.getUint32(d),d+=4),u&&(1===n.version?t.compositionTimeOffset=i.getInt32(d):t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t),c--);c--;)t={},a&&(t.duration=i.getUint32(d),d+=4),o&&(t.size=i.getUint32(d),d+=4),l&&(t.flags=tn(e.subarray(d,d+4)),d+=4),u&&(1===n.version?t.compositionTimeOffset=i.getInt32(d):t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t);return n},rn=$.getUint64,sn=function(e){return new Date(1e3*e-20828448e5)},an=Gt,on=function(e){var t,n,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[];for(t=0;t+4<e.length;t+=n)if(n=i.getUint32(t),t+=4,n<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[t]&31)}return r},ln={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:jt(e.subarray(78,e.byteLength))}},avcC:function(e){var t,n,i,r,s=new DataView(e.buffer,e.byteOffset,e.byteLength),a={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},o=31&e[5];for(i=6,r=0;r<o;r++)n=s.getUint16(i),i+=2,a.sps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;for(t=e[i],i++,r=0;r<t;r++)n=s.getUint16(i),i+=2,a.pps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;return a},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},edts:function(e){return{boxes:jt(e)}},elst:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),edits:[]},r=n.getUint32(4);for(t=8;r;r--)0===i.version?(i.edits.push({segmentDuration:n.getUint32(t),mediaTime:n.getInt32(t+4),mediaRate:n.getUint16(t+8)+n.getUint16(t+10)/65536}),t+=12):(i.edits.push({segmentDuration:rn(e.subarray(t)),mediaTime:rn(e.subarray(t+8)),mediaRate:n.getUint16(t+16)+n.getUint16(t+18)/65536}),t+=20);return i},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={majorBrand:an(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},i=8;i<e.byteLength;)n.compatibleBrands.push(an(e.subarray(i,i+4))),i+=4;return n},dinf:function(e){return{boxes:jt(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:jt(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:an(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}t.name+=String.fromCharCode(e[n])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:on(e)}},mdhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,r={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===r.version?(i+=4,r.creationTime=sn(n.getUint32(i)),i+=8,r.modificationTime=sn(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=8,r.duration=n.getUint32(i)):(r.creationTime=sn(n.getUint32(i)),i+=4,r.modificationTime=sn(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=4,r.duration=n.getUint32(i)),i+=4,t=n.getUint16(i),r.language+=String.fromCharCode(96+(t>>10)),r.language+=String.fromCharCode(96+((992&t)>>5)),r.language+=String.fromCharCode(96+(31&t)),r},mdia:function(e){return{boxes:jt(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:jt(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(n.streamDescriptor=jt(e.subarray(28))[0]),n},moof:function(e){return{boxes:jt(e)}},moov:function(e){return{boxes:jt(e)}},mvex:function(e){return{boxes:jt(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=sn(t.getUint32(n)),n+=8,i.modificationTime=sn(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=8,i.duration=t.getUint32(n)):(i.creationTime=sn(t.getUint32(n)),n+=4,i.modificationTime=sn(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=4,i.duration=t.getUint32(n)),n+=4,i.rate=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,n+=8,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,n+=24,i.nextTrackId=t.getUint32(n),i},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)n.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return n},sidx:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8)},i=12;0===n.version?(n.earliestPresentationTime=t.getUint32(i),n.firstOffset=t.getUint32(i+4),i+=8):(n.earliestPresentationTime=en(e.subarray(i)),n.firstOffset=en(e.subarray(i+8)),i+=16),i+=2;var r=t.getUint16(i);for(i+=2;r>0;i+=12,r--)n.references.push({referenceType:(128&e[i])>>>7,referencedSize:2147483647&t.getUint32(i),subsegmentDuration:t.getUint32(i+4),startsWithSap:!!(128&e[i+8]),sapType:(112&e[i+8])>>>4,sapDeltaTime:268435455&t.getUint32(i+8)});return n},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:jt(e)}},ctts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),compositionOffsets:[]},r=n.getUint32(4);for(t=8;r;t+=8,r--)i.compositionOffsets.push({sampleCount:n.getUint32(t),sampleOffset:n[0===i.version?"getUint32":"getInt32"](t+4)});return i},stss:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),syncSamples:[]},r=n.getUint32(4);for(t=8;r;t+=4,r--)i.syncSamples.push(n.getUint32(t));return i},stco:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},r=n.getUint32(4);for(t=8;r;t+=4,r--)i.chunkOffsets.push(n.getUint32(t));return i},stsc:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=n.getUint32(4),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;i;t+=12,i--)r.sampleToChunks.push({firstChunk:n.getUint32(t),samplesPerChunk:n.getUint32(t+4),sampleDescriptionIndex:n.getUint32(t+8)});return r},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:jt(e.subarray(8))}},stsz:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)i.entries.push(n.getUint32(t));return i},stts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},r=n.getUint32(4);for(t=8;r;t+=8,r--)i.timeToSamples.push({sampleCount:n.getUint32(t),sampleDelta:n.getUint32(t+4)});return i},styp:function(e){return ln.ftyp(e)},tfdt:Jt,tfhd:Zt,tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=sn(t.getUint32(n)),n+=8,i.modificationTime=sn(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=8,i.duration=t.getUint32(n)):(i.creationTime=sn(t.getUint32(n)),n+=4,i.modificationTime=sn(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=4,i.duration=t.getUint32(n)),n+=4,n+=8,i.layer=t.getUint16(n),n+=2,i.alternateGroup=t.getUint16(n),n+=2,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,i.width=t.getUint16(n)+t.getUint16(n+2)/65536,n+=4,i.height=t.getUint16(n)+t.getUint16(n+2)/65536,i},traf:function(e){return{boxes:jt(e)}},trak:function(e){return{boxes:jt(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:nn,"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};jt=function(e){for(var t,n,i,r,s,a=0,o=[],l=new ArrayBuffer(e.length),u=new Uint8Array(l),c=0;c<e.length;++c)u[c]=e[c];for(t=new DataView(l);a<e.byteLength;)n=t.getUint32(a),i=an(e.subarray(a+4,a+8)),r=n>1?a+n:e.byteLength,(s=(ln[i]||function(e){return{data:e}})(e.subarray(a+8,r))).size=n,s.type=i,o.push(s),a=r;return o},$t=function(e,t){var n;return t=t||0,n=new Array(2*t+1).join(" "),e.map((function(e,i){return n+e.type+"\n"+Object.keys(e).filter((function(e){return"type"!==e&&"boxes"!==e})).map((function(t){var i=n+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var s=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map((function(e){return" "+("00"+e.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);return s?1===s.length?i+"<"+s.join("").slice(1)+">":i+"<\n"+s.map((function(e){return n+"  "+e})).join("\n")+"\n"+n+"  >":i+"<>"}return i+JSON.stringify(r,null,2).split("\n").map((function(e,t){return 0===t?e:n+"  "+e})).join("\n")})).join("\n")+(e.boxes?"\n"+$t(e.boxes,t+1):"")})).join("\n")};var un,cn,dn,hn,fn,pn,gn,mn={inspect:jt,textify:$t,parseType:an,findBox:Xt,parseTraf:ln.traf,parseTfdt:ln.tfdt,parseHdlr:ln.hdlr,parseTfhd:ln.tfhd,parseTrun:ln.trun,parseSidx:ln.sidx},yn=function(e){for(var t=0,n=String.fromCharCode(e[t]),i="";"\0"!==n;)i+=n,t++,n=String.fromCharCode(e[t]);return i+=n},vn=$.getUint64,bn=function(e,t){var n="\0"!==t.scheme_id_uri,i=0===e&&Tn(t.presentation_time_delta)&&n,r=1===e&&Tn(t.presentation_time)&&n;return!(e>1)&&i||r},Tn=function(e){return void 0!==e||null!==e},Sn={parseEmsgBox:function(e){var t,n,i,r,s,a,o,l=4,u=e[0];if(0===u)l+=(t=yn(e.subarray(l))).length,l+=(n=yn(e.subarray(l))).length,i=(c=new DataView(e.buffer)).getUint32(l),l+=4,s=c.getUint32(l),l+=4,a=c.getUint32(l),l+=4,o=c.getUint32(l),l+=4;else if(1===u){var c;i=(c=new DataView(e.buffer)).getUint32(l),l+=4,r=vn(e.subarray(l)),l+=8,a=c.getUint32(l),l+=4,o=c.getUint32(l),l+=4,l+=(t=yn(e.subarray(l))).length,l+=(n=yn(e.subarray(l))).length}var d={scheme_id_uri:t,value:n,timescale:i||1,presentation_time:r,presentation_time_delta:s,event_duration:a,id:o,message_data:new Uint8Array(e.subarray(l,e.byteLength))};return bn(u,d)?d:void 0},scaleTime:function(e,t,n,i){return e||0===e?e/t:i+n/t}},_n="undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{},wn=Ht,En=qt,kn=Xt,xn=Gt,An=Sn,Cn=Zt,In=nn,Ln=Jt,Dn=$.getUint64,Rn=_n,Mn=je.parseId3Frames;un=function(e){return kn(e,["moov","trak"]).reduce((function(e,t){var n,i,r,s,a;return(n=kn(t,["tkhd"])[0])?(i=n[0],s=wn(n[r=0===i?12:20]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]),(a=kn(t,["mdia","mdhd"])[0])?(r=0===(i=a[0])?12:20,e[s]=wn(a[r]<<24|a[r+1]<<16|a[r+2]<<8|a[r+3]),e):null):null}),{})},cn=function(e,t){var n=kn(t,["moof","traf"]).reduce((function(t,n){var i,r=kn(n,["tfhd"])[0],s=wn(r[4]<<24|r[5]<<16|r[6]<<8|r[7]),a=e[s]||9e4,o=kn(n,["tfdt"])[0],l=new DataView(o.buffer,o.byteOffset,o.byteLength);let u;return"bigint"===typeof(i=1===o[0]?Dn(o.subarray(4,12)):l.getUint32(4))?u=i/Rn.BigInt(a):"number"!==typeof i||isNaN(i)||(u=i/a),u<Number.MAX_SAFE_INTEGER&&(u=Number(u)),u<t&&(t=u),t}),1/0);return"bigint"===typeof n||isFinite(n)?n:0},dn=function(e,t){var n,i=kn(t,["moof","traf"]),r=0,s=0;if(i&&i.length){var a=kn(i[0],["tfhd"])[0],o=kn(i[0],["trun"])[0],l=kn(i[0],["tfdt"])[0];if(a)n=Cn(a).trackId;if(l)r=Ln(l).baseMediaDecodeTime;if(o){var u=In(o);u.samples&&u.samples.length&&(s=u.samples[0].compositionTimeOffset||0)}}var c=e[n]||9e4;"bigint"===typeof r&&(s=Rn.BigInt(s),c=Rn.BigInt(c));var d=(r+s)/c;return"bigint"===typeof d&&d<Number.MAX_SAFE_INTEGER&&(d=Number(d)),d},hn=function(e){var t=kn(e,["moov","trak"]),n=[];return t.forEach((function(e){var t=kn(e,["mdia","hdlr"]),i=kn(e,["tkhd"]);t.forEach((function(e,t){var r,s,a=xn(e.subarray(8,12)),o=i[t];"vide"===a&&(s=0===(r=new DataView(o.buffer,o.byteOffset,o.byteLength)).getUint8(0)?r.getUint32(12):r.getUint32(20),n.push(s))}))})),n},pn=function(e){var t=0===e[0]?12:20;return wn(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])},fn=function(e){var t=kn(e,["moov","trak"]),n=[];return t.forEach((function(e){var t,i,r={},s=kn(e,["tkhd"])[0];s&&(i=(t=new DataView(s.buffer,s.byteOffset,s.byteLength)).getUint8(0),r.id=0===i?t.getUint32(12):t.getUint32(20));var a=kn(e,["mdia","hdlr"])[0];if(a){var o=xn(a.subarray(8,12));r.type="vide"===o?"video":"soun"===o?"audio":o}var l=kn(e,["mdia","minf","stbl","stsd"])[0];if(l){var u=l.subarray(8);r.codec=xn(u.subarray(4,8));var c,d=kn(u,[r.codec])[0];d&&(/^[asm]vc[1-9]$/i.test(r.codec)?(c=d.subarray(78),"avcC"===xn(c.subarray(4,8))&&c.length>11?(r.codec+=".",r.codec+=En(c[9]),r.codec+=En(c[10]),r.codec+=En(c[11])):r.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(r.codec)?(c=d.subarray(28),"esds"===xn(c.subarray(4,8))&&c.length>20&&0!==c[19]?(r.codec+="."+En(c[19]),r.codec+="."+En(c[20]>>>2&63).replace(/^0/,"")):r.codec="mp4a.40.2"):r.codec=r.codec.toLowerCase())}var h=kn(e,["mdia","mdhd"])[0];h&&(r.timescale=pn(h)),n.push(r)})),n},gn=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return kn(e,["emsg"]).map((e=>{var n=An.parseEmsgBox(new Uint8Array(e)),i=Mn(n.message_data);return{cueTime:An.scaleTime(n.presentation_time,n.timescale,n.presentation_time_delta,t),duration:An.scaleTime(n.event_duration,n.timescale),frames:i}}))};var Pn={findBox:kn,parseType:xn,timescale:un,startTime:cn,compositionStartTime:dn,videoTrackIds:hn,tracks:fn,getTimescaleFromMediaHeader:pn,getEmsgID3:gn};const{parseTrun:On}=mn,{findBox:Nn}=Pn;var Un=_n,Fn={getMdatTrafPairs:function(e){var t=Nn(e,["moof","traf"]),n=Nn(e,["mdat"]),i=[];return n.forEach((function(e,n){var r=t[n];i.push({mdat:e,traf:r})})),i},parseSamples:function(e,t,n){var i=t,r=n.defaultSampleDuration||0,s=n.defaultSampleSize||0,a=n.trackId,o=[];return e.forEach((function(e){var t=On(e).samples;t.forEach((function(e){void 0===e.duration&&(e.duration=r),void 0===e.size&&(e.size=s),e.trackId=a,e.dts=i,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),"bigint"===typeof i?(e.pts=i+Un.BigInt(e.compositionTimeOffset),i+=Un.BigInt(e.duration)):(e.pts=i+e.compositionTimeOffset,i+=e.duration)})),o=o.concat(t)})),o}},Bn=ce.discardEmulationPreventionBytes,jn=Ee.CaptionStream,$n=Xt,Vn=Jt,Hn=Zt,{getMdatTrafPairs:qn,parseSamples:Gn}=Fn,zn=function(e,t){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(n<r.size)return r;n-=r.size}return null},Kn=function(e,t){var n={};return qn(e).forEach((function(e){var i,r=e.mdat,s=e.traf,a=$n(s,["tfhd"]),o=Hn(a[0]),l=o.trackId,u=$n(s,["tfdt"]),c=u.length>0?Vn(u[0]).baseMediaDecodeTime:0,d=$n(s,["trun"]);t===l&&d.length>0&&(i=function(e,t,n){var i,r,s,a,o=new DataView(e.buffer,e.byteOffset,e.byteLength),l={logs:[],seiNals:[]};for(r=0;r+4<e.length;r+=s)if(s=o.getUint32(r),r+=4,!(s<=0))switch(31&e[r]){case 6:var u=e.subarray(r+1,r+1+s),c=zn(r,t);if(i={nalUnitType:"sei_rbsp",size:s,data:u,escapedRBSP:Bn(u),trackId:n},c)i.pts=c.pts,i.dts=c.dts,a=c;else{if(!a){l.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+r+" for trackId "+n+". See mux.js#223."});break}i.pts=a.pts,i.dts=a.dts}l.seiNals.push(i)}return l}(r,Gn(d,c,o),l),n[l]||(n[l]={seiNals:[],logs:[]}),n[l].seiNals=n[l].seiNals.concat(i.seiNals),n[l].logs=n[l].logs.concat(i.logs))})),n},Wn=function(){var e,t,n,i,r,s,a=!1;this.isInitialized=function(){return a},this.init=function(t){e=new jn,a=!0,s=!!t&&t.isPartial,e.on("data",(function(e){e.startTime=e.startPts/i,e.endTime=e.endPts/i,r.captions.push(e),r.captionStreams[e.stream]=!0})),e.on("log",(function(e){r.logs.push(e)}))},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"===typeof t&&0===Object.keys(t).length)&&(n!==e[0]||i!==t[n])},this.parse=function(e,s,a){var o;if(!this.isInitialized())return null;if(!s||!a)return null;if(this.isNewInit(s,a))n=s[0],i=a[n];else if(null===n||!i)return t.push(e),null;for(;t.length>0;){var l=t.shift();this.parse(l,s,a)}return o=function(e,t,n){if(null===t)return null;var i=Kn(e,t)[t]||{};return{seiNals:i.seiNals,logs:i.logs,timescale:n}}(e,n,i),o&&o.logs&&(r.logs=r.logs.concat(o.logs)),null!==o&&o.seiNals?(this.pushNals(o.seiNals),this.flushStream(),r):r.logs.length?{logs:r.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach((function(t){e.push(t)}))},this.flushStream=function(){if(!this.isInitialized())return null;s?e.partialFlush():e.flush()},this.clearParsedCaptions=function(){r.captions=[],r.captionStreams={},r.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=null,i=null,r?this.clearParsedCaptions():r={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()};const{parseTfdt:Xn}=mn,Yn=Xt,{getTimescaleFromMediaHeader:Qn}=Pn,{parseSamples:Jn,getMdatTrafPairs:Zn}=Fn;var ei=function(){let e=9e4;this.init=function(t){const n=Yn(t,["moov","trak","mdia","mdhd"])[0];n&&(e=Qn(n))},this.parseSegment=function(t){const n=[],i=Zn(t);let r=0;return i.forEach((function(t){const i=t.mdat,s=t.traf,a=Yn(s,["tfdt"])[0],o=Yn(s,["tfhd"])[0],l=Yn(s,["trun"]);if(a){const e=Xn(a);r=e.baseMediaDecodeTime}if(l.length&&o){const t=Jn(l,r,o);let s=0;t.forEach((function(t){const r=new TextDecoder("utf-8"),a=i.slice(s,s+t.size);if(Yn(a,["vtte"])[0])return void(s+=t.size);Yn(a,["vttc"]).forEach((function(i){const s=Yn(i,["payl"])[0],a=Yn(i,["sttg"])[0],o=t.pts/e,l=(t.pts+t.duration)/e;let u,c;if(s)try{u=r.decode(s)}catch(d){console.error(d)}if(a)try{c=r.decode(a)}catch(d){console.error(d)}t.duration&&u&&n.push({cueText:u,start:o,end:l,settings:c})})),s+=t.size}))}})),n}},ti=ke,ni=function(e){var t=31&e[1];return t<<=8,t|=e[2]},ii=function(e){return!!(64&e[1])},ri=function(e){var t=0;return(48&e[3])>>>4>1&&(t+=e[4]+1),t},si=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},ai={parseType:function(e,t){var n=ni(e);return 0===n?"pat":n===t?"pmt":t?"pes":null},parsePat:function(e){var t=ii(e),n=4+ri(e);return t&&(n+=e[n]+1),(31&e[n+10])<<8|e[n+11]},parsePmt:function(e){var t={},n=ii(e),i=4+ri(e);if(n&&(i+=e[i]+1),1&e[i+5]){var r;r=3+((15&e[i+1])<<8|e[i+2])-4;for(var s=12+((15&e[i+10])<<8|e[i+11]);s<r;){var a=i+s;t[(31&e[a+1])<<8|e[a+2]]=e[a],s+=5+((15&e[a+3])<<8|e[a+4])}return t}},parsePayloadUnitStartIndicator:ii,parsePesType:function(e,t){switch(t[ni(e)]){case ti.H264_STREAM_TYPE:return"video";case ti.ADTS_STREAM_TYPE:return"audio";case ti.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!ii(e))return null;var t=4+ri(e);if(t>=e.byteLength)return null;var n,i=null;return 192&(n=e[t+7])&&((i={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,i.pts*=4,i.pts+=(6&e[t+13])>>>1,i.dts=i.pts,64&n&&(i.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,i.dts*=4,i.dts+=(6&e[t+18])>>>1)),i},videoPacketContainsKeyFrame:function(e){for(var t=4+ri(e),n=e.subarray(t),i=0,r=0,s=!1;r<n.byteLength-3;r++)if(1===n[r+2]){i=r+5;break}for(;i<n.byteLength;)switch(n[i]){case 0:if(0!==n[i-1]){i+=2;break}if(0!==n[i-2]){i++;break}r+3!==i-2&&"slice_layer_without_partitioning_rbsp_idr"===si(31&n[r+3])&&(s=!0);do{i++}while(1!==n[i]&&i<n.length);r=i-2,i+=3;break;case 1:if(0!==n[i-1]||0!==n[i-2]){i+=3;break}"slice_layer_without_partitioning_rbsp_idr"===si(31&n[r+3])&&(s=!0),r=i-2,i+=3;break;default:i+=3}return n=n.subarray(r),i-=r,r=0,n&&n.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===si(31&n[r+3])&&(s=!0),s}},oi=ke,li=De.handleRollover,ui={};ui.ts=ai,ui.aac=mt;var ci=re.ONE_SECOND_IN_TS,di=188,hi=71,fi=function(e,t,n){for(var i,r,s,a,o=0,l=di,u=!1;l<=e.byteLength;)if(e[o]!==hi||e[l]!==hi&&l!==e.byteLength)o++,l++;else{if(i=e.subarray(o,l),"pes"===ui.ts.parseType(i,t.pid))r=ui.ts.parsePesType(i,t.table),s=ui.ts.parsePayloadUnitStartIndicator(i),"audio"===r&&s&&(a=ui.ts.parsePesTime(i))&&(a.type="audio",n.audio.push(a),u=!0);if(u)break;o+=di,l+=di}for(o=(l=e.byteLength)-di,u=!1;o>=0;)if(e[o]!==hi||e[l]!==hi&&l!==e.byteLength)o--,l--;else{if(i=e.subarray(o,l),"pes"===ui.ts.parseType(i,t.pid))r=ui.ts.parsePesType(i,t.table),s=ui.ts.parsePayloadUnitStartIndicator(i),"audio"===r&&s&&(a=ui.ts.parsePesTime(i))&&(a.type="audio",n.audio.push(a),u=!0);if(u)break;o-=di,l-=di}},pi=function(e,t,n){for(var i,r,s,a,o,l,u,c=0,d=di,h=!1,f={data:[],size:0};d<e.byteLength;)if(e[c]!==hi||e[d]!==hi)c++,d++;else{if(i=e.subarray(c,d),"pes"===ui.ts.parseType(i,t.pid))if(r=ui.ts.parsePesType(i,t.table),s=ui.ts.parsePayloadUnitStartIndicator(i),"video"===r&&(s&&!h&&(a=ui.ts.parsePesTime(i))&&(a.type="video",n.video.push(a),h=!0),!n.firstKeyFrame)){if(s&&0!==f.size){for(o=new Uint8Array(f.size),l=0;f.data.length;)u=f.data.shift(),o.set(u,l),l+=u.byteLength;if(ui.ts.videoPacketContainsKeyFrame(o)){var p=ui.ts.parsePesTime(o);p?(n.firstKeyFrame=p,n.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}f.size=0}f.data.push(i),f.size+=i.byteLength}if(h&&n.firstKeyFrame)break;c+=di,d+=di}for(c=(d=e.byteLength)-di,h=!1;c>=0;)if(e[c]!==hi||e[d]!==hi)c--,d--;else{if(i=e.subarray(c,d),"pes"===ui.ts.parseType(i,t.pid))r=ui.ts.parsePesType(i,t.table),s=ui.ts.parsePayloadUnitStartIndicator(i),"video"===r&&s&&(a=ui.ts.parsePesTime(i))&&(a.type="video",n.video.push(a),h=!0);if(h)break;c-=di,d-=di}},gi=function(e){var t={pid:null,table:null},n={};for(var i in function(e,t){for(var n,i=0,r=di;r<e.byteLength;)if(e[i]!==hi||e[r]!==hi)i++,r++;else{switch(n=e.subarray(i,r),ui.ts.parseType(n,t.pid)){case"pat":t.pid=ui.ts.parsePat(n);break;case"pmt":var s=ui.ts.parsePmt(n);t.table=t.table||{},Object.keys(s).forEach((function(e){t.table[e]=s[e]}))}i+=di,r+=di}}(e,t),t.table){if(t.table.hasOwnProperty(i))switch(t.table[i]){case oi.H264_STREAM_TYPE:n.video=[],pi(e,t,n),0===n.video.length&&delete n.video;break;case oi.ADTS_STREAM_TYPE:n.audio=[],fi(e,t,n),0===n.audio.length&&delete n.audio}}return n},mi=function(e,t){var n;return n=ui.aac.isLikelyAacData(e)?function(e){for(var t,n=!1,i=0,r=null,s=null,a=0,o=0;e.length-o>=3;){switch(ui.aac.parseType(e,o)){case"timed-metadata":if(e.length-o<10){n=!0;break}if((a=ui.aac.parseId3TagSize(e,o))>e.length){n=!0;break}null===s&&(t=e.subarray(o,o+a),s=ui.aac.parseAacTimestamp(t)),o+=a;break;case"audio":if(e.length-o<7){n=!0;break}if((a=ui.aac.parseAdtsSize(e,o))>e.length){n=!0;break}null===r&&(t=e.subarray(o,o+a),r=ui.aac.parseSampleRate(t)),i++,o+=a;break;default:o++}if(n)return null}if(null===r||null===s)return null;var l=ci/r;return{audio:[{type:"audio",dts:s,pts:s},{type:"audio",dts:s+1024*i*l,pts:s+1024*i*l}]}}(e):gi(e),n&&(n.audio||n.video)?(function(e,t){if(e.audio&&e.audio.length){var n=t;("undefined"===typeof n||isNaN(n))&&(n=e.audio[0].dts),e.audio.forEach((function(e){e.dts=li(e.dts,n),e.pts=li(e.pts,n),e.dtsTime=e.dts/ci,e.ptsTime=e.pts/ci}))}if(e.video&&e.video.length){var i=t;if(("undefined"===typeof i||isNaN(i))&&(i=e.video[0].dts),e.video.forEach((function(e){e.dts=li(e.dts,i),e.pts=li(e.pts,i),e.dtsTime=e.dts/ci,e.ptsTime=e.pts/ci})),e.firstKeyFrame){var r=e.firstKeyFrame;r.dts=li(r.dts,i),r.pts=li(r.pts,i),r.dtsTime=r.dts/ci,r.ptsTime=r.pts/ci}}}(n,t),n):null};class yi{constructor(e,t){this.options=t||{},this.self=e,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Vt.Transmuxer(this.options),function(e,t){t.on("data",(function(t){const n=t.initSegment;t.initSegment={data:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength};const i=t.data;t.data=i.buffer,e.postMessage({action:"data",segment:t,byteOffset:i.byteOffset,byteLength:i.byteLength},[t.data])})),t.on("done",(function(t){e.postMessage({action:"done"})})),t.on("gopInfo",(function(t){e.postMessage({action:"gopInfo",gopInfo:t})})),t.on("videoSegmentTimingInfo",(function(t){const n={start:{decode:re.videoTsToSeconds(t.start.dts),presentation:re.videoTsToSeconds(t.start.pts)},end:{decode:re.videoTsToSeconds(t.end.dts),presentation:re.videoTsToSeconds(t.end.pts)},baseMediaDecodeTime:re.videoTsToSeconds(t.baseMediaDecodeTime)};t.prependedContentDuration&&(n.prependedContentDuration=re.videoTsToSeconds(t.prependedContentDuration)),e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:n})})),t.on("audioSegmentTimingInfo",(function(t){const n={start:{decode:re.videoTsToSeconds(t.start.dts),presentation:re.videoTsToSeconds(t.start.pts)},end:{decode:re.videoTsToSeconds(t.end.dts),presentation:re.videoTsToSeconds(t.end.pts)},baseMediaDecodeTime:re.videoTsToSeconds(t.baseMediaDecodeTime)};t.prependedContentDuration&&(n.prependedContentDuration=re.videoTsToSeconds(t.prependedContentDuration)),e.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:n})})),t.on("id3Frame",(function(t){e.postMessage({action:"id3Frame",id3Frame:t})})),t.on("caption",(function(t){e.postMessage({action:"caption",caption:t})})),t.on("trackinfo",(function(t){e.postMessage({action:"trackinfo",trackInfo:t})})),t.on("audioTimingInfo",(function(t){e.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:re.videoTsToSeconds(t.start),end:re.videoTsToSeconds(t.end)}})})),t.on("videoTimingInfo",(function(t){e.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:re.videoTsToSeconds(t.start),end:re.videoTsToSeconds(t.end)}})})),t.on("log",(function(t){e.postMessage({action:"log",log:t})}))}(this.self,this.transmuxer)}pushMp4Captions(e){this.captionParser||(this.captionParser=new Wn,this.captionParser.init());const t=new Uint8Array(e.data,e.byteOffset,e.byteLength),n=this.captionParser.parse(t,e.trackIds,e.timescales);this.self.postMessage({action:"mp4Captions",captions:n&&n.captions||[],logs:n&&n.logs||[],data:t.buffer},[t.buffer])}initMp4WebVttParser(e){this.webVttParser||(this.webVttParser=new ei);const t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.webVttParser.init(t)}getMp4WebVttText(e){this.webVttParser||(this.webVttParser=new ei);const t=new Uint8Array(e.data,e.byteOffset,e.byteLength),n=this.webVttParser.parseSegment(t);this.self.postMessage({action:"getMp4WebVttText",mp4VttCues:n||[],data:t.buffer},[t.buffer])}probeMp4StartTime(e){let{timescales:t,data:n}=e;const i=Pn.startTime(t,n);this.self.postMessage({action:"probeMp4StartTime",startTime:i,data:n},[n.buffer])}probeMp4Tracks(e){let{data:t}=e;const n=Pn.tracks(t);this.self.postMessage({action:"probeMp4Tracks",tracks:n,data:t},[t.buffer])}probeEmsgID3(e){let{data:t,offset:n}=e;const i=Pn.getEmsgID3(t,n);this.self.postMessage({action:"probeEmsgID3",id3Frames:i,emsgData:t},[t.buffer])}probeTs(e){let{data:t,baseStartTime:n}=e;const i="number"!==typeof n||isNaN(n)?void 0:n*re.ONE_SECOND_IN_TS,r=mi(t,i);let s=null;r&&(s={hasVideo:r.video&&2===r.video.length||!1,hasAudio:r.audio&&2===r.audio.length||!1},s.hasVideo&&(s.videoStart=r.video[0].ptsTime),s.hasAudio&&(s.audioStart=r.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:s,data:t},[t.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(e){const t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}reset(){this.transmuxer.reset()}setTimestampOffset(e){const t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(re.secondsToVideoTs(t)))}setAudioAppendStart(e){this.transmuxer.setAudioAppendStart(Math.ceil(re.secondsToVideoTs(e.appendStart)))}setRemux(e){this.transmuxer.setRemux(e.remux)}flush(e){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}self.onmessage=function(e){"init"===e.data.action&&e.data.options?this.messageHandlers=new yi(self,e.data.options):(this.messageHandlers||(this.messageHandlers=new yi(self)),e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data))}}))));const hm=e=>{const{transmuxer:t,bytes:n,audioAppendStart:i,gopsToAlignWith:r,remux:s,onData:a,onTrackInfo:o,onAudioTimingInfo:l,onVideoTimingInfo:u,onVideoSegmentTimingInfo:c,onAudioSegmentTimingInfo:d,onId3:h,onCaptions:f,onDone:p,onEndedTimeline:g,onTransmuxerLog:m,isEndOfTimeline:y,segment:v,triggerSegmentEventFn:b}=e,T={buffer:[]};let S=y;if(t.onmessage=n=>{t.currentTransmux===e&&("data"===n.data.action&&((e,t,n)=>{const{type:i,initSegment:r,captions:s,captionStreams:a,metadata:o,videoFrameDtsTime:l,videoFramePtsTime:u}=e.data.segment;t.buffer.push({captions:s,captionStreams:a,metadata:o});const c=e.data.segment.boxes||{data:e.data.segment.data},d={type:i,data:new Uint8Array(c.data,c.data.byteOffset,c.data.byteLength),initSegment:new Uint8Array(r.data,r.byteOffset,r.byteLength)};"undefined"!==typeof l&&(d.videoFrameDtsTime=l),"undefined"!==typeof u&&(d.videoFramePtsTime=u),n(d)})(n,T,a),"trackinfo"===n.data.action&&o(n.data.trackInfo),"gopInfo"===n.data.action&&((e,t)=>{t.gopInfo=e.data.gopInfo})(n,T),"audioTimingInfo"===n.data.action&&l(n.data.audioTimingInfo),"videoTimingInfo"===n.data.action&&u(n.data.videoTimingInfo),"videoSegmentTimingInfo"===n.data.action&&c(n.data.videoSegmentTimingInfo),"audioSegmentTimingInfo"===n.data.action&&d(n.data.audioSegmentTimingInfo),"id3Frame"===n.data.action&&h([n.data.id3Frame],n.data.id3Frame.dispatchType),"caption"===n.data.action&&f(n.data.caption),"endedtimeline"===n.data.action&&(S=!1,g()),"log"===n.data.action&&m(n.data.log),"transmuxed"===n.data.type&&(S||(t.onmessage=null,(e=>{let{transmuxedData:t,callback:n}=e;t.buffer=[],n(t)})({transmuxedData:T,callback:p}),fm(t))))},t.onerror=()=>{const e={message:"Received an error message from the transmuxer worker",metadata:{errorType:Bp.Error.StreamingFailedToTransmuxSegment,segmentInfo:oy({segment:v})}};p(null,e)},i&&t.postMessage({action:"setAudioAppendStart",appendStart:i}),Array.isArray(r)&&t.postMessage({action:"alignGopsWith",gopsToAlignWith:r}),"undefined"!==typeof s&&t.postMessage({action:"setRemux",remux:s}),n.byteLength){const e=n instanceof ArrayBuffer?n:n.buffer,i=n instanceof ArrayBuffer?0:n.byteOffset;b({type:"segmenttransmuxingstart",segment:v}),t.postMessage({action:"push",data:e,byteOffset:i,byteLength:n.byteLength},[e])}y&&t.postMessage({action:"endTimeline"}),t.postMessage({action:"flush"})},fm=e=>{e.currentTransmux=null,e.transmuxQueue.length&&(e.currentTransmux=e.transmuxQueue.shift(),"function"===typeof e.currentTransmux?e.currentTransmux():hm(e.currentTransmux))},pm=(e,t)=>{e.postMessage({action:t}),fm(e)},gm=(e,t)=>{if(!t.currentTransmux)return t.currentTransmux=e,void pm(t,e);t.transmuxQueue.push(pm.bind(null,t,e))},mm=e=>{if(!e.transmuxer.currentTransmux)return e.transmuxer.currentTransmux=e,void hm(e);e.transmuxer.transmuxQueue.push(e)};var ym=e=>{gm("reset",e)},vm=e=>{const t=new dm;t.currentTransmux=null,t.transmuxQueue=[];const n=t.terminate;return t.terminate=()=>(t.currentTransmux=null,t.transmuxQueue.length=0,n.call(t)),t.postMessage({action:"init",options:e}),t};const bm=function(e){const t=e.transmuxer,n=e.endAction||e.action,i=e.callback,r=mo({},e,{endAction:null,transmuxer:null,callback:null}),s=r=>{r.data.action===n&&(t.removeEventListener("message",s),r.data.data&&(r.data.data=new Uint8Array(r.data.data,e.byteOffset||0,e.byteLength||r.data.data.byteLength),e.data&&(e.data=r.data.data)),i(r.data))};if(t.addEventListener("message",s),e.data){const n=e.data instanceof ArrayBuffer;r.byteOffset=n?0:e.data.byteOffset,r.byteLength=e.data.byteLength;const i=[n?e.data:e.data.buffer];t.postMessage(r,i)}else t.postMessage(r)},Tm=2,Sm=-101,_m=-102,wm="wvtt",Em=e=>{e.forEach((e=>{e.abort()}))},km=(e,t)=>{const{requestType:n}=t,i=Ig({requestType:n,request:t,error:e});return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:Sm,xhr:t,metadata:i}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:_m,xhr:t,metadata:i}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:Tm,xhr:t,metadata:i}:"arraybuffer"===t.responseType&&0===t.response.byteLength?{status:t.status,message:"Empty HLS response at URL: "+t.uri,code:Tm,xhr:t,metadata:i}:null},xm=(e,t,n,i)=>(r,s)=>{const a=s.response,o=km(r,s);if(o)return n(o,e);if(16!==a.byteLength)return n({status:s.status,message:"Invalid HLS key at URL: "+s.uri,code:Tm,xhr:s},e);const l=new DataView(a),u=new Uint32Array([l.getUint32(0),l.getUint32(4),l.getUint32(8),l.getUint32(12)]);for(let e=0;e<t.length;e++)t[e].bytes=u;const c={uri:s.uri};return i({type:"segmentkeyloadcomplete",segment:e,keyInfo:c}),n(null,e)},Am=(e,t)=>{const n=_u(e.map.bytes);if("mp4"!==n){const i=e.map.resolvedUri||e.map.uri,r=n||"unknown";return t({internal:!0,message:`Found unsupported ${r} container for initialization segment at URL: ${i}`,code:Tm,metadata:{mediaType:r}})}bm({action:"probeMp4Tracks",data:e.map.bytes,transmuxer:e.transmuxer,callback:n=>{let{tracks:i,data:r}=n;return e.map.bytes=r,i.forEach((function(t){e.map.tracks=e.map.tracks||{},e.map.tracks[t.type]||(e.map.tracks[t.type]=t,"number"===typeof t.id&&t.timescale&&(e.map.timescales=e.map.timescales||{},e.map.timescales[t.id]=t.timescale),"text"===t.type&&((e,t)=>{t===wm&&e.transmuxer.postMessage({action:"initMp4WebVttParser",data:e.map.bytes})})(e,t.codec))})),t(null)}})},Cm=e=>{let{segment:t,finishProcessingFn:n,responseType:i,triggerSegmentEventFn:r}=e;return(e,s)=>{const a=km(e,s);if(a)return n(a,t);r({type:"segmentloaded",segment:t});const o="arraybuffer"!==i&&s.responseText?(e=>{const t=new Uint8Array(new ArrayBuffer(e.length));for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.buffer})(s.responseText.substring(t.lastReachedChar||0)):s.response;return t.stats=(e=>({bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}))(s),t.key?t.encryptedBytes=new Uint8Array(o):t.bytes=new Uint8Array(o),n(null,t)}},Im=e=>{let{segment:t,bytes:n,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:l,isEndOfTimeline:u,endedTimelineFn:c,dataFn:d,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:p}=e;const g=t.map&&t.map.tracks||{},m=Boolean(g.audio&&g.video);let y=r.bind(null,t,"audio","start");const v=r.bind(null,t,"audio","end");let b=r.bind(null,t,"video","start");const T=r.bind(null,t,"video","end");bm({action:"probeTs",transmuxer:t.transmuxer,data:n,baseStartTime:t.baseStartTime,callback:e=>{t.bytes=n=e.data;const r=e.result;r&&(i(t,{hasAudio:r.hasAudio,hasVideo:r.hasVideo,isMuxed:m}),i=null),mm({bytes:n,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,remux:m,onData:e=>{e.type="combined"===e.type?"video":e.type,d(t,e)},onTrackInfo:e=>{i&&(m&&(e.isMuxed=!0),i(t,e))},onAudioTimingInfo:e=>{y&&"undefined"!==typeof e.start&&(y(e.start),y=null),v&&"undefined"!==typeof e.end&&v(e.end)},onVideoTimingInfo:e=>{b&&"undefined"!==typeof e.start&&(b(e.start),b=null),T&&"undefined"!==typeof e.end&&T(e.end)},onVideoSegmentTimingInfo:e=>{const n={pts:{start:e.start.presentation,end:e.end.presentation},dts:{start:e.start.decode,end:e.end.decode}};p({type:"segmenttransmuxingtiminginfoavailable",segment:t,timingInfo:n}),s(e)},onAudioSegmentTimingInfo:e=>{const n={pts:{start:e.start.pts,end:e.end.pts},dts:{start:e.start.dts,end:e.end.dts}};p({type:"segmenttransmuxingtiminginfoavailable",segment:t,timingInfo:n}),a(e)},onId3:(e,n)=>{o(t,e,n)},onCaptions:e=>{l(t,[e])},isEndOfTimeline:u,onEndedTimeline:()=>{c()},onTransmuxerLog:f,onDone:(e,n)=>{h&&(e.type="combined"===e.type?"video":e.type,p({type:"segmenttransmuxingcomplete",segment:t}),h(n,t,e))},segment:t,triggerSegmentEventFn:p})}})},Lm=e=>{let{segment:t,bytes:n,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:l,isEndOfTimeline:u,endedTimelineFn:c,dataFn:d,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:p}=e,g=new Uint8Array(n);if(function(e){return au(e,["moof"]).length>0}(g)){t.isFmp4=!0;const{tracks:e}=t.map;if(e.text&&(!e.audio||!e.video))return d(t,{data:g,type:"text"}),void((e,t,n)=>{t===wm&&bm({action:"getMp4WebVttText",data:e.bytes,transmuxer:e.transmuxer,callback:t=>{let{data:i,mp4VttCues:r}=t;e.bytes=i,n(null,e,{mp4VttCues:r})}})})(t,e.text.codec,h);const s={isFmp4:!0,hasVideo:!!e.video,hasAudio:!!e.audio};e.audio&&e.audio.codec&&"enca"!==e.audio.codec&&(s.audioCodec=e.audio.codec),e.video&&e.video.codec&&"encv"!==e.video.codec&&(s.videoCodec=e.video.codec),e.video&&e.audio&&(s.isMuxed=!0),i(t,s);const a=(e,n)=>{d(t,{data:g,type:s.hasAudio&&!s.isMuxed?"audio":"video"}),n&&n.length&&o(t,n),e&&e.length&&l(t,e),h(null,t,{})};bm({action:"probeMp4StartTime",timescales:t.map.timescales,data:g,transmuxer:t.transmuxer,callback:i=>{let{data:o,startTime:l}=i;n=o.buffer,t.bytes=g=o,s.hasAudio&&!s.isMuxed&&r(t,"audio","start",l),s.hasVideo&&r(t,"video","start",l),bm({action:"probeEmsgID3",data:g,transmuxer:t.transmuxer,offset:l,callback:i=>{let{emsgData:r,id3Frames:s}=i;n=r.buffer,t.bytes=g=r,e.video&&r.byteLength&&t.transmuxer?bm({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:t.transmuxer,data:g,timescales:t.map.timescales,trackIds:[e.video.id],callback:e=>{n=e.data.buffer,t.bytes=g=e.data,e.logs.forEach((function(e){f(Kp(e,{stream:"mp4CaptionParser"}))})),a(e.captions,s)}}):a(void 0,s)}})}})}else if(t.transmuxer){if("undefined"===typeof t.container&&(t.container=_u(g)),"ts"!==t.container&&"aac"!==t.container)return i(t,{hasAudio:!1,hasVideo:!1}),void h(null,t,{});Im({segment:t,bytes:n,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:l,isEndOfTimeline:u,endedTimelineFn:c,dataFn:d,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:p})}else h(null,t,{})},Dm=function(e,t){let{id:n,key:i,encryptedBytes:r,decryptionWorker:s,segment:a,doneFn:o}=e;const l=e=>{if(e.data.source===n){s.removeEventListener("message",l);const n=e.data.decrypted;t(new Uint8Array(n.bytes,n.byteOffset,n.byteLength))}};let u;s.onerror=()=>{const e="An error occurred in the decryption worker",t=oy({segment:a}),n={message:e,metadata:{error:new Error(e),errorType:Bp.Error.StreamingFailedToDecryptSegment,segmentInfo:t,keyInfo:{uri:a.key.resolvedUri||a.map.key.resolvedUri}}};o(n,a)},s.addEventListener("message",l),u=i.bytes.slice?i.bytes.slice():new Uint32Array(Array.prototype.slice.call(i.bytes)),s.postMessage(Gg({source:n,encrypted:r,key:u,iv:i.iv}),[r.buffer,u.buffer])},Rm=e=>{let{activeXhrs:t,decryptionWorker:n,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:l,isEndOfTimeline:u,endedTimelineFn:c,dataFn:d,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:p}=e,g=0,m=!1;return(e,y)=>{if(!m){if(e)return m=!0,Em(t),h(e,y);if(g+=1,g===t.length){const e=function(){if(y.encryptedBytes)return(e=>{let{decryptionWorker:t,segment:n,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:l,isEndOfTimeline:u,endedTimelineFn:c,dataFn:d,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:p}=e;p({type:"segmentdecryptionstart"}),Dm({id:n.requestId,key:n.key,encryptedBytes:n.encryptedBytes,decryptionWorker:t,segment:n,doneFn:h},(e=>{n.bytes=e,p({type:"segmentdecryptioncomplete",segment:n}),Lm({segment:n,bytes:n.bytes,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:l,isEndOfTimeline:u,endedTimelineFn:c,dataFn:d,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:p})}))})({decryptionWorker:n,segment:y,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:l,isEndOfTimeline:u,endedTimelineFn:c,dataFn:d,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:p});Lm({segment:y,bytes:y.bytes,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:l,isEndOfTimeline:u,endedTimelineFn:c,dataFn:d,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:p})};if(y.endOfAllRequests=Date.now(),y.map&&y.map.encryptedBytes&&!y.map.bytes)return p({type:"segmentdecryptionstart",segment:y}),Dm({decryptionWorker:n,id:y.requestId+"-init",encryptedBytes:y.map.encryptedBytes,key:y.map.key,segment:y,doneFn:h},(n=>{y.map.bytes=n,p({type:"segmentdecryptioncomplete",segment:y}),Am(y,(n=>{if(n)return Em(t),h(n,y);e()}))}));e()}}}},Mm=e=>{let{segment:t,progressFn:n,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:l,isEndOfTimeline:u,endedTimelineFn:c,dataFn:d}=e;return e=>{if(!e.target.aborted)return t.stats=Kp(t.stats,(e=>{const t=e.target,n={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-t.requestTime||0};return n.bytesReceived=e.loaded,n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3),n})(e)),!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived&&(t.stats.firstBytesReceivedAt=Date.now()),n(e,t)}},Pm=e=>{let{xhr:t,xhrOptions:n,decryptionWorker:i,segment:r,abortFn:s,progressFn:a,trackInfoFn:o,timingInfoFn:l,videoSegmentTimingInfoFn:u,audioSegmentTimingInfoFn:c,id3Fn:d,captionsFn:h,isEndOfTimeline:f,endedTimelineFn:p,dataFn:g,doneFn:m,onTransmuxerLog:y,triggerSegmentEventFn:v}=e;const b=[],T=Rm({activeXhrs:b,decryptionWorker:i,trackInfoFn:o,timingInfoFn:l,videoSegmentTimingInfoFn:u,audioSegmentTimingInfoFn:c,id3Fn:d,captionsFn:h,isEndOfTimeline:f,endedTimelineFn:p,dataFn:g,doneFn:m,onTransmuxerLog:y,triggerSegmentEventFn:v});if(r.key&&!r.key.bytes){const e=[r.key];r.map&&!r.map.bytes&&r.map.key&&r.map.key.resolvedUri===r.key.resolvedUri&&e.push(r.map.key);const i=Kp(n,{uri:r.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),s=xm(r,e,T,v);v({type:"segmentkeyloadstart",segment:r,keyInfo:{uri:r.key.resolvedUri}});const a=t(i,s);b.push(a)}if(r.map&&!r.map.bytes){if(r.map.key&&(!r.key||r.key.resolvedUri!==r.map.key.resolvedUri)){const e=Kp(n,{uri:r.map.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),i=xm(r,[r.map.key],T,v);v({type:"segmentkeyloadstart",segment:r,keyInfo:{uri:r.map.key.resolvedUri}});const s=t(e,i);b.push(s)}const e=Kp(n,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:$g(r.map),requestType:"segment-media-initialization"}),i=(e=>{let{segment:t,finishProcessingFn:n,triggerSegmentEventFn:i}=e;return(e,r)=>{const s=km(e,r);if(s)return n(s,t);const a=new Uint8Array(r.response);if(i({type:"segmentloaded",segment:t}),t.map.key)return t.map.encryptedBytes=a,n(null,t);t.map.bytes=a,Am(t,(function(e){if(e)return e.xhr=r,e.status=r.status,n(e,t);n(null,t)}))}})({segment:r,finishProcessingFn:T,triggerSegmentEventFn:v});v({type:"segmentloadstart",segment:r});const s=t(e,i);b.push(s)}const S=Kp(n,{uri:r.part&&r.part.resolvedUri||r.resolvedUri,responseType:"arraybuffer",headers:$g(r),requestType:"segment"}),_=Cm({segment:r,finishProcessingFn:T,responseType:S.responseType,triggerSegmentEventFn:v});v({type:"segmentloadstart",segment:r});const w=t(S,_);w.addEventListener("progress",Mm({segment:r,progressFn:a,trackInfoFn:o,timingInfoFn:l,videoSegmentTimingInfoFn:u,audioSegmentTimingInfoFn:c,id3Fn:d,captionsFn:h,isEndOfTimeline:f,endedTimelineFn:p,dataFn:g})),b.push(w);const E={};return b.forEach((e=>{e.addEventListener("loadend",(e=>{let{loadendState:t,abortFn:n}=e;return e=>{e.target.aborted&&n&&!t.calledAbortFn&&(n(),t.calledAbortFn=!0)}})({loadendState:E,abortFn:s}))})),()=>Em(b)},Om=zp("CodecUtils"),Nm=(e,t)=>{const n=t.attributes||{};return e&&e.mediaGroups&&e.mediaGroups.AUDIO&&n.AUDIO&&e.mediaGroups.AUDIO[n.AUDIO]},Um=function(e){const t={};return e.forEach((e=>{let{mediaType:n,type:i,details:r}=e;t[n]=t[n]||[],t[n].push(Mo(`${i}${r}`))})),Object.keys(t).forEach((function(e){if(t[e].length>1)return Om(`multiple ${e} codecs found as attributes: ${t[e].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),void(t[e]=null);t[e]=t[e][0]})),t},Fm=function(e){let t=0;return e.audio&&t++,e.video&&t++,t},Bm=function(e,t){const n=t.attributes||{},i=Um(function(e){const t=e.attributes||{};if(t.CODECS)return Po(t.CODECS)}(t)||[]);if(Nm(e,t)&&!i.audio&&!((e,t)=>{if(!Nm(e,t))return!0;const n=t.attributes||{},i=e.mediaGroups.AUDIO[n.AUDIO];for(const r in i)if(!i[r].uri&&!i[r].playlists)return!0;return!1})(e,t)){const t=Um(function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var n=e.mediaGroups.AUDIO[t];if(!n)return null;for(var i in n){var r=n[i];if(r.default&&r.playlists)return Po(r.playlists[0].attributes.CODECS)}return null}(e,n.AUDIO)||[]);t.audio&&(i.audio=t.audio)}return i},jm=zp("PlaylistSelector"),$m=function(e){if(!e||!e.playlist)return;const t=e.playlist;return JSON.stringify({id:t.id,bandwidth:e.bandwidth,width:e.width,height:e.height,codecs:t.attributes&&t.attributes.CODECS||""})},Vm=function(e,t){if(!e)return"";const n=lo().getComputedStyle(e);return n?n[t]:""},Hm=function(e,t){const n=e.slice();e.sort((function(e,i){const r=t(e,i);return 0===r?n.indexOf(e)-n.indexOf(i):r}))},qm=function(e,t){let n,i;return e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||lo().Number.MAX_VALUE,t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),i=i||lo().Number.MAX_VALUE,n-i};let Gm=function(e,t,n,i,r,s){if(!e)return;const a={bandwidth:t,width:n,height:i,limitRenditionByPlayerDimensions:r};let o=e.playlists;Sg.isAudioOnly(e)&&(o=s.getAudioTrackPlaylists_(),a.audioOnly=!0);let l=o.map((e=>{let t;const n=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,i=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;return t=e.attributes&&e.attributes.BANDWIDTH,t=t||lo().Number.MAX_VALUE,{bandwidth:t,width:n,height:i,playlist:e}}));Hm(l,((e,t)=>e.bandwidth-t.bandwidth)),l=l.filter((e=>!Sg.isIncompatible(e.playlist)));let u=l.filter((e=>Sg.isEnabled(e.playlist)));u.length||(u=l.filter((e=>!Sg.isDisabled(e.playlist))));const c=u.filter((e=>e.bandwidth*am.BANDWIDTH_VARIANCE<t));let d=c[c.length-1];const h=c.filter((e=>e.bandwidth===d.bandwidth))[0];if(!1===r){const e=h||u[0]||l[0];if(e&&e.playlist){let t="sortedPlaylistReps";return h&&(t="bandwidthBestRep"),u[0]&&(t="enabledPlaylistReps"),jm(`choosing ${$m(e)} using ${t} with options`,a),e.playlist}return jm("could not choose a playlist with options",a),null}const f=c.filter((e=>e.width&&e.height));Hm(f,((e,t)=>e.width-t.width));const p=f.filter((e=>e.width===n&&e.height===i));d=p[p.length-1];const g=p.filter((e=>e.bandwidth===d.bandwidth))[0];let m,y,v,b;if(g||(m=f.filter((e=>e.width>n||e.height>i)),y=m.filter((e=>e.width===m[0].width&&e.height===m[0].height)),d=y[y.length-1],v=y.filter((e=>e.bandwidth===d.bandwidth))[0]),s.leastPixelDiffSelector){const e=f.map((e=>(e.pixelDiff=Math.abs(e.width-n)+Math.abs(e.height-i),e)));Hm(e,((e,t)=>e.pixelDiff===t.pixelDiff?t.bandwidth-e.bandwidth:e.pixelDiff-t.pixelDiff)),b=e[0]}const T=b||v||g||h||u[0]||l[0];if(T&&T.playlist){let e="sortedPlaylistReps";return b?e="leastPixelDiffRep":v?e="resolutionPlusOneRep":g?e="resolutionBestRep":h?e="bandwidthBestRep":u[0]&&(e="enabledPlaylistReps"),jm(`choosing ${$m(T)} using ${e} with options`,a),T.playlist}return jm("could not choose a playlist with options",a),null};const zm=function(){let e=this.useDevicePixelRatio&&lo().devicePixelRatio||1;return isNaN(this.customPixelRatio)||(e=this.customPixelRatio),Gm(this.playlists.main,this.systemBandwidth,parseInt(Vm(this.tech_.el(),"width"),10)*e,parseInt(Vm(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions,this.playlistController_)};function Km(e){try{return new URL(e).pathname.split("/").slice(-2).join("/")}catch(t){return""}}const Wm=e=>{let{inbandTextTracks:t,metadataArray:n,timestampOffset:i,videoDuration:r}=e;if(!n)return;const s=lo().WebKitDataCue||lo().VTTCue,a=t.metadataTrack_;if(!a)return;if(n.forEach((e=>{const t=e.cueTime+i;!("number"!==typeof t||lo().isNaN(t)||t<0)&&t<1/0&&e.frames&&e.frames.length&&e.frames.forEach((e=>{const n=new s(t,t,e.value||e.url||e.data||"");n.frame=e,n.value=e,function(e){Object.defineProperties(e.frame,{id:{get:()=>(Bp.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key)},value:{get:()=>(Bp.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data)},privateData:{get:()=>(Bp.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data)}})}(n),a.addCue(n)}))})),!a.cues||!a.cues.length)return;const o=a.cues,l=[];for(let d=0;d<o.length;d++)o[d]&&l.push(o[d]);const u=l.reduce(((e,t)=>{const n=e[t.startTime]||[];return n.push(t),e[t.startTime]=n,e}),{}),c=Object.keys(u).sort(((e,t)=>Number(e)-Number(t)));c.forEach(((e,t)=>{const n=u[e],i=isFinite(r)?r:e,s=Number(c[t+1])||i;n.forEach((e=>{e.endTime=s}))}))},Xm={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},Ym=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),Qm=(e,t,n)=>{e.metadataTrack_||(e.metadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,Bp.browser.IS_ANY_SAFARI||(e.metadataTrack_.inBandMetadataTrackDispatchType=t))},Jm=function(e,t,n){let i,r;if(n&&n.cues)for(i=n.cues.length;i--;)r=n.cues[i],r.startTime>=e&&r.endTime<=t&&n.removeCue(r)},Zm=e=>"number"===typeof e&&isFinite(e),ey=1/60,ty=e=>{const{startOfSegment:t,duration:n,segment:i,part:r,playlist:{mediaSequence:s,id:a,segments:o=[]},mediaIndex:l,partIndex:u,timeline:c}=e,d=o.length-1;let h="mediaIndex/partIndex increment";e.getMediaInfoForTime?h=`getMediaInfoForTime (${e.getMediaInfoForTime})`:e.isSyncRequest&&(h="getSyncSegmentCandidate (isSyncRequest)"),e.independent&&(h+=` with independent ${e.independent}`);const f="number"===typeof u,p=e.segment.uri?"segment":"pre-segment",g=f?og({preloadSegment:i})-1:0;return`${p} [${s+l}/${s+d}]`+(f?` part [${u}/${g}]`:"")+` segment start/end [${i.start} => ${i.end}]`+(f?` part start/end [${r.start} => ${r.end}]`:"")+` startOfSegment [${t}]`+` duration [${n}]`+` timeline [${c}]`+` selected by [${h}]`+` playlist [${a}]`},ny=e=>`${e}TimingInfo`,iy=e=>{let{timelineChangeController:t,currentTimeline:n,segmentTimeline:i,loaderType:r,audioDisabled:s}=e;if(n===i)return!1;if("audio"===r){const e=t.lastTimelineChange({type:"main"});return!e||e.to!==i}if("main"===r&&s){const e=t.pendingTimelineChange({type:"audio"});return!e||e.to!==i}return!1},ry=e=>{const t=e.pendingSegment_;if(!t)return;if(iy({timelineChangeController:e.timelineChangeController_,currentTimeline:e.currentTimeline_,segmentTimeline:t.timeline,loaderType:e.loaderType_,audioDisabled:e.audioDisabled_})&&(e=>{if(!e)return!1;const t=e.pendingTimelineChange({type:"audio"}),n=e.pendingTimelineChange({type:"main"}),i=t&&n,r=i&&t.to!==n.to;return!(!i||-1===t.from||-1===n.from||!r)})(e.timelineChangeController_)){if((e=>{const t=e.timelineChangeController_.pendingTimelineChange({type:"audio"}),n=e.timelineChangeController_.pendingTimelineChange({type:"main"});return t&&n&&t.to<n.to})(e))return void e.timelineChangeController_.trigger("audioTimelineBehind");e.timelineChangeController_.trigger("fixBadTimelineChange")}},sy=e=>{let{segmentDuration:t,maxDuration:n}=e;return!!t&&Math.round(t)>n+Xp},ay=(e,t)=>{if("hls"!==t)return null;const n=(e=>{let t=0;return["video","audio"].forEach((function(n){const i=e[`${n}TimingInfo`];if(!i)return;const{start:r,end:s}=i;let a;"bigint"===typeof r||"bigint"===typeof s?a=lo().BigInt(s)-lo().BigInt(r):"number"===typeof r&&"number"===typeof s&&(a=s-r),"undefined"!==typeof a&&a>t&&(t=a)})),"bigint"===typeof t&&t<Number.MAX_SAFE_INTEGER&&(t=Number(t)),t})({audioTimingInfo:e.audioTimingInfo,videoTimingInfo:e.videoTimingInfo});if(!n)return null;const i=e.playlist.targetDuration,r=sy({segmentDuration:n,maxDuration:2*i}),s=sy({segmentDuration:n,maxDuration:i}),a=`Segment with index ${e.mediaIndex} from playlist ${e.playlist.id} has a duration of ${n} when the reported duration is ${e.duration} and the target duration is ${i}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return r||s?{severity:r?"warn":"info",message:a}:null},oy=e=>{let{type:t,segment:n}=e;if(!n)return;const i=Boolean(n.key||n.map&&n.map.ke),r=Boolean(n.map&&!n.map.bytes),s=void 0===n.startOfSegment?n.start:n.startOfSegment;return{type:t||n.type,uri:n.resolvedUri||n.uri,start:s,duration:n.duration,isEncrypted:i,isMediaInitialization:r}};class ly extends Bp.EventTarget{constructor(e){if(super(),!e)throw new TypeError("Initialization settings are required");if("function"!==typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.addMetadataToTextTrack=e.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",(()=>{this.isEndOfStream_()||(this.ended_=!1)})),this.fetchAtBuffer_=!1,this.logger_=zp(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(e){e!==this.state_&&(this.logger_(`${this.state_} -> ${e}`),this.state_=e,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",(()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():ry(this)})),this.sourceUpdater_.on("codecschange",(e=>{this.trigger(mo({type:"codecschange"},e))})),"main"===this.loaderType_&&this.timelineChangeController_.on("pendingtimelinechange",(()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():ry(this)})),"audio"===this.loaderType_&&this.timelineChangeController_.on("timelinechange",(e=>{this.trigger(mo({type:"timelinechange"},e)),this.hasEnoughInfoToLoad_()?this.processLoadQueue_():ry(this),this.hasEnoughInfoToAppend_()?this.processCallQueue_():ry(this)}))}get mediaSequenceSync_(){return this.syncController_.getMediaSequenceSync(this.loaderType_)}createTransmuxer_(){return vm({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&lo().clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if("WAITING"!==this.state)return this.pendingSegment_&&(this.pendingSegment_=null),void this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_);this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,lo().clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==e:(this.state="READY",!0)}error(e){return"undefined"!==typeof e&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&ym(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return Wp();if("main"===this.loaderType_){const{hasAudio:t,hasVideo:n,isMuxed:i}=e;if(n&&t&&!this.audioDisabled_&&!i)return this.sourceUpdater_.buffered();if(n)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;const n=zg(e);let i=this.initSegments_[n];return t&&!i&&e.bytes&&(this.initSegments_[n]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),i||e}segmentKey(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;const n=Kg(e);let i=this.keyCache_[n];this.cacheEncryptionKeys_&&t&&!i&&e.bytes&&(this.keyCache_[n]=i={resolvedUri:e.resolvedUri,bytes:e.bytes});const r={resolvedUri:(i||e).resolvedUri};return i&&(r.bytes=i.bytes),r}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),this.playlist_)return"INIT"===this.state&&this.couldBeginLoading_()?this.init_():void(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY"))}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return;if(this.playlist_&&this.playlist_.endList&&e.endList&&this.playlist_.uri===e.uri)return;const n=this.playlist_,i=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,"INIT"===this.state&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},"main"===this.loaderType_&&this.syncController_.setDateTimeMappingForStart(e));let r=null;if(n&&(n.id?r=n.id:n.uri&&(r=n.uri)),this.logger_(`playlist update [${r} => ${e.id||e.uri}]`),this.mediaSequenceSync_&&(this.mediaSequenceSync_.update(e,this.currentTime_()),this.logger_(`Playlist update:\ncurrentTime: ${this.currentTime_()}\nbufferedEnd: ${ng(this.buffered_())}\n`,this.mediaSequenceSync_.diagnostics)),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!n||n.uri!==e.uri){if(null!==this.mediaIndex){!e.endList&&"number"===typeof e.partTargetDuration?this.resetLoader():this.resyncLoader()}return this.currentMediaInfo_=void 0,void this.trigger("playlistupdate")}const s=e.mediaSequence-n.mediaSequence;if(this.logger_(`live window shift [${s}]`),null!==this.mediaIndex)if(this.mediaIndex-=s,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const e=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!e.parts||!e.parts.length||!e.parts[this.partIndex])){const e=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=e}}i&&(i.mediaIndex-=s,i.mediaIndex<0?(i.mediaIndex=null,i.partIndex=null):(i.mediaIndex>=0&&(i.segment=e.segments[i.mediaIndex]),i.partIndex>=0&&i.segment.parts&&(i.part=i.segment.parts[i.partIndex]))),this.syncController_.saveExpiredSegmentInfo(n,e)}pause(){this.checkBufferTimeout_&&(lo().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return null===this.checkBufferTimeout_}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.mediaSequenceSync_&&this.mediaSequenceSync_.resetAppendedStatus(),this.resyncLoader()}resyncLoader(){this.transmuxer_&&ym(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1;const e=this.currentMediaInfo_&&this.currentMediaInfo_.isFmp4;"hls"===this.sourceType_&&!e&&(this.shouldForceTimestampOffsetAfterResync_=!0),this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t===1/0&&(t=this.duration_()),t<=e)return void this.logger_("skipping remove because end ${end} is <= start ${start}");if(!this.sourceUpdater_||!this.getMediaInfo_())return void this.logger_("skipping remove because no source updater or starting media info");let r=1;const s=()=>{r--,0===r&&n()};!i&&this.audioDisabled_||(r++,this.sourceUpdater_.removeAudio(e,t,s)),(i||"main"===this.loaderType_)&&(this.gopBuffer_=((e,t,n,i)=>{const r=Math.ceil((t-i)*wu.ONE_SECOND_IN_TS),s=Math.ceil((n-i)*wu.ONE_SECOND_IN_TS),a=e.slice();let o=e.length;for(;o--&&!(e[o].pts<=s););if(-1===o)return a;let l=o+1;for(;l--&&!(e[l].pts<=r););return l=Math.max(l,0),a.splice(l,o-l+1),a})(this.gopBuffer_,e,t,this.timeMapping_),r++,this.sourceUpdater_.removeVideo(e,t,s));for(const a in this.inbandTextTracks_)Jm(e,t,this.inbandTextTracks_[a]);Jm(e,t,this.segmentMetadataTrack_),s()}monitorBuffer_(){this.checkBufferTimeout_&&lo().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=lo().setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&lo().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=lo().setTimeout(this.monitorBufferTick_.bind(this),500)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();if(!e)return;const t={segmentInfo:oy({type:this.loaderType_,segment:e})};this.trigger({type:"segmentselected",metadata:t}),"number"===typeof e.timestampOffset&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e)}isEndOfStream_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mediaIndex,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.playlist_,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.partIndex;if(!t||!this.mediaSource_)return!1;const i="number"===typeof e&&t.segments[e],r=e+1===t.segments.length,s=!i||!i.parts||n+1===i.parts.length;return t.endList&&"open"===this.mediaSource_.readyState&&r&&s}chooseNextRequest_(){const e=this.buffered_(),t=ng(e)||0,n=ig(e,this.currentTime_()),i=!this.hasPlayed_()&&n>=1,r=n>=this.goalBufferLength_(),s=this.playlist_.segments;if(!s.length||i||r)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const a={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(a.isSyncRequest)a.mediaIndex=function(e,t,n){t=t||[];const i=[];let r=0;for(let s=0;s<t.length;s++){const a=t[s];if(e===a.timeline&&(i.push(s),r+=a.duration,r>n))return s}return 0===i.length?0:i[i.length-1]}(this.currentTimeline_,s,t),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${a.mediaIndex}`);else if(null!==this.mediaIndex){const e=s[this.mediaIndex],n="number"===typeof this.partIndex?this.partIndex:-1;a.startOfSegment=e.end?e.end:t,e.parts&&e.parts[n+1]?(a.mediaIndex=this.mediaIndex,a.partIndex=n+1):a.mediaIndex=this.mediaIndex+1}else{let e,n,i;const r=this.fetchAtBuffer_?t:this.currentTime_();if(this.mediaSequenceSync_&&this.logger_(`chooseNextRequest_ request after Quality Switch:\nFor TargetTime: ${r}.\nCurrentTime: ${this.currentTime_()}\nBufferedEnd: ${t}\nFetch At Buffer: ${this.fetchAtBuffer_}\n`,this.mediaSequenceSync_.diagnostics),this.mediaSequenceSync_&&this.mediaSequenceSync_.isReliable){const t=this.getSyncInfoFromMediaSequenceSync_(r);if(!t){const e="No sync info found while using media sequence sync";return this.error({message:e,metadata:{errorType:Bp.Error.StreamingFailedToSelectNextSegment,error:new Error(e)}}),this.logger_("chooseNextRequest_ - no sync info found using media sequence sync"),null}this.logger_(`chooseNextRequest_ mediaSequence syncInfo (${t.start} --\x3e ${t.end})`),e=t.segmentIndex,n=t.partIndex,i=t.start}else{this.logger_("chooseNextRequest_ - fallback to a regular segment selection algorithm, based on a syncPoint.");const t=Sg.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:r,startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});e=t.segmentIndex,n=t.partIndex,i=t.startTime}a.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${r}`:`currentTime ${r}`,a.mediaIndex=e,a.startOfSegment=i,a.partIndex=n,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${a.mediaIndex} `)}const o=s[a.mediaIndex];let l=o&&"number"===typeof a.partIndex&&o.parts&&o.parts[a.partIndex];if(!o||"number"===typeof a.partIndex&&!l)return null;"number"!==typeof a.partIndex&&o.parts&&(a.partIndex=0,l=o.parts[0]);const u=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!n&&l&&!u&&!l.independent)if(0===a.partIndex){const e=s[a.mediaIndex-1],t=e.parts&&e.parts.length&&e.parts[e.parts.length-1];t&&t.independent&&(a.mediaIndex-=1,a.partIndex=e.parts.length-1,a.independent="previous segment")}else o.parts[a.partIndex-1].independent&&(a.partIndex-=1,a.independent="previous part");const c=this.mediaSource_&&"ended"===this.mediaSource_.readyState;return a.mediaIndex>=s.length-1&&c&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,a.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(a))}getSyncInfoFromMediaSequenceSync_(e){if(!this.mediaSequenceSync_)return null;const t=Math.max(e,this.mediaSequenceSync_.start);e!==t&&this.logger_(`getSyncInfoFromMediaSequenceSync_. Pulled target time from ${e} to ${t}`);const n=this.mediaSequenceSync_.getSyncInfoForTime(t);if(!n)return null;if(!n.isAppended)return n;const i=this.mediaSequenceSync_.getSyncInfoForTime(n.end);return i?(i.isAppended&&this.logger_("getSyncInfoFromMediaSequenceSync_: We encounter unexpected scenario where next media sequence sync info is also appended!"),i):null}generateSegmentInfo_(e){const{independent:t,playlist:n,mediaIndex:i,startOfSegment:r,isSyncRequest:s,partIndex:a,forceTimestampOffset:o,getMediaInfoForTime:l}=e,u=n.segments[i],c="number"===typeof a&&u.parts[a],d={requestId:"segment-loader-"+Math.random(),uri:c&&c.resolvedUri||u.resolvedUri,mediaIndex:i,partIndex:c?a:null,isSyncRequest:s,startOfSegment:r,playlist:n,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:u.timeline,duration:c&&c.duration||u.duration,segment:u,part:c,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:l,independent:t},h="undefined"!==typeof o?o:this.isPendingTimestampOffset_;d.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:u.timeline,currentTimeline:this.currentTimeline_,startOfSegment:r,buffered:this.buffered_(),overrideCheck:h});const f=ng(this.sourceUpdater_.audioBuffered());return"number"===typeof f&&(d.audioAppendStart=f-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(d.gopsToAlignWith=((e,t,n)=>{if("undefined"===typeof t||null===t||!e.length)return[];const i=Math.ceil((t-n+3)*wu.ONE_SECOND_IN_TS);let r;for(r=0;r<e.length&&!(e[r].pts>i);r++);return e.slice(r)})(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),d}timestampOffsetForSegment_(e){return(e=>{let{segmentTimeline:t,currentTimeline:n,startOfSegment:i,buffered:r,overrideCheck:s}=e;return s||t!==n?t<n?i:r.length?r.end(r.length-1):i:null})(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const t=this.currentTime_(),n=e.bandwidth,i=this.pendingSegment_.duration,r=Sg.estimateSegmentRequestTime(i,n,this.playlist_,e.bytesReceived),s=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return((e.length?e.end(e.length-1):0)-t)/n}(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(r<=s)return;const a=function(e){const{main:t,currentTime:n,bandwidth:i,duration:r,segmentDuration:s,timeUntilRebuffer:a,currentTimeline:o,syncController:l}=e,u=t.playlists.filter((e=>!Sg.isIncompatible(e)));let c=u.filter(Sg.isEnabled);c.length||(c=u.filter((e=>!Sg.isDisabled(e))));const d=c.filter(Sg.hasAttribute.bind(null,"BANDWIDTH")).map((e=>{const t=l.getSyncPoint(e,r,o,n)?1:2;return{playlist:e,rebufferingImpact:Sg.estimateSegmentRequestTime(s,i,e)*t-a}})),h=d.filter((e=>e.rebufferingImpact<=0));return Hm(h,((e,t)=>qm(t.playlist,e.playlist))),h.length?h[0]:(Hm(d,((e,t)=>e.rebufferingImpact-t.rebufferingImpact)),d[0]||null)}({main:this.vhs_.playlists.main,currentTime:t,bandwidth:n,duration:this.duration_(),segmentDuration:i,timeUntilRebuffer:s,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!a)return;const o=r-s-a.rebufferingImpact;let l=.5;s<=Xp&&(l=1),!a.playlist||a.playlist.uri===this.playlist_.uri||o<l||(this.bandwidth=a.playlist.attributes.BANDWIDTH*am.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${ty(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,t){this.earlyAbortWhenNeeded_(t.stats),this.checkForAbort_(t.requestId)||this.trigger("progress")}handleTrackInfo_(e,t){const{hasAudio:n,hasVideo:i}=t,r={segmentInfo:oy({type:this.loaderType_,segment:e}),trackInfo:{hasAudio:n,hasVideo:i}};this.trigger({type:"segmenttransmuxingtrackinfoavailable",metadata:r}),this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId)||this.checkForIllegalMediaSwitch(t)||(t=t||{},function(e,t){if(!e&&!t||!e&&t||e&&!t)return!1;if(e===t)return!0;const n=Object.keys(e).sort(),i=Object.keys(t).sort();if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++){const s=n[r];if(s!==i[r])return!1;if(e[s]!==t[s])return!1}return!0}(this.currentMediaInfo_,t)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),this.checkForAbort_(e.requestId)||(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()?this.processCallQueue_():ry(this)))}handleTimingInfo_(e,t,n,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const r=this.pendingSegment_,s=ny(t);r[s]=r[s]||{},r[s][n]=i,this.logger_(`timinginfo: ${t} - ${n} - ${i}`),this.hasEnoughInfoToAppend_()?this.processCallQueue_():ry(this)}handleCaptions_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(0===t.length)return void this.logger_("SegmentLoader received no captions from a caption event");if(!this.pendingSegment_.hasAppendedData_)return void this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t));const n=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),i={};t.forEach((e=>{i[e.stream]=i[e.stream]||{startTime:1/0,captions:[],endTime:0};const t=i[e.stream];t.startTime=Math.min(t.startTime,e.startTime+n),t.endTime=Math.max(t.endTime,e.endTime+n),t.captions.push(e)})),Object.keys(i).forEach((e=>{const{startTime:t,endTime:r,captions:s}=i[e],a=this.inbandTextTracks_;this.logger_(`adding cues from ${t} -> ${r} for ${e}`),function(e,t,n){if(!e[n]){t.trigger({type:"usage",name:"vhs-608"});let i=n;/^cc708_/.test(n)&&(i="SERVICE"+n.split("_")[1]);const r=t.textTracks().getTrackById(i);if(r)e[n]=r;else{let r=n,s=n,a=!1;const o=(t.options_.vhs&&t.options_.vhs.captionServices||{})[i];o&&(r=o.label,s=o.language,a=o.default),e[n]=t.addRemoteTextTrack({kind:"captions",id:i,default:a,label:r,language:s},!1).track}}}(a,this.vhs_.tech_,e),Jm(t,r,a[e]),function(e){let{inbandTextTracks:t,captionArray:n,timestampOffset:i}=e;if(!n)return;const r=lo().WebKitDataCue||lo().VTTCue;n.forEach((e=>{const n=e.stream;e.content?e.content.forEach((s=>{const a=new r(e.startTime+i,e.endTime+i,s.text);a.line=s.line,a.align="left",a.position=s.position,a.positionAlign="line-left",t[n].addCue(a)})):t[n].addCue(new r(e.startTime+i,e.endTime+i,e.text))}))}({captionArray:s,inbandTextTracks:a,timestampOffset:n})})),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,t,n){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;this.pendingSegment_.hasAppendedData_?this.addMetadataToTextTrack(n,t,this.duration_()):this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,n))}processMetadataQueue_(){this.metadataQueue_.id3.forEach((e=>e())),this.metadataQueue_.caption.forEach((e=>e())),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach((e=>e()))}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach((e=>e()))}hasEnoughInfoToLoad_(){if("audio"!==this.loaderType_)return!0;const e=this.pendingSegment_;return!!e&&(!this.getCurrentMediaInfo_()||!iy({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}getCurrentMediaInfo_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pendingSegment_;return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pendingSegment_;return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready())return!1;if(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,t=this.getCurrentMediaInfo_();if(!e||!t)return!1;const{hasAudio:n,hasVideo:i,isMuxed:r}=t;return!(i&&!e.videoTimingInfo)&&(!(n&&!this.audioDisabled_&&!r&&!e.audioTimingInfo)&&!iy({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_())return ry(this),void this.callQueue_.push(this.handleData_.bind(this,e,t));const n=this.pendingSegment_;if(this.setTimeMapping_(n.timeline),this.updateMediaSecondsLoaded_(n.part||n.segment),"closed"!==this.mediaSource_.readyState){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),n.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),n.isFmp4=e.isFmp4,n.timingInfo=n.timingInfo||{},n.isFmp4)this.trigger("fmp4"),n.timingInfo.start=n[ny(t.type)].start;else{const e=this.getCurrentMediaInfo_(),t="main"===this.loaderType_&&e&&e.hasVideo;let i;t&&(i=n.videoTimingInfo.start),n.timingInfo.start=this.trueSegmentStart_({currentStart:n.timingInfo.start,playlist:n.playlist,mediaIndex:n.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:t,firstVideoFrameTimeForData:i,videoTimingInfo:n.videoTimingInfo,audioTimingInfo:n.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(n,t.type),this.updateSourceBufferTimestampOffset_(n),n.isSyncRequest){this.updateTimingInfoEnd_(n),this.syncController_.saveSegmentTimingInfo({segmentInfo:n,shouldSaveTimelineMapping:"main"===this.loaderType_});const e=this.chooseNextRequest_();if(e.mediaIndex!==n.mediaIndex||e.partIndex!==n.partIndex)return void this.logger_("sync segment was incorrect, not appending");this.logger_("sync segment was correct, appending")}n.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(n,t)}}updateAppendInitSegmentStatus(e,t){"main"!==this.loaderType_||"number"!==typeof e.timestampOffset||e.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)}getInitSegmentAndUpdateState_(e){let{type:t,initSegment:n,map:i,playlist:r}=e;if(i){const e=zg(i);if(this.activeInitSegmentId_===e)return null;n=this.initSegmentForMap(i,!0).bytes,this.activeInitSegmentId_=e}return n&&this.appendInitSegment_[t]?(this.playlistOfLastInitSegment_[t]=r,this.appendInitSegment_[t]=!1,this.activeInitSegmentId_=null,n):null}handleQuotaExceededError_(e,t){let{segmentInfo:n,type:i,bytes:r}=e;const s=this.sourceUpdater_.audioBuffered(),a=this.sourceUpdater_.videoBuffered();s.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+tg(s).join(", ")),a.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+tg(a).join(", "));const o=s.length?s.start(0):0,l=s.length?s.end(s.length-1):0,u=a.length?a.start(0):0,c=a.length?a.end(a.length-1):0;if(l-o<=1&&c-u<=1)return this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${r.byteLength}, audio buffer: ${tg(s).join(", ")}, video buffer: ${tg(a).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),void this.trigger("error");this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:n,type:i,bytes:r}));const d=this.currentTime_()-1;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${d}`),this.remove(0,d,(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=lo().setTimeout((()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()}),1e3)}),!0)}handleAppendError_(e,t){let{segmentInfo:n,type:i,bytes:r}=e;t&&(22!==t.code?(this.logger_("Received non QUOTA_EXCEEDED_ERR on append",t),this.error({message:`${i} append of ${r.length}b failed for segment #${n.mediaIndex} in playlist ${n.playlist.id}`,metadata:{errorType:Bp.Error.StreamingFailedToAppendSegment}}),this.trigger("appenderror")):this.handleQuotaExceededError_({segmentInfo:n,type:i,bytes:r}))}appendToSourceBuffer_(e){let{segmentInfo:t,type:n,initSegment:i,data:r,bytes:s}=e;if(!s){const e=[r];let t=r.byteLength;i&&(e.unshift(i),t+=i.byteLength),s=(e=>{let t,n=0;return e.bytes&&(t=new Uint8Array(e.bytes),e.segments.forEach((e=>{t.set(e,n),n+=e.byteLength}))),t})({bytes:t,segments:e})}const a={segmentInfo:oy({type:this.loaderType_,segment:t})};this.trigger({type:"segmentappendstart",metadata:a}),this.sourceUpdater_.appendBuffer({segmentInfo:t,type:n,bytes:s},this.handleAppendError_.bind(this,{segmentInfo:t,type:n,bytes:s}))}handleSegmentTimingInfo_(e,t,n){if(!this.pendingSegment_||t!==this.pendingSegment_.requestId)return;const i=this.pendingSegment_.segment,r=`${e}TimingInfo`;i[r]||(i[r]={}),i[r].transmuxerPrependedSeconds=n.prependedContentDuration||0,i[r].transmuxedPresentationStart=n.start.presentation,i[r].transmuxedDecodeStart=n.start.decode,i[r].transmuxedPresentationEnd=n.end.presentation,i[r].transmuxedDecodeEnd=n.end.decode,i[r].baseMediaDecodeTime=n.baseMediaDecodeTime}appendData_(e,t){const{type:n,data:i}=t;if(!i||!i.byteLength)return;if("audio"===n&&this.audioDisabled_)return;const r=this.getInitSegmentAndUpdateState_({type:n,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:n,initSegment:r,data:i})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),"number"===typeof e.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_())return ry(this),void this.loadQueue_.push((()=>{const t=mo({},e,{forceTimestampOffset:!0});mo(e,this.generateSegmentInfo_(t)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)}));this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const t=this.createSimplifiedSegmentObj_(e),n=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),i=null!==this.mediaIndex,r=e.timeline!==this.currentTimeline_&&e.timeline>0,s=n||i&&r;this.logger_(`Requesting\n${Km(e.uri)}\n${ty(e)}`),t.map&&!t.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=Pm({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:t,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:s,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:t=>{let{message:n,level:i,stream:r}=t;this.logger_(`${ty(e)} logged from transmuxer stream ${r} as a ${i}: ${n}`)},triggerSegmentEventFn:e=>{let{type:t,segment:n,keyInfo:i,trackInfo:r,timingInfo:s}=e;const a={segmentInfo:oy({segment:n})};i&&(a.keyInfo=i),r&&(a.trackInfo=r),s&&(a.timingInfo=s),this.trigger({type:t,metadata:a})}})}trimBackBuffer_(e){const t=((e,t,n)=>{let i=t-am.BACK_BUFFER_LENGTH;e.length&&(i=Math.max(i,e.start(0)));const r=t-n;return Math.min(r,i)})(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}createSimplifiedSegmentObj_(e){const t=e.segment,n=e.part,i=e.segment.key||e.segment.map&&e.segment.map.key,r=e.segment.map&&!e.segment.map.bytes,s={resolvedUri:n?n.resolvedUri:t.resolvedUri,byterange:n?n.byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part,type:this.loaderType_,start:e.startOfSegment,duration:e.duration,isEncrypted:i,isMediaInitialization:r},a=e.playlist.segments[e.mediaIndex-1];if(a&&a.timeline===t.timeline&&(a.videoTimingInfo?s.baseStartTime=a.videoTimingInfo.transmuxedDecodeEnd:a.audioTimingInfo&&(s.baseStartTime=a.audioTimingInfo.transmuxedDecodeEnd)),t.key){const n=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);s.key=this.segmentKey(t.key),s.key.iv=n}return t.map&&(s.map=this.initSegmentForMap(t.map)),s}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,t){if(this.pendingSegment_.byteLength=t.bytesReceived,e<ey)return void this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record 0.016666666666666666`);const n={bandwidthInfo:{from:this.bandwidth,to:t.bandwidth}};this.trigger({type:"bandwidthupdated",metadata:n}),this.bandwidth=t.bandwidth,this.roundTrip=t.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,t,n){if(this.callQueue_.length)return void this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,n));if(this.saveTransferStats_(t.stats),!this.pendingSegment_)return;if(t.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===_m)return;return this.pause(),e.code===Sm?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error"))}const i=this.pendingSegment_;this.saveBandwidthRelatedStats_(i.duration,t.stats),i.endOfAllRequests=t.endOfAllRequests,n.gopInfo&&(this.gopBuffer_=((e,t,n)=>{if(!t.length)return e;if(n)return t.slice();const i=t[0].pts;let r=0;for(;r<e.length&&!(e[r].pts>=i);r++);return e.slice(0,r).concat(t)})(this.gopBuffer_,n.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(i)}setTimeMapping_(e){const t=this.syncController_.mappingForTimeline(e);null!==t&&(this.timeMapping_=t)}updateMediaSecondsLoaded_(e){"number"===typeof e.start&&"number"===typeof e.end?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return null!==e&&("main"===this.loaderType_&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset())}trueSegmentStart_(e){let{currentStart:t,playlist:n,mediaIndex:i,firstVideoFrameTimeForData:r,currentVideoTimestampOffset:s,useVideoTimingInfo:a,videoTimingInfo:o,audioTimingInfo:l}=e;if("undefined"!==typeof t)return t;if(!a)return l.start;const u=n.segments[i-1];return 0!==i&&u&&"undefined"!==typeof u.start&&u.end===r+s?o.start:r}waitForAppendsToComplete_(e){const t=this.getCurrentMediaInfo_(e);if(!t)return this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),void this.trigger("error");const{hasAudio:n,hasVideo:i,isMuxed:r}=t,s="main"===this.loaderType_&&i,a=!this.audioDisabled_&&n&&!r;if(e.waitingOnAppends=0,!e.hasAppendedData_)return e.timingInfo||"number"!==typeof e.timestampOffset||(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),void this.checkAppendsDone_(e);s&&e.waitingOnAppends++,a&&e.waitingOnAppends++,s&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),a&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,0===e.waitingOnAppends&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const t=((e,t,n)=>"main"===e&&t&&n?n.hasAudio||n.hasVideo?t.hasVideo&&!n.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.hasVideo&&n.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null)(this.loaderType_,this.getCurrentMediaInfo_(),e);return!!t&&(this.error({message:t,playlistExclusionDuration:1/0}),this.trigger("error"),!0)}updateSourceBufferTimestampOffset_(e){if(null===e.timestampOffset||"number"!==typeof e.timingInfo.start||e.changedTimestampOffset||"main"!==this.loaderType_)return;let t=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),t=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),t=!0),t&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_(e){let{videoTimingInfo:t,audioTimingInfo:n,timingInfo:i}=e;return this.useDtsForTimestampOffset_?t&&"number"===typeof t.transmuxedDecodeStart?t.transmuxedDecodeStart:n&&"number"===typeof n.transmuxedDecodeStart?n.transmuxedDecodeStart:i.start:i.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const t=this.getMediaInfo_(),n="main"===this.loaderType_&&t&&t.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;n&&(e.timingInfo.end="number"===typeof n.end?n.end:n.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_){const e={segmentInfo:oy({type:this.loaderType_,segment:this.pendingSegment_})};this.trigger({type:"appendsdone",metadata:e})}if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());const e=this.pendingSegment_;e.part&&e.part.syncInfo?e.part.syncInfo.markAppended():e.segment.syncInfo&&e.segment.syncInfo.markAppended(),this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:"main"===this.loaderType_});const t=ay(e,this.sourceType_);if(t&&("warn"===t.severity?Bp.log.warn(t.message):this.logger_(t.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_))return void this.logger_(`Throwing away un-appended sync request ${ty(e)}`);this.logger_(`Appended ${ty(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const n=e.segment,i=e.part,r=n.end&&this.currentTime_()-n.end>3*e.playlist.targetDuration,s=i&&i.end&&this.currentTime_()-i.end>3*e.playlist.partTargetDuration;if(r||s)return this.logger_(`bad ${r?"segment":"part"} ${ty(e)}`),void this.resetEverything();null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<ey)return void this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record 0.016666666666666666`);const t=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,i=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(i-t)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const t=e.segment,n=t.start,i=t.end;if(!Zm(n)||!Zm(i))return;Jm(n,i,this.segmentMetadataTrack_);const r=lo().WebKitDataCue||lo().VTTCue,s={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,programDateTime:t.programDateTime,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:n,end:i},a=new r(n,i,JSON.stringify(s));a.value=s,this.segmentMetadataTrack_.addCue(a)}}function uy(){}const cy=function(e){return"string"!==typeof e?e:e.replace(/./,(e=>e.toUpperCase()))},dy=["video","audio"],hy=(e,t)=>{const n=t[`${e}Buffer`];return n&&n.updating||t.queuePending[e]},fy=(e,t)=>{if(0===t.queue.length)return;let n=0,i=t.queue[n];if("mediaSource"!==i.type){if("mediaSource"!==e&&t.ready()&&"closed"!==t.mediaSource.readyState&&!hy(e,t)){if(i.type!==e){if(n=((e,t)=>{for(let n=0;n<t.length;n++){const i=t[n];if("mediaSource"===i.type)return null;if(i.type===e)return n}return null})(e,t.queue),null===n)return;i=t.queue[n]}return t.queue.splice(n,1),t.queuePending[e]=i,i.action(e,t),i.doneFn?void 0:(t.queuePending[e]=null,void fy(e,t))}}else t.updating()||"closed"===t.mediaSource.readyState||(t.queue.shift(),i.action(t),i.doneFn&&i.doneFn(),fy("audio",t),fy("video",t))},py=(e,t)=>{const n=t[`${e}Buffer`],i=cy(e);n&&(n.removeEventListener("updateend",t[`on${i}UpdateEnd_`]),n.removeEventListener("error",t[`on${i}Error_`]),t.codecs[e]=null,t[`${e}Buffer`]=null)},gy=(e,t)=>e&&t&&-1!==Array.prototype.indexOf.call(e.sourceBuffers,t),my=(e,t,n)=>(i,r)=>{const s=r[`${i}Buffer`];if(gy(r.mediaSource,s)){r.logger_(`Appending segment ${t.mediaIndex}'s ${e.length} bytes to ${i}Buffer`);try{s.appendBuffer(e)}catch(a){r.logger_(`Error with code ${a.code} `+(22===a.code?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${t.mediaIndex} to ${i}Buffer`),r.queuePending[i]=null,n(a)}}},yy=(e,t)=>(n,i)=>{const r=i[`${n}Buffer`];if(gy(i.mediaSource,r)){i.logger_(`Removing ${e} to ${t} from ${n}Buffer`);try{r.remove(e,t)}catch(s){i.logger_(`Remove ${e} to ${t} from ${n}Buffer failed`)}}},vy=e=>(t,n)=>{const i=n[`${t}Buffer`];gy(n.mediaSource,i)&&(n.logger_(`Setting ${t}timestampOffset to ${e}`),i.timestampOffset=e)},by=e=>(t,n)=>{e()},Ty=e=>t=>{if("open"===t.mediaSource.readyState){t.logger_(`Calling mediaSource endOfStream(${e||""})`);try{t.mediaSource.endOfStream(e)}catch(n){Bp.log.warn("Failed to call media source endOfStream",n)}}},Sy=e=>t=>{t.logger_(`Setting mediaSource duration to ${e}`);try{t.mediaSource.duration=e}catch(n){Bp.log.warn("Failed to set media source duration",n)}},_y=()=>(e,t)=>{if("open"!==t.mediaSource.readyState)return;const n=t[`${e}Buffer`];if(gy(t.mediaSource,n)){t.logger_(`calling abort on ${e}Buffer`);try{n.abort()}catch(i){Bp.log.warn(`Failed to abort on ${e}Buffer`,i)}}},wy=(e,t)=>n=>{const i=cy(e),r=No(t);n.logger_(`Adding ${e}Buffer with codec ${t} to mediaSource`);const s=n.mediaSource.addSourceBuffer(r);s.addEventListener("updateend",n[`on${i}UpdateEnd_`]),s.addEventListener("error",n[`on${i}Error_`]),n.codecs[e]=t,n[`${e}Buffer`]=s},Ey=e=>t=>{const n=t[`${e}Buffer`];if(py(e,t),gy(t.mediaSource,n)){t.logger_(`Removing ${e}Buffer with codec ${t.codecs[e]} from mediaSource`);try{t.mediaSource.removeSourceBuffer(n)}catch(i){Bp.log.warn(`Failed to removeSourceBuffer ${e}Buffer`,i)}}},ky=e=>(t,n)=>{const i=n[`${t}Buffer`],r=No(e);if(!gy(n.mediaSource,i))return;const s=e.substring(0,e.indexOf(".")),a=n.codecs[t];if(a.substring(0,a.indexOf("."))===s)return;const o={codecsChangeInfo:{from:a,to:e}};n.trigger({type:"codecschange",metadata:o}),n.logger_(`changing ${t}Buffer codec from ${a} to ${e}`);try{i.changeType(r),n.codecs[t]=e}catch(l){o.errorType=Bp.Error.StreamingCodecsChangeError,o.error=l,l.metadata=o,n.error_=l,n.trigger("error"),Bp.log.warn(`Failed to changeType on ${t}Buffer`,l)}},xy=e=>{let{type:t,sourceUpdater:n,action:i,doneFn:r,name:s}=e;n.queue.push({type:t,action:i,doneFn:r,name:s}),fy(t,n)},Ay=(e,t)=>n=>{const i=function(e){if(0===e.length)return"Buffered Ranges are empty";let t="Buffered Ranges: \n";for(let n=0;n<e.length;n++){const i=e.start(n),r=e.end(n);t+=`${i} --\x3e ${r}. Duration (${r-i})\n`}return t}(t[`${e}Buffered`]());if(t.logger_(`received "updateend" event for ${e} Source Buffer: `,i),t.queuePending[e]){const n=t.queuePending[e].doneFn;t.queuePending[e]=null,n&&n(t[`${e}Error_`])}fy(e,t)};class Cy extends Bp.EventTarget{constructor(e){super(),this.mediaSource=e,this.sourceopenListener_=()=>fy("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=zp("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=Ay("video",this),this.onAudioUpdateEnd_=Ay("audio",this),this.onVideoError_=e=>{this.videoError_=e},this.onAudioError_=e=>{this.audioError_=e},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,t){xy({type:"mediaSource",sourceUpdater:this,action:wy(e,t),name:"addSourceBuffer"})}abort(e){xy({type:e,sourceUpdater:this,action:_y(e),name:"abort"})}removeSourceBuffer(e){this.canRemoveSourceBuffer()?xy({type:"mediaSource",sourceUpdater:this,action:Ey(e),name:"removeSourceBuffer"}):Bp.log.error("removeSourceBuffer is not supported!")}canRemoveSourceBuffer(){return!Bp.browser.IS_FIREFOX&&lo().MediaSource&&lo().MediaSource.prototype&&"function"===typeof lo().MediaSource.prototype.removeSourceBuffer}static canChangeType(){return lo().SourceBuffer&&lo().SourceBuffer.prototype&&"function"===typeof lo().SourceBuffer.prototype.changeType}canChangeType(){return this.constructor.canChangeType()}changeType(e,t){this.canChangeType()?xy({type:e,sourceUpdater:this,action:ky(t),name:"changeType"}):Bp.log.error("changeType is not supported!")}addOrChangeSourceBuffers(e){if(!e||"object"!==typeof e||0===Object.keys(e).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach((t=>{const n=e[t];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(t,n);this.canChangeType()&&this.changeType(t,n)}))}appendBuffer(e,t){const{segmentInfo:n,type:i,bytes:r}=e;if(this.processedAppend_=!0,"audio"===i&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([e,t]),void this.logger_(`delayed audio append of ${r.length} until video append`);if(xy({type:i,sourceUpdater:this,action:my(r,n||{mediaIndex:-1},t),doneFn:t,name:"appendBuffer"}),"video"===i){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const e=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${e.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,e.forEach((e=>{this.appendBuffer.apply(this,e)}))}}audioBuffered(){return gy(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:Wp()}videoBuffered(){return gy(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:Wp()}buffered(){const e=gy(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=gy(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!e?this.audioBuffered():e&&!t?this.videoBuffered():function(e,t){let n=null,i=null,r=0;const s=[],a=[];if(!e||!e.length||!t||!t.length)return Wp();let o=e.length;for(;o--;)s.push({time:e.start(o),type:"start"}),s.push({time:e.end(o),type:"end"});for(o=t.length;o--;)s.push({time:t.start(o),type:"start"}),s.push({time:t.end(o),type:"end"});for(s.sort((function(e,t){return e.time-t.time})),o=0;o<s.length;o++)"start"===s[o].type?(r++,2===r&&(n=s[o].time)):"end"===s[o].type&&(r--,1===r&&(i=s[o].time)),null!==n&&null!==i&&(a.push([n,i]),n=null,i=null);return Wp(a)}(this.audioBuffered(),this.videoBuffered())}setDuration(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uy;xy({type:"mediaSource",sourceUpdater:this,action:Sy(e),name:"duration",doneFn:t})}endOfStream(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uy;"string"!==typeof e&&(e=void 0),xy({type:"mediaSource",sourceUpdater:this,action:Ty(e),name:"endOfStream",doneFn:t})}removeAudio(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:uy;this.audioBuffered().length&&0!==this.audioBuffered().end(0)?xy({type:"audio",sourceUpdater:this,action:yy(e,t),doneFn:n,name:"remove"}):n()}removeVideo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:uy;this.videoBuffered().length&&0!==this.videoBuffered().end(0)?xy({type:"video",sourceUpdater:this,action:yy(e,t),doneFn:n,name:"remove"}):n()}updating(){return!(!hy("audio",this)&&!hy("video",this))}audioTimestampOffset(e){return"undefined"!==typeof e&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(xy({type:"audio",sourceUpdater:this,action:vy(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return"undefined"!==typeof e&&this.videoBuffer&&this.videoTimestampOffset_!==e&&(xy({type:"video",sourceUpdater:this,action:vy(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){this.audioBuffer&&xy({type:"audio",sourceUpdater:this,action:by(e),name:"callback"})}videoQueueCallback(e){this.videoBuffer&&xy({type:"video",sourceUpdater:this,action:by(e),name:"callback"})}dispose(){this.trigger("dispose"),dy.forEach((e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`]((()=>py(e,this)))})),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const Iy=e=>decodeURIComponent(escape(String.fromCharCode.apply(null,e))),Ly=new Uint8Array("\n\n".split("").map((e=>e.charCodeAt(0))));class Dy extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class Ry extends ly{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.mediaSource_=null,this.subtitlesTrack_=null,this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Wp();const e=this.subtitlesTrack_.cues;return Wp([[e[0].startTime,e[e.length-1].startTime]])}initSegmentForMap(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;const n=zg(e);let i=this.initSegments_[n];if(t&&!i&&e.bytes){const t=Ly.byteLength+e.bytes.byteLength,r=new Uint8Array(t);r.set(e.bytes),r.set(Ly,e.bytes.byteLength),this.initSegments_[n]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:r}}return i||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return"undefined"===typeof e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}remove(e,t){Jm(e,t,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(e){if(null===this.syncController_.timestampOffsetForTimeline(e.timeline)){const e=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};return this.syncController_.one("timestampoffset",e),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,t,n){if(!this.subtitlesTrack_)return void(this.state="READY");if(this.saveTransferStats_(t.stats),!this.pendingSegment_)return this.state="READY",void(this.mediaRequestsAborted+=1);if(e)return e.code===Sm&&this.handleTimeout_(),e.code===_m?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,void this.stopForError(e);const i=this.pendingSegment_,r=n.mp4VttCues&&n.mp4VttCues.length;r&&(i.mp4VttCues=n.mp4VttCues),this.saveBandwidthRelatedStats_(i.duration,t.stats),t.key&&this.segmentKey(t.key,!0),this.state="APPENDING",this.trigger("appending");const s=i.segment;if(s.map&&(s.map.bytes=t.map.bytes),i.bytes=t.bytes,"function"!==typeof lo().WebVTT&&"function"===typeof this.loadVttJs)return this.state="WAITING_ON_VTTJS",void this.loadVttJs().then((()=>this.segmentRequestFinished_(e,t,n)),(()=>this.stopForError({message:"Error loading vtt.js"})));s.requested=!0;try{this.parseVTTCues_(i)}catch(a){return void this.stopForError({message:a.message,metadata:{errorType:Bp.Error.StreamingVttParserError,error:a}})}if(r||this.updateTimeMapping_(i,this.syncController_.timelines[i.timeline],this.playlist_),i.cues.length?i.timingInfo={start:i.cues[0].startTime,end:i.cues[i.cues.length-1].endTime}:i.timingInfo={start:i.startOfSegment,end:i.startOfSegment+i.duration},i.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");i.byteLength=i.bytes.byteLength,this.mediaSecondsLoaded+=s.duration,i.cues.forEach((e=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new(lo().VTTCue)(e.startTime,e.endTime,e.text):e)})),function(e){const t=e.cues;if(!t)return;const n={};for(let i=t.length-1;i>=0;i--){const r=t[i],s=`${r.startTime}-${r.endTime}-${r.text}`;n[s]?e.removeCue(r):n[s]=r}}(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(e,t){const n=e&&"vtt"===e.type,i=t&&"text"===t.type;n&&i&&super.handleData_(e,t)}updateTimingInfoEnd_(){}parseMp4VttCues_(e){const t=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();e.mp4VttCues.forEach((n=>{const i=n.start+t,r=n.end+t,s=new(lo().VTTCue)(i,r,n.cueText);n.settings&&n.settings.split(" ").forEach((e=>{const t=e.split(":"),n=t[0],i=t[1];s[n]=isNaN(i)?i:Number(i)})),e.cues.push(s)}))}parseVTTCues_(e){let t,n=!1;if("function"!==typeof lo().WebVTT)throw new Dy;if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},e.mp4VttCues)return void this.parseMp4VttCues_(e);"function"===typeof lo().TextDecoder?t=new(lo().TextDecoder)("utf8"):(t=lo().WebVTT.StringDecoder(),n=!0);const i=new(lo().WebVTT.Parser)(lo(),lo().vttjs,t);if(i.oncue=e.cues.push.bind(e.cues),i.ontimestampmap=t=>{e.timestampmap=t},i.onparsingerror=e=>{Bp.log.warn("Error encountered when parsing cues: "+e.message)},e.segment.map){let t=e.segment.map.bytes;n&&(t=Iy(t)),i.parse(t)}let r=e.bytes;n&&(r=Iy(r)),i.parse(r),i.flush()}updateTimeMapping_(e,t,n){const i=e.segment;if(!t)return;if(!e.cues.length)return void(i.empty=!0);const{MPEGTS:r,LOCAL:s}=e.timestampmap,a=r/wu.ONE_SECOND_IN_TS-s+t.mapping;if(e.cues.forEach((e=>{const n=e.endTime-e.startTime,i=this.handleRollover_(e.startTime+a,t.time);e.startTime=Math.max(i,0),e.endTime=Math.max(i+n,0)})),!n.syncInfo){const t=e.cues[0].startTime,r=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(t,r-i.duration)}}}handleRollover_(e,t){if(null===t)return e;let n=e*wu.ONE_SECOND_IN_TS;const i=t*wu.ONE_SECOND_IN_TS;let r;for(r=i<n?-8589934592:8589934592;Math.abs(n-i)>4294967296;)n+=r;return n/wu.ONE_SECOND_IN_TS}}const My=function(e,t){const n=e.cues;for(let i=0;i<n.length;i++){const e=n[i];if(t>=e.adStartTime&&t<=e.adEndTime)return e}return null};class Py{constructor(e){let{start:t,end:n,segmentIndex:i,partIndex:r=null,appended:s=!1}=e;this.start_=t,this.end_=n,this.segmentIndex_=i,this.partIndex_=r,this.appended_=s}isInRange(e){return e>=this.start&&e<this.end}markAppended(){this.appended_=!0}resetAppendedStatus(){this.appended_=!1}get isAppended(){return this.appended_}get start(){return this.start_}get end(){return this.end_}get segmentIndex(){return this.segmentIndex_}get partIndex(){return this.partIndex_}}class Oy{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.segmentSyncInfo_=e,this.partsSyncInfo_=t}get segmentSyncInfo(){return this.segmentSyncInfo_}get partsSyncInfo(){return this.partsSyncInfo_}get hasPartsSyncInfo(){return this.partsSyncInfo_.length>0}resetAppendStatus(){this.segmentSyncInfo_.resetAppendedStatus(),this.partsSyncInfo_.forEach((e=>e.resetAppendedStatus()))}}class Ny{constructor(){this.storage_=new Map,this.diagnostics_="",this.isReliable_=!1,this.start_=-1/0,this.end_=1/0}get start(){return this.start_}get end(){return this.end_}get diagnostics(){return this.diagnostics_}get isReliable(){return this.isReliable_}resetAppendedStatus(){this.storage_.forEach((e=>e.resetAppendStatus()))}update(e,t){const{mediaSequence:n,segments:i}=e;if(this.isReliable_=this.isReliablePlaylist_(n,i),this.isReliable_)return this.updateStorage_(i,n,this.calculateBaseTime_(n,i,t))}getSyncInfoForTime(e){for(const{segmentSyncInfo:t,partsSyncInfo:n}of this.storage_.values())if(n.length){for(const i of n)if(i.isInRange(e))return i}else if(t.isInRange(e))return t;return null}getSyncInfoForMediaSequence(e){return this.storage_.get(e)}updateStorage_(e,t,n){const i=new Map;let r="\n",s=n,a=t;this.start_=s,e.forEach(((e,t)=>{const n=this.storage_.get(a),o=s,l=o+e.duration,u=Boolean(n&&n.segmentSyncInfo&&n.segmentSyncInfo.isAppended),c=new Py({start:o,end:l,appended:u,segmentIndex:t});e.syncInfo=c;let d=s;const h=(e.parts||[]).map(((e,i)=>{const s=d,o=d+e.duration,l=Boolean(n&&n.partsSyncInfo&&n.partsSyncInfo[i]&&n.partsSyncInfo[i].isAppended),u=new Py({start:s,end:o,appended:l,segmentIndex:t,partIndex:i});return d=o,r+=`Media Sequence: ${a}.${i} | Range: ${s} --\x3e ${o} | Appended: ${l}\n`,e.syncInfo=u,u}));i.set(a,new Oy(c,h)),r+=`${Km(e.resolvedUri)} | Media Sequence: ${a} | Range: ${o} --\x3e ${l} | Appended: ${u}\n`,a++,s=l})),this.end_=s,this.storage_=i,this.diagnostics_=r}calculateBaseTime_(e,t,n){if(!this.storage_.size)return 0;if(this.storage_.has(e))return this.storage_.get(e).segmentSyncInfo.start;const i=Math.min(...this.storage_.keys());if(e<i){const n=i-e;let r=this.storage_.get(i).segmentSyncInfo.start;for(let e=0;e<n;e++){r-=t[e].duration}return r}return n}isReliablePlaylist_(e,t){return void 0!==e&&null!==e&&Array.isArray(t)&&t.length}}class Uy extends Ny{constructor(e){super(),this.parent_=e}calculateBaseTime_(e,t,n){if(!this.storage_.size){const t=this.parent_.getSyncInfoForMediaSequence(e);return t?t.segmentSyncInfo.start:0}return super.calculateBaseTime_(e,t,n)}}const Fy=[{name:"VOD",run:(e,t,n,i,r)=>{if(n!==1/0){return{time:0,segmentIndex:0,partIndex:null}}return null}},{name:"MediaSequence",run:(e,t,n,i,r,s)=>{const a=e.getMediaSequenceSync(s);if(!a)return null;if(!a.isReliable)return null;const o=a.getSyncInfoForTime(r);return o?{time:o.start,partIndex:o.partIndex,segmentIndex:o.segmentIndex}:null}},{name:"ProgramDateTime",run:(e,t,n,i,r)=>{if(!Object.keys(e.timelineToDatetimeMappings).length)return null;let s=null,a=null;const o=sg(t);r=r||0;for(let l=0;l<o.length;l++){const n=o[t.endList||0===r?l:o.length-(l+1)],i=n.segment,u=e.timelineToDatetimeMappings[i.timeline];if(!u||!i.dateTimeObject)continue;let c=i.dateTimeObject.getTime()/1e3+u;if(i.parts&&"number"===typeof n.partIndex)for(let e=0;e<n.partIndex;e++)c+=i.parts[e].duration;const d=Math.abs(r-c);if(null!==a&&(0===d||a<d))break;a=d,s={time:c,segmentIndex:n.segmentIndex,partIndex:n.partIndex}}return s}},{name:"Segment",run:(e,t,n,i,r)=>{let s=null,a=null;r=r||0;const o=sg(t);for(let l=0;l<o.length;l++){const e=o[t.endList||0===r?l:o.length-(l+1)],n=e.segment,u=e.part&&e.part.start||n&&n.start;if(n.timeline===i&&"undefined"!==typeof u){const t=Math.abs(r-u);if(null!==a&&a<t)break;(!s||null===a||a>=t)&&(a=t,s={time:u,segmentIndex:e.segmentIndex,partIndex:e.partIndex})}}return s}},{name:"Discontinuity",run:(e,t,n,i,r)=>{let s=null;if(r=r||0,t.discontinuityStarts&&t.discontinuityStarts.length){let n=null;for(let i=0;i<t.discontinuityStarts.length;i++){const a=t.discontinuityStarts[i],o=t.discontinuitySequence+i+1,l=e.discontinuities[o];if(l){const e=Math.abs(r-l.time);if(null!==n&&n<e)break;(!s||null===n||n>=e)&&(n=e,s={time:l.time,segmentIndex:a,partIndex:null})}}}return s}},{name:"Playlist",run:(e,t,n,i,r)=>{if(t.syncInfo){return{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence,partIndex:null}}return null}}];class By extends Bp.EventTarget{constructor(){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={};const e=new Ny,t=new Uy(e),n=new Uy(e);this.mediaSequenceStorage_={main:e,audio:t,vtt:n},this.logger_=zp("SyncController")}getMediaSequenceSync(e){return this.mediaSequenceStorage_[e]||null}getSyncPoint(e,t,n,i,r){if(t!==1/0){return Fy.find((e=>{let{name:t}=e;return"VOD"===t})).run(this,e,t)}const s=this.runStrategies_(e,t,n,i,r);if(!s.length)return null;for(const a of s){const{syncPoint:t,strategy:n}=a,{segmentIndex:r,time:s}=t;if(r<0)continue;const o=s,l=o+e.segments[r].duration;if(this.logger_(`Strategy: ${n}. Current time: ${i}. selected segment: ${r}. Time: [${o} -> ${l}]}`),i>=o&&i<l)return this.logger_("Found sync point with exact match: ",t),t}return this.selectSyncPoint_(s,{key:"time",value:i})}getExpiredTime(e,t){if(!e||!e.segments)return null;const n=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!n.length)return null;const i=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return i.segmentIndex>0&&(i.time*=-1),Math.abs(i.time+dg({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:i.segmentIndex,endIndex:0}))}runStrategies_(e,t,n,i,r){const s=[];for(let a=0;a<Fy.length;a++){const o=Fy[a],l=o.run(this,e,t,n,i,r);l&&(l.strategy=o.name,s.push({strategy:o.name,syncPoint:l}))}return s}selectSyncPoint_(e,t){let n=e[0].syncPoint,i=Math.abs(e[0].syncPoint[t.key]-t.value),r=e[0].strategy;for(let s=1;s<e.length;s++){const a=Math.abs(e[s].syncPoint[t.key]-t.value);a<i&&(i=a,n=e[s].syncPoint,r=e[s].strategy)}return this.logger_(`syncPoint for [${t.key}: ${t.value}] chosen with strategy [${r}]: [time:${n.time}, segmentIndex:${n.segmentIndex}`+("number"===typeof n.partIndex?`,partIndex:${n.partIndex}`:"")+"]"),n}saveExpiredSegmentInfo(e,t){const n=t.mediaSequence-e.mediaSequence;if(n>86400)Bp.log.warn(`Not saving expired segment info. Media sequence gap ${n} is too large.`);else for(let i=n-1;i>=0;i--){const n=e.segments[i];if(n&&"undefined"!==typeof n.start){t.syncInfo={mediaSequence:e.mediaSequence+i,time:n.start},this.logger_(`playlist refresh sync: [time:${t.syncInfo.time}, mediaSequence: ${t.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const t=e.segments[0],n=t.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[t.timeline]=-n}}saveSegmentTimingInfo(e){let{segmentInfo:t,shouldSaveTimelineMapping:n}=e;const i=this.calculateSegmentTimeMapping_(t,t.timingInfo,n),r=t.segment;i&&(this.saveDiscontinuitySyncInfo_(t),t.playlist.syncInfo||(t.playlist.syncInfo={mediaSequence:t.playlist.mediaSequence+t.mediaIndex,time:r.start}));const s=r.dateTimeObject;r.discontinuity&&n&&s&&(this.timelineToDatetimeMappings[r.timeline]=-s.getTime()/1e3)}timestampOffsetForTimeline(e){return"undefined"===typeof this.timelines[e]?null:this.timelines[e].time}mappingForTimeline(e){return"undefined"===typeof this.timelines[e]?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,t,n){const i=e.segment,r=e.part;let s,a,o=this.timelines[e.timeline];if("number"===typeof e.timestampOffset)o={time:e.startOfSegment,mapping:e.startOfSegment-t.start},n&&(this.timelines[e.timeline]=o,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${o.time}] [mapping: ${o.mapping}]`)),s=e.startOfSegment,a=t.end+o.mapping;else{if(!o)return!1;s=t.start+o.mapping,a=t.end+o.mapping}return r&&(r.start=s,r.end=a),(!i.start||s<i.start)&&(i.start=s),i.end=a,!0}saveDiscontinuitySyncInfo_(e){const t=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(let i=0;i<t.discontinuityStarts.length;i++){const r=t.discontinuityStarts[i],s=t.discontinuitySequence+i+1,a=r-e.mediaIndex,o=Math.abs(a);if(!this.discontinuities[s]||this.discontinuities[s].accuracy>o){let i;i=a<0?n.start-dg({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex,endIndex:r}):n.end+dg({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex+1,endIndex:r}),this.discontinuities[s]={time:i,accuracy:o}}}}dispose(){this.trigger("dispose"),this.off()}}class jy extends Bp.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange(e){let{type:t,from:n,to:i}=e;return"number"===typeof n&&"number"===typeof i&&(this.pendingTimelineChanges_[t]={type:t,from:n,to:i},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[t]}lastTimelineChange(e){let{type:t,from:n,to:i}=e;if("number"===typeof n&&"number"===typeof i){this.lastTimelineChanges_[t]={type:t,from:n,to:i},delete this.pendingTimelineChanges_[t];const e={timelineChangeInfo:{from:n,to:i}};this.trigger({type:"timelinechange",metadata:e})}return this.lastTimelineChanges_[t]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}var $y=lm(um(cm((function(){var e=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(n,1),n>-1},t.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),s=t.length,a=0;a<s;++a)t[a].apply(this,r)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}();let t=null;class i{constructor(e){let n,i,r;t||(t=function(){const e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],i=t[4],r=n[4];let s,a,o;const l=[],u=[];let c,d,h,f,p,g;for(s=0;s<256;s++)u[(l[s]=s<<1^283*(s>>7))^s]=s;for(a=o=0;!i[a];a^=c||1,o=u[o]||1)for(f=o^o<<1^o<<2^o<<3^o<<4,f=f>>8^255&f^99,i[a]=f,r[f]=a,h=l[d=l[c=l[a]]],g=16843009*h^65537*d^257*c^16843008*a,p=257*l[f]^16843008*f,s=0;s<4;s++)t[s][a]=p=p<<24^p>>>8,n[s][f]=g=g<<24^g>>>8;for(s=0;s<5;s++)t[s]=t[s].slice(0),n[s]=n[s].slice(0);return e}()),this._tables=[[t[0][0].slice(),t[0][1].slice(),t[0][2].slice(),t[0][3].slice(),t[0][4].slice()],[t[1][0].slice(),t[1][1].slice(),t[1][2].slice(),t[1][3].slice(),t[1][4].slice()]];const s=this._tables[0][4],a=this._tables[1],o=e.length;let l=1;if(4!==o&&6!==o&&8!==o)throw new Error("Invalid aes key size");const u=e.slice(0),c=[];for(this._key=[u,c],n=o;n<4*o+28;n++)r=u[n-1],(n%o===0||8===o&&n%o===4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[255&r],n%o===0&&(r=r<<8^r>>>24^l<<24,l=l<<1^283*(l>>7))),u[n]=u[n-o]^r;for(i=0;n;i++,n--)r=u[3&i?n:n-4],c[i]=n<=4||i<4?r:a[0][s[r>>>24]]^a[1][s[r>>16&255]]^a[2][s[r>>8&255]]^a[3][s[255&r]]}decrypt(e,t,n,i,r,s){const a=this._key[1];let o,l,u,c=e^a[0],d=i^a[1],h=n^a[2],f=t^a[3];const p=a.length/4-2;let g,m=4;const y=this._tables[1],v=y[0],b=y[1],T=y[2],S=y[3],_=y[4];for(g=0;g<p;g++)o=v[c>>>24]^b[d>>16&255]^T[h>>8&255]^S[255&f]^a[m],l=v[d>>>24]^b[h>>16&255]^T[f>>8&255]^S[255&c]^a[m+1],u=v[h>>>24]^b[f>>16&255]^T[c>>8&255]^S[255&d]^a[m+2],f=v[f>>>24]^b[c>>16&255]^T[d>>8&255]^S[255&h]^a[m+3],m+=4,c=o,d=l,h=u;for(g=0;g<4;g++)r[(3&-g)+s]=_[c>>>24]<<24^_[d>>16&255]<<16^_[h>>8&255]<<8^_[255&f]^a[m++],o=c,c=d,d=h,h=f,f=o}}class r extends e{constructor(){super(e),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const s=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24};class a{constructor(e,t,n,i){const o=a.STEP,l=new Int32Array(e.buffer),u=new Uint8Array(e.byteLength);let c=0;for(this.asyncStream_=new r,this.asyncStream_.push(this.decryptChunk_(l.subarray(c,c+o),t,n,u)),c=o;c<l.length;c+=o)n=new Uint32Array([s(l[c-4]),s(l[c-3]),s(l[c-2]),s(l[c-1])]),this.asyncStream_.push(this.decryptChunk_(l.subarray(c,c+o),t,n,u));this.asyncStream_.push((function(){var e;i(null,(e=u).subarray(0,e.byteLength-e[e.byteLength-1]))}))}static get STEP(){return 32e3}decryptChunk_(e,t,n,r){return function(){const a=function(e,t,n){const r=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),a=new i(Array.prototype.slice.call(t)),o=new Uint8Array(e.byteLength),l=new Int32Array(o.buffer);let u,c,d,h,f,p,g,m,y;for(u=n[0],c=n[1],d=n[2],h=n[3],y=0;y<r.length;y+=4)f=s(r[y]),p=s(r[y+1]),g=s(r[y+2]),m=s(r[y+3]),a.decrypt(f,p,g,m,l,y),l[y]=s(l[y]^u),l[y+1]=s(l[y+1]^c),l[y+2]=s(l[y+2]^d),l[y+3]=s(l[y+3]^h),u=f,c=p,d=g,h=m;return o}(e,t,n);r.set(a,e.byteOffset)}}}var o,l="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{};o="undefined"!==typeof window?window:"undefined"!==typeof l?l:"undefined"!==typeof self?self:{};var u=o.BigInt||Number;u("0x1"),u("0x100"),u("0x10000"),u("0x1000000"),u("0x100000000"),u("0x10000000000"),u("0x1000000000000"),u("0x100000000000000"),u("0x10000000000000000"),function(){var e=new Uint16Array([65484]),t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);255===t[0]||t[0]}();const c=function(e){const t={};return Object.keys(e).forEach((n=>{const i=e[n];var r;r=i,("function"===ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer)?t[n]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:t[n]=i})),t};self.onmessage=function(e){const t=e.data,n=new Uint8Array(t.encrypted.bytes,t.encrypted.byteOffset,t.encrypted.byteLength),i=new Uint32Array(t.key.bytes,t.key.byteOffset,t.key.byteLength/4),r=new Uint32Array(t.iv.bytes,t.iv.byteOffset,t.iv.byteLength/4);new a(n,i,r,(function(e,n){self.postMessage(c({source:t.source,decrypted:n}),[n.buffer])}))}}))));const Vy=e=>{let t=e.default?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(t="main-desc"),t},Hy=(e,t)=>{e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},qy=(e,t)=>{t.activePlaylistLoader=e,e.load()},Gy={AUDIO:(e,t)=>()=>{const{mediaTypes:{[e]:n},excludePlaylist:i}=t,r=n.activeTrack(),s=n.activeGroup(),a=(s.filter((e=>e.default))[0]||s[0]).id,o=n.tracks[a];if(r!==o){Bp.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const e in n.tracks)n.tracks[e].enabled=n.tracks[e]===o;n.onTrackChanged()}else i({error:{message:"Problem encountered loading the default audio track."}})},SUBTITLES:(e,t)=>()=>{const{mediaTypes:{[e]:n}}=t;Bp.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const i=n.activeTrack();i&&(i.mode="disabled"),n.onTrackChanged()}},zy={AUDIO:(e,t,n)=>{if(!t)return;const{tech:i,requestOptions:r,segmentLoaders:{[e]:s}}=n;t.on("loadedmetadata",(()=>{const e=t.media();s.playlist(e,r),(!i.paused()||e.endList&&"none"!==i.preload())&&s.load()})),t.on("loadedplaylist",(()=>{s.playlist(t.media(),r),i.paused()||s.load()})),t.on("error",Gy[e](e,n))},SUBTITLES:(e,t,n)=>{const{tech:i,requestOptions:r,segmentLoaders:{[e]:s},mediaTypes:{[e]:a}}=n;t.on("loadedmetadata",(()=>{const e=t.media();s.playlist(e,r),s.track(a.activeTrack()),(!i.paused()||e.endList&&"none"!==i.preload())&&s.load()})),t.on("loadedplaylist",(()=>{s.playlist(t.media(),r),i.paused()||s.load()})),t.on("error",Gy[e](e,n))}},Ky={AUDIO:(e,t)=>{const{vhs:n,sourceType:i,segmentLoaders:{[e]:r},requestOptions:s,main:{mediaGroups:a},mediaTypes:{[e]:{groups:o,tracks:l,logger_:u}},mainPlaylistLoader:c}=t,d=Tg(c.main);a[e]&&0!==Object.keys(a[e]).length||(a[e]={main:{default:{default:!0}}},d&&(a[e].main.default.playlists=c.main.playlists));for(const h in a[e]){o[h]||(o[h]=[]);for(const r in a[e][h]){let f,p=a[e][h][r];if(d?(u(`AUDIO group '${h}' label '${r}' is a main playlist`),p.isMainPlaylist=!0,f=null):f="vhs-json"===i&&p.playlists?new Fg(p.playlists[0],n,s):p.resolvedUri?new Fg(p.resolvedUri,n,s):p.playlists&&"dash"===i?new sm(p.playlists[0],n,s,c):null,p=Kp({id:r,playlistLoader:f},p),zy[e](e,p.playlistLoader,t),o[h].push(p),"undefined"===typeof l[r]){const e=new Bp.AudioTrack({id:r,kind:Vy(p),enabled:!1,language:p.language,default:p.default,label:r});l[r]=e}}}r.on("error",Gy[e](e,t))},SUBTITLES:(e,t)=>{const{tech:n,vhs:i,sourceType:r,segmentLoaders:{[e]:s},requestOptions:a,main:{mediaGroups:o},mediaTypes:{[e]:{groups:l,tracks:u}},mainPlaylistLoader:c}=t;for(const d in o[e]){l[d]||(l[d]=[]);for(const s in o[e][d]){if(!i.options_.useForcedSubtitles&&o[e][d][s].forced)continue;let h,f=o[e][d][s];if("hls"===r)h=new Fg(f.resolvedUri,i,a);else if("dash"===r){if(!f.playlists.filter((e=>e.excludeUntil!==1/0)).length)return;h=new sm(f.playlists[0],i,a,c)}else"vhs-json"===r&&(h=new Fg(f.playlists?f.playlists[0]:f.resolvedUri,i,a));if(f=Kp({id:s,playlistLoader:h},f),zy[e](e,f.playlistLoader,t),l[d].push(f),"undefined"===typeof u[s]){const e=n.addRemoteTextTrack({id:s,kind:"subtitles",default:f.default&&f.autoselect,language:f.language,label:s},!1).track;u[s]=e}}}s.on("error",Gy[e](e,t))},"CLOSED-CAPTIONS":(e,t)=>{const{tech:n,main:{mediaGroups:i},mediaTypes:{[e]:{groups:r,tracks:s}}}=t;for(const a in i[e]){r[a]||(r[a]=[]);for(const t in i[e][a]){const o=i[e][a][t];if(!/^(?:CC|SERVICE)/.test(o.instreamId))continue;const l=n.options_.vhs&&n.options_.vhs.captionServices||{};let u={label:t,language:o.language,instreamId:o.instreamId,default:o.default&&o.autoselect};if(l[u.instreamId]&&(u=Kp(u,l[u.instreamId])),void 0===u.default&&delete u.default,r[a].push(Kp({id:t},o)),"undefined"===typeof s[t]){const e=n.addRemoteTextTrack({id:u.instreamId,kind:"captions",default:u.default,language:u.language,label:u.label},!1).track;s[t]=e}}}}},Wy=(e,t)=>{for(let n=0;n<e.length;n++){if(vg(t,e[n]))return!0;if(e[n].playlists&&Wy(e[n].playlists,t))return!0}return!1},Xy={AUDIO:(e,t)=>()=>{const{mediaTypes:{[e]:{tracks:n}}}=t;for(const e in n)if(n[e].enabled)return n[e];return null},SUBTITLES:(e,t)=>()=>{const{mediaTypes:{[e]:{tracks:n}}}=t;for(const e in n)if("showing"===n[e].mode||"hidden"===n[e].mode)return n[e];return null}},Yy=e=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((t=>{Ky[t](t,e)}));const{mediaTypes:t,mainPlaylistLoader:n,tech:i,vhs:r,segmentLoaders:{AUDIO:s,main:a}}=e;["AUDIO","SUBTITLES"].forEach((n=>{t[n].activeGroup=((e,t)=>n=>{const{mainPlaylistLoader:i,mediaTypes:{[e]:{groups:r}}}=t,s=i.media();if(!s)return null;let a=null;s.attributes[e]&&(a=r[s.attributes[e]]);const o=Object.keys(r);if(!a)if("AUDIO"===e&&o.length>1&&Tg(t.main))for(let e=0;e<o.length;e++){const t=r[o[e]];if(Wy(t,s)){a=t;break}}else r.main?a=r.main:1===o.length&&(a=r[o[0]]);return"undefined"===typeof n?a:null!==n&&a&&a.filter((e=>e.id===n.id))[0]||null})(n,e),t[n].activeTrack=Xy[n](n,e),t[n].onGroupChanged=((e,t)=>()=>{const{segmentLoaders:{[e]:n,main:i},mediaTypes:{[e]:r}}=t,s=r.activeTrack(),a=r.getActiveGroup(),o=r.activePlaylistLoader,l=r.lastGroup_;a&&l&&a.id===l.id||(r.lastGroup_=a,r.lastTrack_=s,Hy(n,r),a&&!a.isMainPlaylist&&(a.playlistLoader?(n.resyncLoader(),qy(a.playlistLoader,r)):o&&i.resetEverything()))})(n,e),t[n].onGroupChanging=((e,t)=>()=>{const{segmentLoaders:{[e]:n},mediaTypes:{[e]:i}}=t;i.lastGroup_=null,n.abort(),n.pause()})(n,e),t[n].onTrackChanged=((e,t)=>()=>{const{mainPlaylistLoader:n,segmentLoaders:{[e]:i,main:r},mediaTypes:{[e]:s}}=t,a=s.activeTrack(),o=s.getActiveGroup(),l=s.activePlaylistLoader,u=s.lastTrack_;if((!u||!a||u.id!==a.id)&&(s.lastGroup_=o,s.lastTrack_=a,Hy(i,s),o)){if(o.isMainPlaylist){if(!a||!u||a.id===u.id)return;const e=t.vhs.playlistController_,i=e.selectPlaylist();if(e.media()===i)return;return s.logger_(`track change. Switching main audio from ${u.id} to ${a.id}`),n.pause(),r.resetEverything(),void e.fastQualityChange_(i)}if("AUDIO"===e){if(!o.playlistLoader)return r.setAudio(!0),void r.resetEverything();i.setAudio(!0),r.setAudio(!1)}l!==o.playlistLoader?(i.track&&i.track(a),i.resetEverything(),qy(o.playlistLoader,s)):qy(o.playlistLoader,s)}})(n,e),t[n].getActiveGroup=((e,t)=>{let{mediaTypes:n}=t;return()=>{const t=n[e].activeTrack();return t?n[e].activeGroup(t):null}})(n,e)}));const o=t.AUDIO.activeGroup();if(o){const e=(o.filter((e=>e.default))[0]||o[0]).id;t.AUDIO.tracks[e].enabled=!0,t.AUDIO.onGroupChanged(),t.AUDIO.onTrackChanged();t.AUDIO.getActiveGroup().playlistLoader?(a.setAudio(!1),s.setAudio(!0)):a.setAudio(!0)}n.on("mediachange",(()=>{["AUDIO","SUBTITLES"].forEach((e=>t[e].onGroupChanged()))})),n.on("mediachanging",(()=>{["AUDIO","SUBTITLES"].forEach((e=>t[e].onGroupChanging()))}));const l=()=>{t.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"vhs-audio-change"})};i.audioTracks().addEventListener("change",l),i.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),r.on("dispose",(()=>{i.audioTracks().removeEventListener("change",l),i.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)})),i.clearTracks("audio");for(const u in t.AUDIO.tracks)i.audioTracks().addTrack(t.AUDIO.tracks[u])};class Qy{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(e){1===e&&(this.version_=e)}set ttl(e){this.ttl_=e||300}set reloadUri(e){e&&(this.reloadUri_=qp(this.reloadUri_,e))}set priority(e){e&&e.length&&(this.priority_=e)}set pathwayClones(e){e&&e.length&&(this.pathwayClones_=new Map(e.map((e=>[e.ID,e]))))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class Jy extends Bp.EventTarget{constructor(e,t){super(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new Qy,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=zp("Content Steering"),this.xhr_=e,this.getBandwidth_=t}assignTagProperties(e,t){this.manifestType_=t.serverUri?"HLS":"DASH";const n=t.serverUri||t.serverURL;if(!n)return this.logger_(`steering manifest URL is ${n}, cannot request steering manifest.`),void this.trigger("error");n.startsWith("data:")?this.decodeDataUriManifest_(n.substring(n.indexOf(",")+1)):(this.steeringManifest.reloadUri=qp(e,n),this.defaultPathway=t.pathwayId||t.defaultServiceLocation,this.queryBeforeStart=t.queryBeforeStart,this.proxyServerUrl_=t.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering"))}requestSteeringManifest(e){const t=this.steeringManifest.reloadUri;if(!t)return;const n=e?t:this.getRequestURI(t);if(!n)return this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),void this.dispose();const i={contentSteeringInfo:{uri:n}};this.trigger({type:"contentsteeringloadstart",metadata:i}),this.request_=this.xhr_({uri:n,requestType:"content-steering-manifest"},((e,t)=>{if(e){if(410===t.status)return this.logger_(`manifest request 410 ${e}.`),this.logger_(`There will be no more content steering requests to ${n} this session.`),void this.excludedSteeringManifestURLs.add(n);if(429===t.status){const n=t.responseHeaders["retry-after"];return this.logger_(`manifest request 429 ${e}.`),this.logger_(`content steering will retry in ${n} seconds.`),void this.startTTLTimeout_(parseInt(n,10))}return this.logger_(`manifest failed to load ${e}.`),void this.startTTLTimeout_()}let r;this.trigger({type:"contentsteeringloadcomplete",metadata:i});try{r=JSON.parse(this.request_.responseText)}catch(a){const e={errorType:Bp.Error.StreamingContentSteeringParserError,error:a};this.trigger({type:"error",metadata:e})}this.assignSteeringProperties_(r);const s={contentSteeringInfo:i.contentSteeringInfo,contentSteeringManifest:{version:this.steeringManifest.version,reloadUri:this.steeringManifest.reloadUri,priority:this.steeringManifest.priority}};this.trigger({type:"contentsteeringparsed",metadata:s}),this.startTTLTimeout_()}))}setProxyServerUrl_(e){const t=new(lo().URL)(e),n=new(lo().URL)(this.proxyServerUrl_);return n.searchParams.set("url",encodeURI(t.toString())),this.setSteeringParams_(n.toString())}decodeDataUriManifest_(e){const t=JSON.parse(lo().atob(e));this.assignSteeringProperties_(t)}setSteeringParams_(e){const t=new(lo().URL)(e),n=this.getPathway(),i=this.getBandwidth_();if(n){const e=`_${this.manifestType_}_pathway`;t.searchParams.set(e,n)}if(i){const e=`_${this.manifestType_}_throughput`;t.searchParams.set(e,i)}return t.toString()}assignSteeringProperties_(e){if(this.steeringManifest.version=e.VERSION,!this.steeringManifest.version)return this.logger_(`manifest version is ${e.VERSION}, which is not supported.`),void this.trigger("error");this.steeringManifest.ttl=e.TTL,this.steeringManifest.reloadUri=e["RELOAD-URI"],this.steeringManifest.priority=e["PATHWAY-PRIORITY"]||e["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=e["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const t=(e=>{for(const t of e)if(this.availablePathways_.has(t))return t;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==t&&(this.currentPathway=t,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(e){if(!e)return null;const t=e=>this.excludedSteeringManifestURLs.has(e);if(this.proxyServerUrl_){const n=this.setProxyServerUrl_(e);if(!t(n))return n}const n=this.setSteeringParams_(e);return t(n)?null:n}startTTLTimeout_(){const e=1e3*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.steeringManifest.ttl);this.ttlTimeout_=lo().setTimeout((()=>{this.requestSteeringManifest()}),e)}clearTTLTimeout_(){lo().clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new Qy}addAvailablePathway(e){e&&this.availablePathways_.add(e)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(e){return this.availablePathways_.delete(e)}didDASHTagChange(e,t){return!t&&this.steeringManifest.reloadUri||t&&(qp(e,t.serverURL)!==this.steeringManifest.reloadUri||t.defaultServiceLocation!==this.defaultPathway||t.queryBeforeStart!==this.queryBeforeStart||t.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}let Zy;const ev=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],tv=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]};class nv extends Bp.EventTarget{constructor(e){super(),this.fastQualityChange_=((e,t)=>{let n=null;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];clearTimeout(n),n=setTimeout((()=>{e.apply(null,r)}),t)}})(this.fastQualityChange_.bind(this),100);const{src:t,withCredentials:n,tech:i,bandwidth:r,externVhs:s,useCueTags:a,playlistExclusionDuration:o,enableLowInitialPlaylist:l,sourceType:u,cacheEncryptionKeys:c,bufferBasedABR:d,leastPixelDiffSelector:h,captionServices:f,experimentalUseMMS:p}=e;if(!t)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:g}=e;null!==g&&"undefined"!==typeof g||(g=1/0),Zy=s,this.bufferBasedABR=Boolean(d),this.leastPixelDiffSelector=Boolean(h),this.withCredentials=n,this.tech_=i,this.vhs_=i.vhs,this.player_=e.player_,this.sourceType_=u,this.useCueTags_=a,this.playlistExclusionDuration=o,this.maxPlaylistRetries=g,this.enableLowInitialPlaylist=l,this.usingManagedMediaSource_=!1,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:n,maxPlaylistRetries:g,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=(()=>{const e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((t=>{e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:uy,activeTrack:uy,getActiveGroup:uy,onGroupChanged:uy,onTrackChanged:uy,lastTrack_:null,logger_:zp(`MediaGroups[${t}]`)}})),e})(),p&&lo().ManagedMediaSource?(this.tech_.el_.disableRemotePlayback=!0,this.mediaSource=new(lo().ManagedMediaSource),this.usingManagedMediaSource_=!0,Bp.log("Using ManagedMediaSource")):lo().MediaSource&&(this.mediaSource=new(lo().MediaSource)),this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.load=this.load.bind(this),this.pause=this.pause.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.mediaSource.addEventListener("startstreaming",this.load),this.mediaSource.addEventListener("endstreaming",this.pause),this.seekable_=Wp(),this.hasPlayed_=!1,this.syncController_=new By(e),this.segmentMetadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new $y,this.sourceUpdater_=new Cy(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new jy,this.keyStatusMap_=new Map;const m={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:f,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:r,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:c,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_="dash"===this.sourceType_?new sm(t,this.vhs_,Kp(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new Fg(t,this.vhs_,Kp(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new ly(Kp(m,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new ly(Kp(m,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new Ry(Kp(m,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise(((e,t)=>{function n(){i.off("vttjserror",r),e()}function r(){i.off("vttjsloaded",n),t()}i.one("vttjsloaded",n),i.one("vttjserror",r),i.addWebVttScript_()}))}),e);this.contentSteeringController_=new Jy(this.vhs_.xhr,(()=>this.mainSegmentLoader_.bandwidth)),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",(()=>this.startABRTimer_())),this.tech_.on("pause",(()=>this.stopABRTimer_())),this.tech_.on("play",(()=>this.startABRTimer_()))),ev.forEach((e=>{this[e+"_"]=tv.bind(this,e)})),this.logger_=zp("pc"),this.triggeredFmp4Usage=!1,"none"===this.tech_.preload()?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const y="none"===this.tech_.preload()?"play":"loadstart";this.tech_.one(y,(()=>{const e=Date.now();this.tech_.one("loadeddata",(()=>{this.timeToLoadedData__=Date.now()-e,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends}))}))}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),t=this.audioAppendsToLoadedData_();return-1===e||-1===t?-1:e+t}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"abr";const t=this.selectPlaylist();t&&this.shouldSwitchToMedia_(t)&&this.switchMedia_(t,e)}switchMedia_(e,t,n){const i=this.media(),r=i&&(i.id||i.uri),s=e&&(e.id||e.uri);if(r&&r!==s){this.logger_(`switch media ${r} -> ${s} from ${t}`);const n={renditionInfo:{id:s,bandwidth:e.attributes.BANDWIDTH,resolution:e.attributes.RESOLUTION,codecs:e.attributes.CODECS},cause:t};this.trigger({type:"renditionselected",metadata:n}),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${t}`})}this.mainPlaylistLoader_.media(e,n)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((e=>{const t=this.mediaTypes_[e],n=t?t.activeGroup():null,i=this.contentSteeringController_.getPathway();if(n&&i){const t=(n.length?n[0].playlists:n.playlists).filter((e=>e.attributes.serviceLocation===i));t.length&&this.mediaTypes_[e].activePlaylistLoader.media(t[0])}}))}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=lo().setInterval((()=>this.checkABR_()),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(lo().clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),t=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return t;const n=e.mediaGroups.AUDIO,i=Object.keys(n);let r;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)r=this.mediaTypes_.AUDIO.activeTrack();else{const e=n.main||i.length&&n[i[0]];for(const t in e)if(e[t].default){r={label:t};break}}if(!r)return t;const s=[];for(const a in n)if(n[a][r.label]){const t=n[a][r.label];if(t.playlists&&t.playlists.length)s.push.apply(s,t.playlists);else if(t.uri)s.push(t);else if(e.playlists.length)for(let n=0;n<e.playlists.length;n++){const t=e.playlists[n];t.attributes&&t.attributes.AUDIO&&t.attributes.AUDIO===a&&s.push(t)}}return s.length?s:t}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",(()=>{const e=this.mainPlaylistLoader_.media(),t=1.5*e.targetDuration*1e3;yg(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=t,e.endList&&"none"!==this.tech_.preload()&&(this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load()),Yy({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),e),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(()=>{this.trigger("selectedinitialmedia")}))})),this.mainPlaylistLoader_.on("loadedplaylist",(()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let e=this.mainPlaylistLoader_.media();if(!e){let t;if(this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_(),this.enableLowInitialPlaylist&&(t=this.selectInitialPlaylist()),t||(t=this.selectPlaylist()),!t||!this.shouldSwitchToMedia_(t))return;this.initialMedia_=t,this.switchMedia_(this.initialMedia_,"initial");if(!("vhs-json"===this.sourceType_&&this.initialMedia_.segments))return;e=this.initialMedia_}this.handleUpdatedMediaPlaylist(e)})),this.mainPlaylistLoader_.on("error",(()=>{const e=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:e.playlist,error:e})})),this.mainPlaylistLoader_.on("mediachanging",(()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()})),this.mainPlaylistLoader_.on("mediachange",(()=>{const e=this.mainPlaylistLoader_.media(),t=1.5*e.targetDuration*1e3;yg(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=t,"dash"===this.sourceType_&&this.mainPlaylistLoader_.isPaused&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})})),this.mainPlaylistLoader_.on("playlistunchanged",(()=>{const e=this.mainPlaylistLoader_.media();if("playlist-unchanged"===e.lastExcludeReason_)return;this.stuckAtPlaylistEnd_(e)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))})),this.mainPlaylistLoader_.on("renditiondisabled",(()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})})),this.mainPlaylistLoader_.on("renditionenabled",(()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}));["manifestrequeststart","manifestrequestcomplete","manifestparsestart","manifestparsecomplete","playlistrequeststart","playlistrequestcomplete","playlistparsestart","playlistparsecomplete","renditiondisabled","renditionenabled"].forEach((e=>{this.mainPlaylistLoader_.on(e,(e=>{this.player_.trigger(mo({},e))}))}))}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,t){const n=e.mediaGroups||{};let i=!0;const r=Object.keys(n.AUDIO);for(const s in n.AUDIO)for(const e in n.AUDIO[s]){n.AUDIO[s][e].uri||(i=!1)}i&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),Zy.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),r.length&&Object.keys(n.AUDIO[r[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const t=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,n=this.tech_.currentTime(),i=this.bufferLowWaterLine(),r=this.bufferHighWaterLine();return function(e){let{currentPlaylist:t,buffered:n,currentTime:i,nextPlaylist:r,bufferLowWaterLine:s,bufferHighWaterLine:a,duration:o,bufferBasedABR:l,log:u}=e;if(!r)return Bp.log.warn("We received no playlist to switch to. Please check your stream."),!1;const c=`allowing switch ${t&&t.id||"null"} -> ${r.id}`;if(!t)return u(`${c} as current playlist is not set`),!0;if(r.id===t.id)return!1;const d=Boolean(Jp(n,i).length);if(!t.endList)return d||"number"!==typeof t.partTargetDuration?(u(`${c} as current playlist is live`),!0):(u(`not ${c} as current playlist is live llhls, but currentTime isn't in buffered.`),!1);const h=ig(n,i),f=l?am.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:am.MAX_BUFFER_LOW_WATER_LINE;if(o<f)return u(`${c} as duration < max low water line (${o} < ${f})`),!0;const p=r.attributes.BANDWIDTH,g=t.attributes.BANDWIDTH;if(p<g&&(!l||h<a)){let e=`${c} as next bandwidth < current bandwidth (${p} < ${g})`;return l&&(e+=` and forwardBuffer < bufferHighWaterLine (${h} < ${a})`),u(e),!0}if((!l||p>g)&&h>=s){let e=`${c} as forwardBuffer >= bufferLowWaterLine (${h} >= ${s})`;return l&&(e+=` and next bandwidth > current bandwidth (${p} > ${g})`),u(e),!0}return u(`not ${c} as no switching criteria met`),!1}({buffered:this.tech_.buffered(),currentTime:n,currentPlaylist:t,nextPlaylist:e,bufferLowWaterLine:i,bufferHighWaterLine:r,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",(()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")})),this.mainSegmentLoader_.on("timeout",(()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()})),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",(()=>{this.trigger("progress")})),this.mainSegmentLoader_.on("error",(()=>{const e=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:e.playlist,error:e})})),this.mainSegmentLoader_.on("appenderror",(()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")})),this.mainSegmentLoader_.on("syncinfoupdate",(()=>{this.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("timestampoffset",(()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})})),this.audioSegmentLoader_.on("syncinfoupdate",(()=>{this.onSyncInfoUpdate_()})),this.audioSegmentLoader_.on("appenderror",(()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")})),this.mainSegmentLoader_.on("ended",(()=>{this.logger_("main segment loader ended"),this.onEndOfStream()})),this.timelineChangeController_.on("audioTimelineBehind",(()=>{const e=this.audioSegmentLoader_.pendingSegment_;if(!e||!e.segment||!e.segment.syncInfo)return;const t=e.segment.syncInfo.end+.01;this.tech_.setCurrentTime(t)})),this.timelineChangeController_.on("fixBadTimelineChange",(()=>{this.logger_("Fix bad timeline change. Restarting al segment loaders..."),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()})),this.mainSegmentLoader_.on("earlyabort",(e=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:10}))}));const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const e=this.getCodecsOrExclude_();e&&this.sourceUpdater_.addOrChangeSourceBuffers(e)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",(()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("fmp4",(()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("ended",(()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()}));["segmentselected","segmentloadstart","segmentloaded","segmentkeyloadstart","segmentkeyloadcomplete","segmentdecryptionstart","segmentdecryptioncomplete","segmenttransmuxingstart","segmenttransmuxingcomplete","segmenttransmuxingtrackinfoavailable","segmenttransmuxingtiminginfoavailable","segmentappendstart","appendsdone","bandwidthupdated","timelinechange","codecschange"].forEach((e=>{this.mainSegmentLoader_.on(e,(e=>{this.player_.trigger(mo({},e))})),this.audioSegmentLoader_.on(e,(e=>{this.player_.trigger(mo({},e))})),this.subtitleSegmentLoader_.on(e,(e=>{this.player_.trigger(mo({},e))}))}))}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}pause(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}fastQualityChange_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectPlaylist();e&&e===this.mainPlaylistLoader_.media()?this.logger_("skipping fastQualityChange because new media is same as old"):(this.switchMedia_(e,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0)}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList||e.start){const t=this.seekable();if(!t.length)return!1;const n=t.end(0);let i=n;if(e.start){const r=e.start.timeOffset;i=r<0?Math.max(n+r,t.start(0)):Math.min(n,r)}this.trigger("firstplay"),this.tech_.setCurrentTime(i)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();"undefined"!==typeof e&&"function"===typeof e.then&&e.then(null,(e=>{}))}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const t=this.mainSegmentLoader_.getCurrentMediaInfo_();e=!t||t.hasVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_}e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const t=this.syncController_.getExpiredTime(e,this.duration());if(null===t)return!1;const n=Zy.Playlist.playlistEnd(e,t),i=this.tech_.currentTime(),r=this.tech_.buffered();if(!r.length)return n-i<=Yp;const s=r.end(r.length-1);return s-i<=Yp&&n-s<=Yp}excludePlaylist(e){let{playlistToExclude:t=this.mainPlaylistLoader_.media(),error:n={},playlistExclusionDuration:i}=e;if(t=t||this.mainPlaylistLoader_.media(),i=i||n.playlistExclusionDuration||this.playlistExclusionDuration,!t)return this.error=n,void("open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"));t.playlistErrors_++;const r=this.mainPlaylistLoader_.main.playlists,s=r.filter(gg),a=1===s.length&&s[0]===t;if(1===r.length&&i!==1/0)return Bp.log.warn(`Problem encountered with playlist ${t.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(a);if(a){if(this.main().contentSteering){const e=this.pathwayAttribute_(t),n=1e3*this.contentSteeringController_.steeringManifest.ttl;return this.contentSteeringController_.excludePathway(e),this.excludeThenChangePathway_(),void setTimeout((()=>{this.contentSteeringController_.addAvailablePathway(e)}),n)}let e=!1;r.forEach((n=>{if(n===t)return;const i=n.excludeUntil;"undefined"!==typeof i&&i!==1/0&&(e=!0,delete n.excludeUntil)})),e&&(Bp.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let o;o=t.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*i,t.excludeUntil=o,n.reason&&(t.lastExcludeReason_=n.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const l=this.selectPlaylist();if(!l)return this.error="Playback cannot continue. No available working or supported playlists.",void this.trigger("error");const u=n.internal?this.logger_:Bp.log.warn,c=n.message?" "+n.message:"";u(`${n.internal?"Internal problem":"Problem"} encountered with playlist ${t.id}.${c} Switching to playlist ${l.id}.`),l.attributes.AUDIO!==t.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),l.attributes.SUBTITLES!==t.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const d=l.targetDuration/2*1e3||5e3,h="number"===typeof l.lastRequest&&Date.now()-l.lastRequest<=d;return this.switchMedia_(l,"exclude",a||h)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,t){const n=[],i="all"===e;(i||"main"===e)&&n.push(this.mainPlaylistLoader_);const r=[];(i||"audio"===e)&&r.push("AUDIO"),(i||"subtitle"===e)&&(r.push("CLOSED-CAPTIONS"),r.push("SUBTITLES")),r.forEach((e=>{const t=this.mediaTypes_[e]&&this.mediaTypes_[e].activePlaylistLoader;t&&n.push(t)})),["main","audio","subtitle"].forEach((t=>{const i=this[`${t}SegmentLoader_`];!i||e!==t&&"all"!==e||n.push(i)})),n.forEach((e=>t.forEach((t=>{"function"===typeof e[t]&&e[t]()}))))}setCurrentTime(e){const t=Jp(this.tech_.buffered(),e);return this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media()&&this.mainPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),void this.load()):0}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:Zy.Playlist.duration(e):1/0:0}seekable(){return this.seekable_}getSeekableRange_(e,t){const n=e.media();if(!n)return null;const i=this.syncController_.getMediaSequenceSync(t);if(i&&i.isReliable){const e=i.start,t=i.end;if(!isFinite(e)||!isFinite(t))return null;const r=Zy.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,n),s=Math.max(0,t-r);return s<e?null:Wp([[e,s]])}const r=this.syncController_.getExpiredTime(n,this.duration());if(null===r)return null;const s=Zy.Playlist.seekable(n,r,Zy.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,n));return s.length?s:null}computeFinalSeekable_(e,t){if(!t)return e;const n=e.start(0),i=e.end(0),r=t.start(0),s=t.end(0);return r>i||n>s?e:Wp([[Math.max(n,r),Math.min(i,s)]])}onSyncInfoUpdate_(){if(!this.mainPlaylistLoader_)return;const e=this.getSeekableRange_(this.mainPlaylistLoader_,"main");if(!e)return;let t;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(t=this.getSeekableRange_(this.mediaTypes_.AUDIO.activePlaylistLoader,"audio"),!t))return;const n=this.seekable_;if(this.seekable_=this.computeFinalSeekable_(e,t),!this.seekable_)return;if(n&&n.length&&this.seekable_.length&&n.start(0)===this.seekable_.start(0)&&n.end(0)===this.seekable_.end(0))return;this.logger_(`seekable updated [${eg(this.seekable_)}]`);const i={seekableRanges:this.seekable_};this.trigger({type:"seekablerangeschanged",metadata:i}),this.tech_.trigger("seekablechanged")}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,e),void this.mediaSource.addEventListener("sourceopen",this.updateDuration_);if(e){const e=this.seekable();if(!e.length)return;return void((isNaN(this.mediaSource.duration)||this.mediaSource.duration<e.end(e.length-1))&&this.sourceUpdater_.setDuration(e.end(e.length-1)))}const t=this.tech_.buffered();let n=Zy.Playlist.duration(this.mainPlaylistLoader_.media());t.length>0&&(n=Math.max(n,t.end(t.length-1))),this.mediaSource.duration!==n&&this.sourceUpdater_.setDuration(n)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach((e=>{const t=this.mediaTypes_[e].groups;for(const n in t)t[n].forEach((e=>{e.playlistLoader&&e.playlistLoader.dispose()}))})),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,t=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),n=!e||!!this.audioSegmentLoader_.getCurrentMediaInfo_();return!(!t||!n)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},t=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const n=Bm(this.main(),t),i={},r=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(i.video=n.video||e.main.videoCodec||"avc1.4d400d"),e.main.isMuxed&&(i.video+=`,${n.audio||e.main.audioCodec||Bo}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||r)&&(i.audio=n.audio||e.main.audioCodec||e.audio.audioCodec||Bo,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!i.audio&&!i.video)return void this.excludePlaylist({playlistToExclude:t,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0});const s=(e,t)=>e?Uo(t,this.usingManagedMediaSource_):Fo(t),a={};let o;if(["video","audio"].forEach((function(t){if(i.hasOwnProperty(t)&&!s(e[t].isFmp4,i[t])){const n=e[t].isFmp4?"browser":"muxer";a[n]=a[n]||[],a[n].push(i[t]),"audio"===t&&(o=n)}})),r&&o&&t.attributes.AUDIO){const e=t.attributes.AUDIO;this.main().playlists.forEach((n=>{(n.attributes&&n.attributes.AUDIO)===e&&n!==t&&(n.excludeUntil=1/0)})),this.logger_(`excluding audio group ${e} as ${o} does not support codec(s): "${i.audio}"`)}if(!Object.keys(a).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const e=[];if(["video","audio"].forEach((t=>{const n=(Po(this.sourceUpdater_.codecs[t]||"")[0]||{}).type,r=(Po(i[t]||"")[0]||{}).type;n&&r&&n.toLowerCase()!==r.toLowerCase()&&e.push(`"${this.sourceUpdater_.codecs[t]}" -> "${i[t]}"`)})),e.length)return void this.excludePlaylist({playlistToExclude:t,error:{message:`Codec switching not supported: ${e.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0})}return i}{const e=Object.keys(a).reduce(((e,t)=>(e&&(e+=", "),e+=`${t} does not support codec(s): "${a[t].join(",")}"`)),"")+".";this.excludePlaylist({playlistToExclude:t,error:{internal:!0,message:e},playlistExclusionDuration:1/0})}}tryToCreateSourceBuffers_(){if("open"!==this.mediaSource.readyState||this.sourceUpdater_.hasCreatedSourceBuffers())return;if(!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)}excludeUnsupportedVariants_(){const e=this.main().playlists,t=[];Object.keys(e).forEach((n=>{const i=e[n];if(-1!==t.indexOf(i.id))return;t.push(i.id);const r=Bm(this.main,i),s=[];!r.audio||Fo(r.audio)||Uo(r.audio,this.usingManagedMediaSource_)||s.push(`audio codec ${r.audio}`),!r.video||Fo(r.video)||Uo(r.video,this.usingManagedMediaSource_)||s.push(`video codec ${r.video}`),r.text&&"stpp.ttml.im1t"===r.text&&s.push(`text codec ${r.text}`),s.length&&(i.excludeUntil=1/0,this.logger_(`excluding ${i.id} for unsupported: ${s.join(", ")}`))}))}excludeIncompatibleVariants_(e){const t=[],n=this.main().playlists,i=Um(Po(e)),r=Fm(i),s=i.video&&Po(i.video)[0]||null,a=i.audio&&Po(i.audio)[0]||null;Object.keys(n).forEach((e=>{const i=n[e];if(-1!==t.indexOf(i.id)||i.excludeUntil===1/0)return;t.push(i.id);const o=[],l=Bm(this.mainPlaylistLoader_.main,i),u=Fm(l);if(l.audio||l.video){if(u!==r&&o.push(`codec count "${u}" !== "${r}"`),!this.sourceUpdater_.canChangeType()){const e=l.video&&Po(l.video)[0]||null,t=l.audio&&Po(l.audio)[0]||null;e&&s&&e.type.toLowerCase()!==s.type.toLowerCase()&&o.push(`video codec "${e.type}" !== "${s.type}"`),t&&a&&t.type.toLowerCase()!==a.type.toLowerCase()&&o.push(`audio codec "${t.type}" !== "${a.type}"`)}o.length&&(i.excludeUntil=1/0,this.logger_(`excluding ${i.id}: ${o.join(" && ")}`))}}))}updateAdCues_(e){let t=0;const n=this.seekable();n.length&&(t=n.start(0)),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e.segments)return;let i,r=n;for(let s=0;s<e.segments.length;s++){const n=e.segments[s];if(i||(i=My(t,r+n.duration/2)),i){if("cueIn"in n){i.endTime=r,i.adEndTime=r,r+=n.duration,i=null;continue}if(r<i.endTime){r+=n.duration;continue}i.endTime+=n.duration}else if("cueOut"in n&&(i=new(lo().VTTCue)(r,r+n.duration,n.cueOut),i.adStartTime=r,i.adEndTime=r+parseFloat(n.cueOut),t.addCue(i)),"cueOutCont"in n){const[e,s]=n.cueOutCont.split("/").map(parseFloat);i=new(lo().VTTCue)(r,r+n.duration,""),i.adStartTime=r-e,i.adEndTime=i.adStartTime+s,t.addCue(i)}r+=n.duration}}(e,this.cueTagsTrack_,t)}goalBufferLength(){const e=this.tech_.currentTime(),t=am.GOAL_BUFFER_LENGTH,n=am.GOAL_BUFFER_LENGTH_RATE,i=Math.max(t,am.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*n,i)}bufferLowWaterLine(){const e=this.tech_.currentTime(),t=am.BUFFER_LOW_WATER_LINE,n=am.BUFFER_LOW_WATER_LINE_RATE,i=Math.max(t,am.MAX_BUFFER_LOW_WATER_LINE),r=Math.max(t,am.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*n,this.bufferBasedABR?r:i)}bufferHighWaterLine(){return am.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(e){Qm(this.inbandTextTracks_,"com.apple.streaming",this.tech_),(e=>{let{inbandTextTracks:t,dateRanges:n}=e;const i=t.metadataTrack_;if(!i)return;const r=lo().WebKitDataCue||lo().VTTCue;n.forEach((e=>{for(const t of Object.keys(e)){if(Ym.has(t))continue;const n=new r(e.startTime,e.endTime,"");n.id=e.id,n.type="com.apple.quicktime.HLS",n.value={key:Xm[t],data:e[t]},"scte35Out"!==t&&"scte35In"!==t||(n.value.data=new Uint8Array(n.value.data.match(/[\da-f]{2}/gi)).buffer),i.addCue(n)}e.processDateRange()}))})({inbandTextTracks:this.inbandTextTracks_,dateRanges:e})}addMetadataToTextTrack(e,t,n){const i=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();Qm(this.inbandTextTracks_,e,this.tech_),Wm({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:i,videoDuration:n})}pathwayAttribute_(e){return e.attributes["PATHWAY-ID"]||e.attributes.serviceLocation}initContentSteeringController_(){const e=this.main();if(e.contentSteering){for(const t of e.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(t));this.contentSteeringController_.assignTagProperties(e.uri,e.contentSteering),this.contentSteeringController_.queryBeforeStart?this.contentSteeringController_.requestSteeringManifest(!0):this.tech_.one("canplay",(()=>{this.contentSteeringController_.requestSteeringManifest()}))}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this));["contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach((e=>{this.contentSteeringController_.on(e,(e=>{this.trigger(mo({},e))}))})),"dash"===this.sourceType_&&this.mainPlaylistLoader_.on("loadedplaylist",(()=>{const e=this.main();(this.contentSteeringController_.didDASHTagChange(e.uri,e.contentSteering)||(()=>{const t=this.contentSteeringController_.getAvailablePathways(),n=[];for(const i of e.playlists){const e=i.attributes.serviceLocation;if(e&&(n.push(e),!t.has(e)))return!0}return!(n.length||!t.size)})())&&this.resetContentSteeringController_()}))}excludeThenChangePathway_(){const e=this.contentSteeringController_.getPathway();if(!e)return;this.handlePathwayClones_();const t=this.main().playlists,n=new Set;let i=!1;Object.keys(t).forEach((r=>{const s=t[r],a=this.pathwayAttribute_(s),o=a&&e!==a;s.excludeUntil===1/0&&"content-steering"===s.lastExcludeReason_&&!o&&(delete s.excludeUntil,delete s.lastExcludeReason_,i=!0);const l=!s.excludeUntil&&s.excludeUntil!==1/0;!n.has(s.id)&&o&&l&&(n.add(s.id),s.excludeUntil=1/0,s.lastExcludeReason_="content-steering",this.logger_(`excluding ${s.id} for ${s.lastExcludeReason_}`))})),"DASH"===this.contentSteeringController_.manifestType_&&Object.keys(this.mediaTypes_).forEach((t=>{const n=this.mediaTypes_[t];if(n.activePlaylistLoader){const t=n.activePlaylistLoader.media_;t&&t.attributes.serviceLocation!==e&&(i=!0)}})),i&&this.changeSegmentPathway_()}handlePathwayClones_(){const e=this.main().playlists,t=this.contentSteeringController_.currentPathwayClones,n=this.contentSteeringController_.nextPathwayClones;if(t&&t.size||n&&n.size){for(const[e,i]of t.entries()){n.get(e)||(this.mainPlaylistLoader_.updateOrDeleteClone(i),this.contentSteeringController_.excludePathway(e))}for(const[i,r]of n.entries()){const n=t.get(i);if(n)this.equalPathwayClones_(n,r)||(this.mainPlaylistLoader_.updateOrDeleteClone(r,!0),this.contentSteeringController_.addAvailablePathway(i));else{e.filter((e=>e.attributes["PATHWAY-ID"]===r["BASE-ID"])).forEach((e=>{this.mainPlaylistLoader_.addClonePathway(r,e)})),this.contentSteeringController_.addAvailablePathway(i)}}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...n])))}}equalPathwayClones_(e,t){if(e["BASE-ID"]!==t["BASE-ID"]||e.ID!==t.ID||e["URI-REPLACEMENT"].HOST!==t["URI-REPLACEMENT"].HOST)return!1;const n=e["URI-REPLACEMENT"].PARAMS,i=t["URI-REPLACEMENT"].PARAMS;for(const r in n)if(n[r]!==i[r])return!1;for(const r in i)if(n[r]!==i[r])return!1;return!0}changeSegmentPathway_(){const e=this.selectPlaylist();this.pauseLoading(),"DASH"===this.contentSteeringController_.manifestType_&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(e,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let e=0;const t="non-usable";this.mainPlaylistLoader_.main.playlists.forEach((n=>{const i=this.mainPlaylistLoader_.getKeyIdSet(n);i&&i.size&&i.forEach((i=>{const r="usable",s=this.keyStatusMap_.has(i)&&this.keyStatusMap_.get(i)===r,a=n.lastExcludeReason_===t&&n.excludeUntil===1/0;s?s&&a&&(delete n.excludeUntil,delete n.lastExcludeReason_,this.logger_(`enabling playlist ${n.id} because key ID ${i} is ${r}`)):(n.excludeUntil!==1/0&&n.lastExcludeReason_!==t&&(n.excludeUntil=1/0,n.lastExcludeReason_=t,this.logger_(`excluding playlist ${n.id} because the key ID ${i} doesn't exist in the keyStatusMap or is not ${r}`)),e++)}))})),e>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach((e=>{const n=e&&e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height<720,i=e.excludeUntil===1/0&&e.lastExcludeReason_===t;n&&i&&(delete e.excludeUntil,Bp.log.warn(`enabling non-HD playlist ${e.id} because all playlists were excluded due to ${t} key IDs`))}))}addKeyStatus_(e,t){const n=("string"===typeof e?e:(e=>{const t=new Uint8Array(e);return Array.from(t).map((e=>e.toString(16).padStart(2,"0"))).join("")})(e)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${t}' with key ID ${n} added to the keyStatusMap`),this.keyStatusMap_.set(n,t)}updatePlaylistByKeyStatus(e,t){this.addKeyStatus_(e,t),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}class iv{constructor(e,t,n){const{playlistController_:i}=e,r=i.fastQualityChange_.bind(i);if(t.attributes){const e=t.attributes.RESOLUTION;this.width=e&&e.width,this.height=e&&e.height,this.bandwidth=t.attributes.BANDWIDTH,this.frameRate=t.attributes["FRAME-RATE"]}var s,a,o;this.codecs=Bm(i.main(),t),this.playlist=t,this.id=n,this.enabled=(s=e.playlists,a=t.id,o=r,e=>{const t=s.main.playlists[a],n=pg(t),i=gg(t);if("undefined"===typeof e)return i;e?delete t.disabled:t.disabled=!0;const r={renditionInfo:{id:a,bandwidth:t.attributes.BANDWIDTH,resolution:t.attributes.RESOLUTION,codecs:t.attributes.CODECS},cause:"fast-quality"};return e===i||n||(e?(o(t),s.trigger({type:"renditionenabled",metadata:r})):s.trigger({type:"renditiondisabled",metadata:r})),e})}}const rv=["seeking","seeked","pause","playing","error"];class sv extends Bp.EventTarget{constructor(e){super(),this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.playedRanges_=[],this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=zp("PlaybackWatcher"),this.logger_("initialize");const t=()=>this.monitorCurrentTime_(),n=()=>this.monitorCurrentTime_(),i=()=>this.techWaiting_(),r=()=>this.resetTimeUpdate_(),s=this.playlistController_,a=["main","subtitle","audio"],o={};a.forEach((e=>{o[e]={reset:()=>this.resetSegmentDownloads_(e),updateend:()=>this.checkSegmentDownloads_(e)},s[`${e}SegmentLoader_`].on("appendsdone",o[e].updateend),s[`${e}SegmentLoader_`].on("playlistupdate",o[e].reset),this.tech_.on(["seeked","seeking"],o[e].reset)}));const l=e=>{["main","audio"].forEach((t=>{s[`${t}SegmentLoader_`][e]("appended",this.seekingAppendCheck_)}))};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),l("off"))},this.clearSeekingAppendCheck_=()=>l("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),l("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",i),this.tech_.on(rv,r),this.tech_.on("canplay",n),this.tech_.one("play",t),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",i),this.tech_.off(rv,r),this.tech_.off("canplay",n),this.tech_.off("play",t),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),a.forEach((e=>{s[`${e}SegmentLoader_`].off("appendsdone",o[e].updateend),s[`${e}SegmentLoader_`].off("playlistupdate",o[e].reset),this.tech_.off(["seeked","seeking"],o[e].reset)})),this.checkCurrentTimeTimeout_&&lo().clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&lo().clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=lo().setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const t=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=t.buffered_()}checkSegmentDownloads_(e){const t=this.playlistController_,n=t[`${e}SegmentLoader_`],i=n.buffered_(),r=function(e,t){if(e===t)return!1;if(!e&&t||!t&&e)return!0;if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e.start(n)!==t.start(n)||e.end(n)!==t.end(n))return!0;return!1}(this[`${e}Buffered_`],i);if(this[`${e}Buffered_`]=i,r){const n={bufferedRanges:i};return t.trigger({type:"bufferedrangeschanged",metadata:n}),void this.resetSegmentDownloads_(e)}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:n.playlist_&&n.playlist_.id,buffered:tg(i)}),this[`${e}StalledDownloads_`]<10||(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),"subtitle"!==e&&t.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:1/0}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+Yp>=t.end(t.length-1)))return this.techWaiting_();if(this.consecutiveUpdates>=5&&e===this.lastRecordedTime)this.consecutiveUpdates++,this.waiting_();else if(e===this.lastRecordedTime)this.consecutiveUpdates++;else{this.playedRanges_.push(Wp([this.lastRecordedTime,e]));const t={playedRanges:this.playedRanges_};this.playlistController_.trigger({type:"playedrangeschanged",metadata:t}),this.consecutiveUpdates=0,this.lastRecordedTime=e}}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const e=this.seekable(),t=this.tech_.currentTime();let n;if(this.afterSeekableWindow_(e,t,this.media(),this.allowSeeksWithinUnsafeLiveWindow)){n=e.end(e.length-1)}if(this.beforeSeekableWindow_(e,t)){const t=e.start(0);n=t+(t===e.end(0)?0:Yp)}if("undefined"!==typeof n)return this.logger_(`Trying to seek outside of seekable at time ${t} with seekable range ${eg(e)}. Seeking to ${n}.`),this.tech_.setCurrentTime(n),!0;const i=this.playlistController_.sourceUpdater_,r=this.tech_.buffered(),s=i.audioBuffer?i.audioBuffered():null,a=i.videoBuffer?i.videoBuffered():null,o=this.media(),l=o.partTargetDuration?o.partTargetDuration:2*(o.targetDuration-Xp),u=[s,a];for(let d=0;d<u.length;d++){if(!u[d])continue;if(ig(u[d],t)<l)return!1}const c=Zp(r,t);return 0!==c.length&&(n=c.start(0)+Yp,this.logger_(`Buffered region starts (${c.start(0)})  just beyond seek point (${t}). Seeking to ${n}.`),this.tech_.setCurrentTime(n),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),t=this.tech_.buffered(),n=Jp(t,e);return n.length&&e+3<=n.end(0)?(this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${n.start(0)} -> ${n.end(0)}]. Attempting to resume playback by seeking to the current time.`),void this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"})):void 0}techWaiting_(){const e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,t)){const n=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${t}. Seeking to live point (seekable end) ${n}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(n),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const n=this.tech_.vhs.playlistController_.sourceUpdater_,i=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:n.audioBuffered(),videoBuffered:n.videoBuffered(),currentTime:t}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const r=Zp(i,t);return r.length>0&&(this.logger_(`Stopped at ${t} and seeking to ${r.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(t),!0)}afterSeekableWindow_(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e.length)return!1;let r=e.end(e.length-1)+Yp;const s=!n.endList,a="number"===typeof n.partTargetDuration;return s&&(a||i)&&(r=e.end(e.length-1)+3*n.targetDuration),t>r}beforeSeekableWindow_(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_(e){let t,{videoBuffered:n,audioBuffered:i,currentTime:r}=e;if(n){if(n.length&&i.length){const e=Jp(n,r-3),s=Jp(n,r),a=Jp(i,r);a.length&&!s.length&&e.length&&(t={start:e.end(0),end:a.end(0)})}else{Zp(n,r).length||(t=this.gapFromVideoUnderflow_(n,r))}return!!t&&(this.logger_(`Encountered a gap in video from ${t.start} to ${t.end}. Seeking to current time ${r}`),!0)}}skipTheGap_(e){const t=this.tech_.buffered(),n=this.tech_.currentTime(),i=Zp(t,n);if(this.resetTimeUpdate_(),0===i.length||n!==e)return;this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",i.start(0)),this.tech_.setCurrentTime(i.start(0)+Xp);const r={gapInfo:{from:n,to:i.start(0)}};this.playlistController_.trigger({type:"gapjumped",metadata:r}),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"})}gapFromVideoUnderflow_(e,t){const n=function(e){if(e.length<2)return Wp();const t=[];for(let n=1;n<e.length;n++){const i=e.end(n-1),r=e.start(n);t.push([i,r])}return Wp(t)}(e);for(let i=0;i<n.length;i++){const e=n.start(i),r=n.end(i);if(t-e<4&&t-e>2)return{start:e,end:r}}return null}}const av={errorInterval:30,getSource(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},ov=function(e,t){let n=0,i=0;const r=Kp(av,t);e.ready((()=>{e.trigger({type:"usage",name:"vhs-error-reload-initialized"})}));const s=function(){i&&e.currentTime(i)},a=function(t){null!==t&&void 0!==t&&(i=e.duration()!==1/0&&e.currentTime()||0,e.one("loadedmetadata",s),e.src(t),e.trigger({type:"usage",name:"vhs-error-reload"}),e.play())},o=function(){if(Date.now()-n<1e3*r.errorInterval)e.trigger({type:"usage",name:"vhs-error-reload-canceled"});else{if(r.getSource&&"function"===typeof r.getSource)return n=Date.now(),r.getSource.call(e,a);Bp.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},l=function(){e.off("loadedmetadata",s),e.off("error",o),e.off("dispose",l)};e.on("error",o),e.on("dispose",l),e.reloadSourceOnError=function(t){l(),ov(e,t)}},lv=function(e){ov(this,e)};var uv="3.16.2";const cv={PlaylistLoader:Fg,Playlist:Sg,utils:Xg,STANDARD_PLAYLIST_SELECTOR:zm,INITIAL_PLAYLIST_SELECTOR:function(){const e=this.playlists.main.playlists.filter(Sg.isEnabled);Hm(e,((e,t)=>qm(e,t)));return e.filter((e=>!!Bm(this.playlists.main,e).video))[0]||null},lastBandwidthSelector:zm,movingAverageBandwidthSelector:function(e){let t=-1,n=-1;if(e<0||e>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){let i=this.useDevicePixelRatio&&lo().devicePixelRatio||1;return isNaN(this.customPixelRatio)||(i=this.customPixelRatio),t<0&&(t=this.systemBandwidth,n=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==n&&(t=e*this.systemBandwidth+(1-e)*t,n=this.systemBandwidth),Gm(this.playlists.main,t,parseInt(Vm(this.tech_.el(),"width"),10)*i,parseInt(Vm(this.tech_.el(),"height"),10)*i,this.limitRenditionByPlayerDimensions,this.playlistController_)}},comparePlaylistBandwidth:qm,comparePlaylistResolution:function(e,t){let n,i;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||lo().Number.MAX_VALUE,t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),i=i||lo().Number.MAX_VALUE,n===i&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:n-i},xhr:jg()};Object.keys(am).forEach((e=>{Object.defineProperty(cv,e,{get:()=>(Bp.log.warn(`using Vhs.${e} is UNSAFE be sure you know what you are doing`),am[e]),set(t){Bp.log.warn(`using Vhs.${e} is UNSAFE be sure you know what you are doing`),"number"!==typeof t||t<0?Bp.log.warn(`value of Vhs.${e} must be greater than or equal to 0`):am[e]=t}})}));const dv="videojs-vhs",hv=function(e,t){const n=t.media();let i=-1;for(let r=0;r<e.length;r++)if(e[r].id===n.id){i=r;break}e.selectedIndex_=i,e.trigger({selectedIndex:i,type:"change"})};cv.canPlaySource=function(){return Bp.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const fv=e=>{let{player:t,sourceKeySystems:n,audioMedia:i,mainPlaylists:r}=e;if(!t.eme.initializeMediaKeys)return Promise.resolve();const s=((e,t)=>e.reduce(((e,n)=>{if(!n.contentProtection)return e;const i=t.reduce(((e,t)=>{const i=n.contentProtection[t];return i&&i.pssh&&(e[t]={pssh:i.pssh}),e}),{});return Object.keys(i).length&&e.push(i),e}),[]))(i?r.concat([i]):r,Object.keys(n)),a=[],o=[];return s.forEach((e=>{o.push(new Promise(((e,n)=>{t.tech_.one("keysessioncreated",e)}))),a.push(new Promise(((n,i)=>{t.eme.initializeMediaKeys({keySystems:e},(e=>{e?i(e):n()}))})))})),Promise.race([Promise.all(a),Promise.race(o)])},pv=e=>{let{player:t,sourceKeySystems:n,media:i,audioMedia:r}=e;const s=((e,t,n)=>{if(!e)return e;let i={};t&&t.attributes&&t.attributes.CODECS&&(i=Um(Po(t.attributes.CODECS))),n&&n.attributes&&n.attributes.CODECS&&(i.audio=n.attributes.CODECS);const r=No(i.video),s=No(i.audio),a={};for(const o in e)a[o]={},s&&(a[o].audioContentType=s),r&&(a[o].videoContentType=r),t.contentProtection&&t.contentProtection[o]&&t.contentProtection[o].pssh&&(a[o].pssh=t.contentProtection[o].pssh),"string"===typeof e[o]&&(a[o].url=e[o]);return Kp(e,a)})(n,i,r);return!!s&&(t.currentSource().keySystems=s,!(s&&!t.eme)||(Bp.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1))},gv=()=>{if(!lo().localStorage)return null;const e=lo().localStorage.getItem(dv);if(!e)return null;try{return JSON.parse(e)}catch(t){return null}},mv=(e,t)=>{e._requestCallbackSet||(e._requestCallbackSet=new Set),e._requestCallbackSet.add(t)},yv=(e,t)=>{e._responseCallbackSet||(e._responseCallbackSet=new Set),e._responseCallbackSet.add(t)},vv=(e,t)=>{e._requestCallbackSet&&(e._requestCallbackSet.delete(t),e._requestCallbackSet.size||delete e._requestCallbackSet)},bv=(e,t)=>{e._responseCallbackSet&&(e._responseCallbackSet.delete(t),e._responseCallbackSet.size||delete e._responseCallbackSet)};cv.supportsNativeHls=function(){if(!co()||!co().createElement)return!1;const e=co().createElement("video");if(!Bp.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some((function(t){return/maybe|probably/i.test(e.canPlayType(t))}))}(),cv.supportsNativeDash=!!(co()&&co().createElement&&Bp.getTech("Html5").isSupported())&&/maybe|probably/i.test(co().createElement("video").canPlayType("application/dash+xml")),cv.supportsTypeNatively=e=>"hls"===e?cv.supportsNativeHls:"dash"===e&&cv.supportsNativeDash,cv.isSupported=function(){return Bp.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},cv.xhr.onRequest=function(e){mv(cv.xhr,e)},cv.xhr.onResponse=function(e){yv(cv.xhr,e)},cv.xhr.offRequest=function(e){vv(cv.xhr,e)},cv.xhr.offResponse=function(e){bv(cv.xhr,e)};const Tv=Bp.getComponent("Component");class Sv extends Tv{constructor(e,t,n){if(super(t,n.vhs),"number"===typeof n.initialBandwidth&&(this.options_.bandwidth=n.initialBandwidth),this.logger_=zp("VhsHandler"),t.options_&&t.options_.playerId){const e=Bp.getPlayer(t.options_.playerId);this.player_=e}if(this.tech_=t,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(co(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(e=>{const t=co().fullscreenElement||co().webkitFullscreenElement||co().mozFullScreenElement||co().msFullscreenElement;t&&t.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()})),this.on(this.tech_,"seeking",(function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())})),this.on(this.tech_,"error",(function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()})),this.on(this.tech_,"play",this.play)}setOptions_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.options_=Kp(this.options_,e),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage="undefined"!==typeof this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=!1!==this.options_.llhls,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,"number"!==typeof this.options_.playlistExclusionDuration&&(this.options_.playlistExclusionDuration=60),"number"!==typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){const e=gv();e&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),e&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}"number"!==typeof this.options_.bandwidth&&(this.options_.bandwidth=am.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===am.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","customPixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach((e=>{"undefined"!==typeof this.source_[e]&&(this.options_[e]=this.source_[e])})),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio;const t=this.options_.customPixelRatio;"number"===typeof t&&t>=0&&(this.customPixelRatio=t)}setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setOptions_(e)}src(e,t){if(!e)return;var n;this.setOptions_(),this.options_.src=0===(n=this.source_.src).toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(n.substring(n.indexOf(",")+1)):n,this.options_.tech=this.tech_,this.options_.externVhs=cv,this.options_.sourceType=Vo(t),this.options_.seekTo=e=>{this.tech_.setCurrentTime(e)},this.options_.player_=this.player_,this.playlistController_=new nv(this.options_);const i=Kp({liveRangeSafeTimeDelta:Yp},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new sv(i),this.attachStreamingEventListeners_(),this.playlistController_.on("error",(()=>{const e=Bp.players[this.tech_.options_.playerId];let t=this.playlistController_.error;"object"!==typeof t||t.code?"string"===typeof t&&(t={message:t,code:3}):t.code=3,e.error(t)}));const r=this.options_.bufferBasedABR?cv.movingAverageBandwidthSelector(.55):cv.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):r.bind(this),this.playlistController_.selectInitialPlaylist=cv.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(e){this.playlistController_.selectPlaylist=e.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(e){this.playlistController_.mainSegmentLoader_.throughput.rate=e,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let e=this.playlistController_.mainSegmentLoader_.bandwidth;const t=lo().navigator.connection||lo().navigator.mozConnection||lo().navigator.webkitConnection,n=1e7;if(this.options_.useNetworkInformationApi&&t){const i=1e3*t.downlink*1e3;e=i>=n&&e>=n?Math.max(e,i):i}return e},set(e){this.playlistController_.mainSegmentLoader_.bandwidth=e,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const e=1/(this.bandwidth||1);let t;t=this.throughput>0?1/this.throughput:0;return Math.floor(1/(e+t))},set(){Bp.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>tg(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>tg(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",(()=>{this.options_.useBandwidthFromLocalStorage&&(e=>{if(!lo().localStorage)return!1;let t=gv();t=t?Kp(t,e):e;try{lo().localStorage.setItem(dv,JSON.stringify(t))}catch(n){return!1}})({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})})),this.playlistController_.on("selectedinitialmedia",(()=>{var e;(e=this).representations=()=>{const t=e.playlistController_.main(),n=Tg(t)?e.playlistController_.getAudioTrackPlaylists_():t.playlists;return n?n.filter((e=>!pg(e))).map(((t,n)=>new iv(e,t,t.id))):[]}})),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",(()=>{this.setupEme_()})),this.on(this.playlistController_,"progress",(function(){this.tech_.trigger("progress")})),this.on(this.playlistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=!0})),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=lo().URL.createObjectURL(this.playlistController_.mediaSource),(Bp.browser.IS_ANY_SAFARI||Bp.browser.IS_IOS)&&this.options_.overrideNative&&"hls"===this.options_.sourceType&&"function"===typeof this.tech_.addSourceElement?(this.tech_.addSourceElement(this.mediaSourceUrl_),this.tech_.addSourceElement(this.source_.src)):this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),fv({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then((()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()})).catch((e=>{this.logger_("error while creating EME key session",e),this.player_.error({message:"Failed to initialize media keys for EME",code:3})}))}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,t=pv({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});this.player_.tech_.on("keystatuschange",(e=>{this.playlistController_.updatePlaylistByKeyStatus(e.keyId,e.status)})),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),t?this.createKeySessions_():this.playlistController_.sourceUpdater_.initializedEme()}setupQualityLevels_(){const e=Bp.players[this.tech_.options_.playerId];e&&e.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",(()=>{var e,t;e=this.qualityLevels_,(t=this).representations().forEach((t=>{e.addQualityLevel(t)})),hv(e,t.playlists)})),this.playlists.on("mediachange",(()=>{hv(this.qualityLevels_,this.playlists)})))}static version(){return{"@videojs/http-streaming":uv,"mux.js":"7.1.0","mpd-parser":"1.3.1","m3u8-parser":"7.2.0","aes-decrypter":"4.0.2"}}version(){return this.constructor.version()}canChangeType(){return Cy.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&lo().URL.revokeObjectURL&&(lo().URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,t){return Yg({playlist:this.playlistController_.media(),time:e,callback:t})}seekToProgramTime(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return Qg({programTime:e,playlist:this.playlistController_.media(),retryCount:i,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}setupXhrHooks_(){this.xhr.onRequest=e=>{mv(this.xhr,e)},this.xhr.onResponse=e=>{yv(this.xhr,e)},this.xhr.offRequest=e=>{vv(this.xhr,e)},this.xhr.offResponse=e=>{bv(this.xhr,e)},this.player_.trigger("xhr-hooks-ready")}attachStreamingEventListeners_(){["seekablerangeschanged","bufferedrangeschanged","contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach((e=>{this.playlistController_.on(e,(e=>{this.player_.trigger(mo({},e))}))})),["gapjumped","playedrangeschanged"].forEach((e=>{this.playbackWatcher_.on(e,(e=>{this.player_.trigger(mo({},e))}))}))}}const _v={name:"videojs-http-streaming",VERSION:uv,canHandleSource(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Kp(Bp.options,t);return!(!n.vhs.experimentalUseMMS&&!Uo("avc1.4d400d,mp4a.40.2",!1))&&_v.canPlayType(e.type,n)},handleSource(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Kp(Bp.options,n);return t.vhs=new Sv(e,t,i),t.vhs.xhr=jg(),t.vhs.setupXhrHooks_(),t.vhs.src(e.src,e.type),t.vhs},canPlayType(e,t){const n=Vo(e);if(!n)return"";const i=_v.getOverrideNative(t);return!cv.supportsTypeNatively(n)||i?"maybe":""},getOverrideNative(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vhs:t={}}=e,n=!(Bp.browser.IS_ANY_SAFARI||Bp.browser.IS_IOS),{overrideNative:i=n}=t;return i}};Uo("avc1.4d400d,mp4a.40.2",!0)&&Bp.getTech("Html5").registerSourceHandler(_v,0),Bp.VhsHandler=Sv,Bp.VhsSourceHandler=_v,Bp.Vhs=cv,Bp.use||Bp.registerComponent("Vhs",cv),Bp.options.vhs=Bp.options.vhs||{},Bp.getPlugin&&Bp.getPlugin("reloadSourceOnError")||Bp.registerPlugin("reloadSourceOnError",lv);class wv{constructor(){this.player=null,this.videoElement=null,this.eventListeners={}}initialize(e,t){e.innerHTML="";const n=document.createElement("video");n.className="video-js vjs-default-skin",n.style.width="100%",n.style.position="relative",n.style.height="100%",n.setAttribute("controls",""),e.appendChild(n),this.videoElement=n,this.player=Bp(n,{...t,html5:{vhs:{overrideNative:!0}}}),null!==t&&void 0!==t&&t.drm&&this.setupDRM(t.drm),this.player.on("playing",(()=>this.emitEvent("playing"))),this.player.on("waiting",(()=>this.emitEvent("buffering"))),this.player.on("error",(()=>{var e;return this.emitEvent("error",null===(e=this.player)||void 0===e?void 0:e.error())})),this.player.on("loadedmetadata",(()=>{console.log("Metadata loaded - Fetching renditions..."),this.getAvailableRenditions(),this.trackRenditionChange()})),this.player.on("loadeddata",(()=>{console.log("New source loaded - Updating renditions..."),this.getAvailableRenditions()})),this.trackRenditionChange()}trackRenditionChange(){var e,t;if(!this.player)return;const n=()=>{this.emitEvent("renditionchange",{bitrate:this.getBitrate(),resolution:this.getResolution()})};null!==(e=this.player.tech_)&&void 0!==e&&e.hls&&this.player.tech_.hls.on("mediachange",n),null!==(t=this.player.tech_)&&void 0!==t&&t.vhs&&this.player.tech_.vhs.on("mediachange",n)}setupDRM(e){this.player&&this.player.ready((()=>{const t=this.player.tech({IWillNotUseThisInPlugins:!0});null!==t&&void 0!==t&&t.sourceHandler_&&t.on("sourceopen",(()=>{for(const s in e){var n,i,r;null===(n=t.eme)||void 0===n||null===(i=(r=n).setServerCertificate)||void 0===i||i.call(r,s,e[s].serverURL)}}))}))}load(e,t){if(!this.player)return;let n=e.endsWith(".m3u8")?"application/x-mpegURL":e.endsWith(".mpd")?"application/dash+xml":"video/mp4";this.player.src({src:e,type:n}),t&&this.setupDRM({[t.drmType]:{serverURL:t.licenseUrl}})}getAvailableRenditions(){return this.player&&this.player.qualityLevels?Array.from(this.player.qualityLevels().levels_).map((e=>({resolution:`${e.width}x${e.height}`,bitrate:Math.round(e.bitrate/1e3)}))).sort(((e,t)=>e.bitrate-t.bitrate)):[]}setRendition(e){if(!this.player||!this.player.qualityLevels)return;this.player.qualityLevels().levels_.forEach((t=>{t.enabled=`${t.width}x${t.height}`===e})),this.setAdaptiveBitrate(!1),console.log(`Switched to ${e}`)}setAdaptiveBitrate(e){if(!this.player||!this.player.qualityLevels)return;this.player.qualityLevels().levels_.forEach((t=>t.enabled=e)),console.log("ABR "+(e?"enabled":"disabled"))}play(){var e;null===(e=this.player)||void 0===e||e.play().catch((e=>{console.error("Error attempting to play the video:",e)})),this.emitEvent("playing")}pause(){var e;null===(e=this.player)||void 0===e||e.pause()}destroy(){this.player&&(this.player.dispose(),this.player=null),this.videoElement&&this.videoElement.parentElement&&(this.videoElement.parentElement.removeChild(this.videoElement),this.videoElement=null)}getBitrate(){var e,t,n;if(!this.player)return 0;if(null!==(e=this.player.tech_)&&void 0!==e&&e.hls){var i;const e=this.player.tech_.hls.playlists.media();return null!==e&&void 0!==e&&null!==(i=e.attributes)&&void 0!==i&&i.BANDWIDTH?Math.round(e.attributes.BANDWIDTH/1e3):0}if(null!==(t=this.player.tech_)&&void 0!==t&&null!==(n=t.vhs)&&void 0!==n&&n.playlists){var r;const e=this.player.tech_.vhs.playlists.media();return null!==e&&void 0!==e&&null!==(r=e.attributes)&&void 0!==r&&r.BANDWIDTH?Math.round(e.attributes.BANDWIDTH/1e3):0}return 0}getResolution(){return this.videoElement?`${this.videoElement.videoWidth}x${this.videoElement.videoHeight}`:"N/A"}on(e,t){this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(t)}off(e,t){this.eventListeners[e]&&(this.eventListeners[e]=this.eventListeners[e].filter((e=>e!==t)))}emitEvent(e,t){this.eventListeners[e]&&this.eventListeners[e].forEach((e=>e(t)))}}const Ev="videojs",kv="shaka",xv="hls",Av="mse-nav";function Cv(e){switch(e){case kv:return new ao;case Ev:return new wv;case xv:return new Wa;case Av:return new io;default:throw new Error(`Unknown player plugin: ${e}`)}}const Iv=e=>{let{message:t,onRetry:n}=e;return(0,o.jsx)("div",{className:"error-modal-overlay",children:(0,o.jsxs)("div",{className:"error-modal",children:[(0,o.jsx)("h2",{children:"\u26a0\ufe0f Error Occurred"}),(0,o.jsx)("p",{children:t}),(0,o.jsx)("button",{onClick:n,children:"Retry"})]})})};class Lv extends e.Component{constructor(e){super(e),this.handleRetry=()=>{this.setState({hasError:!1,errorMessage:""}),window.location.reload()},this.state={hasError:!1,errorMessage:""}}static getDerivedStateFromError(e){return{hasError:!0,errorMessage:e.message}}componentDidCatch(e,t){console.error("Error caught by ErrorBoundary:",e,t)}render(){return this.state.hasError?(0,o.jsx)(Iv,{message:this.state.errorMessage,onRetry:this.handleRetry}):this.props.children}}const Dv=Lv,Rv=e=>{let{selectedPlayer:t,availablePlayers:n,onSelect:i}=e;return(0,o.jsx)("div",{className:"accordion",children:(0,o.jsxs)("div",{className:"accordion-content-row",children:["Players:",n.map((e=>(0,o.jsxs)("label",{className:"radio-label",children:[(0,o.jsx)("input",{type:"radio",value:e,checked:t===e,onChange:()=>i(e)}),e.toUpperCase()]},e)))]})})},Mv="https://bitmovin-a.akamaihd.net/content/sintel/sintel.mpd",Pv=()=>{const[t,n]=(0,e.useState)(Ev),[i,s]=(0,e.useState)(Mv),[a,l]=(0,e.useState)(null),[u,c]=(0,e.useState)(null),d=r.getAvailablePlugins();return(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:"Nav Stream/Player Tester"}),(0,o.jsxs)("div",{className:"dashBoard",children:[(0,o.jsx)(Rv,{selectedPlayer:t,availablePlayers:d,onSelect:n}),(0,o.jsx)(Dv,{children:(0,o.jsx)(f,{src:i,pluginName:t,drmType:a,licenseUrl:u})})]}),(0,o.jsx)(p,{defaultURL:Mv,onLoad:(e,t,n)=>{s(e),l(t),c(n)}})]})};r.registerPlugin(Ev,(()=>Cv(Ev))),r.registerPlugin(kv,(()=>Cv(kv))),r.registerPlugin(xv,(()=>Cv(xv))),r.registerPlugin(Av,(()=>Cv(Av)));const Ov=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:s,getTTFB:a}=t;n(e),i(e),r(e),s(e),a(e)}))};t.createRoot(document.getElementById("root")).render((0,o.jsx)(e.StrictMode,{children:(0,o.jsx)(Pv,{})})),Ov()})()})();
//# sourceMappingURL=main.80722822.js.map